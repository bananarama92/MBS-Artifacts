/*!
 * MBS: Maid's Bondage Scripts
 *
 * Copyright (C) 2023-2025 Bananarama92
 *
 * This program is free software: you can redistribute it and/or modify it under the terms of
 * the GNU General Public License as published by the Free Software Foundation,
 * either version 3 of the License, or (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY;
 * without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
 * See the GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License along with this program.
 * If not, see https://www.gnu.org/licenses/.
 *
 * An exception is made for the "mbs.css" API, which is licensed under the terms of GNU LGPL
 * version 3 (see https://www.gnu.org/licenses/lgpl-3.0.en.html).
 */
var mbs=function(e){"use strict";const t="1.10.10";var n="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function r(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var i,o={},a={},s={},l={};var u,c={};var d,h={};var f,p={};var g,m={};var v,y,b,R={};function w(){return y||(y=1,function(e){var t=s&&s.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),n=s&&s.__exportStar||function(e,n){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(n,r)||t(n,e,r)};Object.defineProperty(e,"__esModule",{value:!0}),n((i||(i=1,Object.defineProperty(l,"__esModule",{value:!0})),l),e),n((u||(u=1,Object.defineProperty(c,"__esModule",{value:!0})),c),e),n((d||(d=1,Object.defineProperty(h,"__esModule",{value:!0})),h),e),n((f||(f=1,Object.defineProperty(p,"__esModule",{value:!0})),p),e),n((g||(g=1,Object.defineProperty(m,"__esModule",{value:!0})),m),e),n(function(){if(v)return R;v=1,Object.defineProperty(R,"__esModule",{value:!0}),R.classnames=function(e){const t=i(e).filter(n);return t.length>0?t.join(" "):void 0};const e=e=>Object.entries(e).map(([e,t])=>t&&e),t=e=>!!e,n=(e,t,n)=>n.indexOf(e)===t,r=[];function i(n){return n?"string"==typeof n?[n]:Array.isArray(n)?n.flatMap(i).filter(t):e(n).filter(t):r}return R}(),e)}(s)),s}function S(){if(b)return a;b=1,Object.defineProperty(a,"__esModule",{value:!0}),a.setAttributes=function(r,i){for(const o of Object.keys(i)){if("__source"===o||"__self"===o||"tsxTag"===o)continue;const a=i[o];if("class"===o){const t=(0,e.classnames)(a);t&&r.setAttribute(o,t)}else if("ref"===o)a.current=r;else if(n.test(o)){const e=o.replace(/Capture$/,""),t=o!==e,n=e.toLowerCase().substring(2);r.addEventListener(n,a,t)}else"style"===o&&"string"!=typeof a?t(a,r.style):"dangerouslySetInnerHTML"===o?r.innerHTML=a:!0===a?r.setAttribute(o,o):(a||0===a||""===a)&&r.setAttribute(o,a.toString())}};const e=w();function t(e,t){for(const n of Object.keys(e))n in t&&(t[n]=e[n])}const n=/^on\p{Lu}/u;return a}var B,k,C={};function _(){if(B)return C;function e(e,t){t instanceof Element?e.appendChild(t):"string"==typeof t||"number"==typeof t?e.appendChild(document.createTextNode(t.toString())):console.warn("Unknown type to append: ",t)}return B=1,Object.defineProperty(C,"__esModule",{value:!0}),C.applyChildren=function t(n,r){for(const i of r)(i||0===i)&&(Array.isArray(i)?t(n,i):e(n,i))},C.createDomElement=function(e,t){const n=t?.is?{is:t.is}:void 0;return t?.xmlns?document.createElementNS(t.xmlns,e,n):document.createElement(e,n)},C.applyTsxTag=function(e,t){let n=e,r=t;r&&"tsxTag"in r&&(n=r.tsxTag,!r.is&&e.includes("-")&&(r={...r,is:e}));return{finalTag:n,finalAttrs:r}},C}function x(){if(k)return o;k=1,Object.defineProperty(o,"__esModule",{value:!0}),o.jsx=n,o.jsxs=n,o.jsxDEV=n;const e=S(),t=_();function n(n,r){if("function"==typeof n)return n(r);const{children:i,...o}=r,{finalTag:a,finalAttrs:s}=(0,t.applyTsxTag)(n,o),l=(0,t.createDomElement)(a,s);return(0,e.setAttributes)(l,s),(0,t.applyChildren)(l,[i]),l}return o}var P,E=x(),M={},I={};var j,O={};var A,$,F={};$||($=1,function(e){var t=M&&M.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),n=M&&M.__exportStar||function(e,n){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(n,r)||t(n,e,r)};Object.defineProperty(e,"__esModule",{value:!0}),n(function(){if(P)return I;P=1,Object.defineProperty(I,"__esModule",{value:!0}),I.createRef=I.h=void 0,I.createElement=n;const e=S(),t=_();function n(n,r,...i){if("function"==typeof n)return n({...r,children:i});const{finalTag:o,finalAttrs:a}=(0,t.applyTsxTag)(n,r),s=(0,t.createDomElement)(o,a);return a&&(0,e.setAttributes)(s,a),(0,t.applyChildren)(s,i),s}return I.h=n,I.createRef=()=>({current:null}),I}(),e),n(function(){if(j)return O;j=1,Object.defineProperty(O,"__esModule",{value:!0}),O.defineCustomElement=function(t,n,r){return customElements.define(t,n,r),n=>(0,e.jsx)(t,n)};const e=x();return O}(),e),n(x(),e),n((A||(A=1,Object.defineProperty(F,"__esModule",{value:!0})),F),e)}(M));Object.create;Object.create;function L(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)}function T(e,t,n,r,i){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?i.call(e,n):i?i.value=n:t.set(e,n),n}"function"==typeof SuppressedError&&SuppressedError;var D="object"==typeof global&&global&&global.Object===Object&&global,H="object"==typeof self&&self&&self.Object===Object&&self,N=D||H||Function("return this")(),G=N.Symbol,W=Object.prototype,q=W.hasOwnProperty,z=W.toString,K=G?G.toStringTag:void 0;var U=Object.prototype.toString;var V="[object Null]",J="[object Undefined]",Y=G?G.toStringTag:void 0;function X(e){return null==e?void 0===e?J:V:Y&&Y in Object(e)?function(e){var t=q.call(e,K),n=e[K];try{e[K]=void 0;var r=!0}catch(e){}var i=z.call(e);return r&&(t?e[K]=n:delete e[K]),i}(e):function(e){return U.call(e)}(e)}function Z(e){return null!=e&&"object"==typeof e}function Q(e){return"symbol"==typeof e||Z(e)&&"[object Symbol]"==X(e)}function ee(e){return"number"==typeof e?e:Q(e)?NaN:+e}function te(e,t){for(var n=-1,r=null==e?0:e.length,i=Array(r);++n<r;)i[n]=t(e[n],n,e);return i}var ne=Array.isArray,re=G?G.prototype:void 0,ie=re?re.toString:void 0;function oe(e){if("string"==typeof e)return e;if(ne(e))return te(e,oe)+"";if(Q(e))return ie?ie.call(e):"";var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}function ae(e,t){return function(n,r){var i;if(void 0===n&&void 0===r)return t;if(void 0!==n&&(i=n),void 0!==r){if(void 0===i)return r;"string"==typeof n||"string"==typeof r?(n=oe(n),r=oe(r)):(n=ee(n),r=ee(r)),i=e(n,r)}return i}}var se=ae(function(e,t){return e+t},0),le=/\s/;function ue(e){for(var t=e.length;t--&&le.test(e.charAt(t)););return t}var ce=/^\s+/;function de(e){return e?e.slice(0,ue(e)+1).replace(ce,""):e}function he(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}var fe=/^[-+]0x[0-9a-f]+$/i,pe=/^0b[01]+$/i,ge=/^0o[0-7]+$/i,me=parseInt;function ve(e){if("number"==typeof e)return e;if(Q(e))return NaN;if(he(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=he(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=de(e);var n=pe.test(e);return n||ge.test(e)?me(e.slice(2),n?2:8):fe.test(e)?NaN:+e}var ye=1/0;function be(e){return e?(e=ve(e))===ye||e===-1/0?17976931348623157e292*(e<0?-1:1):e==e?e:0:0===e?e:0}function Re(e){var t=be(e),n=t%1;return t==t?n?t-n:t:0}function we(e){return e}var Se="[object AsyncFunction]",Be="[object Function]",ke="[object GeneratorFunction]",Ce="[object Proxy]";function _e(e){if(!he(e))return!1;var t=X(e);return t==Be||t==ke||t==Se||t==Ce}var xe,Pe=N["__core-js_shared__"],Ee=(xe=/[^.]+$/.exec(Pe&&Pe.keys&&Pe.keys.IE_PROTO||""))?"Symbol(src)_1."+xe:"";var Me=Function.prototype.toString;function Ie(e){if(null!=e){try{return Me.call(e)}catch(e){}try{return e+""}catch(e){}}return""}var je=/^\[object .+?Constructor\]$/,Oe=Function.prototype,Ae=Object.prototype,$e=Oe.toString,Fe=Ae.hasOwnProperty,Le=RegExp("^"+$e.call(Fe).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function Te(e){return!(!he(e)||function(e){return!!Ee&&Ee in e}(e))&&(_e(e)?Le:je).test(Ie(e))}function De(e,t){var n=function(e,t){return null==e?void 0:e[t]}(e,t);return Te(n)?n:void 0}var He=De(N,"WeakMap"),Ne=He&&new He,Ge=Ne?function(e,t){return Ne.set(e,t),e}:we,We=Object.create,qe=function(){function e(){}return function(t){if(!he(t))return{};if(We)return We(t);e.prototype=t;var n=new e;return e.prototype=void 0,n}}();function ze(e){return function(){var t=arguments;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var n=qe(e.prototype),r=e.apply(n,t);return he(r)?r:n}}function Ke(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}var Ue=Math.max;function Ve(e,t,n,r){for(var i=-1,o=e.length,a=n.length,s=-1,l=t.length,u=Ue(o-a,0),c=Array(l+u),d=!r;++s<l;)c[s]=t[s];for(;++i<a;)(d||i<o)&&(c[n[i]]=e[i]);for(;u--;)c[s++]=e[i++];return c}var Je=Math.max;function Ye(e,t,n,r){for(var i=-1,o=e.length,a=-1,s=n.length,l=-1,u=t.length,c=Je(o-s,0),d=Array(c+u),h=!r;++i<c;)d[i]=e[i];for(var f=i;++l<u;)d[f+l]=t[l];for(;++a<s;)(h||i<o)&&(d[f+n[a]]=e[i++]);return d}function Xe(){}function Ze(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=4294967295,this.__views__=[]}function Qe(){}Ze.prototype=qe(Xe.prototype),Ze.prototype.constructor=Ze;var et=Ne?function(e){return Ne.get(e)}:Qe,tt={},nt=Object.prototype.hasOwnProperty;function rt(e){for(var t=e.name+"",n=tt[t],r=nt.call(tt,t)?n.length:0;r--;){var i=n[r],o=i.func;if(null==o||o==e)return i.name}return t}function it(e,t){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!t,this.__index__=0,this.__values__=void 0}function ot(e,t){var n=-1,r=e.length;for(t||(t=Array(r));++n<r;)t[n]=e[n];return t}function at(e){if(e instanceof Ze)return e.clone();var t=new it(e.__wrapped__,e.__chain__);return t.__actions__=ot(e.__actions__),t.__index__=e.__index__,t.__values__=e.__values__,t}it.prototype=qe(Xe.prototype),it.prototype.constructor=it;var st=Object.prototype.hasOwnProperty;function lt(e){if(Z(e)&&!ne(e)&&!(e instanceof Ze)){if(e instanceof it)return e;if(st.call(e,"__wrapped__"))return at(e)}return new it(e)}function ut(e){var t=rt(e),n=lt[t];if("function"!=typeof n||!(t in Ze.prototype))return!1;if(e===n)return!0;var r=et(n);return!!r&&e===r[0]}lt.prototype=Xe.prototype,lt.prototype.constructor=lt;var ct=Date.now;function dt(e){var t=0,n=0;return function(){var r=ct(),i=16-(r-n);if(n=r,i>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}var ht=dt(Ge),ft=/\{\n\/\* \[wrapped with (.+)\] \*/,pt=/,? & /;var gt=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/;function mt(e){return function(){return e}}var vt=function(){try{var e=De(Object,"defineProperty");return e({},"",{}),e}catch(e){}}(),yt=vt?function(e,t){return vt(e,"toString",{configurable:!0,enumerable:!1,value:mt(t),writable:!0})}:we,bt=dt(yt);function Rt(e,t){for(var n=-1,r=null==e?0:e.length;++n<r&&!1!==t(e[n],n,e););return e}function wt(e,t,n,r){for(var i=e.length,o=n+(r?1:-1);r?o--:++o<i;)if(t(e[o],o,e))return o;return-1}function St(e){return e!=e}function Bt(e,t,n){return t==t?function(e,t,n){for(var r=n-1,i=e.length;++r<i;)if(e[r]===t)return r;return-1}(e,t,n):wt(e,St,n)}function kt(e,t){return!!(null==e?0:e.length)&&Bt(e,t,0)>-1}var Ct=[["ary",128],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",32],["partialRight",64],["rearg",256]];function _t(e,t,n){var r=t+"";return bt(e,function(e,t){var n=t.length;if(!n)return e;var r=n-1;return t[r]=(n>1?"& ":"")+t[r],t=t.join(n>2?", ":" "),e.replace(gt,"{\n/* [wrapped with "+t+"] */\n")}(r,function(e,t){return Rt(Ct,function(n){var r="_."+n[0];t&n[1]&&!kt(e,r)&&e.push(r)}),e.sort()}(function(e){var t=e.match(ft);return t?t[1].split(pt):[]}(r),n)))}function xt(e,t,n,r,i,o,a,s,l,u){var c=8&t;t|=c?32:64,4&(t&=~(c?64:32))||(t&=-4);var d=[e,t,i,c?o:void 0,c?a:void 0,c?void 0:o,c?void 0:a,s,l,u],h=n.apply(void 0,d);return ut(e)&&ht(h,d),h.placeholder=r,_t(h,e,t)}function Pt(e){return e.placeholder}var Et=9007199254740991,Mt=/^(?:0|[1-9]\d*)$/;function It(e,t){var n=typeof e;return!!(t=null==t?Et:t)&&("number"==n||"symbol"!=n&&Mt.test(e))&&e>-1&&e%1==0&&e<t}var jt=Math.min;var Ot="__lodash_placeholder__";function At(e,t){for(var n=-1,r=e.length,i=0,o=[];++n<r;){var a=e[n];a!==t&&a!==Ot||(e[n]=Ot,o[i++]=n)}return o}function $t(e,t,n,r,i,o,a,s,l,u){var c=128&t,d=1&t,h=2&t,f=24&t,p=512&t,g=h?void 0:ze(e);return function m(){for(var v=arguments.length,y=Array(v),b=v;b--;)y[b]=arguments[b];if(f)var R=Pt(m),w=function(e,t){for(var n=e.length,r=0;n--;)e[n]===t&&++r;return r}(y,R);if(r&&(y=Ve(y,r,i,f)),o&&(y=Ye(y,o,a,f)),v-=w,f&&v<u){var S=At(y,R);return xt(e,t,$t,m.placeholder,n,y,S,s,l,u-v)}var B=d?n:this,k=h?B[e]:e;return v=y.length,s?y=function(e,t){for(var n=e.length,r=jt(t.length,n),i=ot(e);r--;){var o=t[r];e[r]=It(o,n)?i[o]:void 0}return e}(y,s):p&&v>1&&y.reverse(),c&&l<v&&(y.length=l),this&&this!==N&&this instanceof m&&(k=g||ze(k)),k.apply(B,y)}}var Ft="__lodash_placeholder__",Lt=128,Tt=Math.min;var Dt=Math.max;function Ht(e,t,n,r,i,o,a,s){var l=2&t;if(!l&&"function"!=typeof e)throw new TypeError("Expected a function");var u=r?r.length:0;if(u||(t&=-97,r=i=void 0),a=void 0===a?a:Dt(Re(a),0),s=void 0===s?s:Re(s),u-=i?i.length:0,64&t){var c=r,d=i;r=i=void 0}var h=l?void 0:et(e),f=[e,t,n,r,i,c,d,o,a,s];if(h&&function(e,t){var n=e[1],r=t[1],i=n|r,o=i<131,a=r==Lt&&8==n||r==Lt&&256==n&&e[7].length<=t[8]||384==r&&t[7].length<=t[8]&&8==n;if(!o&&!a)return e;1&r&&(e[2]=t[2],i|=1&n?0:4);var s=t[3];if(s){var l=e[3];e[3]=l?Ve(l,s,t[4]):s,e[4]=l?At(e[3],Ft):t[4]}(s=t[5])&&(l=e[5],e[5]=l?Ye(l,s,t[6]):s,e[6]=l?At(e[5],Ft):t[6]),(s=t[7])&&(e[7]=s),r&Lt&&(e[8]=null==e[8]?t[8]:Tt(e[8],t[8])),null==e[9]&&(e[9]=t[9]),e[0]=t[0],e[1]=i}(f,h),e=f[0],t=f[1],n=f[2],r=f[3],i=f[4],!(s=f[9]=void 0===f[9]?l?0:e.length:Dt(f[9]-u,0))&&24&t&&(t&=-25),t&&1!=t)p=8==t||16==t?function(e,t,n){var r=ze(e);return function i(){for(var o=arguments.length,a=Array(o),s=o,l=Pt(i);s--;)a[s]=arguments[s];var u=o<3&&a[0]!==l&&a[o-1]!==l?[]:At(a,l);return(o-=u.length)<n?xt(e,t,$t,i.placeholder,void 0,a,u,void 0,void 0,n-o):Ke(this&&this!==N&&this instanceof i?r:e,this,a)}}(e,t,s):32!=t&&33!=t||i.length?$t.apply(void 0,f):function(e,t,n,r){var i=1&t,o=ze(e);return function t(){for(var a=-1,s=arguments.length,l=-1,u=r.length,c=Array(u+s),d=this&&this!==N&&this instanceof t?o:e;++l<u;)c[l]=r[l];for(;s--;)c[l++]=arguments[++a];return Ke(d,i?n:this,c)}}(e,t,n,r);else var p=function(e,t,n){var r=1&t,i=ze(e);return function t(){return(this&&this!==N&&this instanceof t?i:e).apply(r?n:this,arguments)}}(e,t,n);return _t((h?Ge:ht)(p,f),e,t)}function Nt(e,t,n){return t=n?void 0:t,Ht(e,128,void 0,void 0,void 0,void 0,t=e&&null==t?e.length:t)}function Gt(e,t,n){"__proto__"==t&&vt?vt(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}function Wt(e,t){return e===t||e!=e&&t!=t}var qt=Object.prototype.hasOwnProperty;function zt(e,t,n){var r=e[t];qt.call(e,t)&&Wt(r,n)&&(void 0!==n||t in e)||Gt(e,t,n)}function Kt(e,t,n,r){var i=!n;n||(n={});for(var o=-1,a=t.length;++o<a;){var s=t[o],l=r?r(n[s],e[s],s,n,e):void 0;void 0===l&&(l=e[s]),i?Gt(n,s,l):zt(n,s,l)}return n}var Ut=Math.max;function Vt(e,t,n){return t=Ut(void 0===t?e.length-1:t,0),function(){for(var r=arguments,i=-1,o=Ut(r.length-t,0),a=Array(o);++i<o;)a[i]=r[t+i];i=-1;for(var s=Array(t+1);++i<t;)s[i]=r[i];return s[t]=n(a),Ke(e,this,s)}}function Jt(e,t){return bt(Vt(e,t,we),e+"")}var Yt=9007199254740991;function Xt(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=Yt}function Zt(e){return null!=e&&Xt(e.length)&&!_e(e)}function Qt(e,t,n){if(!he(n))return!1;var r=typeof t;return!!("number"==r?Zt(n)&&It(t,n.length):"string"==r&&t in n)&&Wt(n[t],e)}function en(e){return Jt(function(t,n){var r=-1,i=n.length,o=i>1?n[i-1]:void 0,a=i>2?n[2]:void 0;for(o=e.length>3&&"function"==typeof o?(i--,o):void 0,a&&Qt(n[0],n[1],a)&&(o=i<3?void 0:o,i=1),t=Object(t);++r<i;){var s=n[r];s&&e(t,s,r,o)}return t})}var tn=Object.prototype;function nn(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||tn)}function rn(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}function on(e){return Z(e)&&"[object Arguments]"==X(e)}var an=Object.prototype,sn=an.hasOwnProperty,ln=an.propertyIsEnumerable,un=on(function(){return arguments}())?on:function(e){return Z(e)&&sn.call(e,"callee")&&!ln.call(e,"callee")};function cn(){return!1}var dn="object"==typeof e&&e&&!e.nodeType&&e,hn=dn&&"object"==typeof module&&module&&!module.nodeType&&module,fn=hn&&hn.exports===dn?N.Buffer:void 0,pn=(fn?fn.isBuffer:void 0)||cn,gn={};function mn(e){return function(t){return e(t)}}gn["[object Float32Array]"]=gn["[object Float64Array]"]=gn["[object Int8Array]"]=gn["[object Int16Array]"]=gn["[object Int32Array]"]=gn["[object Uint8Array]"]=gn["[object Uint8ClampedArray]"]=gn["[object Uint16Array]"]=gn["[object Uint32Array]"]=!0,gn["[object Arguments]"]=gn["[object Array]"]=gn["[object ArrayBuffer]"]=gn["[object Boolean]"]=gn["[object DataView]"]=gn["[object Date]"]=gn["[object Error]"]=gn["[object Function]"]=gn["[object Map]"]=gn["[object Number]"]=gn["[object Object]"]=gn["[object RegExp]"]=gn["[object Set]"]=gn["[object String]"]=gn["[object WeakMap]"]=!1;var vn="object"==typeof e&&e&&!e.nodeType&&e,yn=vn&&"object"==typeof module&&module&&!module.nodeType&&module,bn=yn&&yn.exports===vn&&D.process,Rn=function(){try{var e=yn&&yn.require&&yn.require("util").types;return e||bn&&bn.binding&&bn.binding("util")}catch(e){}}(),wn=Rn&&Rn.isTypedArray,Sn=wn?mn(wn):function(e){return Z(e)&&Xt(e.length)&&!!gn[X(e)]},Bn=Object.prototype.hasOwnProperty;function kn(e,t){var n=ne(e),r=!n&&un(e),i=!n&&!r&&pn(e),o=!n&&!r&&!i&&Sn(e),a=n||r||i||o,s=a?rn(e.length,String):[],l=s.length;for(var u in e)!t&&!Bn.call(e,u)||a&&("length"==u||i&&("offset"==u||"parent"==u)||o&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||It(u,l))||s.push(u);return s}function Cn(e,t){return function(n){return e(t(n))}}var _n=Cn(Object.keys,Object),xn=Object.prototype.hasOwnProperty;function Pn(e){if(!nn(e))return _n(e);var t=[];for(var n in Object(e))xn.call(e,n)&&"constructor"!=n&&t.push(n);return t}function En(e){return Zt(e)?kn(e):Pn(e)}var Mn=Object.prototype.hasOwnProperty,In=en(function(e,t){if(nn(t)||Zt(t))Kt(t,En(t),e);else for(var n in t)Mn.call(t,n)&&zt(e,n,t[n])});var jn=Object.prototype.hasOwnProperty;function On(e){if(!he(e))return function(e){var t=[];if(null!=e)for(var n in Object(e))t.push(n);return t}(e);var t=nn(e),n=[];for(var r in e)("constructor"!=r||!t&&jn.call(e,r))&&n.push(r);return n}function An(e){return Zt(e)?kn(e,!0):On(e)}var $n=en(function(e,t){Kt(t,An(t),e)}),Fn=en(function(e,t,n,r){Kt(t,An(t),e,r)}),Ln=en(function(e,t,n,r){Kt(t,En(t),e,r)}),Tn=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Dn=/^\w*$/;function Hn(e,t){if(ne(e))return!1;var n=typeof e;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!Q(e))||(Dn.test(e)||!Tn.test(e)||null!=t&&e in Object(t))}var Nn=De(Object,"create");var Gn=Object.prototype.hasOwnProperty;var Wn=Object.prototype.hasOwnProperty;function qn(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function zn(e,t){for(var n=e.length;n--;)if(Wt(e[n][0],t))return n;return-1}qn.prototype.clear=function(){this.__data__=Nn?Nn(null):{},this.size=0},qn.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},qn.prototype.get=function(e){var t=this.__data__;if(Nn){var n=t[e];return"__lodash_hash_undefined__"===n?void 0:n}return Gn.call(t,e)?t[e]:void 0},qn.prototype.has=function(e){var t=this.__data__;return Nn?void 0!==t[e]:Wn.call(t,e)},qn.prototype.set=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=Nn&&void 0===t?"__lodash_hash_undefined__":t,this};var Kn=Array.prototype.splice;function Un(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}Un.prototype.clear=function(){this.__data__=[],this.size=0},Un.prototype.delete=function(e){var t=this.__data__,n=zn(t,e);return!(n<0)&&(n==t.length-1?t.pop():Kn.call(t,n,1),--this.size,!0)},Un.prototype.get=function(e){var t=this.__data__,n=zn(t,e);return n<0?void 0:t[n][1]},Un.prototype.has=function(e){return zn(this.__data__,e)>-1},Un.prototype.set=function(e,t){var n=this.__data__,r=zn(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this};var Vn=De(N,"Map");function Jn(e,t){var n,r,i=e.__data__;return("string"==(r=typeof(n=t))||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==n:null===n)?i["string"==typeof t?"string":"hash"]:i.map}function Yn(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}Yn.prototype.clear=function(){this.size=0,this.__data__={hash:new qn,map:new(Vn||Un),string:new qn}},Yn.prototype.delete=function(e){var t=Jn(this,e).delete(e);return this.size-=t?1:0,t},Yn.prototype.get=function(e){return Jn(this,e).get(e)},Yn.prototype.has=function(e){return Jn(this,e).has(e)},Yn.prototype.set=function(e,t){var n=Jn(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this};function Xn(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError("Expected a function");var n=function(){var r=arguments,i=t?t.apply(this,r):r[0],o=n.cache;if(o.has(i))return o.get(i);var a=e.apply(this,r);return n.cache=o.set(i,a)||o,a};return n.cache=new(Xn.Cache||Yn),n}Xn.Cache=Yn;var Zn=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Qn=/\\(\\)?/g,er=function(e){var t=Xn(e,function(e){return 500===n.size&&n.clear(),e}),n=t.cache;return t}(function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(Zn,function(e,n,r,i){t.push(r?i.replace(Qn,"$1"):n||e)}),t});function tr(e){return null==e?"":oe(e)}function nr(e,t){return ne(e)?e:Hn(e,t)?[e]:er(tr(e))}function rr(e){if("string"==typeof e||Q(e))return e;var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}function ir(e,t){for(var n=0,r=(t=nr(t,e)).length;null!=e&&n<r;)e=e[rr(t[n++])];return n&&n==r?e:void 0}function or(e,t,n){var r=null==e?void 0:ir(e,t);return void 0===r?n:r}function ar(e,t){for(var n=-1,r=t.length,i=Array(r),o=null==e;++n<r;)i[n]=o?void 0:or(e,t[n]);return i}function sr(e,t){for(var n=-1,r=t.length,i=e.length;++n<r;)e[i+n]=t[n];return e}var lr=G?G.isConcatSpreadable:void 0;function ur(e){return ne(e)||un(e)||!!(lr&&e&&e[lr])}function cr(e,t,n,r,i){var o=-1,a=e.length;for(n||(n=ur),i||(i=[]);++o<a;){var s=e[o];t>0&&n(s)?t>1?cr(s,t-1,n,r,i):sr(i,s):r||(i[i.length]=s)}return i}function dr(e){return(null==e?0:e.length)?cr(e,1):[]}function hr(e){return bt(Vt(e,void 0,dr),e+"")}var fr=hr(ar),pr=Cn(Object.getPrototypeOf,Object),gr=Function.prototype,mr=Object.prototype,vr=gr.toString,yr=mr.hasOwnProperty,br=vr.call(Object);function Rr(e){if(!Z(e)||"[object Object]"!=X(e))return!1;var t=pr(e);if(null===t)return!0;var n=yr.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&vr.call(n)==br}function wr(e){if(!Z(e))return!1;var t=X(e);return"[object Error]"==t||"[object DOMException]"==t||"string"==typeof e.message&&"string"==typeof e.name&&!Rr(e)}var Sr=Jt(function(e,t){try{return Ke(e,void 0,t)}catch(e){return wr(e)?e:new Error(e)}});function Br(e,t){var n;if("function"!=typeof t)throw new TypeError("Expected a function");return e=Re(e),function(){return--e>0&&(n=t.apply(this,arguments)),e<=1&&(t=void 0),n}}var kr=Jt(function(e,t,n){var r=1;if(n.length){var i=At(n,Pt(kr));r|=32}return Ht(e,r,t,n,i)});kr.placeholder={};var Cr=hr(function(e,t){return Rt(t,function(t){t=rr(t),Gt(e,t,kr(e[t],e))}),e}),_r=Jt(function(e,t,n){var r=3;if(n.length){var i=At(n,Pt(_r));r|=32}return Ht(t,r,e,n,i)});function xr(e,t,n){var r=-1,i=e.length;t<0&&(t=-t>i?0:i+t),(n=n>i?i:n)<0&&(n+=i),i=t>n?0:n-t>>>0,t>>>=0;for(var o=Array(i);++r<i;)o[r]=e[r+t];return o}function Pr(e,t,n){var r=e.length;return n=void 0===n?r:n,!t&&n>=r?e:xr(e,t,n)}_r.placeholder={};var Er=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");function Mr(e){return Er.test(e)}var Ir="\\ud800-\\udfff",jr="["+Ir+"]",Or="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",Ar="\\ud83c[\\udffb-\\udfff]",$r="[^"+Ir+"]",Fr="(?:\\ud83c[\\udde6-\\uddff]){2}",Lr="[\\ud800-\\udbff][\\udc00-\\udfff]",Tr="(?:"+Or+"|"+Ar+")"+"?",Dr="[\\ufe0e\\ufe0f]?",Hr=Dr+Tr+("(?:\\u200d(?:"+[$r,Fr,Lr].join("|")+")"+Dr+Tr+")*"),Nr="(?:"+[$r+Or+"?",Or,Fr,Lr,jr].join("|")+")",Gr=RegExp(Ar+"(?="+Ar+")|"+Nr+Hr,"g");function Wr(e){return Mr(e)?function(e){return e.match(Gr)||[]}(e):function(e){return e.split("")}(e)}function qr(e){return function(t){var n=Mr(t=tr(t))?Wr(t):void 0,r=n?n[0]:t.charAt(0),i=n?Pr(n,1).join(""):t.slice(1);return r[e]()+i}}var zr=qr("toUpperCase");function Kr(e){return zr(tr(e).toLowerCase())}function Ur(e,t,n,r){var i=-1,o=null==e?0:e.length;for(r&&o&&(n=e[++i]);++i<o;)n=t(n,e[i],i,e);return n}function Vr(e){return function(t){return null==e?void 0:e[t]}}var Jr=Vr({"À":"A","Á":"A","Â":"A","Ã":"A","Ä":"A","Å":"A","à":"a","á":"a","â":"a","ã":"a","ä":"a","å":"a","Ç":"C","ç":"c","Ð":"D","ð":"d","È":"E","É":"E","Ê":"E","Ë":"E","è":"e","é":"e","ê":"e","ë":"e","Ì":"I","Í":"I","Î":"I","Ï":"I","ì":"i","í":"i","î":"i","ï":"i","Ñ":"N","ñ":"n","Ò":"O","Ó":"O","Ô":"O","Õ":"O","Ö":"O","Ø":"O","ò":"o","ó":"o","ô":"o","õ":"o","ö":"o","ø":"o","Ù":"U","Ú":"U","Û":"U","Ü":"U","ù":"u","ú":"u","û":"u","ü":"u","Ý":"Y","ý":"y","ÿ":"y","Æ":"Ae","æ":"ae","Þ":"Th","þ":"th","ß":"ss","Ā":"A","Ă":"A","Ą":"A","ā":"a","ă":"a","ą":"a","Ć":"C","Ĉ":"C","Ċ":"C","Č":"C","ć":"c","ĉ":"c","ċ":"c","č":"c","Ď":"D","Đ":"D","ď":"d","đ":"d","Ē":"E","Ĕ":"E","Ė":"E","Ę":"E","Ě":"E","ē":"e","ĕ":"e","ė":"e","ę":"e","ě":"e","Ĝ":"G","Ğ":"G","Ġ":"G","Ģ":"G","ĝ":"g","ğ":"g","ġ":"g","ģ":"g","Ĥ":"H","Ħ":"H","ĥ":"h","ħ":"h","Ĩ":"I","Ī":"I","Ĭ":"I","Į":"I","İ":"I","ĩ":"i","ī":"i","ĭ":"i","į":"i","ı":"i","Ĵ":"J","ĵ":"j","Ķ":"K","ķ":"k","ĸ":"k","Ĺ":"L","Ļ":"L","Ľ":"L","Ŀ":"L","Ł":"L","ĺ":"l","ļ":"l","ľ":"l","ŀ":"l","ł":"l","Ń":"N","Ņ":"N","Ň":"N","Ŋ":"N","ń":"n","ņ":"n","ň":"n","ŋ":"n","Ō":"O","Ŏ":"O","Ő":"O","ō":"o","ŏ":"o","ő":"o","Ŕ":"R","Ŗ":"R","Ř":"R","ŕ":"r","ŗ":"r","ř":"r","Ś":"S","Ŝ":"S","Ş":"S","Š":"S","ś":"s","ŝ":"s","ş":"s","š":"s","Ţ":"T","Ť":"T","Ŧ":"T","ţ":"t","ť":"t","ŧ":"t","Ũ":"U","Ū":"U","Ŭ":"U","Ů":"U","Ű":"U","Ų":"U","ũ":"u","ū":"u","ŭ":"u","ů":"u","ű":"u","ų":"u","Ŵ":"W","ŵ":"w","Ŷ":"Y","ŷ":"y","Ÿ":"Y","Ź":"Z","Ż":"Z","Ž":"Z","ź":"z","ż":"z","ž":"z","Ĳ":"IJ","ĳ":"ij","Œ":"Oe","œ":"oe","ŉ":"'n","ſ":"s"}),Yr=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Xr=RegExp("[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]","g");function Zr(e){return(e=tr(e))&&e.replace(Yr,Jr).replace(Xr,"")}var Qr=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g;var ei=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/;var ti="\\ud800-\\udfff",ni="\\u2700-\\u27bf",ri="a-z\\xdf-\\xf6\\xf8-\\xff",ii="A-Z\\xc0-\\xd6\\xd8-\\xde",oi="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",ai="["+oi+"]",si="\\d+",li="["+ni+"]",ui="["+ri+"]",ci="[^"+ti+oi+si+ni+ri+ii+"]",di="(?:\\ud83c[\\udde6-\\uddff]){2}",hi="[\\ud800-\\udbff][\\udc00-\\udfff]",fi="["+ii+"]",pi="(?:"+ui+"|"+ci+")",gi="(?:"+fi+"|"+ci+")",mi="(?:['’](?:d|ll|m|re|s|t|ve))?",vi="(?:['’](?:D|LL|M|RE|S|T|VE))?",yi="(?:[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]|\\ud83c[\\udffb-\\udfff])?",bi="[\\ufe0e\\ufe0f]?",Ri=bi+yi+("(?:\\u200d(?:"+["[^"+ti+"]",di,hi].join("|")+")"+bi+yi+")*"),wi="(?:"+[li,di,hi].join("|")+")"+Ri,Si=RegExp([fi+"?"+ui+"+"+mi+"(?="+[ai,fi,"$"].join("|")+")",gi+"+"+vi+"(?="+[ai,fi+pi,"$"].join("|")+")",fi+"?"+pi+"+"+mi,fi+"+"+vi,"\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",si,wi].join("|"),"g");function Bi(e,t,n){return e=tr(e),void 0===(t=n?void 0:t)?function(e){return ei.test(e)}(e)?function(e){return e.match(Si)||[]}(e):function(e){return e.match(Qr)||[]}(e):e.match(t)||[]}var ki=RegExp("['’]","g");function Ci(e){return function(t){return Ur(Bi(Zr(t).replace(ki,"")),e,"")}}var _i=Ci(function(e,t,n){return t=t.toLowerCase(),e+(n?Kr(t):t)});var xi=N.isFinite,Pi=Math.min;function Ei(e){var t=Math[e];return function(e,n){if(e=ve(e),(n=null==n?0:Pi(Re(n),292))&&xi(e)){var r=(tr(e)+"e").split("e");return+((r=(tr(t(r[0]+"e"+(+r[1]+n)))+"e").split("e"))[0]+"e"+(+r[1]-n))}return t(e)}}var Mi=Ei("ceil");function Ii(e){var t=lt(e);return t.__chain__=!0,t}var ji=Math.ceil,Oi=Math.max;function Ai(e,t,n){return e==e&&(void 0!==n&&(e=e<=n?e:n),void 0!==t&&(e=e>=t?e:t)),e}function $i(e,t,n){return void 0===n&&(n=t,t=void 0),void 0!==n&&(n=(n=ve(n))==n?n:0),void 0!==t&&(t=(t=ve(t))==t?t:0),Ai(ve(e),t,n)}function Fi(e){var t=this.__data__=new Un(e);this.size=t.size}function Li(e,t){return e&&Kt(t,En(t),e)}Fi.prototype.clear=function(){this.__data__=new Un,this.size=0},Fi.prototype.delete=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n},Fi.prototype.get=function(e){return this.__data__.get(e)},Fi.prototype.has=function(e){return this.__data__.has(e)},Fi.prototype.set=function(e,t){var n=this.__data__;if(n instanceof Un){var r=n.__data__;if(!Vn||r.length<199)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new Yn(r)}return n.set(e,t),this.size=n.size,this};var Ti="object"==typeof e&&e&&!e.nodeType&&e,Di=Ti&&"object"==typeof module&&module&&!module.nodeType&&module,Hi=Di&&Di.exports===Ti?N.Buffer:void 0,Ni=Hi?Hi.allocUnsafe:void 0;function Gi(e,t){if(t)return e.slice();var n=e.length,r=Ni?Ni(n):new e.constructor(n);return e.copy(r),r}function Wi(e,t){for(var n=-1,r=null==e?0:e.length,i=0,o=[];++n<r;){var a=e[n];t(a,n,e)&&(o[i++]=a)}return o}function qi(){return[]}var zi=Object.prototype.propertyIsEnumerable,Ki=Object.getOwnPropertySymbols,Ui=Ki?function(e){return null==e?[]:(e=Object(e),Wi(Ki(e),function(t){return zi.call(e,t)}))}:qi;var Vi=Object.getOwnPropertySymbols?function(e){for(var t=[];e;)sr(t,Ui(e)),e=pr(e);return t}:qi;function Ji(e,t,n){var r=t(e);return ne(e)?r:sr(r,n(e))}function Yi(e){return Ji(e,En,Ui)}function Xi(e){return Ji(e,An,Vi)}var Zi=De(N,"DataView"),Qi=De(N,"Promise"),eo=De(N,"Set"),to="[object Map]",no="[object Promise]",ro="[object Set]",io="[object WeakMap]",oo="[object DataView]",ao=Ie(Zi),so=Ie(Vn),lo=Ie(Qi),uo=Ie(eo),co=Ie(He),ho=X;(Zi&&ho(new Zi(new ArrayBuffer(1)))!=oo||Vn&&ho(new Vn)!=to||Qi&&ho(Qi.resolve())!=no||eo&&ho(new eo)!=ro||He&&ho(new He)!=io)&&(ho=function(e){var t=X(e),n="[object Object]"==t?e.constructor:void 0,r=n?Ie(n):"";if(r)switch(r){case ao:return oo;case so:return to;case lo:return no;case uo:return ro;case co:return io}return t});var fo=ho,po=Object.prototype.hasOwnProperty;var go=N.Uint8Array;function mo(e){var t=new e.constructor(e.byteLength);return new go(t).set(new go(e)),t}var vo=/\w*$/;var yo=G?G.prototype:void 0,bo=yo?yo.valueOf:void 0;function Ro(e,t){var n=t?mo(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}var wo="[object Boolean]",So="[object Date]",Bo="[object Map]",ko="[object Number]",Co="[object RegExp]",_o="[object Set]",xo="[object String]",Po="[object Symbol]",Eo="[object ArrayBuffer]",Mo="[object DataView]",Io="[object Float32Array]",jo="[object Float64Array]",Oo="[object Int8Array]",Ao="[object Int16Array]",$o="[object Int32Array]",Fo="[object Uint8Array]",Lo="[object Uint8ClampedArray]",To="[object Uint16Array]",Do="[object Uint32Array]";function Ho(e,t,n){var r,i=e.constructor;switch(t){case Eo:return mo(e);case wo:case So:return new i(+e);case Mo:return function(e,t){var n=t?mo(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)}(e,n);case Io:case jo:case Oo:case Ao:case $o:case Fo:case Lo:case To:case Do:return Ro(e,n);case Bo:return new i;case ko:case xo:return new i(e);case Co:return function(e){var t=new e.constructor(e.source,vo.exec(e));return t.lastIndex=e.lastIndex,t}(e);case _o:return new i;case Po:return r=e,bo?Object(bo.call(r)):{}}}function No(e){return"function"!=typeof e.constructor||nn(e)?{}:qe(pr(e))}var Go=Rn&&Rn.isMap,Wo=Go?mn(Go):function(e){return Z(e)&&"[object Map]"==fo(e)};var qo=Rn&&Rn.isSet,zo=qo?mn(qo):function(e){return Z(e)&&"[object Set]"==fo(e)},Ko=1,Uo=2,Vo=4,Jo="[object Arguments]",Yo="[object Function]",Xo="[object GeneratorFunction]",Zo="[object Object]",Qo={};function ea(e,t,n,r,i,o){var a,s=t&Ko,l=t&Uo,u=t&Vo;if(n&&(a=i?n(e,r,i,o):n(e)),void 0!==a)return a;if(!he(e))return e;var c=ne(e);if(c){if(a=function(e){var t=e.length,n=new e.constructor(t);return t&&"string"==typeof e[0]&&po.call(e,"index")&&(n.index=e.index,n.input=e.input),n}(e),!s)return ot(e,a)}else{var d=fo(e),h=d==Yo||d==Xo;if(pn(e))return Gi(e,s);if(d==Zo||d==Jo||h&&!i){if(a=l||h?{}:No(e),!s)return l?function(e,t){return Kt(e,Vi(e),t)}(e,function(e,t){return e&&Kt(t,An(t),e)}(a,e)):function(e,t){return Kt(e,Ui(e),t)}(e,Li(a,e))}else{if(!Qo[d])return i?e:{};a=Ho(e,d,s)}}o||(o=new Fi);var f=o.get(e);if(f)return f;o.set(e,a),zo(e)?e.forEach(function(r){a.add(ea(r,t,n,r,e,o))}):Wo(e)&&e.forEach(function(r,i){a.set(i,ea(r,t,n,i,e,o))});var p=c?void 0:(u?l?Xi:Yi:l?An:En)(e);return Rt(p||e,function(r,i){p&&(r=e[i=r]),zt(a,i,ea(r,t,n,i,e,o))}),a}Qo[Jo]=Qo["[object Array]"]=Qo["[object ArrayBuffer]"]=Qo["[object DataView]"]=Qo["[object Boolean]"]=Qo["[object Date]"]=Qo["[object Float32Array]"]=Qo["[object Float64Array]"]=Qo["[object Int8Array]"]=Qo["[object Int16Array]"]=Qo["[object Int32Array]"]=Qo["[object Map]"]=Qo["[object Number]"]=Qo[Zo]=Qo["[object RegExp]"]=Qo["[object Set]"]=Qo["[object String]"]=Qo["[object Symbol]"]=Qo["[object Uint8Array]"]=Qo["[object Uint8ClampedArray]"]=Qo["[object Uint16Array]"]=Qo["[object Uint32Array]"]=!0,Qo["[object Error]"]=Qo[Yo]=Qo["[object WeakMap]"]=!1;var ta=4;function na(e){return ea(e,ta)}var ra=1,ia=4;function oa(e){return ea(e,ra|ia)}function aa(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new Yn;++t<n;)this.add(e[t])}function sa(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1}function la(e,t){return e.has(t)}aa.prototype.add=aa.prototype.push=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this},aa.prototype.has=function(e){return this.__data__.has(e)};function ua(e,t,n,r,i,o){var a=1&n,s=e.length,l=t.length;if(s!=l&&!(a&&l>s))return!1;var u=o.get(e),c=o.get(t);if(u&&c)return u==t&&c==e;var d=-1,h=!0,f=2&n?new aa:void 0;for(o.set(e,t),o.set(t,e);++d<s;){var p=e[d],g=t[d];if(r)var m=a?r(g,p,d,t,e,o):r(p,g,d,e,t,o);if(void 0!==m){if(m)continue;h=!1;break}if(f){if(!sa(t,function(e,t){if(!la(f,t)&&(p===e||i(p,e,n,r,o)))return f.push(t)})){h=!1;break}}else if(p!==g&&!i(p,g,n,r,o)){h=!1;break}}return o.delete(e),o.delete(t),h}function ca(e){var t=-1,n=Array(e.size);return e.forEach(function(e,r){n[++t]=[r,e]}),n}function da(e){var t=-1,n=Array(e.size);return e.forEach(function(e){n[++t]=e}),n}var ha=G?G.prototype:void 0,fa=ha?ha.valueOf:void 0;var pa=Object.prototype.hasOwnProperty;var ga="[object Arguments]",ma="[object Array]",va="[object Object]",ya=Object.prototype.hasOwnProperty;function ba(e,t,n,r,i,o){var a=ne(e),s=ne(t),l=a?ma:fo(e),u=s?ma:fo(t),c=(l=l==ga?va:l)==va,d=(u=u==ga?va:u)==va,h=l==u;if(h&&pn(e)){if(!pn(t))return!1;a=!0,c=!1}if(h&&!c)return o||(o=new Fi),a||Sn(e)?ua(e,t,n,r,i,o):function(e,t,n,r,i,o,a){switch(n){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":return!(e.byteLength!=t.byteLength||!o(new go(e),new go(t)));case"[object Boolean]":case"[object Date]":case"[object Number]":return Wt(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case"[object Map]":var s=ca;case"[object Set]":var l=1&r;if(s||(s=da),e.size!=t.size&&!l)return!1;var u=a.get(e);if(u)return u==t;r|=2,a.set(e,t);var c=ua(s(e),s(t),r,i,o,a);return a.delete(e),c;case"[object Symbol]":if(fa)return fa.call(e)==fa.call(t)}return!1}(e,t,l,n,r,i,o);if(!(1&n)){var f=c&&ya.call(e,"__wrapped__"),p=d&&ya.call(t,"__wrapped__");if(f||p){var g=f?e.value():e,m=p?t.value():t;return o||(o=new Fi),i(g,m,n,r,o)}}return!!h&&(o||(o=new Fi),function(e,t,n,r,i,o){var a=1&n,s=Yi(e),l=s.length;if(l!=Yi(t).length&&!a)return!1;for(var u=l;u--;){var c=s[u];if(!(a?c in t:pa.call(t,c)))return!1}var d=o.get(e),h=o.get(t);if(d&&h)return d==t&&h==e;var f=!0;o.set(e,t),o.set(t,e);for(var p=a;++u<l;){var g=e[c=s[u]],m=t[c];if(r)var v=a?r(m,g,c,t,e,o):r(g,m,c,e,t,o);if(!(void 0===v?g===m||i(g,m,n,r,o):v)){f=!1;break}p||(p="constructor"==c)}if(f&&!p){var y=e.constructor,b=t.constructor;y==b||!("constructor"in e)||!("constructor"in t)||"function"==typeof y&&y instanceof y&&"function"==typeof b&&b instanceof b||(f=!1)}return o.delete(e),o.delete(t),f}(e,t,n,r,i,o))}function Ra(e,t,n,r,i){return e===t||(null==e||null==t||!Z(e)&&!Z(t)?e!=e&&t!=t:ba(e,t,n,r,Ra,i))}function wa(e,t,n,r){var i=n.length,o=i,a=!r;if(null==e)return!o;for(e=Object(e);i--;){var s=n[i];if(a&&s[2]?s[1]!==e[s[0]]:!(s[0]in e))return!1}for(;++i<o;){var l=(s=n[i])[0],u=e[l],c=s[1];if(a&&s[2]){if(void 0===u&&!(l in e))return!1}else{var d=new Fi;if(r)var h=r(u,c,l,e,t,d);if(!(void 0===h?Ra(c,u,3,r,d):h))return!1}}return!0}function Sa(e){return e==e&&!he(e)}function Ba(e){for(var t=En(e),n=t.length;n--;){var r=t[n],i=e[r];t[n]=[r,i,Sa(i)]}return t}function ka(e,t){return function(n){return null!=n&&(n[e]===t&&(void 0!==t||e in Object(n)))}}function Ca(e){var t=Ba(e);return 1==t.length&&t[0][2]?ka(t[0][0],t[0][1]):function(n){return n===e||wa(n,e,t)}}function _a(e,t){return null!=e&&t in Object(e)}function xa(e,t,n){for(var r=-1,i=(t=nr(t,e)).length,o=!1;++r<i;){var a=rr(t[r]);if(!(o=null!=e&&n(e,a)))break;e=e[a]}return o||++r!=i?o:!!(i=null==e?0:e.length)&&Xt(i)&&It(a,i)&&(ne(e)||un(e))}function Pa(e,t){return null!=e&&xa(e,t,_a)}function Ea(e,t){return Hn(e)&&Sa(t)?ka(rr(e),t):function(n){var r=or(n,e);return void 0===r&&r===t?Pa(n,e):Ra(t,r,3)}}function Ma(e){return function(t){return null==t?void 0:t[e]}}function Ia(e){return Hn(e)?Ma(rr(e)):function(e){return function(t){return ir(t,e)}}(e)}function ja(e){return"function"==typeof e?e:null==e?we:"object"==typeof e?ne(e)?Ea(e[0],e[1]):Ca(e):Ia(e)}function Oa(e,t,n){var r=n.length;if(null==e)return!r;for(e=Object(e);r--;){var i=n[r],o=t[i],a=e[i];if(void 0===a&&!(i in e)||!o(a))return!1}return!0}function Aa(e,t,n,r){for(var i=-1,o=null==e?0:e.length;++i<o;){var a=e[i];t(r,a,n(a),e)}return r}function $a(e){return function(t,n,r){for(var i=-1,o=Object(t),a=r(t),s=a.length;s--;){var l=a[e?s:++i];if(!1===n(o[l],l,o))break}return t}}var Fa=$a();function La(e,t){return e&&Fa(e,t,En)}function Ta(e,t){return function(n,r){if(null==n)return n;if(!Zt(n))return e(n,r);for(var i=n.length,o=t?i:-1,a=Object(n);(t?o--:++o<i)&&!1!==r(a[o],o,a););return n}}var Da=Ta(La);function Ha(e,t,n,r){return Da(e,function(e,i,o){t(r,e,n(e),o)}),r}function Na(e,t){return function(n,r){var i=ne(n)?Aa:Ha,o=t?t():{};return i(n,e,ja(r),o)}}var Ga=Object.prototype.hasOwnProperty,Wa=Na(function(e,t,n){Ga.call(e,n)?++e[n]:Gt(e,n,1)});function qa(e,t,n){var r=Ht(e,8,void 0,void 0,void 0,void 0,void 0,t=n?void 0:t);return r.placeholder=qa.placeholder,r}qa.placeholder={};function za(e,t,n){var r=Ht(e,16,void 0,void 0,void 0,void 0,void 0,t=n?void 0:t);return r.placeholder=za.placeholder,r}za.placeholder={};var Ka=function(){return N.Date.now()},Ua=Math.max,Va=Math.min;function Ja(e,t,n){var r,i,o,a,s,l,u=0,c=!1,d=!1,h=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function f(t){var n=r,o=i;return r=i=void 0,u=t,a=e.apply(o,n)}function p(e){var n=e-l;return void 0===l||n>=t||n<0||d&&e-u>=o}function g(){var e=Ka();if(p(e))return m(e);s=setTimeout(g,function(e){var n=t-(e-l);return d?Va(n,o-(e-u)):n}(e))}function m(e){return s=void 0,h&&r?f(e):(r=i=void 0,a)}function v(){var e=Ka(),n=p(e);if(r=arguments,i=this,l=e,n){if(void 0===s)return function(e){return u=e,s=setTimeout(g,t),c?f(e):a}(l);if(d)return clearTimeout(s),s=setTimeout(g,t),f(l)}return void 0===s&&(s=setTimeout(g,t)),a}return t=ve(t)||0,he(n)&&(c=!!n.leading,o=(d="maxWait"in n)?Ua(ve(n.maxWait)||0,t):o,h="trailing"in n?!!n.trailing:h),v.cancel=function(){void 0!==s&&clearTimeout(s),u=0,r=l=i=s=void 0},v.flush=function(){return void 0===s?a:m(Ka())},v}var Ya=Object.prototype,Xa=Ya.hasOwnProperty,Za=Jt(function(e,t){e=Object(e);var n=-1,r=t.length,i=r>2?t[2]:void 0;for(i&&Qt(t[0],t[1],i)&&(r=1);++n<r;)for(var o=t[n],a=An(o),s=-1,l=a.length;++s<l;){var u=a[s],c=e[u];(void 0===c||Wt(c,Ya[u])&&!Xa.call(e,u))&&(e[u]=o[u])}return e});function Qa(e,t,n){(void 0!==n&&!Wt(e[t],n)||void 0===n&&!(t in e))&&Gt(e,t,n)}function es(e){return Z(e)&&Zt(e)}function ts(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]}function ns(e){return Kt(e,An(e))}function rs(e,t,n,r,i){e!==t&&Fa(t,function(o,a){if(i||(i=new Fi),he(o))!function(e,t,n,r,i,o,a){var s=ts(e,n),l=ts(t,n),u=a.get(l);if(u)Qa(e,n,u);else{var c=o?o(s,l,n+"",e,t,a):void 0,d=void 0===c;if(d){var h=ne(l),f=!h&&pn(l),p=!h&&!f&&Sn(l);c=l,h||f||p?ne(s)?c=s:es(s)?c=ot(s):f?(d=!1,c=Gi(l,!0)):p?(d=!1,c=Ro(l,!0)):c=[]:Rr(l)||un(l)?(c=s,un(s)?c=ns(s):he(s)&&!_e(s)||(c=No(l))):d=!1}d&&(a.set(l,c),i(c,l,r,o,a),a.delete(l)),Qa(e,n,c)}}(e,t,a,n,rs,r,i);else{var s=r?r(ts(e,a),o,a+"",e,t,i):void 0;void 0===s&&(s=o),Qa(e,a,s)}},An)}function is(e,t,n,r,i,o){return he(e)&&he(t)&&(o.set(t,e),rs(e,t,void 0,is,o),o.delete(t)),e}var os=en(function(e,t,n,r){rs(e,t,n,r)}),as=Jt(function(e){return e.push(void 0,is),Ke(os,void 0,e)});function ss(e,t,n){if("function"!=typeof e)throw new TypeError("Expected a function");return setTimeout(function(){e.apply(void 0,n)},t)}var ls=Jt(function(e,t){return ss(e,1,t)}),us=Jt(function(e,t,n){return ss(e,ve(t)||0,n)});function cs(e,t,n){for(var r=-1,i=null==e?0:e.length;++r<i;)if(n(t,e[r]))return!0;return!1}function ds(e,t,n,r){var i=-1,o=kt,a=!0,s=e.length,l=[],u=t.length;if(!s)return l;n&&(t=te(t,mn(n))),r?(o=cs,a=!1):t.length>=200&&(o=la,a=!1,t=new aa(t));e:for(;++i<s;){var c=e[i],d=null==n?c:n(c);if(c=r||0!==c?c:0,a&&d==d){for(var h=u;h--;)if(t[h]===d)continue e;l.push(c)}else o(t,d,r)||l.push(c)}return l}var hs=Jt(function(e,t){return es(e)?ds(e,cr(t,1,es,!0)):[]});function fs(e){var t=null==e?0:e.length;return t?e[t-1]:void 0}var ps=Jt(function(e,t){var n=fs(t);return es(n)&&(n=void 0),es(e)?ds(e,cr(t,1,es,!0),ja(n)):[]}),gs=Jt(function(e,t){var n=fs(t);return es(n)&&(n=void 0),es(e)?ds(e,cr(t,1,es,!0),void 0,n):[]}),ms=ae(function(e,t){return e/t},1);function vs(e,t,n,r){for(var i=e.length,o=r?i:-1;(r?o--:++o<i)&&t(e[o],o,e););return n?xr(e,r?0:o,r?o+1:i):xr(e,r?o+1:0,r?i:o)}function ys(e){return"function"==typeof e?e:we}function bs(e,t){return(ne(e)?Rt:Da)(e,ys(t))}function Rs(e,t){for(var n=null==e?0:e.length;n--&&!1!==t(e[n],n,e););return e}var ws=$a(!0);function Ss(e,t){return e&&ws(e,t,En)}var Bs=Ta(Ss,!0);function ks(e,t){return(ne(e)?Rs:Bs)(e,ys(t))}function Cs(e){return function(t){var n=fo(t);return"[object Map]"==n?ca(t):"[object Set]"==n?function(e){var t=-1,n=Array(e.size);return e.forEach(function(e){n[++t]=[e,e]}),n}(t):function(e,t){return te(t,function(t){return[t,e[t]]})}(t,e(t))}}var _s=Cs(En),xs=Cs(An),Ps=Vr({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"}),Es=/[&<>"']/g,Ms=RegExp(Es.source);function Is(e){return(e=tr(e))&&Ms.test(e)?e.replace(Es,Ps):e}var js=/[\\^$.*+?()[\]{}|]/g,Os=RegExp(js.source);function As(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(!t(e[n],n,e))return!1;return!0}function $s(e,t){var n=!0;return Da(e,function(e,r,i){return n=!!t(e,r,i)}),n}function Fs(e){return e?Ai(Re(e),0,4294967295):0}function Ls(e,t){var n=[];return Da(e,function(e,r,i){t(e,r,i)&&n.push(e)}),n}function Ts(e){return function(t,n,r){var i=Object(t);if(!Zt(t)){var o=ja(n);t=En(t),n=function(e){return o(i[e],e,i)}}var a=e(t,n,r);return a>-1?i[o?t[a]:a]:void 0}}var Ds=Math.max;function Hs(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var i=null==n?0:Re(n);return i<0&&(i=Ds(r+i,0)),wt(e,ja(t),i)}var Ns=Ts(Hs);function Gs(e,t,n){var r;return n(e,function(e,n,i){if(t(e,n,i))return r=n,!1}),r}var Ws=Math.max,qs=Math.min;function zs(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var i=r-1;return void 0!==n&&(i=Re(n),i=n<0?Ws(r+i,0):qs(i,r-1)),wt(e,ja(t),i,!0)}var Ks=Ts(zs);function Us(e){return e&&e.length?e[0]:void 0}function Vs(e,t){var n=-1,r=Zt(e)?Array(e.length):[];return Da(e,function(e,i,o){r[++n]=t(e,i,o)}),r}function Js(e,t){return(ne(e)?te:Vs)(e,ja(t))}var Ys=1/0;var Xs=1/0;var Zs=Ei("floor");function Qs(e){return hr(function(t){var n=t.length,r=n,i=it.prototype.thru;for(e&&t.reverse();r--;){var o=t[r];if("function"!=typeof o)throw new TypeError("Expected a function");if(i&&!a&&"wrapper"==rt(o))var a=new it([],!0)}for(r=a?r:n;++r<n;){var s=rt(o=t[r]),l="wrapper"==s?et(o):void 0;a=l&&ut(l[0])&&424==l[1]&&!l[4].length&&1==l[9]?a[rt(l[0])].apply(a,l[3]):1==o.length&&ut(o)?a[s]():a.thru(o)}return function(){var e=arguments,r=e[0];if(a&&1==e.length&&ne(r))return a.plant(r).value();for(var i=0,o=n?t[i].apply(this,e):r;++i<n;)o=t[i].call(this,o);return o}})}var el=Qs(),tl=Qs(!0);function nl(e,t){return Wi(t,function(t){return _e(e[t])})}var rl=Object.prototype.hasOwnProperty,il=Na(function(e,t,n){rl.call(e,n)?e[n].push(t):Gt(e,n,[t])});function ol(e,t){return e>t}function al(e){return function(t,n){return"string"==typeof t&&"string"==typeof n||(t=ve(t),n=ve(n)),e(t,n)}}var sl=al(ol),ll=al(function(e,t){return e>=t}),ul=Object.prototype.hasOwnProperty;function cl(e,t){return null!=e&&ul.call(e,t)}var dl=Math.max,hl=Math.min;function fl(e){return"string"==typeof e||!ne(e)&&Z(e)&&"[object String]"==X(e)}function pl(e,t){return te(t,function(t){return e[t]})}function gl(e){return null==e?[]:pl(e,En(e))}var ml=Math.max;var vl=Math.max;var yl=Math.min;function bl(e,t,n){for(var r=n?cs:kt,i=e[0].length,o=e.length,a=o,s=Array(o),l=1/0,u=[];a--;){var c=e[a];a&&t&&(c=te(c,mn(t))),l=yl(c.length,l),s[a]=!n&&(t||i>=120&&c.length>=120)?new aa(a&&c):void 0}c=e[0];var d=-1,h=s[0];e:for(;++d<i&&u.length<l;){var f=c[d],p=t?t(f):f;if(f=n||0!==f?f:0,!(h?la(h,p):r(u,p,n))){for(a=o;--a;){var g=s[a];if(!(g?la(g,p):r(e[a],p,n)))continue e}h&&h.push(p),u.push(f)}}return u}function Rl(e){return es(e)?e:[]}var wl=Jt(function(e){var t=te(e,Rl);return t.length&&t[0]===e[0]?bl(t):[]}),Sl=Jt(function(e){var t=fs(e),n=te(e,Rl);return t===fs(n)?t=void 0:n.pop(),n.length&&n[0]===e[0]?bl(n,ja(t)):[]}),Bl=Jt(function(e){var t=fs(e),n=te(e,Rl);return(t="function"==typeof t?t:void 0)&&n.pop(),n.length&&n[0]===e[0]?bl(n,void 0,t):[]});function kl(e,t){return function(n,r){return function(e,t,n,r){return La(e,function(e,i,o){t(r,n(e),i,o)}),r}(n,e,t(r),{})}}var Cl=Object.prototype.toString,_l=kl(function(e,t,n){null!=t&&"function"!=typeof t.toString&&(t=Cl.call(t)),e[t]=n},mt(we)),xl=Object.prototype,Pl=xl.hasOwnProperty,El=xl.toString,Ml=kl(function(e,t,n){null!=t&&"function"!=typeof t.toString&&(t=El.call(t)),Pl.call(e,t)?e[t].push(n):e[t]=[n]},ja);function Il(e,t){return t.length<2?e:ir(e,xr(t,0,-1))}function jl(e,t,n){var r=null==(e=Il(e,t=nr(t,e)))?e:e[rr(fs(t))];return null==r?void 0:Ke(r,e,n)}var Ol=Jt(jl),Al=Jt(function(e,t,n){var r=-1,i="function"==typeof t,o=Zt(e)?Array(e.length):[];return Da(e,function(e){o[++r]=i?Ke(t,e,n):jl(e,t,n)}),o});var $l=Rn&&Rn.isArrayBuffer,Fl=$l?mn($l):function(e){return Z(e)&&"[object ArrayBuffer]"==X(e)};var Ll=Rn&&Rn.isDate,Tl=Ll?mn(Ll):function(e){return Z(e)&&"[object Date]"==X(e)};var Dl=Object.prototype.hasOwnProperty;function Hl(e,t){return Ra(e,t)}var Nl=N.isFinite;function Gl(e){return"number"==typeof e&&e==Re(e)}function Wl(e){return"number"==typeof e||Z(e)&&"[object Number]"==X(e)}var ql=Pe?_e:cn;var zl=Rn&&Rn.isRegExp,Kl=zl?mn(zl):function(e){return Z(e)&&"[object RegExp]"==X(e)},Ul=9007199254740991;var Vl=Array.prototype.join;var Jl=Ci(function(e,t,n){return e+(n?"-":"")+t.toLowerCase()}),Yl=Na(function(e,t,n){Gt(e,n,t)});var Xl=Math.max,Zl=Math.min;var Ql=Ci(function(e,t,n){return e+(n?" ":"")+t.toLowerCase()}),eu=qr("toLowerCase");function tu(e,t){return e<t}var nu=al(tu),ru=al(function(e,t){return e<=t});function iu(e,t,n){for(var r=-1,i=e.length;++r<i;){var o=e[r],a=t(o);if(null!=a&&(void 0===s?a==a&&!Q(a):n(a,s)))var s=a,l=o}return l}function ou(e,t){for(var n,r=-1,i=e.length;++r<i;){var o=t(e[r]);void 0!==o&&(n=void 0===n?o:n+o)}return n}function au(e,t){var n=null==e?0:e.length;return n?ou(e,t)/n:NaN}var su=en(function(e,t,n){rs(e,t,n)}),lu=Jt(function(e,t){return function(n){return jl(n,e,t)}}),uu=Jt(function(e,t){return function(n){return jl(e,n,t)}});function cu(e,t,n){var r=En(t),i=nl(t,r),o=!(he(n)&&"chain"in n&&!n.chain),a=_e(e);return Rt(i,function(n){var r=t[n];e[n]=r,a&&(e.prototype[n]=function(){var t=this.__chain__;if(o||t){var n=e(this.__wrapped__);return(n.__actions__=ot(this.__actions__)).push({func:r,args:arguments,thisArg:e}),n.__chain__=t,n}return r.apply(e,sr([this.value()],arguments))})}),e}var du=ae(function(e,t){return e*t},1);function hu(e){if("function"!=typeof e)throw new TypeError("Expected a function");return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}}var fu=G?G.iterator:void 0;function pu(e){if(!e)return[];if(Zt(e))return fl(e)?Wr(e):ot(e);if(fu&&e[fu])return function(e){for(var t,n=[];!(t=e.next()).done;)n.push(t.value);return n}(e[fu]());var t=fo(e);return("[object Map]"==t?ca:"[object Set]"==t?da:gl)(e)}function gu(e,t){var n=e.length;if(n)return It(t+=t<0?n:0,n)?e[t]:void 0}var mu=Object.prototype.hasOwnProperty;function vu(e,t){var n=-1,r=(t=nr(t,e)).length;if(!r)return!0;for(var i=null==e||"object"!=typeof e&&"function"!=typeof e;++n<r;){var o=t[n];if("string"==typeof o){if("__proto__"===o&&!mu.call(e,"__proto__"))return!1;if("constructor"===o&&n+1<r&&"string"==typeof t[n+1]&&"prototype"===t[n+1]){if(i&&0===n)continue;return!1}}}var a=Il(e,t);return null==a||delete a[rr(fs(t))]}function yu(e){return Rr(e)?void 0:e}var bu=hr(function(e,t){var n={};if(null==e)return n;var r=!1;t=te(t,function(t){return t=nr(t,e),r||(r=t.length>1),t}),Kt(e,Xi(e),n),r&&(n=ea(n,7,yu));for(var i=t.length;i--;)vu(n,t[i]);return n});function Ru(e,t,n,r){if(!he(e))return e;for(var i=-1,o=(t=nr(t,e)).length,a=o-1,s=e;null!=s&&++i<o;){var l=rr(t[i]),u=n;if("__proto__"===l||"constructor"===l||"prototype"===l)return e;if(i!=a){var c=s[l];void 0===(u=r?r(c,l,s):void 0)&&(u=he(c)?c:It(t[i+1])?[]:{})}zt(s,l,u),s=s[l]}return e}function wu(e,t,n){for(var r=-1,i=t.length,o={};++r<i;){var a=t[r],s=ir(e,a);n(s,a)&&Ru(o,nr(a,e),s)}return o}function Su(e,t){if(null==e)return{};var n=te(Xi(e),function(e){return[e]});return t=ja(t),wu(e,n,function(e,n){return t(e,n[0])})}function Bu(e,t){if(e!==t){var n=void 0!==e,r=null===e,i=e==e,o=Q(e),a=void 0!==t,s=null===t,l=t==t,u=Q(t);if(!s&&!u&&!o&&e>t||o&&a&&l&&!s&&!u||r&&a&&l||!n&&l||!i)return 1;if(!r&&!o&&!u&&e<t||u&&n&&i&&!r&&!o||s&&n&&i||!a&&i||!l)return-1}return 0}function ku(e,t,n){t=t.length?te(t,function(e){return ne(e)?function(t){return ir(t,1===e.length?e[0]:e)}:e}):[we];var r=-1;t=te(t,mn(ja));var i=Vs(e,function(e,n,i){var o=te(t,function(t){return t(e)});return{criteria:o,index:++r,value:e}});return function(e,t){var n=e.length;for(e.sort(t);n--;)e[n]=e[n].value;return e}(i,function(e,t){return function(e,t,n){for(var r=-1,i=e.criteria,o=t.criteria,a=i.length,s=n.length;++r<a;){var l=Bu(i[r],o[r]);if(l)return r>=s?l:l*("desc"==n[r]?-1:1)}return e.index-t.index}(e,t,n)})}function Cu(e){return hr(function(t){return t=te(t,mn(ja)),Jt(function(n){var r=this;return e(t,function(e){return Ke(e,r,n)})})})}var _u=Cu(te),xu=Jt,Pu=Math.min,Eu=xu(function(e,t){var n=(t=1==t.length&&ne(t[0])?te(t[0],mn(ja)):te(cr(t,1),mn(ja))).length;return Jt(function(r){for(var i=-1,o=Pu(r.length,n);++i<o;)r[i]=t[i].call(this,r[i]);return Ke(e,this,r)})}),Mu=Cu(As),Iu=Cu(sa),ju=Math.floor;function Ou(e,t){var n="";if(!e||t<1||t>9007199254740991)return n;do{t%2&&(n+=e),(t=ju(t/2))&&(e+=e)}while(t);return n}var Au=Ma("length"),$u="\\ud800-\\udfff",Fu="["+$u+"]",Lu="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",Tu="\\ud83c[\\udffb-\\udfff]",Du="[^"+$u+"]",Hu="(?:\\ud83c[\\udde6-\\uddff]){2}",Nu="[\\ud800-\\udbff][\\udc00-\\udfff]",Gu="(?:"+Lu+"|"+Tu+")"+"?",Wu="[\\ufe0e\\ufe0f]?",qu=Wu+Gu+("(?:\\u200d(?:"+[Du,Hu,Nu].join("|")+")"+Wu+Gu+")*"),zu="(?:"+[Du+Lu+"?",Lu,Hu,Nu,Fu].join("|")+")",Ku=RegExp(Tu+"(?="+Tu+")|"+zu+qu,"g");function Uu(e){return Mr(e)?function(e){for(var t=Ku.lastIndex=0;Ku.test(e);)++t;return t}(e):Au(e)}var Vu=Math.ceil;function Ju(e,t){var n=(t=void 0===t?" ":oe(t)).length;if(n<2)return n?Ou(t,e):t;var r=Ou(t,Vu(e/Uu(t)));return Mr(t)?Pr(Wr(r),0,e).join(""):r.slice(0,e)}var Yu=Math.ceil,Xu=Math.floor;var Zu=/^\s+/,Qu=N.parseInt;var ec=Jt(function(e,t){return Ht(e,32,void 0,t,At(t,Pt(ec)))});ec.placeholder={};var tc=Jt(function(e,t){return Ht(e,64,void 0,t,At(t,Pt(tc)))});tc.placeholder={};var nc=Na(function(e,t,n){e[n?0:1].push(t)},function(){return[[],[]]});var rc=hr(function(e,t){return null==e?{}:function(e,t){return wu(e,t,function(t,n){return Pa(e,n)})}(e,t)});function ic(e,t,n,r){for(var i=n-1,o=e.length;++i<o;)if(r(e[i],t))return i;return-1}var oc=Array.prototype.splice;function ac(e,t,n,r){var i=r?ic:Bt,o=-1,a=t.length,s=e;for(e===t&&(t=ot(t)),n&&(s=te(e,mn(n)));++o<a;)for(var l=0,u=t[o],c=n?n(u):u;(l=i(s,c,l,r))>-1;)s!==e&&oc.call(s,l,1),oc.call(e,l,1);return e}function sc(e,t){return e&&e.length&&t&&t.length?ac(e,t):e}var lc=Jt(sc);var uc=Array.prototype.splice;function cc(e,t){for(var n=e?t.length:0,r=n-1;n--;){var i=t[n];if(n==r||i!==o){var o=i;It(i)?uc.call(e,i,1):vu(e,i)}}return e}var dc=hr(function(e,t){var n=null==e?0:e.length,r=ar(e,t);return cc(e,te(t,function(e){return It(e,n)?+e:e}).sort(Bu)),r}),hc=Math.floor,fc=Math.random;function pc(e,t){return e+hc(fc()*(t-e+1))}var gc=parseFloat,mc=Math.min,vc=Math.random;var yc=Math.ceil,bc=Math.max;function Rc(e){return function(t,n,r){return r&&"number"!=typeof r&&Qt(t,n,r)&&(n=r=void 0),t=be(t),void 0===n?(n=t,t=0):n=be(n),function(e,t,n,r){for(var i=-1,o=bc(yc((t-e)/(n||1)),0),a=Array(o);o--;)a[r?o:++i]=e,e+=n;return a}(t,n,r=void 0===r?t<n?1:-1:be(r),e)}}var wc=Rc(),Sc=Rc(!0),Bc=hr(function(e,t){return Ht(e,256,void 0,void 0,void 0,t)});function kc(e,t,n,r,i){return i(e,function(e,i,o){n=r?(r=!1,e):t(n,e,i,o)}),n}function Cc(e,t,n,r){var i=null==e?0:e.length;for(r&&i&&(n=e[--i]);i--;)n=t(n,e[i],i,e);return n}var _c=Array.prototype.reverse;function xc(e){return null==e?e:_c.call(e)}var Pc=Ei("round");function Ec(e){var t=e.length;return t?e[pc(0,t-1)]:void 0}function Mc(e){return Ec(gl(e))}function Ic(e){return(ne(e)?Ec:Mc)(e)}function jc(e,t){var n=-1,r=e.length,i=r-1;for(t=void 0===t?r:t;++n<t;){var o=pc(n,i),a=e[o];e[o]=e[n],e[n]=a}return e.length=t,e}function Oc(e,t){return jc(ot(e),Ai(t,0,e.length))}function Ac(e,t){var n=gl(e);return jc(n,Ai(t,0,n.length))}function $c(e){return jc(ot(e))}function Fc(e){return jc(gl(e))}var Lc=Ci(function(e,t,n){return e+(n?"_":"")+t.toLowerCase()});function Tc(e,t){var n;return Da(e,function(e,r,i){return!(n=t(e,r,i))}),!!n}var Dc=Jt(function(e,t){if(null==e)return[];var n=t.length;return n>1&&Qt(e,t[0],t[1])?t=[]:n>2&&Qt(t[0],t[1],t[2])&&(t=[t[0]]),ku(e,cr(t,1),[])}),Hc=Math.floor,Nc=Math.min;function Gc(e,t,n,r){var i=0,o=null==e?0:e.length;if(0===o)return 0;for(var a=(t=n(t))!=t,s=null===t,l=Q(t),u=void 0===t;i<o;){var c=Hc((i+o)/2),d=n(e[c]),h=void 0!==d,f=null===d,p=d==d,g=Q(d);if(a)var m=r||p;else m=u?p&&(r||h):s?p&&h&&(r||!f):l?p&&h&&!f&&(r||!g):!f&&!g&&(r?d<=t:d<t);m?i=c+1:o=c}return Nc(o,4294967294)}function Wc(e,t,n){var r=0,i=null==e?r:e.length;if("number"==typeof t&&t==t&&i<=2147483647){for(;r<i;){var o=r+i>>>1,a=e[o];null!==a&&!Q(a)&&(n?a<=t:a<t)?r=o+1:i=o}return i}return Gc(e,t,we,n)}function qc(e,t){for(var n=-1,r=e.length,i=0,o=[];++n<r;){var a=e[n],s=t?t(a):a;if(!n||!Wt(s,l)){var l=s;o[i++]=0===a?0:a}}return o}var zc=Math.max;var Kc=Ci(function(e,t,n){return e+(n?" ":"")+zr(t)});var Uc=ae(function(e,t){return e-t},0);function Vc(e){return e&&e.length?ou(e,we):0}function Jc(e,t){return e&&e.length?ou(e,ja(t)):0}var Yc=Object.prototype,Xc=Yc.hasOwnProperty;function Zc(e,t,n,r){return void 0===e||Wt(e,Yc[n])&&!Xc.call(r,n)?t:e}var Qc={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"};function ed(e){return"\\"+Qc[e]}var td=/<%=([\s\S]+?)%>/g,nd={escape:/<%-([\s\S]+?)%>/g,evaluate:/<%([\s\S]+?)%>/g,interpolate:td,variable:"",imports:{_:{escape:Is}}},rd=/\b__p \+= '';/g,id=/\b(__p \+=) '' \+/g,od=/(__e\(.*?\)|\b__t\)) \+\n'';/g,ad=/[()=,{}\[\]\/\s]/,sd=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,ld=/($^)/,ud=/['\n\r\u2028\u2029\\]/g,cd=Object.prototype.hasOwnProperty;function dd(e,t){return t(e)}var hd=4294967295,fd=Math.min;function pd(e,t){var n=e;return n instanceof Ze&&(n=n.value()),Ur(t,function(e,t){return t.func.apply(t.thisArg,sr([e],t.args))},n)}function gd(){return pd(this.__wrapped__,this.__actions__)}var md=9007199254740991;function vd(e,t){for(var n=e.length;n--&&Bt(t,e[n],0)>-1;);return n}function yd(e,t){for(var n=-1,r=e.length;++n<r&&Bt(t,e[n],0)>-1;);return n}var bd=/^\s+/;var Rd=/\w*$/;var wd=Vr({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"}),Sd=/&(?:amp|lt|gt|quot|#39);/g,Bd=RegExp(Sd.source);var kd=eo&&1/da(new eo([,-0]))[1]==1/0?function(e){return new eo(e)}:Qe;function Cd(e,t,n){var r=-1,i=kt,o=e.length,a=!0,s=[],l=s;if(n)a=!1,i=cs;else if(o>=200){var u=t?null:kd(e);if(u)return da(u);a=!1,i=la,l=new aa}else l=t?[]:s;e:for(;++r<o;){var c=e[r],d=t?t(c):c;if(c=n||0!==c?c:0,a&&d==d){for(var h=l.length;h--;)if(l[h]===d)continue e;t&&l.push(d),s.push(c)}else i(l,d,n)||(l!==s&&l.push(d),s.push(c))}return s}var _d=Jt(function(e){return Cd(cr(e,1,es,!0))}),xd=Jt(function(e){var t=fs(e);return es(t)&&(t=void 0),Cd(cr(e,1,es,!0),ja(t))}),Pd=Jt(function(e){var t=fs(e);return t="function"==typeof t?t:void 0,Cd(cr(e,1,es,!0),void 0,t)});var Ed=0;var Md=Math.max;function Id(e){if(!e||!e.length)return[];var t=0;return e=Wi(e,function(e){if(es(e))return t=Md(e.length,t),!0}),rn(t,function(t){return te(e,Ma(t))})}function jd(e,t){if(!e||!e.length)return[];var n=Id(e);return null==t?n:te(n,function(e){return Ke(t,void 0,e)})}function Od(e,t,n,r){return Ru(e,t,n(ir(e,t)),r)}var Ad=Ci(function(e,t,n){return e+(n?" ":"")+t.toUpperCase()});var $d=Jt(function(e,t){return es(e)?ds(e,t):[]});var Fd=hr(function(e){var t=e.length,n=t?e[0]:0,r=this.__wrapped__,i=function(t){return ar(t,e)};return!(t>1||this.__actions__.length)&&r instanceof Ze&&It(n)?((r=r.slice(n,+n+(t?1:0))).__actions__.push({func:dd,args:[i],thisArg:void 0}),new it(r,this.__chain__).thru(function(e){return t&&!e.length&&e.push(void 0),e})):this.thru(i)});function Ld(e,t,n){var r=e.length;if(r<2)return r?Cd(e[0]):[];for(var i=-1,o=Array(r);++i<r;)for(var a=e[i],s=-1;++s<r;)s!=i&&(o[i]=ds(o[i]||a,e[s],t,n));return Cd(cr(o,1),t,n)}var Td=Jt(function(e){return Ld(Wi(e,es))}),Dd=Jt(function(e){var t=fs(e);return es(t)&&(t=void 0),Ld(Wi(e,es),ja(t))}),Hd=Jt(function(e){var t=fs(e);return t="function"==typeof t?t:void 0,Ld(Wi(e,es),void 0,t)}),Nd=Jt(Id);function Gd(e,t,n){for(var r=-1,i=e.length,o=t.length,a={};++r<i;){var s=r<o?t[r]:void 0;n(a,e[r],s)}return a}var Wd=Jt(function(e){var t=e.length,n=t>1?e[t-1]:void 0;return n="function"==typeof n?(e.pop(),n):void 0,jd(e,n)}),qd={chunk:function(e,t,n){t=(n?Qt(e,t,n):void 0===t)?1:Oi(Re(t),0);var r=null==e?0:e.length;if(!r||t<1)return[];for(var i=0,o=0,a=Array(ji(r/t));i<r;)a[o++]=xr(e,i,i+=t);return a},compact:function(e){for(var t=-1,n=null==e?0:e.length,r=0,i=[];++t<n;){var o=e[t];o&&(i[r++]=o)}return i},concat:function(){var e=arguments.length;if(!e)return[];for(var t=Array(e-1),n=arguments[0],r=e;r--;)t[r-1]=arguments[r];return sr(ne(n)?ot(n):[n],cr(t,1))},difference:hs,differenceBy:ps,differenceWith:gs,drop:function(e,t,n){var r=null==e?0:e.length;return r?xr(e,(t=n||void 0===t?1:Re(t))<0?0:t,r):[]},dropRight:function(e,t,n){var r=null==e?0:e.length;return r?xr(e,0,(t=r-(t=n||void 0===t?1:Re(t)))<0?0:t):[]},dropRightWhile:function(e,t){return e&&e.length?vs(e,ja(t),!0,!0):[]},dropWhile:function(e,t){return e&&e.length?vs(e,ja(t),!0):[]},fill:function(e,t,n,r){var i=null==e?0:e.length;return i?(n&&"number"!=typeof n&&Qt(e,t,n)&&(n=0,r=i),function(e,t,n,r){var i=e.length;for((n=Re(n))<0&&(n=-n>i?0:i+n),(r=void 0===r||r>i?i:Re(r))<0&&(r+=i),r=n>r?0:Fs(r);n<r;)e[n++]=t;return e}(e,t,n,r)):[]},findIndex:Hs,findLastIndex:zs,first:Us,flatten:dr,flattenDeep:function(e){return(null==e?0:e.length)?cr(e,Xs):[]},flattenDepth:function(e,t){return(null==e?0:e.length)?cr(e,t=void 0===t?1:Re(t)):[]},fromPairs:function(e){for(var t=-1,n=null==e?0:e.length,r={};++t<n;){var i=e[t];r[i[0]]=i[1]}return r},head:Us,indexOf:function(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var i=null==n?0:Re(n);return i<0&&(i=vl(r+i,0)),Bt(e,t,i)},initial:function(e){return(null==e?0:e.length)?xr(e,0,-1):[]},intersection:wl,intersectionBy:Sl,intersectionWith:Bl,join:function(e,t){return null==e?"":Vl.call(e,t)},last:fs,lastIndexOf:function(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var i=r;return void 0!==n&&(i=(i=Re(n))<0?Xl(r+i,0):Zl(i,r-1)),t==t?function(e,t,n){for(var r=n+1;r--;)if(e[r]===t)return r;return r}(e,t,i):wt(e,St,i,!0)},nth:function(e,t){return e&&e.length?gu(e,Re(t)):void 0},pull:lc,pullAll:sc,pullAllBy:function(e,t,n){return e&&e.length&&t&&t.length?ac(e,t,ja(n)):e},pullAllWith:function(e,t,n){return e&&e.length&&t&&t.length?ac(e,t,void 0,n):e},pullAt:dc,remove:function(e,t){var n=[];if(!e||!e.length)return n;var r=-1,i=[],o=e.length;for(t=ja(t);++r<o;){var a=e[r];t(a,r,e)&&(n.push(a),i.push(r))}return cc(e,i),n},reverse:xc,slice:function(e,t,n){var r=null==e?0:e.length;return r?(n&&"number"!=typeof n&&Qt(e,t,n)?(t=0,n=r):(t=null==t?0:Re(t),n=void 0===n?r:Re(n)),xr(e,t,n)):[]},sortedIndex:function(e,t){return Wc(e,t)},sortedIndexBy:function(e,t,n){return Gc(e,t,ja(n))},sortedIndexOf:function(e,t){var n=null==e?0:e.length;if(n){var r=Wc(e,t);if(r<n&&Wt(e[r],t))return r}return-1},sortedLastIndex:function(e,t){return Wc(e,t,!0)},sortedLastIndexBy:function(e,t,n){return Gc(e,t,ja(n),!0)},sortedLastIndexOf:function(e,t){if(null==e?0:e.length){var n=Wc(e,t,!0)-1;if(Wt(e[n],t))return n}return-1},sortedUniq:function(e){return e&&e.length?qc(e):[]},sortedUniqBy:function(e,t){return e&&e.length?qc(e,ja(t)):[]},tail:function(e){var t=null==e?0:e.length;return t?xr(e,1,t):[]},take:function(e,t,n){return e&&e.length?xr(e,0,(t=n||void 0===t?1:Re(t))<0?0:t):[]},takeRight:function(e,t,n){var r=null==e?0:e.length;return r?xr(e,(t=r-(t=n||void 0===t?1:Re(t)))<0?0:t,r):[]},takeRightWhile:function(e,t){return e&&e.length?vs(e,ja(t),!1,!0):[]},takeWhile:function(e,t){return e&&e.length?vs(e,ja(t)):[]},union:_d,unionBy:xd,unionWith:Pd,uniq:function(e){return e&&e.length?Cd(e):[]},uniqBy:function(e,t){return e&&e.length?Cd(e,ja(t)):[]},uniqWith:function(e,t){return t="function"==typeof t?t:void 0,e&&e.length?Cd(e,void 0,t):[]},unzip:Id,unzipWith:jd,without:$d,xor:Td,xorBy:Dd,xorWith:Hd,zip:Nd,zipObject:function(e,t){return Gd(e||[],t||[],zt)},zipObjectDeep:function(e,t){return Gd(e||[],t||[],Ru)},zipWith:Wd},zd={countBy:Wa,each:bs,eachRight:ks,every:function(e,t,n){var r=ne(e)?As:$s;return n&&Qt(e,t,n)&&(t=void 0),r(e,ja(t))},filter:function(e,t){return(ne(e)?Wi:Ls)(e,ja(t))},find:Ns,findLast:Ks,flatMap:function(e,t){return cr(Js(e,t),1)},flatMapDeep:function(e,t){return cr(Js(e,t),Ys)},flatMapDepth:function(e,t,n){return n=void 0===n?1:Re(n),cr(Js(e,t),n)},forEach:bs,forEachRight:ks,groupBy:il,includes:function(e,t,n,r){e=Zt(e)?e:gl(e),n=n&&!r?Re(n):0;var i=e.length;return n<0&&(n=ml(i+n,0)),fl(e)?n<=i&&e.indexOf(t,n)>-1:!!i&&Bt(e,t,n)>-1},invokeMap:Al,keyBy:Yl,map:Js,orderBy:function(e,t,n,r){return null==e?[]:(ne(t)||(t=null==t?[]:[t]),ne(n=r?void 0:n)||(n=null==n?[]:[n]),ku(e,t,n))},partition:nc,reduce:function(e,t,n){var r=ne(e)?Ur:kc,i=arguments.length<3;return r(e,ja(t),n,i,Da)},reduceRight:function(e,t,n){var r=ne(e)?Cc:kc,i=arguments.length<3;return r(e,ja(t),n,i,Bs)},reject:function(e,t){return(ne(e)?Wi:Ls)(e,hu(ja(t)))},sample:Ic,sampleSize:function(e,t,n){return t=(n?Qt(e,t,n):void 0===t)?1:Re(t),(ne(e)?Oc:Ac)(e,t)},shuffle:function(e){return(ne(e)?$c:Fc)(e)},size:function(e){if(null==e)return 0;if(Zt(e))return fl(e)?Uu(e):e.length;var t=fo(e);return"[object Map]"==t||"[object Set]"==t?e.size:Pn(e).length},some:function(e,t,n){var r=ne(e)?sa:Tc;return n&&Qt(e,t,n)&&(t=void 0),r(e,ja(t))},sortBy:Dc},Kd=Ka,Ud={after:function(e,t){if("function"!=typeof t)throw new TypeError("Expected a function");return e=Re(e),function(){if(--e<1)return t.apply(this,arguments)}},ary:Nt,before:Br,bind:kr,bindKey:_r,curry:qa,curryRight:za,debounce:Ja,defer:ls,delay:us,flip:function(e){return Ht(e,512)},memoize:Xn,negate:hu,once:function(e){return Br(2,e)},overArgs:Eu,partial:ec,partialRight:tc,rearg:Bc,rest:function(e,t){if("function"!=typeof e)throw new TypeError("Expected a function");return Jt(e,t=void 0===t?t:Re(t))},spread:function(e,t){if("function"!=typeof e)throw new TypeError("Expected a function");return t=null==t?0:zc(Re(t),0),Jt(function(n){var r=n[t],i=Pr(n,0,t);return r&&sr(i,r),Ke(e,this,i)})},throttle:function(e,t,n){var r=!0,i=!0;if("function"!=typeof e)throw new TypeError("Expected a function");return he(n)&&(r="leading"in n?!!n.leading:r,i="trailing"in n?!!n.trailing:i),Ja(e,t,{leading:r,maxWait:t,trailing:i})},unary:function(e){return Nt(e,1)},wrap:function(e,t){return ec(ys(t),e)}},Vd={castArray:function(){if(!arguments.length)return[];var e=arguments[0];return ne(e)?e:[e]},clone:na,cloneDeep:oa,cloneDeepWith:function(e,t){return ea(e,5,t="function"==typeof t?t:void 0)},cloneWith:function(e,t){return ea(e,4,t="function"==typeof t?t:void 0)},conformsTo:function(e,t){return null==t||Oa(e,t,En(t))},eq:Wt,gt:sl,gte:ll,isArguments:un,isArray:ne,isArrayBuffer:Fl,isArrayLike:Zt,isArrayLikeObject:es,isBoolean:function(e){return!0===e||!1===e||Z(e)&&"[object Boolean]"==X(e)},isBuffer:pn,isDate:Tl,isElement:function(e){return Z(e)&&1===e.nodeType&&!Rr(e)},isEmpty:function(e){if(null==e)return!0;if(Zt(e)&&(ne(e)||"string"==typeof e||"function"==typeof e.splice||pn(e)||Sn(e)||un(e)))return!e.length;var t=fo(e);if("[object Map]"==t||"[object Set]"==t)return!e.size;if(nn(e))return!Pn(e).length;for(var n in e)if(Dl.call(e,n))return!1;return!0},isEqual:Hl,isEqualWith:function(e,t,n){var r=(n="function"==typeof n?n:void 0)?n(e,t):void 0;return void 0===r?Ra(e,t,void 0,n):!!r},isError:wr,isFinite:function(e){return"number"==typeof e&&Nl(e)},isFunction:_e,isInteger:Gl,isLength:Xt,isMap:Wo,isMatch:function(e,t){return e===t||wa(e,t,Ba(t))},isMatchWith:function(e,t,n){return n="function"==typeof n?n:void 0,wa(e,t,Ba(t),n)},isNaN:function(e){return Wl(e)&&e!=+e},isNative:function(e){if(ql(e))throw new Error("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return Te(e)},isNil:function(e){return null==e},isNull:function(e){return null===e},isNumber:Wl,isObject:he,isObjectLike:Z,isPlainObject:Rr,isRegExp:Kl,isSafeInteger:function(e){return Gl(e)&&e>=-9007199254740991&&e<=Ul},isSet:zo,isString:fl,isSymbol:Q,isTypedArray:Sn,isUndefined:function(e){return void 0===e},isWeakMap:function(e){return Z(e)&&"[object WeakMap]"==fo(e)},isWeakSet:function(e){return Z(e)&&"[object WeakSet]"==X(e)},lt:nu,lte:ru,toArray:pu,toFinite:be,toInteger:Re,toLength:Fs,toNumber:ve,toPlainObject:ns,toSafeInteger:function(e){return e?Ai(Re(e),-9007199254740991,md):0===e?e:0},toString:tr},Jd={add:se,ceil:Mi,divide:ms,floor:Zs,max:function(e){return e&&e.length?iu(e,we,ol):void 0},maxBy:function(e,t){return e&&e.length?iu(e,ja(t),ol):void 0},mean:function(e){return au(e,we)},meanBy:function(e,t){return au(e,ja(t))},min:function(e){return e&&e.length?iu(e,we,tu):void 0},minBy:function(e,t){return e&&e.length?iu(e,ja(t),tu):void 0},multiply:du,round:Pc,subtract:Uc,sum:Vc,sumBy:Jc},Yd=$i,Xd=function(e,t,n){return t=be(t),void 0===n?(n=t,t=0):n=be(n),function(e,t,n){return e>=hl(t,n)&&e<dl(t,n)}(e=ve(e),t,n)},Zd=function(e,t,n){if(n&&"boolean"!=typeof n&&Qt(e,t,n)&&(t=n=void 0),void 0===n&&("boolean"==typeof t?(n=t,t=void 0):"boolean"==typeof e&&(n=e,e=void 0)),void 0===e&&void 0===t?(e=0,t=1):(e=be(e),void 0===t?(t=e,e=0):t=be(t)),e>t){var r=e;e=t,t=r}if(n||e%1||t%1){var i=vc();return mc(e+i*(t-e+gc("1e-"+((i+"").length-1))),t)}return pc(e,t)},Qd={assign:In,assignIn:$n,assignInWith:Fn,assignWith:Ln,at:fr,create:function(e,t){var n=qe(e);return null==t?n:Li(n,t)},defaults:Za,defaultsDeep:as,entries:_s,entriesIn:xs,extend:$n,extendWith:Fn,findKey:function(e,t){return Gs(e,ja(t),La)},findLastKey:function(e,t){return Gs(e,ja(t),Ss)},forIn:function(e,t){return null==e?e:Fa(e,ys(t),An)},forInRight:function(e,t){return null==e?e:ws(e,ys(t),An)},forOwn:function(e,t){return e&&La(e,ys(t))},forOwnRight:function(e,t){return e&&Ss(e,ys(t))},functions:function(e){return null==e?[]:nl(e,En(e))},functionsIn:function(e){return null==e?[]:nl(e,An(e))},get:or,has:function(e,t){return null!=e&&xa(e,t,cl)},hasIn:Pa,invert:_l,invertBy:Ml,invoke:Ol,keys:En,keysIn:An,mapKeys:function(e,t){var n={};return t=ja(t),La(e,function(e,r,i){Gt(n,t(e,r,i),e)}),n},mapValues:function(e,t){var n={};return t=ja(t),La(e,function(e,r,i){Gt(n,r,t(e,r,i))}),n},merge:su,mergeWith:os,omit:bu,omitBy:function(e,t){return Su(e,hu(ja(t)))},pick:rc,pickBy:Su,result:function(e,t,n){var r=-1,i=(t=nr(t,e)).length;for(i||(i=1,e=void 0);++r<i;){var o=null==e?void 0:e[rr(t[r])];void 0===o&&(r=i,o=n),e=_e(o)?o.call(e):o}return e},set:function(e,t,n){return null==e?e:Ru(e,t,n)},setWith:function(e,t,n,r){return r="function"==typeof r?r:void 0,null==e?e:Ru(e,t,n,r)},toPairs:_s,toPairsIn:xs,transform:function(e,t,n){var r=ne(e),i=r||pn(e)||Sn(e);if(t=ja(t),null==n){var o=e&&e.constructor;n=i?r?new o:[]:he(e)&&_e(o)?qe(pr(e)):{}}return(i?Rt:La)(e,function(e,r,i){return t(n,e,r,i)}),n},unset:function(e,t){return null==e||vu(e,t)},update:function(e,t,n){return null==e?e:Od(e,t,ys(n))},updateWith:function(e,t,n,r){return r="function"==typeof r?r:void 0,null==e?e:Od(e,t,ys(n),r)},values:gl,valuesIn:function(e){return null==e?[]:pl(e,An(e))}},eh={at:Fd,chain:Ii,commit:function(){return new it(this.value(),this.__chain__)},lodash:lt,next:function(){void 0===this.__values__&&(this.__values__=pu(this.value()));var e=this.__index__>=this.__values__.length;return{done:e,value:e?void 0:this.__values__[this.__index__++]}},plant:function(e){for(var t,n=this;n instanceof Xe;){var r=at(n);r.__index__=0,r.__values__=void 0,t?i.__wrapped__=r:t=r;var i=r;n=n.__wrapped__}return i.__wrapped__=e,t},reverse:function(){var e=this.__wrapped__;if(e instanceof Ze){var t=e;return this.__actions__.length&&(t=new Ze(this)),(t=t.reverse()).__actions__.push({func:dd,args:[xc],thisArg:void 0}),new it(t,this.__chain__)}return this.thru(xc)},tap:function(e,t){return t(e),e},thru:dd,toIterator:function(){return this},toJSON:gd,value:gd,valueOf:gd,wrapperChain:function(){return Ii(this)}},th={camelCase:_i,capitalize:Kr,deburr:Zr,endsWith:function(e,t,n){e=tr(e),t=oe(t);var r=e.length,i=n=void 0===n?r:Ai(Re(n),0,r);return(n-=t.length)>=0&&e.slice(n,i)==t},escape:Is,escapeRegExp:function(e){return(e=tr(e))&&Os.test(e)?e.replace(js,"\\$&"):e},kebabCase:Jl,lowerCase:Ql,lowerFirst:eu,pad:function(e,t,n){e=tr(e);var r=(t=Re(t))?Uu(e):0;if(!t||r>=t)return e;var i=(t-r)/2;return Ju(Xu(i),n)+e+Ju(Yu(i),n)},padEnd:function(e,t,n){e=tr(e);var r=(t=Re(t))?Uu(e):0;return t&&r<t?e+Ju(t-r,n):e},padStart:function(e,t,n){e=tr(e);var r=(t=Re(t))?Uu(e):0;return t&&r<t?Ju(t-r,n)+e:e},parseInt:function(e,t,n){return n||null==t?t=0:t&&(t=+t),Qu(tr(e).replace(Zu,""),t||0)},repeat:function(e,t,n){return t=(n?Qt(e,t,n):void 0===t)?1:Re(t),Ou(tr(e),t)},replace:function(){var e=arguments,t=tr(e[0]);return e.length<3?t:t.replace(e[1],e[2])},snakeCase:Lc,split:function(e,t,n){return n&&"number"!=typeof n&&Qt(e,t,n)&&(t=n=void 0),(n=void 0===n?4294967295:n>>>0)?(e=tr(e))&&("string"==typeof t||null!=t&&!Kl(t))&&!(t=oe(t))&&Mr(e)?Pr(Wr(e),0,n):e.split(t,n):[]},startCase:Kc,startsWith:function(e,t,n){return e=tr(e),n=null==n?0:Ai(Re(n),0,e.length),t=oe(t),e.slice(n,n+t.length)==t},template:function(e,t,n){var r=nd.imports._.templateSettings||nd;n&&Qt(e,t,n)&&(t=void 0),e=tr(e),t=Fn({},t,r,Zc);var i,o,a=Fn({},t.imports,r.imports,Zc),s=En(a),l=pl(a,s),u=0,c=t.interpolate||ld,d="__p += '",h=RegExp((t.escape||ld).source+"|"+c.source+"|"+(c===td?sd:ld).source+"|"+(t.evaluate||ld).source+"|$","g"),f=cd.call(t,"sourceURL")?"//# sourceURL="+(t.sourceURL+"").replace(/\s/g," ")+"\n":"";e.replace(h,function(t,n,r,a,s,l){return r||(r=a),d+=e.slice(u,l).replace(ud,ed),n&&(i=!0,d+="' +\n__e("+n+") +\n'"),s&&(o=!0,d+="';\n"+s+";\n__p += '"),r&&(d+="' +\n((__t = ("+r+")) == null ? '' : __t) +\n'"),u=l+t.length,t}),d+="';\n";var p=cd.call(t,"variable")&&t.variable;if(p){if(ad.test(p))throw new Error("Invalid `variable` option passed into `_.template`")}else d="with (obj) {\n"+d+"\n}\n";d=(o?d.replace(rd,""):d).replace(id,"$1").replace(od,"$1;"),d="function("+(p||"obj")+") {\n"+(p?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(i?", __e = _.escape":"")+(o?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+d+"return __p\n}";var g=Sr(function(){return Function(s,f+"return "+d).apply(void 0,l)});if(g.source=d,wr(g))throw g;return g},templateSettings:nd,toLower:function(e){return tr(e).toLowerCase()},toUpper:function(e){return tr(e).toUpperCase()},trim:function(e,t,n){if((e=tr(e))&&(n||void 0===t))return de(e);if(!e||!(t=oe(t)))return e;var r=Wr(e),i=Wr(t);return Pr(r,yd(r,i),vd(r,i)+1).join("")},trimEnd:function(e,t,n){if((e=tr(e))&&(n||void 0===t))return e.slice(0,ue(e)+1);if(!e||!(t=oe(t)))return e;var r=Wr(e);return Pr(r,0,vd(r,Wr(t))+1).join("")},trimStart:function(e,t,n){if((e=tr(e))&&(n||void 0===t))return e.replace(bd,"");if(!e||!(t=oe(t)))return e;var r=Wr(e);return Pr(r,yd(r,Wr(t))).join("")},truncate:function(e,t){var n=30,r="...";if(he(t)){var i="separator"in t?t.separator:i;n="length"in t?Re(t.length):n,r="omission"in t?oe(t.omission):r}var o=(e=tr(e)).length;if(Mr(e)){var a=Wr(e);o=a.length}if(n>=o)return e;var s=n-Uu(r);if(s<1)return r;var l=a?Pr(a,0,s).join(""):e.slice(0,s);if(void 0===i)return l+r;if(a&&(s+=l.length-s),Kl(i)){if(e.slice(s).search(i)){var u,c=l;for(i.global||(i=RegExp(i.source,tr(Rd.exec(i))+"g")),i.lastIndex=0;u=i.exec(c);)var d=u.index;l=l.slice(0,void 0===d?s:d)}}else if(e.indexOf(oe(i),s)!=s){var h=l.lastIndexOf(i);h>-1&&(l=l.slice(0,h))}return l+r},unescape:function(e){return(e=tr(e))&&Bd.test(e)?e.replace(Sd,wd):e},upperCase:Ad,upperFirst:zr,words:Bi},nh={attempt:Sr,bindAll:Cr,cond:function(e){var t=null==e?0:e.length,n=ja;return e=t?te(e,function(e){if("function"!=typeof e[1])throw new TypeError("Expected a function");return[n(e[0]),e[1]]}):[],Jt(function(n){for(var r=-1;++r<t;){var i=e[r];if(Ke(i[0],this,n))return Ke(i[1],this,n)}})},conforms:function(e){return function(e){var t=En(e);return function(n){return Oa(n,e,t)}}(ea(e,1))},constant:mt,defaultTo:function(e,t){return null==e||e!=e?t:e},flow:el,flowRight:tl,identity:we,iteratee:function(e){return ja("function"==typeof e?e:ea(e,1))},matches:function(e){return Ca(ea(e,1))},matchesProperty:function(e,t){return Ea(e,ea(t,1))},method:lu,methodOf:uu,mixin:cu,noop:Qe,nthArg:function(e){return e=Re(e),Jt(function(t){return gu(t,e)})},over:_u,overEvery:Mu,overSome:Iu,property:Ia,propertyOf:function(e){return function(t){return null==e?void 0:ir(e,t)}},range:wc,rangeRight:Sc,stubArray:qi,stubFalse:cn,stubObject:function(){return{}},stubString:function(){return""},stubTrue:function(){return!0},times:function(e,t){if((e=Re(e))<1||e>9007199254740991)return[];var n=hd,r=fd(e,hd);t=ys(t),e-=hd;for(var i=rn(r,t);++n<e;)t(n);return i},toPath:function(e){return ne(e)?te(e,rr):Q(e)?[e]:ot(er(tr(e)))},uniqueId:function(e){var t=++Ed;return tr(e)+t}};var rh=Math.max,ih=Math.min;var oh=Math.min;
/**
	 * @license
	 * Lodash (Custom Build) <https://lodash.com/>
	 * Build: `lodash modularize exports="es" -o ./`
	 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
	 * Released under MIT license <https://lodash.com/license>
	 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
	 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
	 */
var ah,sh=4294967295,lh=Array.prototype,uh=Object.prototype.hasOwnProperty,ch=G?G.iterator:void 0,dh=Math.max,hh=Math.min,fh=function(e){return function(t,n,r){if(null==r){var i=he(n),o=i&&En(n),a=o&&o.length&&nl(n,o);(a?a.length:i)||(r=n,n=t,t=this)}return e(t,n,r)}}(cu);lt.after=Ud.after,lt.ary=Ud.ary,lt.assign=Qd.assign,lt.assignIn=Qd.assignIn,lt.assignInWith=Qd.assignInWith,lt.assignWith=Qd.assignWith,lt.at=Qd.at,lt.before=Ud.before,lt.bind=Ud.bind,lt.bindAll=nh.bindAll,lt.bindKey=Ud.bindKey,lt.castArray=Vd.castArray,lt.chain=eh.chain,lt.chunk=qd.chunk,lt.compact=qd.compact,lt.concat=qd.concat,lt.cond=nh.cond,lt.conforms=nh.conforms,lt.constant=nh.constant,lt.countBy=zd.countBy,lt.create=Qd.create,lt.curry=Ud.curry,lt.curryRight=Ud.curryRight,lt.debounce=Ud.debounce,lt.defaults=Qd.defaults,lt.defaultsDeep=Qd.defaultsDeep,lt.defer=Ud.defer,lt.delay=Ud.delay,lt.difference=qd.difference,lt.differenceBy=qd.differenceBy,lt.differenceWith=qd.differenceWith,lt.drop=qd.drop,lt.dropRight=qd.dropRight,lt.dropRightWhile=qd.dropRightWhile,lt.dropWhile=qd.dropWhile,lt.fill=qd.fill,lt.filter=zd.filter,lt.flatMap=zd.flatMap,lt.flatMapDeep=zd.flatMapDeep,lt.flatMapDepth=zd.flatMapDepth,lt.flatten=qd.flatten,lt.flattenDeep=qd.flattenDeep,lt.flattenDepth=qd.flattenDepth,lt.flip=Ud.flip,lt.flow=nh.flow,lt.flowRight=nh.flowRight,lt.fromPairs=qd.fromPairs,lt.functions=Qd.functions,lt.functionsIn=Qd.functionsIn,lt.groupBy=zd.groupBy,lt.initial=qd.initial,lt.intersection=qd.intersection,lt.intersectionBy=qd.intersectionBy,lt.intersectionWith=qd.intersectionWith,lt.invert=Qd.invert,lt.invertBy=Qd.invertBy,lt.invokeMap=zd.invokeMap,lt.iteratee=nh.iteratee,lt.keyBy=zd.keyBy,lt.keys=En,lt.keysIn=Qd.keysIn,lt.map=zd.map,lt.mapKeys=Qd.mapKeys,lt.mapValues=Qd.mapValues,lt.matches=nh.matches,lt.matchesProperty=nh.matchesProperty,lt.memoize=Ud.memoize,lt.merge=Qd.merge,lt.mergeWith=Qd.mergeWith,lt.method=nh.method,lt.methodOf=nh.methodOf,lt.mixin=fh,lt.negate=hu,lt.nthArg=nh.nthArg,lt.omit=Qd.omit,lt.omitBy=Qd.omitBy,lt.once=Ud.once,lt.orderBy=zd.orderBy,lt.over=nh.over,lt.overArgs=Ud.overArgs,lt.overEvery=nh.overEvery,lt.overSome=nh.overSome,lt.partial=Ud.partial,lt.partialRight=Ud.partialRight,lt.partition=zd.partition,lt.pick=Qd.pick,lt.pickBy=Qd.pickBy,lt.property=nh.property,lt.propertyOf=nh.propertyOf,lt.pull=qd.pull,lt.pullAll=qd.pullAll,lt.pullAllBy=qd.pullAllBy,lt.pullAllWith=qd.pullAllWith,lt.pullAt=qd.pullAt,lt.range=nh.range,lt.rangeRight=nh.rangeRight,lt.rearg=Ud.rearg,lt.reject=zd.reject,lt.remove=qd.remove,lt.rest=Ud.rest,lt.reverse=qd.reverse,lt.sampleSize=zd.sampleSize,lt.set=Qd.set,lt.setWith=Qd.setWith,lt.shuffle=zd.shuffle,lt.slice=qd.slice,lt.sortBy=zd.sortBy,lt.sortedUniq=qd.sortedUniq,lt.sortedUniqBy=qd.sortedUniqBy,lt.split=th.split,lt.spread=Ud.spread,lt.tail=qd.tail,lt.take=qd.take,lt.takeRight=qd.takeRight,lt.takeRightWhile=qd.takeRightWhile,lt.takeWhile=qd.takeWhile,lt.tap=eh.tap,lt.throttle=Ud.throttle,lt.thru=dd,lt.toArray=Vd.toArray,lt.toPairs=Qd.toPairs,lt.toPairsIn=Qd.toPairsIn,lt.toPath=nh.toPath,lt.toPlainObject=Vd.toPlainObject,lt.transform=Qd.transform,lt.unary=Ud.unary,lt.union=qd.union,lt.unionBy=qd.unionBy,lt.unionWith=qd.unionWith,lt.uniq=qd.uniq,lt.uniqBy=qd.uniqBy,lt.uniqWith=qd.uniqWith,lt.unset=Qd.unset,lt.unzip=qd.unzip,lt.unzipWith=qd.unzipWith,lt.update=Qd.update,lt.updateWith=Qd.updateWith,lt.values=Qd.values,lt.valuesIn=Qd.valuesIn,lt.without=qd.without,lt.words=th.words,lt.wrap=Ud.wrap,lt.xor=qd.xor,lt.xorBy=qd.xorBy,lt.xorWith=qd.xorWith,lt.zip=qd.zip,lt.zipObject=qd.zipObject,lt.zipObjectDeep=qd.zipObjectDeep,lt.zipWith=qd.zipWith,lt.entries=Qd.toPairs,lt.entriesIn=Qd.toPairsIn,lt.extend=Qd.assignIn,lt.extendWith=Qd.assignInWith,fh(lt,lt),lt.add=Jd.add,lt.attempt=nh.attempt,lt.camelCase=th.camelCase,lt.capitalize=th.capitalize,lt.ceil=Jd.ceil,lt.clamp=Yd,lt.clone=Vd.clone,lt.cloneDeep=Vd.cloneDeep,lt.cloneDeepWith=Vd.cloneDeepWith,lt.cloneWith=Vd.cloneWith,lt.conformsTo=Vd.conformsTo,lt.deburr=th.deburr,lt.defaultTo=nh.defaultTo,lt.divide=Jd.divide,lt.endsWith=th.endsWith,lt.eq=Vd.eq,lt.escape=th.escape,lt.escapeRegExp=th.escapeRegExp,lt.every=zd.every,lt.find=zd.find,lt.findIndex=qd.findIndex,lt.findKey=Qd.findKey,lt.findLast=zd.findLast,lt.findLastIndex=qd.findLastIndex,lt.findLastKey=Qd.findLastKey,lt.floor=Jd.floor,lt.forEach=zd.forEach,lt.forEachRight=zd.forEachRight,lt.forIn=Qd.forIn,lt.forInRight=Qd.forInRight,lt.forOwn=Qd.forOwn,lt.forOwnRight=Qd.forOwnRight,lt.get=Qd.get,lt.gt=Vd.gt,lt.gte=Vd.gte,lt.has=Qd.has,lt.hasIn=Qd.hasIn,lt.head=qd.head,lt.identity=we,lt.includes=zd.includes,lt.indexOf=qd.indexOf,lt.inRange=Xd,lt.invoke=Qd.invoke,lt.isArguments=Vd.isArguments,lt.isArray=ne,lt.isArrayBuffer=Vd.isArrayBuffer,lt.isArrayLike=Vd.isArrayLike,lt.isArrayLikeObject=Vd.isArrayLikeObject,lt.isBoolean=Vd.isBoolean,lt.isBuffer=Vd.isBuffer,lt.isDate=Vd.isDate,lt.isElement=Vd.isElement,lt.isEmpty=Vd.isEmpty,lt.isEqual=Vd.isEqual,lt.isEqualWith=Vd.isEqualWith,lt.isError=Vd.isError,lt.isFinite=Vd.isFinite,lt.isFunction=Vd.isFunction,lt.isInteger=Vd.isInteger,lt.isLength=Vd.isLength,lt.isMap=Vd.isMap,lt.isMatch=Vd.isMatch,lt.isMatchWith=Vd.isMatchWith,lt.isNaN=Vd.isNaN,lt.isNative=Vd.isNative,lt.isNil=Vd.isNil,lt.isNull=Vd.isNull,lt.isNumber=Vd.isNumber,lt.isObject=he,lt.isObjectLike=Vd.isObjectLike,lt.isPlainObject=Vd.isPlainObject,lt.isRegExp=Vd.isRegExp,lt.isSafeInteger=Vd.isSafeInteger,lt.isSet=Vd.isSet,lt.isString=Vd.isString,lt.isSymbol=Vd.isSymbol,lt.isTypedArray=Vd.isTypedArray,lt.isUndefined=Vd.isUndefined,lt.isWeakMap=Vd.isWeakMap,lt.isWeakSet=Vd.isWeakSet,lt.join=qd.join,lt.kebabCase=th.kebabCase,lt.last=fs,lt.lastIndexOf=qd.lastIndexOf,lt.lowerCase=th.lowerCase,lt.lowerFirst=th.lowerFirst,lt.lt=Vd.lt,lt.lte=Vd.lte,lt.max=Jd.max,lt.maxBy=Jd.maxBy,lt.mean=Jd.mean,lt.meanBy=Jd.meanBy,lt.min=Jd.min,lt.minBy=Jd.minBy,lt.stubArray=nh.stubArray,lt.stubFalse=nh.stubFalse,lt.stubObject=nh.stubObject,lt.stubString=nh.stubString,lt.stubTrue=nh.stubTrue,lt.multiply=Jd.multiply,lt.nth=qd.nth,lt.noop=nh.noop,lt.now=Kd,lt.pad=th.pad,lt.padEnd=th.padEnd,lt.padStart=th.padStart,lt.parseInt=th.parseInt,lt.random=Zd,lt.reduce=zd.reduce,lt.reduceRight=zd.reduceRight,lt.repeat=th.repeat,lt.replace=th.replace,lt.result=Qd.result,lt.round=Jd.round,lt.sample=zd.sample,lt.size=zd.size,lt.snakeCase=th.snakeCase,lt.some=zd.some,lt.sortedIndex=qd.sortedIndex,lt.sortedIndexBy=qd.sortedIndexBy,lt.sortedIndexOf=qd.sortedIndexOf,lt.sortedLastIndex=qd.sortedLastIndex,lt.sortedLastIndexBy=qd.sortedLastIndexBy,lt.sortedLastIndexOf=qd.sortedLastIndexOf,lt.startCase=th.startCase,lt.startsWith=th.startsWith,lt.subtract=Jd.subtract,lt.sum=Jd.sum,lt.sumBy=Jd.sumBy,lt.template=th.template,lt.times=nh.times,lt.toFinite=Vd.toFinite,lt.toInteger=Re,lt.toLength=Vd.toLength,lt.toLower=th.toLower,lt.toNumber=Vd.toNumber,lt.toSafeInteger=Vd.toSafeInteger,lt.toString=Vd.toString,lt.toUpper=th.toUpper,lt.trim=th.trim,lt.trimEnd=th.trimEnd,lt.trimStart=th.trimStart,lt.truncate=th.truncate,lt.unescape=th.unescape,lt.uniqueId=nh.uniqueId,lt.upperCase=th.upperCase,lt.upperFirst=th.upperFirst,lt.each=zd.forEach,lt.eachRight=zd.forEachRight,lt.first=qd.head,fh(lt,(ah={},La(lt,function(e,t){uh.call(lt.prototype,t)||(ah[t]=e)}),ah),{chain:!1}),lt.VERSION="4.17.23",(lt.templateSettings=th.templateSettings).imports._=lt,Rt(["bind","bindKey","curry","curryRight","partial","partialRight"],function(e){lt[e].placeholder=lt}),Rt(["drop","take"],function(e,t){Ze.prototype[e]=function(n){n=void 0===n?1:dh(Re(n),0);var r=this.__filtered__&&!t?new Ze(this):this.clone();return r.__filtered__?r.__takeCount__=hh(n,r.__takeCount__):r.__views__.push({size:hh(n,sh),type:e+(r.__dir__<0?"Right":"")}),r},Ze.prototype[e+"Right"]=function(t){return this.reverse()[e](t).reverse()}}),Rt(["filter","map","takeWhile"],function(e,t){var n=t+1,r=1==n||3==n;Ze.prototype[e]=function(e){var t=this.clone();return t.__iteratees__.push({iteratee:ja(e),type:n}),t.__filtered__=t.__filtered__||r,t}}),Rt(["head","last"],function(e,t){var n="take"+(t?"Right":"");Ze.prototype[e]=function(){return this[n](1).value()[0]}}),Rt(["initial","tail"],function(e,t){var n="drop"+(t?"":"Right");Ze.prototype[e]=function(){return this.__filtered__?new Ze(this):this[n](1)}}),Ze.prototype.compact=function(){return this.filter(we)},Ze.prototype.find=function(e){return this.filter(e).head()},Ze.prototype.findLast=function(e){return this.reverse().find(e)},Ze.prototype.invokeMap=Jt(function(e,t){return"function"==typeof e?new Ze(this):this.map(function(n){return jl(n,e,t)})}),Ze.prototype.reject=function(e){return this.filter(hu(ja(e)))},Ze.prototype.slice=function(e,t){e=Re(e);var n=this;return n.__filtered__&&(e>0||t<0)?new Ze(n):(e<0?n=n.takeRight(-e):e&&(n=n.drop(e)),void 0!==t&&(n=(t=Re(t))<0?n.dropRight(-t):n.take(t-e)),n)},Ze.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},Ze.prototype.toArray=function(){return this.take(sh)},La(Ze.prototype,function(e,t){var n=/^(?:filter|find|map|reject)|While$/.test(t),r=/^(?:head|last)$/.test(t),i=lt[r?"take"+("last"==t?"Right":""):t],o=r||/^find/.test(t);i&&(lt.prototype[t]=function(){var t=this.__wrapped__,a=r?[1]:arguments,s=t instanceof Ze,l=a[0],u=s||ne(t),c=function(e){var t=i.apply(lt,sr([e],a));return r&&d?t[0]:t};u&&n&&"function"==typeof l&&1!=l.length&&(s=u=!1);var d=this.__chain__,h=!!this.__actions__.length,f=o&&!d,p=s&&!h;if(!o&&u){t=p?t:new Ze(this);var g=e.apply(t,a);return g.__actions__.push({func:dd,args:[c],thisArg:void 0}),new it(g,d)}return f&&p?e.apply(this,a):(g=this.thru(c),f?r?g.value()[0]:g.value():g)})}),Rt(["pop","push","shift","sort","splice","unshift"],function(e){var t=lh[e],n=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",r=/^(?:pop|shift)$/.test(e);lt.prototype[e]=function(){var e=arguments;if(r&&!this.__chain__){var i=this.value();return t.apply(ne(i)?i:[],e)}return this[n](function(n){return t.apply(ne(n)?n:[],e)})}}),La(Ze.prototype,function(e,t){var n=lt[t];if(n){var r=n.name+"";uh.call(tt,r)||(tt[r]=[]),tt[r].push({name:t,func:n})}}),tt[$t(void 0,2).name]=[{name:"wrapper",func:void 0}],Ze.prototype.clone=function(){var e=new Ze(this.__wrapped__);return e.__actions__=ot(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=ot(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=ot(this.__views__),e},Ze.prototype.reverse=function(){if(this.__filtered__){var e=new Ze(this);e.__dir__=-1,e.__filtered__=!0}else(e=this.clone()).__dir__*=-1;return e},Ze.prototype.value=function(){var e=this.__wrapped__.value(),t=this.__dir__,n=ne(e),r=t<0,i=n?e.length:0,o=function(e,t,n){for(var r=-1,i=n.length;++r<i;){var o=n[r],a=o.size;switch(o.type){case"drop":e+=a;break;case"dropRight":t-=a;break;case"take":t=ih(t,e+a);break;case"takeRight":e=rh(e,t-a)}}return{start:e,end:t}}(0,i,this.__views__),a=o.start,s=o.end,l=s-a,u=r?s:a-1,c=this.__iteratees__,d=c.length,h=0,f=oh(l,this.__takeCount__);if(!n||!r&&i==l&&f==l)return pd(e,this.__actions__);var p=[];e:for(;l--&&h<f;){for(var g=-1,m=e[u+=t];++g<d;){var v=c[g],y=v.iteratee,b=v.type,R=y(m);if(2==b)m=R;else if(!R){if(1==b)continue e;break e}}p[h++]=m}return p},lt.prototype.at=eh.at,lt.prototype.chain=eh.wrapperChain,lt.prototype.commit=eh.commit,lt.prototype.next=eh.next,lt.prototype.plant=eh.plant,lt.prototype.reverse=eh.reverse,lt.prototype.toJSON=lt.prototype.valueOf=lt.prototype.value=eh.value,lt.prototype.first=lt.prototype.head,ch&&(lt.prototype[ch]=eh.toIterator)
/**
	 * @license
	 * Lodash (Custom Build) <https://lodash.com/>
	 * Build: `lodash modularize exports="es" -o ./`
	 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
	 * Released under MIT license <https://lodash.com/license>
	 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
	 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
	 */;var ph,gh={};var mh,vh,yh,bh,Rh=(ph||(ph=1,mh=gh,function(){const e="1.2.0";function t(e){alert("Mod ERROR:\n"+e);const t=new Error(e);throw console.error(t),t}const n=new TextEncoder;function r(e){return!!e&&"object"==typeof e&&!Array.isArray(e)}function i(e){const t=new Set;return e.filter(e=>!t.has(e)&&t.add(e))}const o=new Map,a=new Set;function s(e){a.has(e)||(a.add(e),console.warn(e))}function l(e){const t=[],n=new Map,r=new Set;for(const i of h.values()){const o=i.patching.get(e.name);if(o){t.push(...o.hooks);for(const[t,a]of o.patches.entries())n.has(t)&&n.get(t)!==a&&s(`ModSDK: Mod '${i.name}' is patching function ${e.name} with same pattern that is already applied by different mod, but with different pattern:\nPattern:\n${t}\nPatch1:\n${n.get(t)||""}\nPatch2:\n${a}`),n.set(t,a),r.add(i.name)}}t.sort((e,t)=>t.priority-e.priority);const i=function(e,t){if(0===t.size)return e;let n=e.toString().replaceAll("\r\n","\n");for(const[r,i]of t.entries())n.includes(r)||s(`ModSDK: Patching ${e.name}: Patch ${r} not applied`),n=n.replaceAll(r,i);return(0,eval)(`(${n})`)}(e.original,n);let o=function(t){var n,o;const a=null===(o=(n=m.errorReporterHooks).hookChainExit)||void 0===o?void 0:o.call(n,e.name,r),s=i.apply(this,t);return null==a||a(),s};for(let n=t.length-1;n>=0;n--){const r=t[n],i=o;o=function(t){var n,o;const a=null===(o=(n=m.errorReporterHooks).hookEnter)||void 0===o?void 0:o.call(n,e.name,r.mod),s=r.hook.apply(this,[t,e=>{if(1!==arguments.length||!Array.isArray(t))throw new Error(`Mod ${r.mod} failed to call next hook: Expected args to be array, got ${typeof e}`);return i.call(this,e)}]);return null==a||a(),s}}return{hooks:t,patches:n,patchesSources:r,enter:o,final:i}}function u(e,t=!1){let i=o.get(e);if(i)t&&(i.precomputed=l(i));else{let t=window;const a=e.split(".");for(let n=0;n<a.length-1;n++)if(t=t[a[n]],!r(t))throw new Error(`ModSDK: Function ${e} to be patched not found; ${a.slice(0,n+1).join(".")} is not object`);const s=t[a[a.length-1]];if("function"!=typeof s)throw new Error(`ModSDK: Function ${e} to be patched not found`);const u=function(e){let t=-1;for(const r of n.encode(e)){let e=255&(t^r);for(let t=0;t<8;t++)e=1&e?-306674912^e>>>1:e>>>1;t=t>>>8^e}return((-1^t)>>>0).toString(16).padStart(8,"0").toUpperCase()}(s.toString().replaceAll("\r\n","\n")),c={name:e,original:s,originalHash:u};i=Object.assign(Object.assign({},c),{precomputed:l(c),router:()=>{},context:t,contextProperty:a[a.length-1]}),i.router=function(e){return function(...t){return e.precomputed.enter.apply(this,[t])}}(i),o.set(e,i),t[i.contextProperty]=i.router}return i}function c(){for(const e of o.values())e.precomputed=l(e)}function d(){const e=new Map;for(const[t,n]of o)e.set(t,{name:t,original:n.original,originalHash:n.originalHash,sdkEntrypoint:n.router,currentEntrypoint:n.context[n.contextProperty],hookedByMods:i(n.precomputed.hooks.map(e=>e.mod)),patchedByMods:Array.from(n.precomputed.patchesSources)});return e}const h=new Map;function f(e){h.get(e.name)!==e&&t(`Failed to unload mod '${e.name}': Not registered`),h.delete(e.name),e.loaded=!1,c()}function p(e,n){e&&"object"==typeof e||t("Failed to register mod: Expected info object, got "+typeof e),"string"==typeof e.name&&e.name||t("Failed to register mod: Expected name to be non-empty string, got "+typeof e.name);let i=`'${e.name}'`;"string"==typeof e.fullName&&e.fullName||t(`Failed to register mod ${i}: Expected fullName to be non-empty string, got ${typeof e.fullName}`),i=`'${e.fullName} (${e.name})'`,"string"!=typeof e.version&&t(`Failed to register mod ${i}: Expected version to be string, got ${typeof e.version}`),e.repository||(e.repository=void 0),void 0!==e.repository&&"string"!=typeof e.repository&&t(`Failed to register mod ${i}: Expected repository to be undefined or string, got ${typeof e.version}`),null==n&&(n={}),n&&"object"==typeof n||t(`Failed to register mod ${i}: Expected options to be undefined or object, got ${typeof n}`);const o=!0===n.allowReplace,a=h.get(e.name);a&&(a.allowReplace&&o||t(`Refusing to load mod ${i}: it is already loaded and doesn't allow being replaced.\nWas the mod loaded multiple times?`),f(a));const s=e=>{let t=p.patching.get(e.name);return t||(t={hooks:[],patches:new Map},p.patching.set(e.name,t)),t},l=(e,n)=>(...r)=>{var o,a;const s=null===(a=(o=m.errorReporterHooks).apiEndpointEnter)||void 0===a?void 0:a.call(o,e,p.name);p.loaded||t(`Mod ${i} attempted to call SDK function after being unloaded`);const l=n(...r);return null==s||s(),l},d={unload:l("unload",()=>f(p)),hookFunction:l("hookFunction",(e,n,r)=>{"string"==typeof e&&e||t(`Mod ${i} failed to patch a function: Expected function name string, got ${typeof e}`);const o=u(e),a=s(o);"number"!=typeof n&&t(`Mod ${i} failed to hook function '${e}': Expected priority number, got ${typeof n}`),"function"!=typeof r&&t(`Mod ${i} failed to hook function '${e}': Expected hook function, got ${typeof r}`);const l={mod:p.name,priority:n,hook:r};return a.hooks.push(l),c(),()=>{const e=a.hooks.indexOf(l);e>=0&&(a.hooks.splice(e,1),c())}}),patchFunction:l("patchFunction",(e,n)=>{"string"==typeof e&&e||t(`Mod ${i} failed to patch a function: Expected function name string, got ${typeof e}`);const o=u(e),a=s(o);r(n)||t(`Mod ${i} failed to patch function '${e}': Expected patches object, got ${typeof n}`);for(const[r,o]of Object.entries(n))"string"==typeof o?a.patches.set(r,o):null===o?a.patches.delete(r):t(`Mod ${i} failed to patch function '${e}': Invalid format of patch '${r}'`);c()}),removePatches:l("removePatches",e=>{"string"==typeof e&&e||t(`Mod ${i} failed to patch a function: Expected function name string, got ${typeof e}`);const n=u(e);s(n).patches.clear(),c()}),callOriginal:l("callOriginal",(e,n,r)=>{"string"==typeof e&&e||t(`Mod ${i} failed to call a function: Expected function name string, got ${typeof e}`);const o=u(e);return Array.isArray(n)||t(`Mod ${i} failed to call a function: Expected args array, got ${typeof n}`),o.original.apply(null!=r?r:globalThis,n)}),getOriginalHash:l("getOriginalHash",e=>("string"==typeof e&&e||t(`Mod ${i} failed to get hash: Expected function name string, got ${typeof e}`),u(e).originalHash))},p={name:e.name,fullName:e.fullName,version:e.version,repository:e.repository,allowReplace:o,api:d,loaded:!0,patching:new Map};return h.set(e.name,p),Object.freeze(d)}function g(){const e=[];for(const t of h.values())e.push({name:t.name,fullName:t.fullName,version:t.version,repository:t.repository});return e}let m;const v=void 0===window.bcModSdk?window.bcModSdk=function(){const t={version:e,apiVersion:1,registerMod:p,getModsInfo:g,getPatchingInfo:d,errorReporterHooks:Object.seal({apiEndpointEnter:null,hookEnter:null,hookChainExit:null})};return m=t,Object.freeze(t)}():(r(window.bcModSdk)||t("Failed to init Mod SDK: Name already in use"),1!==window.bcModSdk.apiVersion&&t(`Failed to init Mod SDK: Different version already loaded ('1.2.0' vs '${window.bcModSdk.version}')`),window.bcModSdk.version!==e&&alert(`Mod SDK warning: Loading different but compatible versions ('1.2.0' vs '${window.bcModSdk.version}')\nOne of mods you are using is using an old version of SDK. It will work for now but please inform author to update`),window.bcModSdk);Object.defineProperty(mh,"__esModule",{value:!0}),mh.default=v}()),gh),wh=r(Rh);const Sh=Array.isArray,Bh=Object.keys,kh=Object.entries,Ch=Object.fromEntries;function _h(e,t){return e.includes(t)}const xh=Number.isInteger;vh=new WeakSet,yh=function(e,t){const n=new Date(Date.now());console[e]("MBS:",...t),this.push({date:n,level:e,args:t})};const Ph=new class extends Array{constructor(){super(...arguments),vh.add(this)}debug(...e){L(this,vh,"m",yh).call(this,"debug",e)}log(...e){L(this,vh,"m",yh).call(this,"log",e)}warn(...e){L(this,vh,"m",yh).call(this,"warn",e)}error(...e){L(this,vh,"m",yh).call(this,"error",e)}};function Eh(e,t,n=Number.MIN_SAFE_INTEGER,r=Number.MAX_SAFE_INTEGER,i=null){if(i=null==i?"":`${i}: `,!(Number.isInteger(e)&&e>=n&&e<=r))throw"number"!=typeof e?new TypeError(`${i}Invalid "${t}" type: ${typeof e}`):Number.isInteger(e)?new RangeError(`${i}"${t}" must fall in the [${n}, ${r}] interval: ${e}`):new Error(`${i}"${t}" must be an integer: ${e}`)}function Mh(e,t){let n=`${e}(`;return n+=Object.values(t).map(e=>String(e)).join(", "),n+=")",n}const Ih=/^(v?)([0-9]+)\.([0-9]+)\.([0-9]+)(\.\S+)?$/;class jh{constructor(e=0,t=0,n=0,r=!1){if(bh.set(this,void 0),Eh(e,"major",0,65535),Eh(t,"minor",0,65535),Eh(n,"micro",0,65535),"boolean"!=typeof r)throw new TypeError('Invalid "beta" type: '+typeof r);this.major=e,this.minor=t,this.micro=n,this.beta=r,T(this,bh,[e,t,n].map(e=>String.fromCharCode(e))+String.fromCharCode(r?0:1),"f"),Object.freeze(this)}equal(e){return e instanceof jh&&this.valueOf()===e.valueOf()}greater(e){return e instanceof jh&&this.valueOf()>e.valueOf()}lesser(e){return e instanceof jh&&this.valueOf()<e.valueOf()}greaterOrEqual(e){return e instanceof jh&&this.valueOf()>=e.valueOf()}lesserOrEqual(e){return e instanceof jh&&this.valueOf()<=e.valueOf()}static fromVersion(e){const t=Ih.exec(e);if(null===t)throw new Error(`Invalid "version": ${e}`);return new jh(Number(t[2]),Number(t[3]),Number(t[4]),void 0!==t[5])}static fromBCVersion(e){const t=GameVersionFormat.exec(e);if(null===t)throw new Error(`Invalid BC version: "${e}"`);return new jh(Number(t[1]),0,0,void 0!==t[2])}toString(){return Mh(typeof this,this.toJSON())}valueOf(){return L(this,bh,"f")}toJSON(){return{major:this.major,minor:this.minor,micro:this.micro,beta:this.beta}}}bh=new WeakMap;const Oh=["api","backgrounds","backport","changelog","crafting","equipper","fortune_wheel","garbling","mbs","new_items_screen","preset_screen","settings","settings_screen"];const Ah=new class{constructor(){this.allNames=Object.freeze(new Set(Oh)),this.expectedNames=new Set(this.allNames),this.names=new Set,this.afterLoad={},this.afterLogin={},this.afterMBS={}}toJSON(){return{allNames:Array.from(this.allNames).sort(),afterLoad:Object.keys(this.afterLoad).sort(),afterLogin:Object.keys(this.afterLogin).sort(),afterMBS:Object.keys(this.afterMBS).sort()}}};async function $h(){await GameReadyState.load;const e=globalThis.GameVersion;if("string"!=typeof e||!GameVersionFormat.test(e))return Ph.error(`Detected an invalid BC version: "${e}"`),Ph.log("Unloading MBS from Mod SDK"),Kh.unload(),void(void 0!==e&&window.alert(`Aborting MBS initialization\nMBS ${t} detected an invalid BC version: "${e}"`));const n=jh.fromBCVersion(e),r=jh.fromBCVersion("R124");if(n.lesser(r))return Ph.error(`BC version "R124" or later required; detected "${e}"`),Ph.log("Unloading MBS from Mod SDK"),Kh.unload(),void window.alert(`Aborting MBS initialization\nMBS ${t} requires BC version "R124" or later\nDetected BC version: "${e}"`);Ph.log(`Detected BC ${e}`),Ph.debug("Executing afterLoad hooks",Object.keys(Ah.afterLoad).sort()),await Promise.all(Object.values(Ah.afterLoad).map(e=>e())),await ServerIsLoggedInAsync(),Ph.debug("Executing afterLogin hooks",Object.keys(Ah.afterLogin).sort()),await Promise.all(Object.values(Ah.afterLogin).map(e=>e())),Ph.debug("Executing afterMBS hooks",Object.keys(Ah.afterMBS).sort()),await Promise.all(Object.values(Ah.afterMBS).map(e=>e()))}function Fh(e,t){if(Ah.names.has(e))throw new Error(`BC listener "${e}" has already been registered`);if(!Ah.expectedNames.has(e))throw new Error(`Unknown BC listener: "${e}"`);return Ah.names.add(e),Ah.expectedNames.delete(e),t.afterLoad&&(Ah.afterLoad[e]=t.afterLoad),t.afterLogin&&(Ah.afterLogin[e]=t.afterLogin),t.afterMBS&&(Ah.afterMBS[e]=t.afterMBS),0===Ah.expectedNames.size&&("complete"===document.readyState?$h():globalThis.addEventListener("load",$h),!0)}var Lh,Th,Dh,Hh;const Nh=Object.freeze(["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"]);function Gh(e,t,n){if(Eh(t,"n",0),!Array.isArray(e))throw new TypeError('Invalid "list" type: '+typeof e);const r=t-e.length;return r>0&&e.push(...Array(r).fill(n)),e}function Wh(e,t){if(Eh(t,"n",0),!Array.isArray(e))throw new TypeError('Invalid "list" type: '+typeof e);const n=e.length-t;return n>0&&e.splice(t,n),e}function qh(e){return Eh(e,"n",0,8),wc(0,e).map(e=>Ic(Nh)).join("")}const zh=Object.freeze({name:"MBS",fullName:"Maid's Bondage Scripts",repository:"https://github.com/bananarama92/MBS",version:t}),Kh=wh.registerMod(zh);Lh=new WeakMap,Th=new WeakMap;const Uh=new class{constructor(){Lh.set(this,null),Th.set(this,!1)}get api(){if(null!==L(this,Lh,"f"))return L(this,Lh,"f");if("undefined"==typeof bcx||!CommonIsObject(bcx))return L(this,Th,"f")||(T(this,Th,!0,"f"),Ph.debug("Failed to detect BCX")),L(this,Lh,"f");const e=bcx.versionParsed??{};return 1===e.major&&e.minor>=1&&(e.minor>1||e.patch>=7)?(L(this,Th,"f")||(T(this,Th,!0,"f"),Ph.debug(`Detecting supported BCX version ${bcx.version}`)),T(this,Lh,bcx.getModApi("MBS"),"f")):(L(this,Th,"f")||(T(this,Th,!0,"f"),Ph.debug(`Detecting unsupported BCX version ${bcx.version}; requires [1.1.7, 2.0)`)),L(this,Lh,"f"))}get modName(){return"MBS"}getRuleState(e){return this.api?.getRuleState(e)??null}getCurseInfo(e){return this.api?.getCurseInfo(e)??null}sendQuery(e,t,n,r){return this.api?.sendQuery(e,t,n,r)??Promise.resolve(null)}on(e,t){return this.api?.on(e,t)??(()=>{})}onAny(e){return this.api?.onAny(e)??(()=>{})}};class Vh{get index(){return L(this,Hh,"f")}set index(e){this.setPosition(e)}get value(){return L(this,Dh,"f")[L(this,Hh,"f")]}get list(){return L(this,Dh,"f")}constructor(e,t=0){if(Dh.set(this,void 0),Hh.set(this,void 0),!Yh(e))throw new TypeError('Invalid "iterable" type: '+typeof e);const n=Object.freeze([...e]);if(0===n.length)throw new Error('Passed "iterable" must contain at least one element');Eh(t,"index",0,n.length-1),T(this,Dh,n,"f"),T(this,Hh,t,"f")}*[(Dh=new WeakMap,Hh=new WeakMap,Symbol.iterator)](){for(;;)yield this.next()}next(e=!0){const t=(L(this,Hh,"f")+1)%L(this,Dh,"f").length;return e&&T(this,Hh,t,"f"),L(this,Dh,"f")[t]}previous(e=!0){const t=(L(this,Hh,"f")+L(this,Dh,"f").length-1)%L(this,Dh,"f").length;return e&&T(this,Hh,t,"f"),L(this,Dh,"f")[t]}setPosition(e){Eh(e,"index",0,L(this,Dh,"f").length-1),T(this,Hh,e,"f")}toString(){return Mh(typeof this,this.toJSON())}toJSON(){return{list:this.list,index:this.index}}}function Jh(e,t){if(Eh(e,"start",0,65535),!Sh(t))throw new TypeError('Invalid "indices" type: '+typeof t);const n=e+Math.max(0,...t)+1;Eh(n,"stop",e+1,65535);const r=wc(e,n);return t.map(e=>String.fromCharCode(r[e]))}function Yh(e){return Symbol.iterator in Object(e)}const Xh=Object.freeze(Object.fromEntries([["CraftingSaveServer",["025B434F"]],["CraftingClick",["518ADD1E"]],["CraftingRun",["2FDBFF13"]],["SpeechTransformProcess",["666DDA2F"]],["SpeechTransformGagGarble",["691A05BF"]],["WheelFortuneLoad",["58E058DD"]],["WheelFortuneClick",["D368BBF2"]],["WheelFortuneRun",["D4DF7BB8"]],["WheelFortuneMouseUp",["887E5D09"]],["WheelFortuneMouseDown",["78354D35"]],["WheelFortuneCustomizeLoad",["7A8DD30D"]],["WheelFortuneDrawWheel",["B21DAEA9"]]].map(e=>{const[t,n]=e,r=new Set(n.filter(e=>null!=e));return[t,Object.freeze(r)]})));function Zh(){const e=function(){const e=jh.fromVersion(t),n=`#v${e.major}${e.minor}${e.micro}`;return e.beta?["blob/devel",""]:["blob/main",n]}();return`https://github.com/bananarama92/MBS/${e[0]}/CHANGELOG.md${e[1]}`}async function Qh(e,n=null){const r=document.getElementById("mbs-changelog");if(r){if(r.getAttribute("data-start")===e&&r.getAttribute("data-stop")===n)return r.remove(),void ChatRoomAppendChat(r);r.remove()}const i=jh.fromVersion(t).beta?"devel":"main",o='<h1 id="mbs-changelog">MBS Changelog</h1>\n<h2 id="v11010">v1.10.10</h2>\n<ul>\n<li>Fix an issue wherein the MBS settings page could potentially be accessed before MBS had finished loading</li>\n<li>Fix the size of the local crafting info button</li>\n<li>Remove dead BC R120 code</li>\n<li>Add BC R125Beta1 support</li>\n</ul>\n<h2 id="v1109">v1.10.9</h2>\n<ul>\n<li>Drop BC R123 support</li>\n<li>Fix checking for the <code>complete</code> readystate rather than <code>interactive</code></li>\n<li>Fix Listening for the <code>load</code> event on the window rather than document</li>\n<li>Fix a few BC asset group look ups potentially firing before BC is fully loaded</li>\n</ul>\n<h2 id="v1108">v1.10.8</h2>\n<ul>\n<li>Drop BC R122 support</li>\n<li>Add BC R124Beta1 support</li>\n</ul>\n<h2 id="v1107">v1.10.7</h2>\n<ul>\n<li>Add BC R123Beta1 support</li>\n</ul>\n<h2 id="v1106">v1.10.6</h2>\n<ul>\n<li>Drop BC R121 support</li>\n<li>Backport three R123 bug fixes:<ul>\n<li><a href="https://gitgud.io/BondageProjects/Bondage-College/-/merge_requests/6033">BondageProjects/Bondage-College#6033</a>: Fix the color spin buttons in the item color menu failing to switch to the next color</li>\n<li><a href="https://gitgud.io/BondageProjects/Bondage-College/-/merge_requests/6035">BondageProjects/Bondage-College#6035</a>: Fix the missing entries for the minigame&#39;s administration screens</li>\n<li><a href="https://gitgud.io/BondageProjects/Bondage-College/-/merge_requests/6036">BondageProjects/Bondage-College#6036</a>: Fix opening the color picker resetting layer opacities if the layers have distinct values</li>\n</ul>\n</li>\n</ul>\n<h2 id="v1105">v1.10.5</h2>\n<ul>\n<li>Add BC R122Beta1 support</li>\n<li>Explicitly mark the &quot;filter by BC version&quot; dropdown in the shop as originating from MBS</li>\n</ul>\n<h2 id="v1104">v1.10.4</h2>\n<ul>\n<li>Drop BC R120 support</li>\n<li>Fix MBS local crafts only populating the player&#39;s crafting list after opening the crafting screen</li>\n<li>Remove a redundant <code>PreferenceExit()</code> call</li>\n<li>Prevent to MBS server crafts from migrating multiple times to base BC</li>\n<li>Backport one BC R121 hotfix:<ul>\n<li><a href="https://gitgud.io/BondageProjects/Bondage-College/-/merge_requests/5918">BondageProjects/Bondage-College#5918</a>: Fix crafting data failing to properly sync between players</li>\n</ul>\n</li>\n</ul>\n<h2 id="v1103">v1.10.3</h2>\n<ul>\n<li>Move all MBS server crafts to BC starting from the full C R121 (non-beta) release<ul>\n<li>Starting from the full BC R121 release all &quot;MBS (Account)&quot; crafted items will be moved to base BC, utilizing its increase in crafting slot (from 80 to 200).\nAs a reminder: ensure that enough empty slots remain available for the migration.</li>\n</ul>\n</li>\n<li>Increase the max number of local MBS crafting slots from 160 to 600</li>\n<li>Add support for BC R121Beta1</li>\n<li>Fix an issue wherein registering MBS wheel of fortune listeners could crash if BC is insufficiently loaded at that point</li>\n<li>Ensure that the extensions preference subscreen is re-opened via <code>PreferenceOpenSubscreen()</code></li>\n</ul>\n<h2 id="v1102">v1.10.2</h2>\n<ul>\n<li>Vendor the ES module version of Dexie in order to circumvent its version check<ul>\n<li>Prevents Dexie&#39;s &quot;Two different versions of Dexie loaded in the same&quot; error from popping up if addons happen to be using mismatched versions</li>\n</ul>\n</li>\n</ul>\n<h2 id="v1101">v1.10.1</h2>\n<ul>\n<li>Fix MBS server-stored crafts failing to load</li>\n</ul>\n<h2 id="v1100">v1.10.0</h2>\n<ul>\n<li>Add the ability to save crafted items locally in your browser. Note that these crafts are exclusive to a specific combination of BC account, web browser and BC server (<em>i.e.</em> no mixing of the US, EU and Asia servers)</li>\n<li>Provide increased clarification as to whether a craft is from base BC, MBS (server-stored) or MBS (locally-stored)</li>\n<li>Ensure that the crafting JSON exporter also exports the extra MBS crafts</li>\n<li>Drop BC R119 support</li>\n</ul>\n<h2 id="v196">v1.9.6</h2>\n<ul>\n<li>Add BC R120Beta1 support</li>\n</ul>\n<h2 id="v195">v1.9.5</h2>\n<ul>\n<li>Drop BC R118 support</li>\n<li>Ensure that the wheel of fortune does not try to remove BCX-cursed items or any items made unreachable by BCX-cursed items</li>\n<li>Fix <code>mbs.css</code> API calls failing to correctly apply their styling to buttons in a number of cases</li>\n<li>Fix checkbox marks persisting after hiding an MBS screen</li>\n</ul>\n<h2 id="v194">v1.9.4</h2>\n<ul>\n<li>Add BC R119 support</li>\n<li>Drop R117 support</li>\n</ul>\n<h2 id="v193">v1.9.3</h2>\n<ul>\n<li>Add BC R118Beta1 support</li>\n<li>Backport one BC R118 bug fix:<ul>\n<li><a href="https://gitgud.io/BondageProjects/Bondage-College/-/merge_requests/5674">BondageProjects/Bondage-College#5674</a>: Fix <code>ExtendedItemSetOptionByRecord()</code> unconditionally failing to handle non-extended items</li>\n</ul>\n</li>\n</ul>\n<h2 id="v192">v1.9.2</h2>\n<ul>\n<li>Drop R116 support</li>\n<li>Fix the cancel button being disabled when creating a new wheel item set</li>\n</ul>\n<h2 id="v191">v1.9.1</h2>\n<ul>\n<li>Add BC R117Beta1 support</li>\n<li>Fix an issue wherein the wheel of fortune preview character would fail to render</li>\n</ul>\n<h2 id="v190">v1.9.0</h2>\n<ul>\n<li>Backport the crafting mass import + export functionality<ul>\n<li><a href="https://gitgud.io/BondageProjects/Bondage-College/-/merge_requests/5618">BondageProjects/Bondage-College#5618</a>: Add an importer + exporter for entire crafting inventories\n<img src="static/images/craft_mass_import.png" alt="Crafting import"></li>\n</ul>\n</li>\n</ul>\n<h2 id="v184">v1.8.4</h2>\n<ul>\n<li>Add support for BC R116Beta1</li>\n<li>Fix the <code>Opacity</code> item property not being considered legal for clothes</li>\n<li>Fix the &quot;Parse&quot; button in the fortune wheel customization menu raising if the name is empty</li>\n</ul>\n<h2 id="v183">v1.8.3</h2>\n<ul>\n<li>Adapt the mobile button tooltip patch to a BC hotfix</li>\n</ul>\n<h2 id="v182">v1.8.2</h2>\n<ul>\n<li>Wheel event API:<ul>\n<li>Fix the example mod names as used in the readme</li>\n<li>Clean up the styling of various kwarg-related DOM elements</li>\n<li>Fix default values of <code>number</code> kwarg inputs failing to be assigned</li>\n<li>Fix a failure to look up the original kwarg config</li>\n<li>Fix <code>number</code> kwargs improperly checking for finite values</li>\n<li>Make the wheel event registration logic more strict w.r.t. checking for MBS-esque names</li>\n</ul>\n</li>\n</ul>\n<h2 id="v181">v1.8.1</h2>\n<ul>\n<li>Fix a crash when creating a new wheel outfit</li>\n<li>Fix wheel of fortune hook kwargs not being initially disabled when creating new item sets</li>\n</ul>\n<h2 id="v180">v1.8.0</h2>\n<ul>\n<li>Drop support for BC R114</li>\n<li>Add support for building MBS with Node &gt;=22</li>\n<li>Make MBS&#39;s load system a bit more robust w.r.t. BC load errors</li>\n<li>Refactor the MBS&#39;s wheel of fortune outfit equipping logic, switching to an event-based structure</li>\n<li>Add the ability to register and use third-party, external addon-specific options when spinning the wheel of fortune. Such options can be used if the following three conditions are fulfilled:<ul>\n<li>An addon registers its own custom options for MBS</li>\n<li>The wheel owner enables and configures aforementioned option(s)</li>\n<li>The wheel spinner has the relevant third-party addon enabled and spins\n<img src="static/images/addon_config.png" alt="New items"></li>\n</ul>\n</li>\n<li>The MBS public API has been incremented to version 1.5, exposing a new <code>mbs.wheelEvents</code> namespace for registering wheel event listeners (see the API <a href="https://github.com/bananarama92/MBS/tree/main/api#readme">README</a> file for a few examples)</li>\n</ul>\n<h2 id="v1746">v1.7.46</h2>\n<ul>\n<li>Remove all reference to the old extended crafted description feature as it&#39;s been available in unmodded Bondage Club ever since R109 (see the crafting screen)</li>\n<li>Fix a <a href="https://gitgud.io/BondageProjects/Bondage-College/-/merge_requests/5347">BondageProjects/Bondage-College#5347</a> backport making player names in the chat log unselectable</li>\n</ul>\n<h2 id="v1745">v1.7.45</h2>\n<ul>\n<li>Fix a crash due to an invalid CSS selector in the MBS settings screen</li>\n<li>Fix a <a href="https://gitgud.io/BondageProjects/Bondage-College/-/merge_requests/5347">BondageProjects/Bondage-College#5347</a> backport crash due to usage of an invalid event listener</li>\n</ul>\n<h2 id="v1744">v1.7.44</h2>\n<ul>\n<li>Add BC R115Beta1 support</li>\n<li>Relax the validation of min/max opacities in wheel of fortune outfits</li>\n<li>Ensure that wheel-equipped crafted items are attributed to the wheel owner</li>\n<li>Backport one R115 BC change:<ul>\n<li><a href="https://gitgud.io/BondageProjects/Bondage-College/-/merge_requests/5347">BondageProjects/Bondage-College#5347</a>: Show DOM button tooltips on mobile after touching them for 300 ms</li>\n</ul>\n</li>\n</ul>\n<h2 id="v1743">v1.7.43</h2>\n<ul>\n<li>Drop R113 support and add full R114 support</li>\n</ul>\n<h2 id="v1742">v1.7.42</h2>\n<ul>\n<li>Expand the number of supported wheel of fortune item properties<ul>\n<li>Includes, among others, expanded item opacity support</li>\n</ul>\n</li>\n<li>Add BC R114Beta1 support</li>\n<li>Backport two BC R114 fixes:<ul>\n<li><a href="https://gitgud.io/BondageProjects/Bondage-College/-/merge_requests/5438">BondageProjects/Bondage-College#5438</a>: Stop the tongue piercing gag from blocking its own group</li>\n<li><a href="https://gitgud.io/BondageProjects/Bondage-College/-/merge_requests/5440">BondageProjects/Bondage-College#5440</a>: Fix the wheel of fortune potentially initializing to the wrong character</li>\n<li><a href="https://gitgud.io/BondageProjects/Bondage-College/-/merge_requests/5447">BondageProjects/Bondage-College#5447</a>: Fix <code>CommonDynamicFunctionParams()</code> incorrectly parsing parameters of length 0</li>\n</ul>\n</li>\n</ul>\n<h2 id="v1741">v1.7.41</h2>\n<ul>\n<li>Backport three BC R114 fixes:<ul>\n<li><a href="https://gitgud.io/BondageProjects/Bondage-College/-/merge_requests/5433">BondageProjects/Bondage-College#5433</a>: Make the <code>dialog</code> status scroll + expand upon overflow rather than clamping</li>\n<li><a href="https://gitgud.io/BondageProjects/Bondage-College/-/merge_requests/5429">BondageProjects/Bondage-College#5429</a>: Fix password padlock drawing hint text with last assigned color</li>\n<li><a href="https://gitgud.io/BondageProjects/Bondage-College/-/merge_requests/5432">BondageProjects/Bondage-College#5432</a>: Connect normalize</li>\n</ul>\n</li>\n</ul>\n<h2 id="v1740">v1.7.40</h2>\n<ul>\n<li>Drop R112 support</li>\n<li>Restructure the way MBS handles the detection of BC and BC logins</li>\n<li>Misc cleanup of the MBS settings screen</li>\n<li>Backport two R113 hotfixes:<ul>\n<li><a href="https://gitgud.io/BondageProjects/Bondage-College/-/merge_requests/5410">BondageProjects/Bondage-College#5410</a>: Ensures that updating <code>C.Stage</code> and <code>C.CurrentDialog</code> triggers an appropriate dialog menu reload</li>\n<li><a href="https://gitgud.io/BondageProjects/Bondage-College/-/merge_requests/5412">BondageProjects/Bondage-College#5412</a>: Fix <code>ElementButton</code> creator function failing to properly expand the <code>options.icons</code> array</li>\n</ul>\n</li>\n</ul>\n<h2 id="v1739">v1.7.39</h2>\n<ul>\n<li>Update build dependencies</li>\n<li>Add BC R113Beta1 support</li>\n</ul>\n<h2 id="v1738">v1.7.38</h2>\n<ul>\n<li>Fix the players <code>FocusGroup</code> grid persisting after performing an activity</li>\n</ul>\n<h2 id="v1737">v1.7.37</h2>\n<ul>\n<li>Backport two more R113 fixes:<ul>\n<li><a href="https://gitgud.io/BondageProjects/Bondage-College/-/merge_requests/5383">BondageProjects/Bondage-College#5383</a>: Misc chat-related styling changes</li>\n<li><a href="https://gitgud.io/BondageProjects/Bondage-College/-/merge_requests/5389">BondageProjects/Bondage-College#5389</a>: Fix <code>DialogLeave()</code> clearing the player&#39;s focus group if there&#39;s no current character</li>\n</ul>\n</li>\n</ul>\n<h2 id="v1736">v1.7.36</h2>\n<ul>\n<li>Backport two R113 fixes:<ul>\n<li><a href="https://gitgud.io/BondageProjects/Bondage-College/-/merge_requests/5377">BondageProjects/Bondage-College#5377</a>: Fix an issue wherein the focus group could be <code>null</code></li>\n<li><a href="https://gitgud.io/BondageProjects/Bondage-College/-/merge_requests/5378">BondageProjects/Bondage-College#5378</a>: Fix more unintended dialog refreshes</li>\n</ul>\n</li>\n</ul>\n<h2 id="v1735">v1.7.35</h2>\n<ul>\n<li>Drop R110 support</li>\n<li>Forcefully set the <code>&lt;select&gt;</code>-element text color to black (affects specific browsers such as iOS Safari)</li>\n<li>Add R112Beta1 support</li>\n<li>Backport five R112 changes to R111:<ul>\n<li><a href="https://gitgud.io/BondageProjects/Bondage-College/-/merge_requests/5309">BondageProjects/Bondage-College#5309</a>: Add styling for un-toggleable radio buttons</li>\n<li><a href="https://gitgud.io/BondageProjects/Bondage-College/-/merge_requests/5348">BondageProjects/Bondage-College#5348</a>: Ensure that crafted items are first sorted by asset name and then custom craft name</li>\n<li><a href="https://gitgud.io/BondageProjects/Bondage-College/-/merge_requests/5349">BondageProjects/Bondage-College#5349</a>: Change the crafting description text-alignment to <code>left</code></li>\n<li><a href="https://gitgud.io/BondageProjects/Bondage-College/-/merge_requests/5357">BondageProjects/Bondage-College#5357</a>: Provide better DOM element support for older browsers</li>\n<li><a href="https://gitgud.io/BondageProjects/Bondage-College/-/merge_requests/5360">BondageProjects/Bondage-College#5360</a>: Fix the padlock validation failing to properly validate the <code>Lock</code> effect</li>\n</ul>\n</li>\n<li>Backport one R112-Beta2 change to R112-Beta1:<ul>\n<li><a href="https://gitgud.io/BondageProjects/Bondage-College/-/merge_requests/5364">BondageProjects/Bondage-College#5364</a>: Do not set the button aria-labelledby/describedby attribute if there&#39;s no tooltip</li>\n</ul>\n</li>\n</ul>\n<h2 id="v1734">v1.7.34</h2>\n<ul>\n<li>Fix the MBS changelog showing up more than intended</li>\n<li>Add R111Beta1 support</li>\n</ul>\n<h2 id="v1733">v1.7.33</h2>\n<ul>\n<li>Backport four R111 bug fixes:<ul>\n<li><a href="https://gitgud.io/BondageProjects/Bondage-College/-/merge_requests/5264">BondageProjects/Bondage-College#5264</a>: Ensure that voice-triggered auto-punishments more thoroughly check for OOC blocks</li>\n<li><a href="https://gitgud.io/BondageProjects/Bondage-College/-/merge_requests/5272">BondageProjects/Bondage-College#5272</a>: Silence deprecation warning about mobile-web-app-capable</li>\n<li><a href="https://gitgud.io/BondageProjects/Bondage-College/-/merge_requests/5274">BondageProjects/Bondage-College#5274</a>: Fix the shop not properly unhiding DOM elements after exiting certain subscreens</li>\n<li><a href="https://gitgud.io/BondageProjects/Bondage-College/-/merge_requests/5290">BondageProjects/Bondage-College#5290</a>: Fix blur effects being enabled by default when rendering backgrounds</li>\n</ul>\n</li>\n</ul>\n<h2 id="v1732">v1.7.32</h2>\n<ul>\n<li>Drop R109 support</li>\n<li>Add a setting for enabling or disabling MBS changelog notifications</li>\n<li>Add a BC version selection dropdown in the shop</li>\n</ul>\n<h2 id="v1731">v1.7.31</h2>\n<ul>\n<li>Backport one R111 feature:<ul>\n<li><a href="https://gitgud.io/BondageProjects/Bondage-College/-/merge_requests/5254">BondageProjects/Bondage-College#5254</a>: Add the <code>/changelog</code> chat command</li>\n</ul>\n</li>\n</ul>\n<h2 id="v1730">v1.7.30</h2>\n<ul>\n<li>Drop R108 support</li>\n<li>Add R110Beta1 support</li>\n<li>Backport one R110 bug fix:<ul>\n<li><a href="https://gitgud.io/BondageProjects/Bondage-College/-/merge_requests/5237">BondageProjects/Bondage-College#5237</a>: Fix <code>CraftingDescription.Decode</code> failing to properly handle zero-terminated bits</li>\n</ul>\n</li>\n</ul>\n<h2 id="v1729">v1.7.29</h2>\n<ul>\n<li>Add R109Beta1 support</li>\n</ul>\n<h2 id="v1728">v1.7.28</h2>\n<ul>\n<li>Disable MBS&#39;s extended crafting descriptions in R109 in favor of BC&#39;s native implementation</li>\n</ul>\n<h2 id="v1727">v1.7.27</h2>\n<ul>\n<li>Drop R107 support</li>\n<li>Ensure that exiting the MBS preference screen returns one to the preference extension subscreen</li>\n<li>Backport two R109 changes:<ul>\n<li><a href="https://gitgud.io/BondageProjects/Bondage-College/-/merge_requests/5205">BondageProjects/Bondage-College#5205</a>: Take <code>Asset.CraftGroup</code> into account when sorting crafted items</li>\n<li><a href="https://gitgud.io/BondageProjects/Bondage-College/-/merge_requests/5207">BondageProjects/Bondage-College#5207</a>: Fix two crafting screen bugs</li>\n<li><a href="https://gitgud.io/BondageProjects/Bondage-College/-/merge_requests/5208">BondageProjects/Bondage-College#5208</a>: Fix the appropriate default color failing to be selected upon creating a new crafted item</li>\n</ul>\n</li>\n</ul>\n<h2 id="v1726">v1.7.26</h2>\n<ul>\n<li>Add R108Beta1 support</li>\n<li>Move the MBS preferences from <code>Preferences &gt; MBS</code> to <code>Preferences &gt; Extensions &gt; MBS</code> starting from R108</li>\n<li>Partially backport two changes to R108Beta1:<ul>\n<li><a href="https://gitgud.io/BondageProjects/Bondage-College/-/merge_requests/5187">BondageProjects/Bondage-College#5187</a>: Minor crafting UI-related tweaks</li>\n<li><a href="https://gitgud.io/BondageProjects/Bondage-College/-/merge_requests/5188">BondageProjects/Bondage-College#5188</a>: Fix the subscreen exiting logic in <code>PreferenceExit()</code> and <code>PreferenceSubscreenExtensionsExit()</code></li>\n</ul>\n</li>\n</ul>\n<h2 id="v1725">v1.7.25</h2>\n<ul>\n<li>Set the max supported BC version to R107 until full beta support can be added</li>\n</ul>\n<h2 id="v1724">v1.7.24</h2>\n<ul>\n<li>Fix extended crafting descriptions sometimes dropping the last character</li>\n</ul>\n<h2 id="v1723">v1.7.23</h2>\n<ul>\n<li>Add a missing extended crafted item description check to <code>CraftingModeSet</code></li>\n</ul>\n<h2 id="v1722">v1.7.22</h2>\n<ul>\n<li>Include the new BC EU host URL in the MBS user script</li>\n<li>Add the ability to create crafted item description with up to 398 &quot;simple&quot; characters (<em>i.e.</em> extended ASCII).\nThis functionality can be enabled under <code>Preferences</code> &gt; <code>MBS Settings</code>.\nNote that these descriptions will only be legible for MBS users.</li>\n</ul>\n<h2 id="v1721">v1.7.21</h2>\n<ul>\n<li>Drop R106 support</li>\n<li>Update reported R107 items</li>\n</ul>\n<h2 id="v1720">v1.7.20</h2>\n<ul>\n<li>Add R107Beta1 support</li>\n<li>Drop R105 support</li>\n</ul>\n<h2 id="v1719">v1.7.19</h2>\n<ul>\n<li>Add R106Beta1 support</li>\n<li>Show the MBS changelog in the chat</li>\n<li>Add the <code>/mbschangelog</code> chat command to show the latest MBS changelog (default behavior) or alternatively the changelog of a specific version or version range.</li>\n</ul>\n<h2 id="v1718">v1.7.18</h2>\n<ul>\n<li>Backport two bug fixes:<ul>\n<li><a href="https://gitgud.io/BondageProjects/Bondage-College/-/merge_requests/5108">BondageProjects/Bondage-College#5108</a>: Fix number inputs being clamped to zero if no min/max is specified on the input element</li>\n<li><a href="https://gitgud.io/BondageProjects/Bondage-College/-/merge_requests/5109">BondageProjects/Bondage-College#5109</a>: Fix item visibility settings not saving</li>\n</ul>\n</li>\n</ul>\n<h2 id="v1717">v1.7.17</h2>\n<ul>\n<li>Drop R104 support</li>\n</ul>\n<h2 id="v1716">v1.7.16</h2>\n<ul>\n<li>Add R105Beta1 support</li>\n</ul>\n<h2 id="v1715">v1.7.15</h2>\n<ul>\n<li>Allow search inputs to provide suggestions<ul>\n<li>Backports <a href="https://gitgud.io/BondageProjects/Bondage-College/-/merge_requests/5065">BondageProjects/Bondage-College#5065</a>: Offer search suggestions when typing into search bars</li>\n</ul>\n</li>\n</ul>\n<h2 id="v1714">v1.7.14</h2>\n<ul>\n<li>Switch a few remaining units from viewport- to dynamic viewport</li>\n<li>Chat room separator tweaks (xref <a href="https://gitgud.io/BondageProjects/Bondage-College/-/merge_requests/5063">BondageProjects/Bondage-College#5063</a>: Various minor chat room separator adjustments):<ul>\n<li>Fix the spurious chat room separator transparency when in sens dep</li>\n<li>Ensure that the chat room separator buttons are unfocused on mobile after a click</li>\n<li>Ensure that sending a message or action scrolls the chat area to the bottom</li>\n</ul>\n</li>\n</ul>\n<h2 id="v1713">v1.7.13</h2>\n<ul>\n<li>New improvements to the chat room separator</li>\n<li>Backport a pose-related bug fix<ul>\n<li><a href="https://gitgud.io/BondageProjects/Bondage-College/-/merge_requests/5059">BondageProjects/Bondage-College#5059</a>: Fix the freeze effect accidentally limiting upper body changes</li>\n</ul>\n</li>\n</ul>\n<h2 id="v1712">v1.7.12</h2>\n<ul>\n<li>Backport PR 5508 - Make the chat room separator much more fancier<ul>\n<li><a href="https://gitgud.io/BondageProjects/Bondage-College/-/merge_requests/5058">BondageProjects/Bondage-College#5058</a>: Make the chat room separator much more fancier</li>\n</ul>\n</li>\n</ul>\n<h2 id="v1711">v1.7.11</h2>\n<ul>\n<li>Fix another crash in the fortune wheel command screen</li>\n</ul>\n<h2 id="v1710">v1.7.10</h2>\n<ul>\n<li>Fix a crash in the fortune wheel command screen</li>\n</ul>\n<h2 id="v179">v1.7.9</h2>\n<ul>\n<li>Use a hook for patching <code>Layering._ApplyAssetPriority</code></li>\n</ul>\n<h2 id="v178">v1.7.8</h2>\n<ul>\n<li>Backport two R105 bug fixes<ul>\n<li><a href="https://gitgud.io/BondageProjects/Bondage-College/-/merge_requests/5052">BondageProjects/Bondage-College#5052</a>: fix <code>PreferenceSubscreenExtensionsClear()</code> when the optional unload function is undefined</li>\n<li><a href="https://gitgud.io/BondageProjects/Bondage-College/-/merge_requests/5055">BondageProjects/Bondage-College#5055</a>: Disable layering for locked items that one cannot unlock</li>\n</ul>\n</li>\n</ul>\n<h2 id="v177">v1.7.7</h2>\n<ul>\n<li>Drop BC R103 support</li>\n<li>Fix the screen shape not being passed on to the fortune wheel command screen</li>\n</ul>\n<h2 id="v176">v1.7.6</h2>\n<ul>\n<li>Fix the R104 alignment of the item version filter</li>\n</ul>\n<h2 id="v174">v1.7.4</h2>\n<ul>\n<li>Switch from viewport- to dynamic viewport units. This should provide a more consistent UI positioning on mobile.</li>\n<li>Add BC R104Beta1 support</li>\n</ul>\n<h2 id="v173">v1.7.3</h2>\n<ul>\n<li>Fix a race condition related to the alternate garbling initialization</li>\n</ul>\n<h2 id="v172">v1.7.2</h2>\n<ul>\n<li>Fix the shop not showing newly released assets</li>\n</ul>\n<h2 id="v171">v1.7.1</h2>\n<ul>\n<li>Improve button alignment in the wheel of fortune item set menu</li>\n<li>Use custom <code>text</code>-based inputs (rather than <code>time</code>-based) for the wheel of fortune timers;\nfixes the odd time-offsets and AM/PM markers occasionally observed.</li>\n</ul>\n<h2 id="v170">v1.7.0</h2>\n<ul>\n<li>Increment the MBS API to version 1.4:<ul>\n<li>Relicense the <code>mbs.css</code> API under terms of LPGL-v3</li>\n</ul>\n</li>\n</ul>\n<h2 id="v163">v1.6.3</h2>\n<ul>\n<li>Drop support for BC R102</li>\n<li>Fix the save-condition being broken for the fortune wheel commands screen</li>\n</ul>\n<h2 id="v162">v1.6.2</h2>\n<ul>\n<li>Update for BC R103Beta2</li>\n<li>Add a safeguard for loading MBS while the <code>WheelFortuneCustomize</code> screen is open</li>\n<li>Remote-fetch the alternative garbling JSON data rather than directly vendoring it (again...)</li>\n<li>Fix various OOC-related issues related to alternative garbling</li>\n<li>Add the option to vary the (alternative) garbling strength per syllable</li>\n<li>Switch from the en_UK phonetic data to the larger en_US dataset</li>\n</ul>\n<h2 id="v161">v1.6.1</h2>\n<ul>\n<li>Fix the garbling JSON data failing to load</li>\n</ul>\n<h2 id="v160">v1.6.0</h2>\n<ul>\n<li>Experimental: Add an alternative form of more phonetically-acurate garbling based on Cordelia Mist&#39;s <a href="https://github.com/CordeliaMist/Dalamud-GagSpeak">Dalamud-GagSpeak</a>.\nNote that the alternative garbling is disabled by default.</li>\n<li>Add support for BC R103Beta1</li>\n</ul>\n<h2 id="v150">v1.5.0</h2>\n<ul>\n<li>Use DOM elements for all remaining MBS screens, wrapping up the DOM-ification</li>\n<li>Remove a few redundant functions and replace the with lodash equivalents</li>\n<li>Reduce the tooltip overlap in the wheel preset screen and improve the tooltip standardization</li>\n<li>Further centralize the CSS styling</li>\n<li>Add safeguards for loading MBS while the preference- or wheel screen is open</li>\n<li>Increment the MBS API to version 1.3:<ul>\n<li>Add the new <code>mbs.css</code> namespace, which contains functions modifying MBS&#39;s style sheets.</li>\n</ul>\n</li>\n</ul>\n<h2 id="v147">v1.4.7</h2>\n<ul>\n<li>Fix the MBS settings menu sometimes requiring two clicks to exit</li>\n<li>Fix the MBS settings menu locking being incorrectly locked when restrained</li>\n</ul>\n<h2 id="v146">v1.4.6</h2>\n<ul>\n<li>Use DOM elements for the MBS preference screens</li>\n<li>Bump the BC mod SDK to 1.2.0</li>\n</ul>\n<h2 id="v145">v1.4.5</h2>\n<ul>\n<li>Remove MBS&#39;s dedicated &quot;show new item screen&quot; buttons when in R103</li>\n<li>Rewrite the MBS fortune wheel preset screen using DOM elements</li>\n</ul>\n<h2 id="v144">v1.4.4</h2>\n<ul>\n<li>Fix the broken exit button image in the MBS wheel of fortune selection menu</li>\n<li>Rewrite the MBS fortune wheel item set screen using DOM elements</li>\n</ul>\n<h2 id="v143">v1.4.3</h2>\n<ul>\n<li>Remove the the fortune wheel option hiding checkbox</li>\n<li>Fix the <a href="https://gitgud.io/BondageProjects/Bondage-College/-/merge_requests/4900">BondageProjects/Bondage-College#4900</a> backport not hiding owner/lovers/family-locked items when required</li>\n<li>Rewrite the MBS fortune wheel selection screen using DOM elements; add a scroll bar</li>\n<li>Fix spurious MBS warnings about duplicate crafts</li>\n</ul>\n<h2 id="v142">v1.4.2</h2>\n<ul>\n<li>Drop support for BCR101</li>\n<li>Fix the FUSAM button not disappearing when accessing the SHOP via the MBS preferences menu</li>\n<li>Backport one BC R103 change to R102:<ul>\n<li><a href="https://gitgud.io/BondageProjects/Bondage-College/-/merge_requests/4900">BondageProjects/Bondage-College#4900</a>: Optimize the handling of crafted items in <code>DialogInventoryBuild</code></li>\n</ul>\n</li>\n</ul>\n<h2 id="v141">v1.4.1</h2>\n<ul>\n<li>Fix unconditional accessing of a BC R102 variable</li>\n</ul>\n<h2 id="v140">v1.4.0</h2>\n<ul>\n<li>Increment the MBS API to version 1.2:<ul>\n<li>Guarantee that the <code>mbs.getDebug()</code> output strings are JSON-safe</li>\n<li>Provide better documentation regarding when features were added to the API</li>\n</ul>\n</li>\n<li>Add the ability to import &amp; export MBS settings</li>\n<li>Send a beep to the player if errors are encountered while initializing MBS settings</li>\n<li>Add support for BC R102</li>\n<li>Deprecate MBS&#39; custom entry points for the Show New Items menu, all of which will be removed in R103.\nOnce R102 is live (or its beta), you can use the Club Shop button in the main hall or the <code>/shop</code> chat command instead.</li>\n</ul>\n<h2 id="v137">v1.3.7</h2>\n<ul>\n<li>Minor UI adjustments in the wheel of fortune screens</li>\n<li>Add the option to change an items color in the show new items menu</li>\n<li>Drop support for BC R100</li>\n</ul>\n<h2 id="v136">v1.3.6</h2>\n<ul>\n<li>Do not display the wheel storage size for non-player characters</li>\n<li>Fix the reported index for entries in the wheel customization menu</li>\n<li>Fix the show now item buy menu failing to update for items with no buygroup</li>\n<li>Misc minor changes to how the data storage size is reported</li>\n</ul>\n<h2 id="v135">v1.3.5</h2>\n<ul>\n<li>Refactor the logic for checking whether BC is properly loaded or not</li>\n<li>Re-enable the storing of crafted item descriptions in the wheel of fortune, reverting their previous removal in MBS v0.6.22</li>\n<li>Add checks to ensure that MBS does not exceed the 180 KB storage limit for its shared settings, exceeding of which can cause crashes and unstable behavior in BC</li>\n</ul>\n<h2 id="v134">v1.3.4</h2>\n<ul>\n<li>Add R101Beta2 support; no support for Beta1 will be added</li>\n<li>Let the Show New Items menu display whether the player has F-/M-only shop items enabled</li>\n<li>Bump the MBS build target from ES2020 to ES2021</li>\n</ul>\n<h2 id="v133">v1.3.3</h2>\n<ul>\n<li>Backport three BC R101 fixes to R100 (and fixed the KD one from MBS v1.3.2):<ul>\n<li><a href="https://gitgud.io/BondageProjects/Bondage-College/-/merge_requests/4777">BondageProjects/Bondage-College#4777</a>: Fix eye colour reset on expression clear</li>\n<li><a href="https://gitgud.io/BondageProjects/Bondage-College/-/merge_requests/4779">BondageProjects/Bondage-College#4779</a>: Fix <code>Item.Property</code> not always properly initializing in KD</li>\n<li><a href="https://gitgud.io/BondageProjects/Bondage-College/-/merge_requests/4780">BondageProjects/Bondage-College#4780</a>: Fix the futuristic harness ball gag auto-inflation triggering validation</li>\n</ul>\n</li>\n</ul>\n<h2 id="v132">v1.3.2</h2>\n<ul>\n<li>Add the ability to buy items from the Show New Items menu</li>\n<li>Add safeguards in the MBS API for checking whether MBS is fully loaded already</li>\n<li>Fix the new item preview refreshing to the wrong outfit</li>\n<li>Ensure that the Show New Items menu respect the players <code>HideShopItems</code> setting</li>\n</ul>\n<h2 id="v131">v1.3.1</h2>\n<ul>\n<li>Add a duration-tooltip for the builtin BC wheel options in the preset config screen</li>\n<li>Add extended item screen support to the Show New Item menu</li>\n<li>Allow chatroom backgrounds to show in the Show New Item menu</li>\n</ul>\n<h2 id="v130">v1.3.0</h2>\n<ul>\n<li>Ensure that the Show New Item preview does not remove new items when switching clothing mode</li>\n<li>Restructure the MBS files and directories</li>\n<li>Add a new screen for storing wheel of fortune option presets\n<img src="static/images/preset.png" alt="New items"></li>\n</ul>\n<h2 id="v122">v1.2.2</h2>\n<ul>\n<li>Fix a the Show New Item menu preview again only partially resetting</li>\n</ul>\n<h2 id="v121">v1.2.1</h2>\n<ul>\n<li>Fix a the Show New Item menu preview only partially resetting</li>\n<li>Fix a crash when paginating in the Show New Item menu</li>\n<li>Add a button the to MBS preference screen for accessing the Show New Item menu</li>\n</ul>\n<h2 id="v120">v1.2.0</h2>\n<ul>\n<li>Add a new button in the main hallway for showing all new items added in the current version (beta or otherwise):\n<img src="static/images/new_beta_items.png" alt="New items"></li>\n</ul>\n<h2 id="v117">v1.1.7</h2>\n<ul>\n<li>Add R100Beta1 support</li>\n<li>Backport two BC R100Beta2 fixes to R100Beta1:<ul>\n<li><a href="https://gitgud.io/BondageProjects/Bondage-College/-/merge_requests/4740">BondageProjects/Bondage-College#4740</a>: Fix <code>PreferenceArousalSettingsValidate</code> calling the wrong cloning function</li>\n<li><a href="https://gitgud.io/BondageProjects/Bondage-College/-/merge_requests/4741">BondageProjects/Bondage-College#4741</a>: Ensure that the <code>GameVersion</code> validation modifies the players game version when required</li>\n</ul>\n</li>\n</ul>\n<h2 id="v116">v1.1.6</h2>\n<ul>\n<li>Drop BC R98 support</li>\n</ul>\n<h2 id="v115">v1.1.5</h2>\n<ul>\n<li>Fix a faulty <code>TypeRecord</code> check</li>\n</ul>\n<h2 id="v114">v1.1.4</h2>\n<ul>\n<li>Add R99Beta1 support</li>\n<li>Add a dedicated MBS logger.</li>\n<li>Increment the MBS API to version 1.1:<ul>\n<li>Expose <code>mbs.getDebug()</code> to the API</li>\n</ul>\n</li>\n<li>Backport one BC R99Beta2 fix to R99Beta1:<ul>\n<li><a href="https://gitgud.io/BondageProjects/Bondage-College/-/merge_requests/4662">BondageProjects/Bondage-College#4662</a>: Various <code>TypeRecord</code>-related fixes</li>\n</ul>\n</li>\n</ul>\n<h2 id="v113">v1.1.3</h2>\n<ul>\n<li>Fix (non-shared) MBS settings not saving</li>\n</ul>\n<h2 id="v111">v1.1.1</h2>\n<ul>\n<li>Misc CI updates</li>\n<li>Remove the last <code>OnlineSettings</code> remnants</li>\n<li>Provide more console output upon encountering errors related to MBS extra crafting items</li>\n<li>Register an MBS debugger to FUSAM</li>\n<li>Backport one BC R99 fix:<ul>\n<li><a href="https://gitgud.io/BondageProjects/Bondage-College/-/merge_requests/4610">BondageProjects/Bondage-College#4610</a>: Remove <code>InventoryAllow</code> checks from <code>DialogMenuButtonBuild()</code></li>\n</ul>\n</li>\n</ul>\n<h2 id="v110">v1.1.0</h2>\n<ul>\n<li>Add the ability to specify weights for wheel of fortune options</li>\n<li>Move <code>OnlineSettings</code> to <code>ExtensionSettings</code>. Note that this does not affect data stored in <code>OnlineSharedSettings</code>.</li>\n<li>Append the MBS version with the git tag on non-release commits</li>\n<li>Backport three BC R99 fixes:<ul>\n<li><a href="https://gitgud.io/BondageProjects/Bondage-College/-/merge_requests/4602">BondageProjects/Bondage-College#4602</a>: Allow to specify <code>Top</code>/<code>Left</code> on a pose-by-pose basis</li>\n<li><a href="https://gitgud.io/BondageProjects/Bondage-College/-/merge_requests/4604">BondageProjects/Bondage-College#4604</a>: Fix the futuristic gag auto inflation tripping up on the <code>Init</code> validation</li>\n<li><a href="https://gitgud.io/BondageProjects/Bondage-College/-/merge_requests/4605">BondageProjects/Bondage-College#4605</a>: Properly implement Advanced vibrator mode support for the vibrating item <code>Init</code> validation</li>\n</ul>\n</li>\n</ul>\n<h2 id="v101">v1.0.1</h2>\n<ul>\n<li>Drop support for BC R98</li>\n<li>Backport one BC R98 hotfix:<ul>\n<li><a href="https://gitgud.io/BondageProjects/Bondage-College/-/merge_requests/4597">BondageProjects/Bondage-College#4597</a>: Fix a validation loop triggered by the love chastity belt</li>\n</ul>\n</li>\n</ul>\n<h2 id="v100">v1.0.0</h2>\n<ul>\n<li>Add full R98Beta1 support</li>\n<li>Added a button for clearing all MBS data</li>\n</ul>\n<h2 id="v0628">v0.6.28</h2>\n<ul>\n<li>Add preliminarily R98 support</li>\n<li>Formalize and expand the MBS API with <code>API_VERSION</code> and the <code>wheelOutfits</code> namespace</li>\n</ul>\n<h2 id="v0627">v0.6.27</h2>\n<ul>\n<li>Remove more R96 leftovers</li>\n<li>Fix a faulty check for the presence of LSCG</li>\n</ul>\n<h2 id="v0626">v0.6.26</h2>\n<ul>\n<li>Fix the parsing of outfit codes with extended items sometimes raising</li>\n<li>Refactor and deduplicate elements shared between <code>Settings</code> and <code>OnlineSharedSettings</code></li>\n<li>Install BC-stubs via NPM rather than vendoring them</li>\n<li>Drop support for BC R97</li>\n<li>Special case LSCG item-specific keywords, allowing them in wheel of fortune crafted item descriptions</li>\n</ul>\n<h2 id="v0625">v0.6.25</h2>\n<ul>\n<li>Minor wheel of fortune performance improvement (requires BC R97Beta1 or later)</li>\n<li>Backport two R97Beta2 bug fixes to R97Beta1:<ul>\n<li><a href="https://gitgud.io/BondageProjects/Bondage-College/-/merge_requests/4508">BondageProjects/Bondage-College#4508</a>: Fix items not being applicable anymore</li>\n<li><a href="https://gitgud.io/BondageProjects/Bondage-College/-/merge_requests/4509">BondageProjects/Bondage-College#4509</a>: Fix <code>CantChangeWhileLocked</code> stopping player-made changes to the crafting preview character when tied up</li>\n</ul>\n</li>\n</ul>\n<h2 id="v0624">v0.6.24</h2>\n<ul>\n<li>Add support for BC R97Beta1</li>\n<li>Add the option to disallow wheel spins while restrained</li>\n<li>Made the wheel of fortune character preview more responsive (requires BC R97Beta1 or later)</li>\n</ul>\n<h2 id="v0623">v0.6.23</h2>\n<ul>\n<li>Use heavier MBS settings compression</li>\n</ul>\n<h2 id="v0622">v0.6.22</h2>\n<ul>\n<li>Optimize the amount of stored server-side data</li>\n<li>Crafted items applied by the wheel of fortune no longer have a description in order to save on data</li>\n</ul>\n<h2 id="v0621">v0.6.21</h2>\n<ul>\n<li>Add the option to forgo any locks when equipping fortune wheel item sets</li>\n</ul>\n<h2 id="v0620">v0.6.20</h2>\n<ul>\n<li>Drop support for BC R95</li>\n<li>Update the MBS URL&#39;s in the bookmark &amp; *.user.js files with a cache bust.</li>\n<li>Backport two R97 bug fixes:<ul>\n<li><a href="https://gitgud.io/BondageProjects/Bondage-College/-/merge_requests/4478">BondageProjects/Bondage-College#4478</a>: Fix a bunch issues related to the forbidden chastity belt and bra</li>\n<li><a href="https://gitgud.io/BondageProjects/Bondage-College/-/merge_requests/4475">BondageProjects/Bondage-College#4475</a>: Fix the crafting validation sometimes looking up the wrong asset</li>\n</ul>\n</li>\n</ul>\n<h2 id="v0619">v0.6.19</h2>\n<ul>\n<li>Add support for BC R96Beta1</li>\n</ul>\n<h2 id="v0618">v0.6.18</h2>\n<ul>\n<li>Update type annotations for BC R95Beta1</li>\n<li>Increase the maximum number of wheel of fortune item sets and commands to 32</li>\n</ul>\n<h2 id="v0617">v0.6.17</h2>\n<ul>\n<li>Perform stricter validation of wheel of fortune embedded items</li>\n<li>Fix the wheel of fortune preview character failing to equip items if the player is enclosed</li>\n</ul>\n<h2 id="v0616">v0.6.16</h2>\n<ul>\n<li>Fix <code>PreferenceExit</code> not being called when opening the MBS preference screen</li>\n</ul>\n<h2 id="v0615">v0.6.15</h2>\n<ul>\n<li>Drop support for BC R95</li>\n<li>Fix a double call to <code>PreferenceLoad</code> when exiting the MBS settings screen</li>\n</ul>\n<h2 id="v0614">v0.6.14</h2>\n<ul>\n<li>Update for R94Beta3</li>\n</ul>\n<h2 id="v0613">v0.6.13</h2>\n<ul>\n<li>More crafting duplication fixes</li>\n</ul>\n<h2 id="v0612">v0.6.12</h2>\n<ul>\n<li>Add even more safeguards against crafting duplication</li>\n</ul>\n<h2 id="v0610">v0.6.10</h2>\n<ul>\n<li>Fix a bug that would cause crafting item duplication when upgrading from BC R93 to R94</li>\n</ul>\n<h2 id="v069">v0.6.9</h2>\n<ul>\n<li>Adapt to BC R94Beta1 failing to actually increment its version</li>\n</ul>\n<h2 id="v068">v0.6.8</h2>\n<ul>\n<li>Add full support for BC R94Beta1</li>\n<li>Increase the number of crafting slots from 100 to 160</li>\n</ul>\n<h2 id="v067">v0.6.7</h2>\n<ul>\n<li>Ensure that ModSDK hooks always call <code>next()</code></li>\n<li>Add basic support for BC R94Beta1</li>\n<li>Increase the max number of lines for crafted item descriptions to 7</li>\n</ul>\n<h2 id="v066">v0.6.6</h2>\n<ul>\n<li>Fix an incompatibility between MBS settings screen and BCTweaks</li>\n</ul>\n<h2 id="v065">v0.6.5</h2>\n<ul>\n<li>Update type annotations for BC R93</li>\n<li>Drop support for BC R92</li>\n<li>Added a basic MBS settings menu to the BC preferences</li>\n<li>Increase the maximum description length of crafted items from 100 to 200</li>\n</ul>\n<h2 id="v064">v0.6.4</h2>\n<ul>\n<li>Update type annotations for BC R93Beta1</li>\n<li>Misc GitHub Actions workflow maintenance</li>\n<li>Backport two BC R93Beta2 bug fixes to R93Beta1<ul>\n<li><a href="https://gitgud.io/BondageProjects/Bondage-College/-/merge_requests/4289">BondageProjects/Bondage-College#4289</a>: Remove the <code>TapedHands</code> entry from the <code>HideForPose</code> array of handheld items</li>\n<li><a href="https://gitgud.io/BondageProjects/Bondage-College/-/merge_requests/4290">BondageProjects/Bondage-College#4290</a>: Fix a hard-coded <code>IsOwnedByPlayer</code> check</li>\n</ul>\n</li>\n</ul>\n<h2 id="v063">v0.6.3</h2>\n<ul>\n<li>Add support for storing record-based <code>Item.OverridePriority</code> values</li>\n<li>Fix the bookmark loader URL</li>\n</ul>\n<h2 id="v062">v0.6.2</h2>\n<ul>\n<li>Misc CI fixes</li>\n</ul>\n<h2 id="v061">v0.6.1</h2>\n<ul>\n<li>Drop support for BC R91</li>\n<li>Do not send a version-update beep when installing MBS for the first time</li>\n<li>Overhauled the build artifact storage system</li>\n<li>Demand that at least one wheel of fortune lock flag is enabled</li>\n<li>Add support for saving futuristic training belt properties</li>\n</ul>\n<h2 id="v060">v0.6.0</h2>\n<ul>\n<li>Allow the specification of custom timer lock durations for the wheel of fortune</li>\n<li>Reduced the number of exposed functions</li>\n<li>Backport two more BC R92Beta2 bug fixes to R92Beta1<ul>\n<li><a href="https://gitgud.io/BondageProjects/Bondage-College/-/merge_requests/4204">BondageProjects/Bondage-College#4204</a>: Fix a crash with the color picker when on mobile</li>\n<li><a href="https://gitgud.io/BondageProjects/Bondage-College/-/merge_requests/4207">BondageProjects/Bondage-College#4207</a>: Fix subscreens not opening when the respective super-screen option was previously already selected</li>\n</ul>\n</li>\n</ul>\n<h2 id="v0514">v0.5.14</h2>\n<ul>\n<li>Backport two BC R92Beta2 bug fixes to R92Beta1<ul>\n<li><a href="https://gitgud.io/BondageProjects/Bondage-College/-/merge_requests/4202">BondageProjects/Bondage-College#4202</a>: Fix the high-sec and intricate locks not being unlockable</li>\n<li><a href="https://gitgud.io/BondageProjects/Bondage-College/-/merge_requests/4203">BondageProjects/Bondage-College#4203</a>: Make the two chastity shields block clit activities</li>\n</ul>\n</li>\n</ul>\n<h2 id="v0513">v0.5.13</h2>\n<ul>\n<li>Full R92Beta1 support</li>\n<li>Various misc Github Actions related updates</li>\n</ul>\n<h2 id="v0512">v0.5.12</h2>\n<ul>\n<li>Preliminary R92Beta1 compatibility changes</li>\n</ul>\n<h2 id="v0511">v0.5.11</h2>\n<ul>\n<li>Add formal R91 support and drop R90 support</li>\n<li>Fix certain wheel checks being skipped if an item is added without replacement</li>\n</ul>\n<h2 id="v0510">v0.5.10</h2>\n<ul>\n<li>Update type annotations for R91Beta1</li>\n<li>Add a few minor R91Beta1 fixes</li>\n</ul>\n<h2 id="v059">v0.5.9</h2>\n<ul>\n<li>Fix a bug that could cause MBS to crash if zero flags were selected for a particular fortune wheel item set.</li>\n</ul>\n<h2 id="v058">v0.5.8</h2>\n<ul>\n<li>Backport even more BC R91 bug fixes<ul>\n<li><a href="https://gitgud.io/BondageProjects/Bondage-College/-/merge_requests/4049">https://gitgud.io/BondageProjects/Bondage-College/-/merge_requests/4049</a></li>\n<li><a href="https://gitgud.io/BondageProjects/Bondage-College/-/merge_requests/4057">https://gitgud.io/BondageProjects/Bondage-College/-/merge_requests/4057</a></li>\n<li><a href="https://gitgud.io/BondageProjects/Bondage-College/-/merge_requests/4062">https://gitgud.io/BondageProjects/Bondage-College/-/merge_requests/4062</a></li>\n</ul>\n</li>\n</ul>\n<h2 id="v057">v0.5.7</h2>\n<ul>\n<li>Backport a number of BC R91 bug fixes<ul>\n<li><a href="https://gitgud.io/BondageProjects/Bondage-College/-/merge_requests/4044">https://gitgud.io/BondageProjects/Bondage-College/-/merge_requests/4044</a></li>\n<li><a href="https://gitgud.io/BondageProjects/Bondage-College/-/merge_requests/4046">https://gitgud.io/BondageProjects/Bondage-College/-/merge_requests/4046</a></li>\n<li><a href="https://gitgud.io/BondageProjects/Bondage-College/-/merge_requests/4047">https://gitgud.io/BondageProjects/Bondage-College/-/merge_requests/4047</a></li>\n<li><a href="https://gitgud.io/BondageProjects/Bondage-College/-/merge_requests/4048">https://gitgud.io/BondageProjects/Bondage-College/-/merge_requests/4048</a></li>\n</ul>\n</li>\n</ul>\n<h2 id="v056">v0.5.6</h2>\n<ul>\n<li>Drop support for R89</li>\n<li>Attach build artifacts whenever creating a new release</li>\n<li>Bump dev dependencies</li>\n<li>Add more conveniently typed variations of a few stdlib functions</li>\n<li>Misc improvements to the player settings parsing</li>\n</ul>\n<h2 id="v055">v0.5.5</h2>\n<ul>\n<li>Revert the <a href="https://gitgud.io/BondageProjects/Bondage-College/-/merge_requests/4030">https://gitgud.io/BondageProjects/Bondage-College/-/merge_requests/4030</a> port-forward patch.</li>\n</ul>\n<h2 id="v054">v0.5.4</h2>\n<ul>\n<li>Port forward a few more BC R90Beta3 bug fixes to R90Beta2 (xref <a href="https://gitgud.io/BondageProjects/Bondage-College/-/merge_requests/4030">https://gitgud.io/BondageProjects/Bondage-College/-/merge_requests/4030</a>, <a href="https://gitgud.io/BondageProjects/Bondage-College/-/merge_requests/4031">https://gitgud.io/BondageProjects/Bondage-College/-/merge_requests/4031</a> and <a href="https://gitgud.io/BondageProjects/Bondage-College/-/merge_requests/4033">https://gitgud.io/BondageProjects/Bondage-College/-/merge_requests/4033</a>)</li>\n</ul>\n<h2 id="v053">v0.5.3</h2>\n<ul>\n<li>Port forward a BC R90Beta2 crash fix to R90Beta1 (xref <a href="https://gitgud.io/BondageProjects/Bondage-College/-/merge_requests/4023">https://gitgud.io/BondageProjects/Bondage-College/-/merge_requests/4023</a>)</li>\n<li>Remove an unused function</li>\n</ul>\n<h2 id="v052">v0.5.2</h2>\n<ul>\n<li>Fix the name of the <code>MiniGame</code> module</li>\n<li>Ensure that colors are always copied when creating items</li>\n<li>Update type annotations for BC R90Beta1</li>\n<li>Allow custom item sets to be specified via (serialized) single items in addition to item lists (for real this time...)</li>\n</ul>\n<h2 id="v051">v0.5.1</h2>\n<ul>\n<li>Fix the &quot;Missing outfit&quot; error message not showing</li>\n<li>Allow custom item sets to be specified via (serialized) single items in addition to item lists</li>\n</ul>\n<h2 id="v050">v0.5.0</h2>\n<ul>\n<li>Add a MBS test suite</li>\n<li>Drop BC R88 support</li>\n<li>Expand the BC .d.ts stub files with those autogenerated from BC</li>\n<li>Add custom classes for managing (sub-)screens</li>\n<li>Add the option to create custom wheel of fortune (RP) commands:\n<img src="static/images/spin_command.png" alt="Command example"></li>\n</ul>\n<h2 id="v045">v0.4.5</h2>\n<ul>\n<li>Fix the <code>padArray</code> and <code>trimArray</code> logic; make them more lenient</li>\n</ul>\n<h2 id="v044">v0.4.4</h2>\n<ul>\n<li>Properly respect items with the <code>Enclose</code> effect such as the futuristic create</li>\n<li>Do not attempt to wear clothes if one is wearing a clubsslave collar</li>\n<li>Allow <code>FortuneWheelOption.Script</code> to be used on arbitrary player- and simple characters</li>\n</ul>\n<h2 id="v043">v0.4.3</h2>\n<ul>\n<li>Fix <code>Item.Craft</code> not being properly copied</li>\n<li>Further enforce the immutability of <code>FortuneWheelItem</code></li>\n</ul>\n<h2 id="v042">v0.4.2</h2>\n<ul>\n<li>Fixed a crash that could occur when BCX is not installed</li>\n<li>Fixed builtin MBS options not properly saving</li>\n</ul>\n<h2 id="v041">v0.4.1</h2>\n<ul>\n<li>Consolidate and expand the BC validation</li>\n<li>Allow custom wheel of fortune item sets to store the <code>OverrideHeight</code> property</li>\n<li>Check for the BCX <code>alt_allow_changing_appearance</code> rule when determining whether cosplay items can be changed</li>\n<li>Add <code>lodash</code> as a dependency; remove <code>mapsort</code></li>\n<li>Fix custom override priorities of the builtin MBS item sets</li>\n<li>Check whether an item is not blocked at the room level before equipping</li>\n</ul>\n<h2 id="v040">v0.4.0</h2>\n<ul>\n<li>Place the <code>ITEM_SET_TYPE_DICT</code> and <code>MBSDummy</code> initialization behind a <code>waitFor</code> guard</li>\n<li>Split <code>common</code> into two modules</li>\n<li>Fix the previously broken <code>Version.beta</code> comparison</li>\n<li>Overhaul the ID assignment of custom item sets; make it more robust</li>\n<li>Add <code>mapsort</code> as a dependency</li>\n<li>Ensure that the previous item set is properly unregistered before saving a new one</li>\n<li>Fix a potential issue with the BC version comparison</li>\n<li>Resize the preview character for a better fit</li>\n<li>Up the number of custom item slots from 14 to 16</li>\n</ul>\n<h2 id="v033">v0.3.3</h2>\n<ul>\n<li>Ensure that MBS does not throw literals as exceptions</li>\n<li>Fix the vibrator mode not being properly read for custom outfits</li>\n<li>Various fixes and improvements related to the futuristic vibrator</li>\n<li>Update <code>MBSSelect.currentFortuneWheelSets</code> when saving/removing wheel of fortune outfits</li>\n</ul>\n<h2 id="v032">v0.3.2</h2>\n<ul>\n<li>Minor bugfixes related to interactions with people that lack MBS</li>\n<li>Make the inspection of other people&#39;s custom item sets a bit more robust</li>\n</ul>\n<h2 id="v031">v0.3.1</h2>\n<ul>\n<li>Minor improvements to the README documentation</li>\n<li>Minor <code>pushMBSSettings</code> optimizations</li>\n<li>Raise whenever an unsupported BC version is detected</li>\n<li>Always check for <code>null</code> when performing <code>typeof ... &quot;object&quot;</code> checks</li>\n</ul>\n<h2 id="v030">v0.3.0</h2>\n<ul>\n<li>Expand the list of padlocks that MBS can (potentially) remove, including support for BCX&#39;s <code>block_keyuse_self</code> rule</li>\n<li>Switch from LGPL3 to GPL3</li>\n<li>Up the priority of the <code>WheelFortuneLoad</code> and <code>WheelFortuneExit</code> hooks</li>\n<li>Try to unequip blocking restraints, even if their group does not intersect with the to-be equipped item set</li>\n<li>Fix the wheel of fortune item set preview using the incorrect item set list when viewing other players</li>\n<li>Fix the petrifcation wheel of fortune option occasionally failing to properly color the skin</li>\n</ul>\n<h2 id="v023">v0.2.3</h2>\n<ul>\n<li>Ensure that crafting ID lists are joined via empty strings rather than commas</li>\n</ul>\n<h2 id="v022">v0.2.2</h2>\n<ul>\n<li>Allow the viewing other people&#39;s wheel of fortune item set config</li>\n<li>Create a dedicated MBS changelog file</li>\n<li>Report the changelog whenever the MBS version is incremented</li>\n</ul>\n<h2 id="v021">v0.2.1</h2>\n<ul>\n<li>Fix the first-time initialization of the MBS wheel of fortune settings</li>\n</ul>\n<h2 id="v020">v0.2.0</h2>\n<ul>\n<li>Add the option to create custom wheel of fortune outfits\n<img src="static/images/config.png" alt="Item set example"></li>\n</ul>\n<h2 id="v0118">v0.1.18</h2>\n<ul>\n<li>Always disallow the wheel of fortune to remove owner-/lovers locked items,\neven when decoy restraints are used</li>\n</ul>\n<h2 id="v0117">v0.1.17</h2>\n<ul>\n<li>Add a new petrification-based wheel of fortune option</li>\n<li>Make the first-time initialization of MBS settings more robust</li>\n</ul>\n<h2 id="v0116">v0.1.16</h2>\n<ul>\n<li>Add bookmark-based installation instructions</li>\n<li>Ensure that the user.js scripts are also pushed to github pages</li>\n<li>Add MBS settings and cache the extra crafting items in the MBS settings</li>\n<li>Minor adjustments to the bondage maid outfit color and boots</li>\n</ul>\n<h2 id="v0115">v0.1.15</h2>\n<ul>\n<li>Do not set the member number for locks as this will cause the player to see its password</li>\n<li>Do not let the crafting check raise if the user does not own an item</li>\n<li>Only load MBS after BC is properly loaded</li>\n</ul>\n<h2 id="v0114">v0.1.14</h2>\n<ul>\n<li>Make specifying the strip level mandatory and expand on the available levels</li>\n<li>Add a new mummy outfit for the wheel of fortune</li>\n<li>Add a new bondage maid outfit for the wheel of fortune</li>\n</ul>\n<h2 id="v0113">v0.1.13</h2>\n<ul>\n<li>Fix the downloadURL of the user.js files</li>\n<li>Lower the priority of the futuristic harness</li>\n<li>Allow the removal of locked decoy restraints</li>\n</ul>\n<h2 id="v0112">v0.1.12</h2>\n<ul>\n<li>Use the player&#39;s member number rather than ID</li>\n<li>Check for the Lock effect rather than the presence of a lock</li>\n</ul>\n<h2 id="v0111">v0.1.11</h2>\n<ul>\n<li>Log it whenever a wheel of fortune item fails to equip</li>\n<li>Make the dev and normal <code>user.js</code> scripts more distinct</li>\n<li>Ensure that <code>playerNakedNoCosplay</code> modifies the appearance inplace</li>\n</ul>\n<h2 id="v0110">v0.1.10</h2>\n<ul>\n<li>Ensure that a assigned Typed item properties are copied</li>\n</ul>\n<h2 id="v019">v0.1.9</h2>\n<ul>\n<li>Never strip the character of their cosplay items, regardless of permission settings</li>\n<li>Use the <code>Puzzling</code> crafting property with the High security PSO bondage wheel of fortune option</li>\n</ul>\n<h2 id="v018">v0.1.8</h2>\n<ul>\n<li>Add additional wheel of fortune options based on the PSO (permanently sealed object) suit.</li>\n<li>Bump the number of available crafting slots from 40 to 100.</li>\n</ul>\n'.replaceAll('<img src="static/images/',`<img src="https://bananarama92.github.io/MBS/${i}/images/`);if(document.getElementById("TextAreaChatLog"))CommandsChangelog.Publish(o,{id:"mbs-changelog",href:`https://github.com/bananarama92/MBS/blob/${i}/CHANGELOG.md`,startID:e,stopID:n});else{let t=!1;Kh.hookFunction("ChatRoomCreateElement",0,(r,a)=>{const s=a(r);return t||(t=!0,CommandsChangelog.Publish(o,{id:"mbs-changelog",href:`https://github.com/bananarama92/MBS/blob/${i}/CHANGELOG.md`,startID:e,stopID:n})),s})}}const ef=/^(v?)([0-9]+)(\.([0-9]+))?(\.([0-9]+))?(\.\S+)?$/i;function tf(e,n,r){const i=r[0]?ef.exec(r[0]):null,o=r[1]?ef.exec(r[1]):null;let a=null,s=null;if(i&&o){const e=new jh(Number.parseInt(i[2],10),Number.parseInt(i[4]||"0",10),Number.parseInt(i[6]||"0",10)),t=new jh(Number.parseInt(o[2],10),Number.parseInt(o[4]||"0",10),Number.parseInt(o[6]||"0",10));e.greater(t)?(a=`v${e.major}${e.minor}${e.micro}`,s=`v${t.major}${t.minor}${t.micro}`):(a=`v${t.major}${t.minor}${t.micro}`,s=`v${e.major}${e.minor}${e.micro}`)}else if(i)a=`v${i[2]}${i[4]||0}${i[6]||0}`;else if(o)a=`v${o[2]}${o[4]||0}${o[6]||0}`;else{const e=jh.fromVersion(t);a=`v${e.major}${e.minor}${e.beta?e.micro-1:e.micro}`}Qh(a,s)}function nf(e,t,n){if("number"!=typeof e.default)throw new TypeError(`${n}: Invalid kwarg "${t}.default" type: "${typeof e.default}"`);if(!Number.isFinite(e.default))throw new Error(`${n}: Invalid kwarg "${t}.default" value: "${e.default}"`);if("number"!=typeof e.min)throw new TypeError(`${n}: Invalid kwarg "${t}.min" type: "${typeof e.min}"`);if(!Number.isFinite(e.min))throw new Error(`${n}: Invalid kwarg "${t}.min" value: "${e.min}"`);if("number"!=typeof e.max)throw new TypeError(`${n}: Invalid kwarg "${t}.max" type: "${typeof e.max}"`);if(!Number.isFinite(e.max))throw new Error(`${n}: Invalid kwarg "${t}.max" value: "${e.max}"`);if(null!=e.step){if("number"!=typeof e.step)throw new TypeError(`${n}: Invalid kwarg "${t}.step" type: "${typeof e.step}"`);if(!Number.isFinite(e.step))throw new Error(`${n}: Invalid kwarg "${t}.step" value: "${e.step}"`)}if(null!=e.inputmode&&"numeric"!=e.inputmode&&"decimal"!=e.inputmode)throw new Error(`${n}: Invalid kwarg "${t}.inputmode" value: "${e.inputmode}"`);if(null!=e.suggestions){if(!Sh(e.suggestions))throw new TypeError(`${n}: Invalid kwarg "${t}.suggestions" type: "${typeof e.suggestions}"`);if(!e.suggestions.every(e=>"number"==typeof e))throw new Error(`${n}: Invalid kwarg "${t}.suggestions" value: all array member must be numbers`);if(!e.suggestions.every(t=>t>=e.min&&t<=e.max))throw new RangeError(`${n}: Invalid kwarg "${t}.suggestions" value: all array member must lie in the [${t}.min, ${t}.max] interval`)}if(e.max<e.min)throw new Error(`${n}: Kwarg "${t}.min" cannot be larger than "${t}.max"`);if(e.default<e.min)throw new Error(`${n}: Kwarg "${t}.min" cannot be larger than "${t}.default"`);if(e.max<e.default)throw new Error(`${n}: Kwarg "${t}.default" cannot be larger than "${t}.max"`)}function rf(e,t,n){if("string"!=typeof e.default)throw new TypeError(`${n}: Invalid kwarg "${t}.default" type: "${typeof e.default}"`);if(null!=e.minlength&&Eh(e.minlength,"kwarg.minlength",0,void 0,n),null!=e.maxlength&&Eh(e.maxlength,"kwarg.maxlength",1,void 0,n),null!=e.spellcheck&&"boolean"!=typeof e.spellcheck)throw new TypeError(`${n}: Invalid kwarg "${t}.spellcheck" type: "${typeof e.spellcheck}"`);if(null!=e.pattern&&"string"!=typeof e.pattern&&!(e.pattern instanceof RegExp))throw new TypeError(`${n}: Invalid kwarg "${t}.pattern" type: "${typeof e.pattern}"`);if(null!=e.suggestions&&!Sh(e.suggestions))throw new TypeError(`${n}: Invalid kwarg "${t}.suggestions" type: "${typeof e.suggestions}"`);if(!(e.suggestions??[]).every(e=>"string"==typeof e))throw new Error(`${n}: Invalid kwarg "${t}.suggestions" value: all array member must be strings`);if(null!=e.minlength&&null!=e.maxlength&&e.minlength>e.maxlength)throw new Error(`${n}: Kwarg "${t}.minlength" cannot be larger than "${t}.maxlength"`)}function of(e,t,n){if("boolean"!=typeof e.default)throw new TypeError(`${n}: Invalid kwarg "${t}.default" type: "${typeof e.default}"`)}function af(e,t,n){if(null!=e.size&&Eh(e.size,"kwarg.size",0,void 0,n),null!=e.required&&"boolean"!=typeof e.required)throw new TypeError(`${n}: Invalid kwarg "${t}.required" type: "${typeof e.required}"`);if(!Sh(e.options))throw new TypeError(`${n}: Invalid kwarg "${t}.options" type: "${typeof e.options}"`);if(0===e.options.length)throw new TypeError(`${n}: Invalid kwarg "${t}.options" value: array must be of length >=1`);let r=0;for(const i of e.options){if(!CommonIsObject(i))throw new TypeError(`${n}: Invalid kwarg "${t}.options" value: array member is of invalid type "${typeof e.options}"`);if("string"!=typeof i.label)throw new TypeError(`${n}: Invalid kwarg "${t}.options" value: array member labels must be strings`);if(!i.label)throw new Error(`${n}: Invalid kwarg "${t}.options" value: array member labels must be non-empty strings`);if(null!=i.value&&"string"!=typeof i.value)throw new TypeError(`${n}: Invalid kwarg "${t}.options" value: array member values must be nullish or strings`);if(i.default&&r++,null!=i.default&&"boolean"!=typeof i.default)throw new TypeError(`${n}: Invalid kwarg "${t}.options" value: array member defaults must nullish or booleans`);if(null!=i.group&&"string"!=typeof i.group)throw new TypeError(`${n}: Invalid kwarg "${t}.options" value: array member groups must nullish or booleans`)}if("select"===e.type&&r>1)throw new Error(`${n}: Invalid kwarg "${t}.options" value: array cannot have more than one default option`)}function sf(e){return function(t){const n=this.closest(".mbs-fwitemset-event"),r=n?.getAttribute("data-name"),i=n?.getAttribute("data-type"),o=n?.getAttribute("data-mod"),a=e.activeHooks.get(`${o}-${i}-${r}`),s=this.closest("label")?.querySelector(".mbs-fwitemset-event-error-msg");if(!a||!s||!r)return void t.stopImmediatePropagation();if(!this.validity.valid)return s.textContent=` (${this.validationMessage})`,void t.stopImmediatePropagation();s.textContent="";const l=this.name;switch(this.type){case"number":a.kwargs.set(l,{type:"number",value:this.valueAsNumber});break;case"text":a.kwargs.set(l,{type:"text",value:this.value});break;case"checkbox":a.kwargs.set(l,{type:"checkbox",value:this.checked})}}}function lf(e){return function(t){const n=this.closest(".mbs-fwitemset-event"),r=n?.getAttribute("data-name"),i=n?.getAttribute("data-type"),o=n?.getAttribute("data-mod"),a=e.activeHooks.get(`${o}-${i}-${r}`),s=this.closest("label")?.querySelector(".mbs-fwitemset-event-error-msg");if(!s||!a||!r)return void t.stopImmediatePropagation();if(!this.validity.valid)return s.textContent=` (${this.validationMessage})`,void t.stopImmediatePropagation();s.textContent="";const l=this.name;a.kwargs.set(l,{type:"select",value:this.value})}}function uf(e){return function(t){const n=this.closest(".mbs-fwitemset-event"),r=n?.getAttribute("data-name"),i=n?.getAttribute("data-type"),o=n?.getAttribute("data-mod"),a=e.activeHooks.get(`${o}-${i}-${r}`),s=this.closest("label")?.querySelector(".mbs-fwitemset-event-error-msg");if(!a||!s||!r)return void t.stopImmediatePropagation();if(this.required){const e=!Array.from(this.selectedOptions).some(e=>e.value);this.setCustomValidity(e?"Please select one or more items in the list":"")}if(!this.validity.valid)return s.textContent=` (${this.validationMessage})`,void t.stopImmediatePropagation();let l;s.textContent="";const u=new Set;l=0===this.selectedOptions.length?"none":this.selectedOptions.length===this.options.length?"all":"some";for(const e of this.selectedOptions)e.value&&u.add(e.value);const c=this.name;a.kwargs.set(c,{type:"select-multiple",state:l,value:u})}}function cf(e,t,n,r){const i=[n.default];let o;return n.suggestions&&(i.push(E.jsx("datalist",{id:`${e}-${t}-datalist`,children:n.suggestions.map(e=>E.jsx("option",{children:e}))})),o=`${e}-${t}-datalist`),ElementCreate({tag:"input",attributes:{type:"text",minlength:n.minlength,maxlength:n.maxlength,pattern:n.pattern instanceof RegExp?n.pattern.source:n.pattern,spellcheck:n.spellcheck,list:o,size:0,name:t,disabled:!0},classList:["mbs-fwitemset-event-kwarg-config"],children:i,eventListeners:{change:sf(r)}})}function df(e,t,n,r){const i=[];let o;n.suggestions&&(i.push(E.jsx("datalist",{id:`${e}-${t}-datalist`,children:n.suggestions.map(e=>E.jsx("option",{children:e}))})),o=`${e}-${t}-datalist`);const a=Number.isInteger(n.default)&&Number.isInteger(n.min)&&Number.isInteger(n.max)&&(null==n.step||Number.isInteger(n.step))?"numeric":"decimal";return ElementCreate({tag:"input",attributes:{type:"number",min:n.min,max:n.max,value:n.default,step:null==n.step?void 0:n.step,inputmode:n.inputmode??a,list:o,size:0,name:t,disabled:!0},children:i,classList:["mbs-fwitemset-event-kwarg-config"],eventListeners:{change:sf(r),wheel(e){if(this.disabled||document.activeElement!==this)e.stopImmediatePropagation();else{if(e.preventDefault(),e.deltaY<0)this.stepUp();else{if(!(e.deltaY>0))return;this.stepDown()}this.dispatchEvent(new InputEvent("input"))}}}})}function hf(e,t,n,r){return ElementCreate({tag:"input",attributes:{type:"checkbox",checked:n.default,name:t,disabled:!0},classList:["checkbox","mbs-fwitemset-event-kwarg-config"],eventListeners:{change:sf(r)}})}function ff(){const e=this.getAttribute("aria-controls"),t=e?document.getElementById(e):null,n=this.hasAttribute("data-select-all");if(t instanceof HTMLSelectElement){for(const e of t.options)e.selected=n;t.dispatchEvent(new Event("change")),t.focus()}}function pf(e,t,n,r){const i=[],o={};let a=0;for(const e of n.options){(e.group?o[e.group]??=[]:i).push(ElementCreate({tag:"option",attributes:{selected:e.default,value:e.value},children:[e.label]})),e.default&&a++}for(const[e,t]of Object.entries(o))i.push(E.jsx("optgroup",{label:e,children:t}));const s=[];switch(n.type){case"select":if(a>1)throw new Error(`Keyword argument "${t}" of type "${n.type}" has more than one default value (${a})`);s.push(E.jsx("option",{selected:!0,"aria-hidden":"true",children:"--Select an option--"}));break;case"select-multiple":break;default:throw new Error}s.forEach(e=>e.setAttribute("value","")),i.unshift(...s,E.jsx("hr",{}));const l=ElementCreate({tag:"select",attributes:{multiple:"select-multiple"===n.type,required:n.required,size:"select-multiple"===n.type?n.size??5:n.size,name:t,disabled:!0,id:`${e}-select`},classList:["mbs-fwitemset-event-kwarg-config"],eventListeners:{change:"select"===n.type?lf(r):uf(r),focus(){try{this.showPicker?.()}catch{return}}},children:i});return"select"===n.type?l:E.jsxs("div",{class:"mbs-fwitemset-event-multi-select",role:"group",children:[l,ElementButton.Create(`${e}-select-all`,ff,{label:"Select all",labelPosition:"center"},{button:{attributes:{"aria-controls":`${e}-select`,"screen-generated":void 0},dataAttributes:{selectAll:""},classList:["mbs-fwitemset-event-kwarg-config"]}}),ElementButton.Create(`${e}-select-none`,ff,{label:"Select none",labelPosition:"center"},{button:{attributes:{"aria-controls":`${e}-select`,"screen-generated":void 0},classList:["mbs-fwitemset-event-kwarg-config"]}})]})}function gf(e){if(e instanceof HTMLInputElement)switch(e.type){case"checkbox":e.checked=e.defaultChecked;break;case"number":case"text":e.value=e.defaultValue}else if(e instanceof HTMLSelectElement)for(const t of e.options)t.selected=t.defaultSelected}function mf(e,t,n){for(const r of e.querySelectorAll(".mbs-fwitemset-event-kwarg-config")){if(r instanceof HTMLButtonElement){r.toggleAttribute("disabled",n);continue}const e=r.getAttribute("name");if(!e)continue;const i=t.get(e);switch(i?.type){case"checkbox":r instanceof HTMLInputElement&&"checkbox"===r.type&&(r.checked=i.value);break;case"text":r instanceof HTMLInputElement&&"text"===r.type&&(r.value=i.value);break;case"number":r instanceof HTMLInputElement&&"number"===r.type&&(r.valueAsNumber=i.value);break;case"select-multiple":case"select":if(r instanceof HTMLSelectElement){const e=i.value instanceof Set?i.value:new Set([i.value]);for(const t of r.options)"none"===i.state?t.selected=!1:"all"===i.state?t.selected=!0:t.selected=e.has(t.value)}break;default:gf(r)}r.toggleAttribute("disabled",n)}}Fh("changelog",{async afterLoad(){CommandCombine({Tag:"mbschangelog",Description:"[version-start] [version-end]: Show the changelog(s) of the specified MBS version or version range; defaults to the latest version",Action:tf})}});var vf,yf={exports:{}},bf=yf.exports;
/**
	 * @license
	 * Lodash <https://lodash.com/>
	 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
	 * Released under MIT license <https://lodash.com/license>
	 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
	 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
	 */var Rf=(vf||(vf=1,function(e,t){(function(){var r,i="Expected a function",o="__lodash_hash_undefined__",a="__lodash_placeholder__",s=16,l=32,u=64,c=128,d=256,h=1/0,f=9007199254740991,p=NaN,g=4294967295,m=[["ary",c],["bind",1],["bindKey",2],["curry",8],["curryRight",s],["flip",512],["partial",l],["partialRight",u],["rearg",d]],v="[object Arguments]",y="[object Array]",b="[object Boolean]",R="[object Date]",w="[object Error]",S="[object Function]",B="[object GeneratorFunction]",k="[object Map]",C="[object Number]",_="[object Object]",x="[object Promise]",P="[object RegExp]",E="[object Set]",M="[object String]",I="[object Symbol]",j="[object WeakMap]",O="[object ArrayBuffer]",A="[object DataView]",$="[object Float32Array]",F="[object Float64Array]",L="[object Int8Array]",T="[object Int16Array]",D="[object Int32Array]",H="[object Uint8Array]",N="[object Uint8ClampedArray]",G="[object Uint16Array]",W="[object Uint32Array]",q=/\b__p \+= '';/g,z=/\b(__p \+=) '' \+/g,K=/(__e\(.*?\)|\b__t\)) \+\n'';/g,U=/&(?:amp|lt|gt|quot|#39);/g,V=/[&<>"']/g,J=RegExp(U.source),Y=RegExp(V.source),X=/<%-([\s\S]+?)%>/g,Z=/<%([\s\S]+?)%>/g,Q=/<%=([\s\S]+?)%>/g,ee=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,te=/^\w*$/,ne=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,re=/[\\^$.*+?()[\]{}|]/g,ie=RegExp(re.source),oe=/^\s+/,ae=/\s/,se=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,le=/\{\n\/\* \[wrapped with (.+)\] \*/,ue=/,? & /,ce=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,de=/[()=,{}\[\]\/\s]/,he=/\\(\\)?/g,fe=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,pe=/\w*$/,ge=/^[-+]0x[0-9a-f]+$/i,me=/^0b[01]+$/i,ve=/^\[object .+?Constructor\]$/,ye=/^0o[0-7]+$/i,be=/^(?:0|[1-9]\d*)$/,Re=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,we=/($^)/,Se=/['\n\r\u2028\u2029\\]/g,Be="\\ud800-\\udfff",ke="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",Ce="\\u2700-\\u27bf",_e="a-z\\xdf-\\xf6\\xf8-\\xff",xe="A-Z\\xc0-\\xd6\\xd8-\\xde",Pe="\\ufe0e\\ufe0f",Ee="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Me="['’]",Ie="["+Be+"]",je="["+Ee+"]",Oe="["+ke+"]",Ae="\\d+",$e="["+Ce+"]",Fe="["+_e+"]",Le="[^"+Be+Ee+Ae+Ce+_e+xe+"]",Te="\\ud83c[\\udffb-\\udfff]",De="[^"+Be+"]",He="(?:\\ud83c[\\udde6-\\uddff]){2}",Ne="[\\ud800-\\udbff][\\udc00-\\udfff]",Ge="["+xe+"]",We="\\u200d",qe="(?:"+Fe+"|"+Le+")",ze="(?:"+Ge+"|"+Le+")",Ke="(?:['’](?:d|ll|m|re|s|t|ve))?",Ue="(?:['’](?:D|LL|M|RE|S|T|VE))?",Ve="(?:"+Oe+"|"+Te+")?",Je="["+Pe+"]?",Ye=Je+Ve+"(?:"+We+"(?:"+[De,He,Ne].join("|")+")"+Je+Ve+")*",Xe="(?:"+[$e,He,Ne].join("|")+")"+Ye,Ze="(?:"+[De+Oe+"?",Oe,He,Ne,Ie].join("|")+")",Qe=RegExp(Me,"g"),et=RegExp(Oe,"g"),tt=RegExp(Te+"(?="+Te+")|"+Ze+Ye,"g"),nt=RegExp([Ge+"?"+Fe+"+"+Ke+"(?="+[je,Ge,"$"].join("|")+")",ze+"+"+Ue+"(?="+[je,Ge+qe,"$"].join("|")+")",Ge+"?"+qe+"+"+Ke,Ge+"+"+Ue,"\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Ae,Xe].join("|"),"g"),rt=RegExp("["+We+Be+ke+Pe+"]"),it=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,ot=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],at=-1,st={};st[$]=st[F]=st[L]=st[T]=st[D]=st[H]=st[N]=st[G]=st[W]=!0,st[v]=st[y]=st[O]=st[b]=st[A]=st[R]=st[w]=st[S]=st[k]=st[C]=st[_]=st[P]=st[E]=st[M]=st[j]=!1;var lt={};lt[v]=lt[y]=lt[O]=lt[A]=lt[b]=lt[R]=lt[$]=lt[F]=lt[L]=lt[T]=lt[D]=lt[k]=lt[C]=lt[_]=lt[P]=lt[E]=lt[M]=lt[I]=lt[H]=lt[N]=lt[G]=lt[W]=!0,lt[w]=lt[S]=lt[j]=!1;var ut={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},ct=parseFloat,dt=parseInt,ht="object"==typeof n&&n&&n.Object===Object&&n,ft="object"==typeof self&&self&&self.Object===Object&&self,pt=ht||ft||Function("return this")(),gt=t&&!t.nodeType&&t,mt=gt&&e&&!e.nodeType&&e,vt=mt&&mt.exports===gt,yt=vt&&ht.process,bt=function(){try{var e=mt&&mt.require&&mt.require("util").types;return e||yt&&yt.binding&&yt.binding("util")}catch(e){}}(),Rt=bt&&bt.isArrayBuffer,wt=bt&&bt.isDate,St=bt&&bt.isMap,Bt=bt&&bt.isRegExp,kt=bt&&bt.isSet,Ct=bt&&bt.isTypedArray;function _t(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}function xt(e,t,n,r){for(var i=-1,o=null==e?0:e.length;++i<o;){var a=e[i];t(r,a,n(a),e)}return r}function Pt(e,t){for(var n=-1,r=null==e?0:e.length;++n<r&&!1!==t(e[n],n,e););return e}function Et(e,t){for(var n=null==e?0:e.length;n--&&!1!==t(e[n],n,e););return e}function Mt(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(!t(e[n],n,e))return!1;return!0}function It(e,t){for(var n=-1,r=null==e?0:e.length,i=0,o=[];++n<r;){var a=e[n];t(a,n,e)&&(o[i++]=a)}return o}function jt(e,t){return!(null==e||!e.length)&&Gt(e,t,0)>-1}function Ot(e,t,n){for(var r=-1,i=null==e?0:e.length;++r<i;)if(n(t,e[r]))return!0;return!1}function At(e,t){for(var n=-1,r=null==e?0:e.length,i=Array(r);++n<r;)i[n]=t(e[n],n,e);return i}function $t(e,t){for(var n=-1,r=t.length,i=e.length;++n<r;)e[i+n]=t[n];return e}function Ft(e,t,n,r){var i=-1,o=null==e?0:e.length;for(r&&o&&(n=e[++i]);++i<o;)n=t(n,e[i],i,e);return n}function Lt(e,t,n,r){var i=null==e?0:e.length;for(r&&i&&(n=e[--i]);i--;)n=t(n,e[i],i,e);return n}function Tt(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1}var Dt=Kt("length");function Ht(e,t,n){var r;return n(e,function(e,n,i){if(t(e,n,i))return r=n,!1}),r}function Nt(e,t,n,r){for(var i=e.length,o=n+(r?1:-1);r?o--:++o<i;)if(t(e[o],o,e))return o;return-1}function Gt(e,t,n){return t==t?function(e,t,n){for(var r=n-1,i=e.length;++r<i;)if(e[r]===t)return r;return-1}(e,t,n):Nt(e,qt,n)}function Wt(e,t,n,r){for(var i=n-1,o=e.length;++i<o;)if(r(e[i],t))return i;return-1}function qt(e){return e!=e}function zt(e,t){var n=null==e?0:e.length;return n?Jt(e,t)/n:p}function Kt(e){return function(t){return null==t?r:t[e]}}function Ut(e){return function(t){return null==e?r:e[t]}}function Vt(e,t,n,r,i){return i(e,function(e,i,o){n=r?(r=!1,e):t(n,e,i,o)}),n}function Jt(e,t){for(var n,i=-1,o=e.length;++i<o;){var a=t(e[i]);a!==r&&(n=n===r?a:n+a)}return n}function Yt(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}function Xt(e){return e?e.slice(0,gn(e)+1).replace(oe,""):e}function Zt(e){return function(t){return e(t)}}function Qt(e,t){return At(t,function(t){return e[t]})}function en(e,t){return e.has(t)}function tn(e,t){for(var n=-1,r=e.length;++n<r&&Gt(t,e[n],0)>-1;);return n}function nn(e,t){for(var n=e.length;n--&&Gt(t,e[n],0)>-1;);return n}var rn=Ut({"À":"A","Á":"A","Â":"A","Ã":"A","Ä":"A","Å":"A","à":"a","á":"a","â":"a","ã":"a","ä":"a","å":"a","Ç":"C","ç":"c","Ð":"D","ð":"d","È":"E","É":"E","Ê":"E","Ë":"E","è":"e","é":"e","ê":"e","ë":"e","Ì":"I","Í":"I","Î":"I","Ï":"I","ì":"i","í":"i","î":"i","ï":"i","Ñ":"N","ñ":"n","Ò":"O","Ó":"O","Ô":"O","Õ":"O","Ö":"O","Ø":"O","ò":"o","ó":"o","ô":"o","õ":"o","ö":"o","ø":"o","Ù":"U","Ú":"U","Û":"U","Ü":"U","ù":"u","ú":"u","û":"u","ü":"u","Ý":"Y","ý":"y","ÿ":"y","Æ":"Ae","æ":"ae","Þ":"Th","þ":"th","ß":"ss","Ā":"A","Ă":"A","Ą":"A","ā":"a","ă":"a","ą":"a","Ć":"C","Ĉ":"C","Ċ":"C","Č":"C","ć":"c","ĉ":"c","ċ":"c","č":"c","Ď":"D","Đ":"D","ď":"d","đ":"d","Ē":"E","Ĕ":"E","Ė":"E","Ę":"E","Ě":"E","ē":"e","ĕ":"e","ė":"e","ę":"e","ě":"e","Ĝ":"G","Ğ":"G","Ġ":"G","Ģ":"G","ĝ":"g","ğ":"g","ġ":"g","ģ":"g","Ĥ":"H","Ħ":"H","ĥ":"h","ħ":"h","Ĩ":"I","Ī":"I","Ĭ":"I","Į":"I","İ":"I","ĩ":"i","ī":"i","ĭ":"i","į":"i","ı":"i","Ĵ":"J","ĵ":"j","Ķ":"K","ķ":"k","ĸ":"k","Ĺ":"L","Ļ":"L","Ľ":"L","Ŀ":"L","Ł":"L","ĺ":"l","ļ":"l","ľ":"l","ŀ":"l","ł":"l","Ń":"N","Ņ":"N","Ň":"N","Ŋ":"N","ń":"n","ņ":"n","ň":"n","ŋ":"n","Ō":"O","Ŏ":"O","Ő":"O","ō":"o","ŏ":"o","ő":"o","Ŕ":"R","Ŗ":"R","Ř":"R","ŕ":"r","ŗ":"r","ř":"r","Ś":"S","Ŝ":"S","Ş":"S","Š":"S","ś":"s","ŝ":"s","ş":"s","š":"s","Ţ":"T","Ť":"T","Ŧ":"T","ţ":"t","ť":"t","ŧ":"t","Ũ":"U","Ū":"U","Ŭ":"U","Ů":"U","Ű":"U","Ų":"U","ũ":"u","ū":"u","ŭ":"u","ů":"u","ű":"u","ų":"u","Ŵ":"W","ŵ":"w","Ŷ":"Y","ŷ":"y","Ÿ":"Y","Ź":"Z","Ż":"Z","Ž":"Z","ź":"z","ż":"z","ž":"z","Ĳ":"IJ","ĳ":"ij","Œ":"Oe","œ":"oe","ŉ":"'n","ſ":"s"}),on=Ut({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function an(e){return"\\"+ut[e]}function sn(e){return rt.test(e)}function ln(e){var t=-1,n=Array(e.size);return e.forEach(function(e,r){n[++t]=[r,e]}),n}function un(e,t){return function(n){return e(t(n))}}function cn(e,t){for(var n=-1,r=e.length,i=0,o=[];++n<r;){var s=e[n];s!==t&&s!==a||(e[n]=a,o[i++]=n)}return o}function dn(e){var t=-1,n=Array(e.size);return e.forEach(function(e){n[++t]=e}),n}function hn(e){var t=-1,n=Array(e.size);return e.forEach(function(e){n[++t]=[e,e]}),n}function fn(e){return sn(e)?function(e){for(var t=tt.lastIndex=0;tt.test(e);)++t;return t}(e):Dt(e)}function pn(e){return sn(e)?function(e){return e.match(tt)||[]}(e):function(e){return e.split("")}(e)}function gn(e){for(var t=e.length;t--&&ae.test(e.charAt(t)););return t}var mn=Ut({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"}),vn=function e(t){var n=(t=null==t?pt:vn.defaults(pt.Object(),t,vn.pick(pt,ot))).Array,ae=t.Date,Be=t.Error,ke=t.Function,Ce=t.Math,_e=t.Object,xe=t.RegExp,Pe=t.String,Ee=t.TypeError,Me=n.prototype,Ie=ke.prototype,je=_e.prototype,Oe=t["__core-js_shared__"],Ae=Ie.toString,$e=je.hasOwnProperty,Fe=0,Le=function(){var e=/[^.]+$/.exec(Oe&&Oe.keys&&Oe.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),Te=je.toString,De=Ae.call(_e),He=pt._,Ne=xe("^"+Ae.call($e).replace(re,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Ge=vt?t.Buffer:r,We=t.Symbol,qe=t.Uint8Array,ze=Ge?Ge.allocUnsafe:r,Ke=un(_e.getPrototypeOf,_e),Ue=_e.create,Ve=je.propertyIsEnumerable,Je=Me.splice,Ye=We?We.isConcatSpreadable:r,Xe=We?We.iterator:r,Ze=We?We.toStringTag:r,tt=function(){try{var e=ho(_e,"defineProperty");return e({},"",{}),e}catch(e){}}(),rt=t.clearTimeout!==pt.clearTimeout&&t.clearTimeout,ut=ae&&ae.now!==pt.Date.now&&ae.now,ht=t.setTimeout!==pt.setTimeout&&t.setTimeout,ft=Ce.ceil,gt=Ce.floor,mt=_e.getOwnPropertySymbols,yt=Ge?Ge.isBuffer:r,bt=t.isFinite,Dt=Me.join,Ut=un(_e.keys,_e),yn=Ce.max,bn=Ce.min,Rn=ae.now,wn=t.parseInt,Sn=Ce.random,Bn=Me.reverse,kn=ho(t,"DataView"),Cn=ho(t,"Map"),_n=ho(t,"Promise"),xn=ho(t,"Set"),Pn=ho(t,"WeakMap"),En=ho(_e,"create"),Mn=Pn&&new Pn,In={},jn=To(kn),On=To(Cn),An=To(_n),$n=To(xn),Fn=To(Pn),Ln=We?We.prototype:r,Tn=Ln?Ln.valueOf:r,Dn=Ln?Ln.toString:r;function Hn(e){if(ts(e)&&!qa(e)&&!(e instanceof qn)){if(e instanceof Wn)return e;if($e.call(e,"__wrapped__"))return Do(e)}return new Wn(e)}var Nn=function(){function e(){}return function(t){if(!es(t))return{};if(Ue)return Ue(t);e.prototype=t;var n=new e;return e.prototype=r,n}}();function Gn(){}function Wn(e,t){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!t,this.__index__=0,this.__values__=r}function qn(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=g,this.__views__=[]}function zn(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function Kn(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function Un(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function Vn(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new Un;++t<n;)this.add(e[t])}function Jn(e){var t=this.__data__=new Kn(e);this.size=t.size}function Yn(e,t){var n=qa(e),r=!n&&Wa(e),i=!n&&!r&&Va(e),o=!n&&!r&&!i&&us(e),a=n||r||i||o,s=a?Yt(e.length,Pe):[],l=s.length;for(var u in e)!t&&!$e.call(e,u)||a&&("length"==u||i&&("offset"==u||"parent"==u)||o&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||bo(u,l))||s.push(u);return s}function Xn(e){var t=e.length;return t?e[Vr(0,t-1)]:r}function Zn(e,t){return $o(Ei(e),sr(t,0,e.length))}function Qn(e){return $o(Ei(e))}function er(e,t,n){(n!==r&&!Ha(e[t],n)||n===r&&!(t in e))&&or(e,t,n)}function tr(e,t,n){var i=e[t];$e.call(e,t)&&Ha(i,n)&&(n!==r||t in e)||or(e,t,n)}function nr(e,t){for(var n=e.length;n--;)if(Ha(e[n][0],t))return n;return-1}function rr(e,t,n,r){return hr(e,function(e,i,o){t(r,e,n(e),o)}),r}function ir(e,t){return e&&Mi(t,Is(t),e)}function or(e,t,n){"__proto__"==t&&tt?tt(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}function ar(e,t){for(var i=-1,o=t.length,a=n(o),s=null==e;++i<o;)a[i]=s?r:_s(e,t[i]);return a}function sr(e,t,n){return e==e&&(n!==r&&(e=e<=n?e:n),t!==r&&(e=e>=t?e:t)),e}function lr(e,t,n,i,o,a){var s,l=1&t,u=2&t,c=4&t;if(n&&(s=o?n(e,i,o,a):n(e)),s!==r)return s;if(!es(e))return e;var d=qa(e);if(d){if(s=function(e){var t=e.length,n=new e.constructor(t);return t&&"string"==typeof e[0]&&$e.call(e,"index")&&(n.index=e.index,n.input=e.input),n}(e),!l)return Ei(e,s)}else{var h=go(e),f=h==S||h==B;if(Va(e))return Bi(e,l);if(h==_||h==v||f&&!o){if(s=u||f?{}:vo(e),!l)return u?function(e,t){return Mi(e,po(e),t)}(e,function(e,t){return e&&Mi(t,js(t),e)}(s,e)):function(e,t){return Mi(e,fo(e),t)}(e,ir(s,e))}else{if(!lt[h])return o?e:{};s=function(e,t,n){var r,i=e.constructor;switch(t){case O:return ki(e);case b:case R:return new i(+e);case A:return function(e,t){var n=t?ki(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)}(e,n);case $:case F:case L:case T:case D:case H:case N:case G:case W:return Ci(e,n);case k:return new i;case C:case M:return new i(e);case P:return function(e){var t=new e.constructor(e.source,pe.exec(e));return t.lastIndex=e.lastIndex,t}(e);case E:return new i;case I:return r=e,Tn?_e(Tn.call(r)):{}}}(e,h,l)}}a||(a=new Jn);var p=a.get(e);if(p)return p;a.set(e,s),as(e)?e.forEach(function(r){s.add(lr(r,t,n,r,e,a))}):ns(e)&&e.forEach(function(r,i){s.set(i,lr(r,t,n,i,e,a))});var g=d?r:(c?u?io:ro:u?js:Is)(e);return Pt(g||e,function(r,i){g&&(r=e[i=r]),tr(s,i,lr(r,t,n,i,e,a))}),s}function ur(e,t,n){var i=n.length;if(null==e)return!i;for(e=_e(e);i--;){var o=n[i],a=t[o],s=e[o];if(s===r&&!(o in e)||!a(s))return!1}return!0}function cr(e,t,n){if("function"!=typeof e)throw new Ee(i);return Io(function(){e.apply(r,n)},t)}function dr(e,t,n,r){var i=-1,o=jt,a=!0,s=e.length,l=[],u=t.length;if(!s)return l;n&&(t=At(t,Zt(n))),r?(o=Ot,a=!1):t.length>=200&&(o=en,a=!1,t=new Vn(t));e:for(;++i<s;){var c=e[i],d=null==n?c:n(c);if(c=r||0!==c?c:0,a&&d==d){for(var h=u;h--;)if(t[h]===d)continue e;l.push(c)}else o(t,d,r)||l.push(c)}return l}Hn.templateSettings={escape:X,evaluate:Z,interpolate:Q,variable:"",imports:{_:Hn}},Hn.prototype=Gn.prototype,Hn.prototype.constructor=Hn,Wn.prototype=Nn(Gn.prototype),Wn.prototype.constructor=Wn,qn.prototype=Nn(Gn.prototype),qn.prototype.constructor=qn,zn.prototype.clear=function(){this.__data__=En?En(null):{},this.size=0},zn.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},zn.prototype.get=function(e){var t=this.__data__;if(En){var n=t[e];return n===o?r:n}return $e.call(t,e)?t[e]:r},zn.prototype.has=function(e){var t=this.__data__;return En?t[e]!==r:$e.call(t,e)},zn.prototype.set=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=En&&t===r?o:t,this},Kn.prototype.clear=function(){this.__data__=[],this.size=0},Kn.prototype.delete=function(e){var t=this.__data__,n=nr(t,e);return!(n<0||(n==t.length-1?t.pop():Je.call(t,n,1),--this.size,0))},Kn.prototype.get=function(e){var t=this.__data__,n=nr(t,e);return n<0?r:t[n][1]},Kn.prototype.has=function(e){return nr(this.__data__,e)>-1},Kn.prototype.set=function(e,t){var n=this.__data__,r=nr(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this},Un.prototype.clear=function(){this.size=0,this.__data__={hash:new zn,map:new(Cn||Kn),string:new zn}},Un.prototype.delete=function(e){var t=uo(this,e).delete(e);return this.size-=t?1:0,t},Un.prototype.get=function(e){return uo(this,e).get(e)},Un.prototype.has=function(e){return uo(this,e).has(e)},Un.prototype.set=function(e,t){var n=uo(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this},Vn.prototype.add=Vn.prototype.push=function(e){return this.__data__.set(e,o),this},Vn.prototype.has=function(e){return this.__data__.has(e)},Jn.prototype.clear=function(){this.__data__=new Kn,this.size=0},Jn.prototype.delete=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n},Jn.prototype.get=function(e){return this.__data__.get(e)},Jn.prototype.has=function(e){return this.__data__.has(e)},Jn.prototype.set=function(e,t){var n=this.__data__;if(n instanceof Kn){var r=n.__data__;if(!Cn||r.length<199)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new Un(r)}return n.set(e,t),this.size=n.size,this};var hr=Oi(Rr),fr=Oi(wr,!0);function pr(e,t){var n=!0;return hr(e,function(e,r,i){return n=!!t(e,r,i)}),n}function gr(e,t,n){for(var i=-1,o=e.length;++i<o;){var a=e[i],s=t(a);if(null!=s&&(l===r?s==s&&!ls(s):n(s,l)))var l=s,u=a}return u}function mr(e,t){var n=[];return hr(e,function(e,r,i){t(e,r,i)&&n.push(e)}),n}function vr(e,t,n,r,i){var o=-1,a=e.length;for(n||(n=yo),i||(i=[]);++o<a;){var s=e[o];t>0&&n(s)?t>1?vr(s,t-1,n,r,i):$t(i,s):r||(i[i.length]=s)}return i}var yr=Ai(),br=Ai(!0);function Rr(e,t){return e&&yr(e,t,Is)}function wr(e,t){return e&&br(e,t,Is)}function Sr(e,t){return It(t,function(t){return Xa(e[t])})}function Br(e,t){for(var n=0,i=(t=bi(t,e)).length;null!=e&&n<i;)e=e[Lo(t[n++])];return n&&n==i?e:r}function kr(e,t,n){var r=t(e);return qa(e)?r:$t(r,n(e))}function Cr(e){return null==e?e===r?"[object Undefined]":"[object Null]":Ze&&Ze in _e(e)?function(e){var t=$e.call(e,Ze),n=e[Ze];try{e[Ze]=r;var i=!0}catch(e){}var o=Te.call(e);return i&&(t?e[Ze]=n:delete e[Ze]),o}(e):function(e){return Te.call(e)}(e)}function _r(e,t){return e>t}function xr(e,t){return null!=e&&$e.call(e,t)}function Pr(e,t){return null!=e&&t in _e(e)}function Er(e,t,i){for(var o=i?Ot:jt,a=e[0].length,s=e.length,l=s,u=n(s),c=1/0,d=[];l--;){var h=e[l];l&&t&&(h=At(h,Zt(t))),c=bn(h.length,c),u[l]=!i&&(t||a>=120&&h.length>=120)?new Vn(l&&h):r}h=e[0];var f=-1,p=u[0];e:for(;++f<a&&d.length<c;){var g=h[f],m=t?t(g):g;if(g=i||0!==g?g:0,!(p?en(p,m):o(d,m,i))){for(l=s;--l;){var v=u[l];if(!(v?en(v,m):o(e[l],m,i)))continue e}p&&p.push(m),d.push(g)}}return d}function Mr(e,t,n){var i=null==(e=Po(e,t=bi(t,e)))?e:e[Lo(Yo(t))];return null==i?r:_t(i,e,n)}function Ir(e){return ts(e)&&Cr(e)==v}function jr(e,t,n,i,o){return e===t||(null==e||null==t||!ts(e)&&!ts(t)?e!=e&&t!=t:function(e,t,n,i,o,a){var s=qa(e),l=qa(t),u=s?y:go(e),c=l?y:go(t),d=(u=u==v?_:u)==_,h=(c=c==v?_:c)==_,f=u==c;if(f&&Va(e)){if(!Va(t))return!1;s=!0,d=!1}if(f&&!d)return a||(a=new Jn),s||us(e)?to(e,t,n,i,o,a):function(e,t,n,r,i,o,a){switch(n){case A:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case O:return!(e.byteLength!=t.byteLength||!o(new qe(e),new qe(t)));case b:case R:case C:return Ha(+e,+t);case w:return e.name==t.name&&e.message==t.message;case P:case M:return e==t+"";case k:var s=ln;case E:var l=1&r;if(s||(s=dn),e.size!=t.size&&!l)return!1;var u=a.get(e);if(u)return u==t;r|=2,a.set(e,t);var c=to(s(e),s(t),r,i,o,a);return a.delete(e),c;case I:if(Tn)return Tn.call(e)==Tn.call(t)}return!1}(e,t,u,n,i,o,a);if(!(1&n)){var p=d&&$e.call(e,"__wrapped__"),g=h&&$e.call(t,"__wrapped__");if(p||g){var m=p?e.value():e,S=g?t.value():t;return a||(a=new Jn),o(m,S,n,i,a)}}return!!f&&(a||(a=new Jn),function(e,t,n,i,o,a){var s=1&n,l=ro(e),u=l.length,c=ro(t),d=c.length;if(u!=d&&!s)return!1;for(var h=u;h--;){var f=l[h];if(!(s?f in t:$e.call(t,f)))return!1}var p=a.get(e),g=a.get(t);if(p&&g)return p==t&&g==e;var m=!0;a.set(e,t),a.set(t,e);for(var v=s;++h<u;){var y=e[f=l[h]],b=t[f];if(i)var R=s?i(b,y,f,t,e,a):i(y,b,f,e,t,a);if(!(R===r?y===b||o(y,b,n,i,a):R)){m=!1;break}v||(v="constructor"==f)}if(m&&!v){var w=e.constructor,S=t.constructor;w==S||!("constructor"in e)||!("constructor"in t)||"function"==typeof w&&w instanceof w&&"function"==typeof S&&S instanceof S||(m=!1)}return a.delete(e),a.delete(t),m}(e,t,n,i,o,a))}(e,t,n,i,jr,o))}function Or(e,t,n,i){var o=n.length,a=o,s=!i;if(null==e)return!a;for(e=_e(e);o--;){var l=n[o];if(s&&l[2]?l[1]!==e[l[0]]:!(l[0]in e))return!1}for(;++o<a;){var u=(l=n[o])[0],c=e[u],d=l[1];if(s&&l[2]){if(c===r&&!(u in e))return!1}else{var h=new Jn;if(i)var f=i(c,d,u,e,t,h);if(!(f===r?jr(d,c,3,i,h):f))return!1}}return!0}function Ar(e){return!(!es(e)||function(e){return!!Le&&Le in e}(e))&&(Xa(e)?Ne:ve).test(To(e))}function $r(e){return"function"==typeof e?e:null==e?rl:"object"==typeof e?qa(e)?Nr(e[0],e[1]):Hr(e):hl(e)}function Fr(e){if(!ko(e))return Ut(e);var t=[];for(var n in _e(e))$e.call(e,n)&&"constructor"!=n&&t.push(n);return t}function Lr(e){if(!es(e))return function(e){var t=[];if(null!=e)for(var n in _e(e))t.push(n);return t}(e);var t=ko(e),n=[];for(var r in e)("constructor"!=r||!t&&$e.call(e,r))&&n.push(r);return n}function Tr(e,t){return e<t}function Dr(e,t){var r=-1,i=Ka(e)?n(e.length):[];return hr(e,function(e,n,o){i[++r]=t(e,n,o)}),i}function Hr(e){var t=co(e);return 1==t.length&&t[0][2]?_o(t[0][0],t[0][1]):function(n){return n===e||Or(n,e,t)}}function Nr(e,t){return wo(e)&&Co(t)?_o(Lo(e),t):function(n){var i=_s(n,e);return i===r&&i===t?xs(n,e):jr(t,i,3)}}function Gr(e,t,n,i,o){e!==t&&yr(t,function(a,s){if(o||(o=new Jn),es(a))!function(e,t,n,i,o,a,s){var l=Eo(e,n),u=Eo(t,n),c=s.get(u);if(c)er(e,n,c);else{var d=a?a(l,u,n+"",e,t,s):r,h=d===r;if(h){var f=qa(u),p=!f&&Va(u),g=!f&&!p&&us(u);d=u,f||p||g?qa(l)?d=l:Ua(l)?d=Ei(l):p?(h=!1,d=Bi(u,!0)):g?(h=!1,d=Ci(u,!0)):d=[]:is(u)||Wa(u)?(d=l,Wa(l)?d=vs(l):es(l)&&!Xa(l)||(d=vo(u))):h=!1}h&&(s.set(u,d),o(d,u,i,a,s),s.delete(u)),er(e,n,d)}}(e,t,s,n,Gr,i,o);else{var l=i?i(Eo(e,s),a,s+"",e,t,o):r;l===r&&(l=a),er(e,s,l)}},js)}function Wr(e,t){var n=e.length;if(n)return bo(t+=t<0?n:0,n)?e[t]:r}function qr(e,t,n){t=t.length?At(t,function(e){return qa(e)?function(t){return Br(t,1===e.length?e[0]:e)}:e}):[rl];var r=-1;t=At(t,Zt(lo()));var i=Dr(e,function(e,n,i){var o=At(t,function(t){return t(e)});return{criteria:o,index:++r,value:e}});return function(e,t){var n=e.length;for(e.sort(t);n--;)e[n]=e[n].value;return e}(i,function(e,t){return function(e,t,n){for(var r=-1,i=e.criteria,o=t.criteria,a=i.length,s=n.length;++r<a;){var l=_i(i[r],o[r]);if(l)return r>=s?l:l*("desc"==n[r]?-1:1)}return e.index-t.index}(e,t,n)})}function zr(e,t,n){for(var r=-1,i=t.length,o={};++r<i;){var a=t[r],s=Br(e,a);n(s,a)&&Qr(o,bi(a,e),s)}return o}function Kr(e,t,n,r){var i=r?Wt:Gt,o=-1,a=t.length,s=e;for(e===t&&(t=Ei(t)),n&&(s=At(e,Zt(n)));++o<a;)for(var l=0,u=t[o],c=n?n(u):u;(l=i(s,c,l,r))>-1;)s!==e&&Je.call(s,l,1),Je.call(e,l,1);return e}function Ur(e,t){for(var n=e?t.length:0,r=n-1;n--;){var i=t[n];if(n==r||i!==o){var o=i;bo(i)?Je.call(e,i,1):di(e,i)}}return e}function Vr(e,t){return e+gt(Sn()*(t-e+1))}function Jr(e,t){var n="";if(!e||t<1||t>f)return n;do{t%2&&(n+=e),(t=gt(t/2))&&(e+=e)}while(t);return n}function Yr(e,t){return jo(xo(e,t,rl),e+"")}function Xr(e){return Xn(Hs(e))}function Zr(e,t){var n=Hs(e);return $o(n,sr(t,0,n.length))}function Qr(e,t,n,i){if(!es(e))return e;for(var o=-1,a=(t=bi(t,e)).length,s=a-1,l=e;null!=l&&++o<a;){var u=Lo(t[o]),c=n;if("__proto__"===u||"constructor"===u||"prototype"===u)return e;if(o!=s){var d=l[u];(c=i?i(d,u,l):r)===r&&(c=es(d)?d:bo(t[o+1])?[]:{})}tr(l,u,c),l=l[u]}return e}var ei=Mn?function(e,t){return Mn.set(e,t),e}:rl,ti=tt?function(e,t){return tt(e,"toString",{configurable:!0,enumerable:!1,value:el(t),writable:!0})}:rl;function ni(e){return $o(Hs(e))}function ri(e,t,r){var i=-1,o=e.length;t<0&&(t=-t>o?0:o+t),(r=r>o?o:r)<0&&(r+=o),o=t>r?0:r-t>>>0,t>>>=0;for(var a=n(o);++i<o;)a[i]=e[i+t];return a}function ii(e,t){var n;return hr(e,function(e,r,i){return!(n=t(e,r,i))}),!!n}function oi(e,t,n){var r=0,i=null==e?r:e.length;if("number"==typeof t&&t==t&&i<=2147483647){for(;r<i;){var o=r+i>>>1,a=e[o];null!==a&&!ls(a)&&(n?a<=t:a<t)?r=o+1:i=o}return i}return ai(e,t,rl,n)}function ai(e,t,n,i){var o=0,a=null==e?0:e.length;if(0===a)return 0;for(var s=(t=n(t))!=t,l=null===t,u=ls(t),c=t===r;o<a;){var d=gt((o+a)/2),h=n(e[d]),f=h!==r,p=null===h,g=h==h,m=ls(h);if(s)var v=i||g;else v=c?g&&(i||f):l?g&&f&&(i||!p):u?g&&f&&!p&&(i||!m):!p&&!m&&(i?h<=t:h<t);v?o=d+1:a=d}return bn(a,4294967294)}function si(e,t){for(var n=-1,r=e.length,i=0,o=[];++n<r;){var a=e[n],s=t?t(a):a;if(!n||!Ha(s,l)){var l=s;o[i++]=0===a?0:a}}return o}function li(e){return"number"==typeof e?e:ls(e)?p:+e}function ui(e){if("string"==typeof e)return e;if(qa(e))return At(e,ui)+"";if(ls(e))return Dn?Dn.call(e):"";var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}function ci(e,t,n){var r=-1,i=jt,o=e.length,a=!0,s=[],l=s;if(n)a=!1,i=Ot;else if(o>=200){var u=t?null:Ji(e);if(u)return dn(u);a=!1,i=en,l=new Vn}else l=t?[]:s;e:for(;++r<o;){var c=e[r],d=t?t(c):c;if(c=n||0!==c?c:0,a&&d==d){for(var h=l.length;h--;)if(l[h]===d)continue e;t&&l.push(d),s.push(c)}else i(l,d,n)||(l!==s&&l.push(d),s.push(c))}return s}function di(e,t){var n=-1,r=(t=bi(t,e)).length;if(!r)return!0;for(var i=null==e||"object"!=typeof e&&"function"!=typeof e;++n<r;){var o=t[n];if("string"==typeof o){if("__proto__"===o&&!$e.call(e,"__proto__"))return!1;if("constructor"===o&&n+1<r&&"string"==typeof t[n+1]&&"prototype"===t[n+1]){if(i&&0===n)continue;return!1}}}var a=Po(e,t);return null==a||delete a[Lo(Yo(t))]}function hi(e,t,n,r){return Qr(e,t,n(Br(e,t)),r)}function fi(e,t,n,r){for(var i=e.length,o=r?i:-1;(r?o--:++o<i)&&t(e[o],o,e););return n?ri(e,r?0:o,r?o+1:i):ri(e,r?o+1:0,r?i:o)}function pi(e,t){var n=e;return n instanceof qn&&(n=n.value()),Ft(t,function(e,t){return t.func.apply(t.thisArg,$t([e],t.args))},n)}function gi(e,t,r){var i=e.length;if(i<2)return i?ci(e[0]):[];for(var o=-1,a=n(i);++o<i;)for(var s=e[o],l=-1;++l<i;)l!=o&&(a[o]=dr(a[o]||s,e[l],t,r));return ci(vr(a,1),t,r)}function mi(e,t,n){for(var i=-1,o=e.length,a=t.length,s={};++i<o;){var l=i<a?t[i]:r;n(s,e[i],l)}return s}function vi(e){return Ua(e)?e:[]}function yi(e){return"function"==typeof e?e:rl}function bi(e,t){return qa(e)?e:wo(e,t)?[e]:Fo(ys(e))}var Ri=Yr;function wi(e,t,n){var i=e.length;return n=n===r?i:n,!t&&n>=i?e:ri(e,t,n)}var Si=rt||function(e){return pt.clearTimeout(e)};function Bi(e,t){if(t)return e.slice();var n=e.length,r=ze?ze(n):new e.constructor(n);return e.copy(r),r}function ki(e){var t=new e.constructor(e.byteLength);return new qe(t).set(new qe(e)),t}function Ci(e,t){var n=t?ki(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}function _i(e,t){if(e!==t){var n=e!==r,i=null===e,o=e==e,a=ls(e),s=t!==r,l=null===t,u=t==t,c=ls(t);if(!l&&!c&&!a&&e>t||a&&s&&u&&!l&&!c||i&&s&&u||!n&&u||!o)return 1;if(!i&&!a&&!c&&e<t||c&&n&&o&&!i&&!a||l&&n&&o||!s&&o||!u)return-1}return 0}function xi(e,t,r,i){for(var o=-1,a=e.length,s=r.length,l=-1,u=t.length,c=yn(a-s,0),d=n(u+c),h=!i;++l<u;)d[l]=t[l];for(;++o<s;)(h||o<a)&&(d[r[o]]=e[o]);for(;c--;)d[l++]=e[o++];return d}function Pi(e,t,r,i){for(var o=-1,a=e.length,s=-1,l=r.length,u=-1,c=t.length,d=yn(a-l,0),h=n(d+c),f=!i;++o<d;)h[o]=e[o];for(var p=o;++u<c;)h[p+u]=t[u];for(;++s<l;)(f||o<a)&&(h[p+r[s]]=e[o++]);return h}function Ei(e,t){var r=-1,i=e.length;for(t||(t=n(i));++r<i;)t[r]=e[r];return t}function Mi(e,t,n,i){var o=!n;n||(n={});for(var a=-1,s=t.length;++a<s;){var l=t[a],u=i?i(n[l],e[l],l,n,e):r;u===r&&(u=e[l]),o?or(n,l,u):tr(n,l,u)}return n}function Ii(e,t){return function(n,r){var i=qa(n)?xt:rr,o=t?t():{};return i(n,e,lo(r,2),o)}}function ji(e){return Yr(function(t,n){var i=-1,o=n.length,a=o>1?n[o-1]:r,s=o>2?n[2]:r;for(a=e.length>3&&"function"==typeof a?(o--,a):r,s&&Ro(n[0],n[1],s)&&(a=o<3?r:a,o=1),t=_e(t);++i<o;){var l=n[i];l&&e(t,l,i,a)}return t})}function Oi(e,t){return function(n,r){if(null==n)return n;if(!Ka(n))return e(n,r);for(var i=n.length,o=t?i:-1,a=_e(n);(t?o--:++o<i)&&!1!==r(a[o],o,a););return n}}function Ai(e){return function(t,n,r){for(var i=-1,o=_e(t),a=r(t),s=a.length;s--;){var l=a[e?s:++i];if(!1===n(o[l],l,o))break}return t}}function $i(e){return function(t){var n=sn(t=ys(t))?pn(t):r,i=n?n[0]:t.charAt(0),o=n?wi(n,1).join(""):t.slice(1);return i[e]()+o}}function Fi(e){return function(t){return Ft(Xs(Ws(t).replace(Qe,"")),e,"")}}function Li(e){return function(){var t=arguments;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var n=Nn(e.prototype),r=e.apply(n,t);return es(r)?r:n}}function Ti(e){return function(t,n,i){var o=_e(t);if(!Ka(t)){var a=lo(n,3);t=Is(t),n=function(e){return a(o[e],e,o)}}var s=e(t,n,i);return s>-1?o[a?t[s]:s]:r}}function Di(e){return no(function(t){var n=t.length,o=n,a=Wn.prototype.thru;for(e&&t.reverse();o--;){var s=t[o];if("function"!=typeof s)throw new Ee(i);if(a&&!l&&"wrapper"==ao(s))var l=new Wn([],!0)}for(o=l?o:n;++o<n;){var u=ao(s=t[o]),c="wrapper"==u?oo(s):r;l=c&&So(c[0])&&424==c[1]&&!c[4].length&&1==c[9]?l[ao(c[0])].apply(l,c[3]):1==s.length&&So(s)?l[u]():l.thru(s)}return function(){var e=arguments,r=e[0];if(l&&1==e.length&&qa(r))return l.plant(r).value();for(var i=0,o=n?t[i].apply(this,e):r;++i<n;)o=t[i].call(this,o);return o}})}function Hi(e,t,i,o,a,s,l,u,d,h){var f=t&c,p=1&t,g=2&t,m=24&t,v=512&t,y=g?r:Li(e);return function c(){for(var b=arguments.length,R=n(b),w=b;w--;)R[w]=arguments[w];if(m)var S=so(c),B=function(e,t){for(var n=e.length,r=0;n--;)e[n]===t&&++r;return r}(R,S);if(o&&(R=xi(R,o,a,m)),s&&(R=Pi(R,s,l,m)),b-=B,m&&b<h){var k=cn(R,S);return Ui(e,t,Hi,c.placeholder,i,R,k,u,d,h-b)}var C=p?i:this,_=g?C[e]:e;return b=R.length,u?R=function(e,t){for(var n=e.length,i=bn(t.length,n),o=Ei(e);i--;){var a=t[i];e[i]=bo(a,n)?o[a]:r}return e}(R,u):v&&b>1&&R.reverse(),f&&d<b&&(R.length=d),this&&this!==pt&&this instanceof c&&(_=y||Li(_)),_.apply(C,R)}}function Ni(e,t){return function(n,r){return function(e,t,n,r){return Rr(e,function(e,i,o){t(r,n(e),i,o)}),r}(n,e,t(r),{})}}function Gi(e,t){return function(n,i){var o;if(n===r&&i===r)return t;if(n!==r&&(o=n),i!==r){if(o===r)return i;"string"==typeof n||"string"==typeof i?(n=ui(n),i=ui(i)):(n=li(n),i=li(i)),o=e(n,i)}return o}}function Wi(e){return no(function(t){return t=At(t,Zt(lo())),Yr(function(n){var r=this;return e(t,function(e){return _t(e,r,n)})})})}function qi(e,t){var n=(t=t===r?" ":ui(t)).length;if(n<2)return n?Jr(t,e):t;var i=Jr(t,ft(e/fn(t)));return sn(t)?wi(pn(i),0,e).join(""):i.slice(0,e)}function zi(e){return function(t,i,o){return o&&"number"!=typeof o&&Ro(t,i,o)&&(i=o=r),t=fs(t),i===r?(i=t,t=0):i=fs(i),function(e,t,r,i){for(var o=-1,a=yn(ft((t-e)/(r||1)),0),s=n(a);a--;)s[i?a:++o]=e,e+=r;return s}(t,i,o=o===r?t<i?1:-1:fs(o),e)}}function Ki(e){return function(t,n){return"string"==typeof t&&"string"==typeof n||(t=ms(t),n=ms(n)),e(t,n)}}function Ui(e,t,n,i,o,a,s,c,d,h){var f=8&t;t|=f?l:u,4&(t&=~(f?u:l))||(t&=-4);var p=[e,t,o,f?a:r,f?s:r,f?r:a,f?r:s,c,d,h],g=n.apply(r,p);return So(e)&&Mo(g,p),g.placeholder=i,Oo(g,e,t)}function Vi(e){var t=Ce[e];return function(e,n){if(e=ms(e),(n=null==n?0:bn(ps(n),292))&&bt(e)){var r=(ys(e)+"e").split("e");return+((r=(ys(t(r[0]+"e"+(+r[1]+n)))+"e").split("e"))[0]+"e"+(+r[1]-n))}return t(e)}}var Ji=xn&&1/dn(new xn([,-0]))[1]==h?function(e){return new xn(e)}:ll;function Yi(e){return function(t){var n=go(t);return n==k?ln(t):n==E?hn(t):function(e,t){return At(t,function(t){return[t,e[t]]})}(t,e(t))}}function Xi(e,t,o,h,f,p,g,m){var v=2&t;if(!v&&"function"!=typeof e)throw new Ee(i);var y=h?h.length:0;if(y||(t&=-97,h=f=r),g=g===r?g:yn(ps(g),0),m=m===r?m:ps(m),y-=f?f.length:0,t&u){var b=h,R=f;h=f=r}var w=v?r:oo(e),S=[e,t,o,h,f,b,R,p,g,m];if(w&&function(e,t){var n=e[1],r=t[1],i=n|r,o=i<131,s=r==c&&8==n||r==c&&n==d&&e[7].length<=t[8]||384==r&&t[7].length<=t[8]&&8==n;if(!o&&!s)return e;1&r&&(e[2]=t[2],i|=1&n?0:4);var l=t[3];if(l){var u=e[3];e[3]=u?xi(u,l,t[4]):l,e[4]=u?cn(e[3],a):t[4]}(l=t[5])&&(u=e[5],e[5]=u?Pi(u,l,t[6]):l,e[6]=u?cn(e[5],a):t[6]),(l=t[7])&&(e[7]=l),r&c&&(e[8]=null==e[8]?t[8]:bn(e[8],t[8])),null==e[9]&&(e[9]=t[9]),e[0]=t[0],e[1]=i}(S,w),e=S[0],t=S[1],o=S[2],h=S[3],f=S[4],!(m=S[9]=S[9]===r?v?0:e.length:yn(S[9]-y,0))&&24&t&&(t&=-25),t&&1!=t)B=8==t||t==s?function(e,t,i){var o=Li(e);return function a(){for(var s=arguments.length,l=n(s),u=s,c=so(a);u--;)l[u]=arguments[u];var d=s<3&&l[0]!==c&&l[s-1]!==c?[]:cn(l,c);return(s-=d.length)<i?Ui(e,t,Hi,a.placeholder,r,l,d,r,r,i-s):_t(this&&this!==pt&&this instanceof a?o:e,this,l)}}(e,t,m):t!=l&&33!=t||f.length?Hi.apply(r,S):function(e,t,r,i){var o=1&t,a=Li(e);return function t(){for(var s=-1,l=arguments.length,u=-1,c=i.length,d=n(c+l),h=this&&this!==pt&&this instanceof t?a:e;++u<c;)d[u]=i[u];for(;l--;)d[u++]=arguments[++s];return _t(h,o?r:this,d)}}(e,t,o,h);else var B=function(e,t,n){var r=1&t,i=Li(e);return function t(){return(this&&this!==pt&&this instanceof t?i:e).apply(r?n:this,arguments)}}(e,t,o);return Oo((w?ei:Mo)(B,S),e,t)}function Zi(e,t,n,i){return e===r||Ha(e,je[n])&&!$e.call(i,n)?t:e}function Qi(e,t,n,i,o,a){return es(e)&&es(t)&&(a.set(t,e),Gr(e,t,r,Qi,a),a.delete(t)),e}function eo(e){return is(e)?r:e}function to(e,t,n,i,o,a){var s=1&n,l=e.length,u=t.length;if(l!=u&&!(s&&u>l))return!1;var c=a.get(e),d=a.get(t);if(c&&d)return c==t&&d==e;var h=-1,f=!0,p=2&n?new Vn:r;for(a.set(e,t),a.set(t,e);++h<l;){var g=e[h],m=t[h];if(i)var v=s?i(m,g,h,t,e,a):i(g,m,h,e,t,a);if(v!==r){if(v)continue;f=!1;break}if(p){if(!Tt(t,function(e,t){if(!en(p,t)&&(g===e||o(g,e,n,i,a)))return p.push(t)})){f=!1;break}}else if(g!==m&&!o(g,m,n,i,a)){f=!1;break}}return a.delete(e),a.delete(t),f}function no(e){return jo(xo(e,r,zo),e+"")}function ro(e){return kr(e,Is,fo)}function io(e){return kr(e,js,po)}var oo=Mn?function(e){return Mn.get(e)}:ll;function ao(e){for(var t=e.name+"",n=In[t],r=$e.call(In,t)?n.length:0;r--;){var i=n[r],o=i.func;if(null==o||o==e)return i.name}return t}function so(e){return($e.call(Hn,"placeholder")?Hn:e).placeholder}function lo(){var e=Hn.iteratee||il;return e=e===il?$r:e,arguments.length?e(arguments[0],arguments[1]):e}function uo(e,t){var n,r,i=e.__data__;return("string"==(r=typeof(n=t))||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==n:null===n)?i["string"==typeof t?"string":"hash"]:i.map}function co(e){for(var t=Is(e),n=t.length;n--;){var r=t[n],i=e[r];t[n]=[r,i,Co(i)]}return t}function ho(e,t){var n=function(e,t){return null==e?r:e[t]}(e,t);return Ar(n)?n:r}var fo=mt?function(e){return null==e?[]:(e=_e(e),It(mt(e),function(t){return Ve.call(e,t)}))}:gl,po=mt?function(e){for(var t=[];e;)$t(t,fo(e)),e=Ke(e);return t}:gl,go=Cr;function mo(e,t,n){for(var r=-1,i=(t=bi(t,e)).length,o=!1;++r<i;){var a=Lo(t[r]);if(!(o=null!=e&&n(e,a)))break;e=e[a]}return o||++r!=i?o:!!(i=null==e?0:e.length)&&Qa(i)&&bo(a,i)&&(qa(e)||Wa(e))}function vo(e){return"function"!=typeof e.constructor||ko(e)?{}:Nn(Ke(e))}function yo(e){return qa(e)||Wa(e)||!!(Ye&&e&&e[Ye])}function bo(e,t){var n=typeof e;return!!(t=null==t?f:t)&&("number"==n||"symbol"!=n&&be.test(e))&&e>-1&&e%1==0&&e<t}function Ro(e,t,n){if(!es(n))return!1;var r=typeof t;return!!("number"==r?Ka(n)&&bo(t,n.length):"string"==r&&t in n)&&Ha(n[t],e)}function wo(e,t){if(qa(e))return!1;var n=typeof e;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!ls(e))||te.test(e)||!ee.test(e)||null!=t&&e in _e(t)}function So(e){var t=ao(e),n=Hn[t];if("function"!=typeof n||!(t in qn.prototype))return!1;if(e===n)return!0;var r=oo(n);return!!r&&e===r[0]}(kn&&go(new kn(new ArrayBuffer(1)))!=A||Cn&&go(new Cn)!=k||_n&&go(_n.resolve())!=x||xn&&go(new xn)!=E||Pn&&go(new Pn)!=j)&&(go=function(e){var t=Cr(e),n=t==_?e.constructor:r,i=n?To(n):"";if(i)switch(i){case jn:return A;case On:return k;case An:return x;case $n:return E;case Fn:return j}return t});var Bo=Oe?Xa:ml;function ko(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||je)}function Co(e){return e==e&&!es(e)}function _o(e,t){return function(n){return null!=n&&n[e]===t&&(t!==r||e in _e(n))}}function xo(e,t,i){return t=yn(t===r?e.length-1:t,0),function(){for(var r=arguments,o=-1,a=yn(r.length-t,0),s=n(a);++o<a;)s[o]=r[t+o];o=-1;for(var l=n(t+1);++o<t;)l[o]=r[o];return l[t]=i(s),_t(e,this,l)}}function Po(e,t){return t.length<2?e:Br(e,ri(t,0,-1))}function Eo(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]}var Mo=Ao(ei),Io=ht||function(e,t){return pt.setTimeout(e,t)},jo=Ao(ti);function Oo(e,t,n){var r=t+"";return jo(e,function(e,t){var n=t.length;if(!n)return e;var r=n-1;return t[r]=(n>1?"& ":"")+t[r],t=t.join(n>2?", ":" "),e.replace(se,"{\n/* [wrapped with "+t+"] */\n")}(r,function(e,t){return Pt(m,function(n){var r="_."+n[0];t&n[1]&&!jt(e,r)&&e.push(r)}),e.sort()}(function(e){var t=e.match(le);return t?t[1].split(ue):[]}(r),n)))}function Ao(e){var t=0,n=0;return function(){var i=Rn(),o=16-(i-n);if(n=i,o>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(r,arguments)}}function $o(e,t){var n=-1,i=e.length,o=i-1;for(t=t===r?i:t;++n<t;){var a=Vr(n,o),s=e[a];e[a]=e[n],e[n]=s}return e.length=t,e}var Fo=function(e){var t=Aa(e,function(e){return 500===n.size&&n.clear(),e}),n=t.cache;return t}(function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(ne,function(e,n,r,i){t.push(r?i.replace(he,"$1"):n||e)}),t});function Lo(e){if("string"==typeof e||ls(e))return e;var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}function To(e){if(null!=e){try{return Ae.call(e)}catch(e){}try{return e+""}catch(e){}}return""}function Do(e){if(e instanceof qn)return e.clone();var t=new Wn(e.__wrapped__,e.__chain__);return t.__actions__=Ei(e.__actions__),t.__index__=e.__index__,t.__values__=e.__values__,t}var Ho=Yr(function(e,t){return Ua(e)?dr(e,vr(t,1,Ua,!0)):[]}),No=Yr(function(e,t){var n=Yo(t);return Ua(n)&&(n=r),Ua(e)?dr(e,vr(t,1,Ua,!0),lo(n,2)):[]}),Go=Yr(function(e,t){var n=Yo(t);return Ua(n)&&(n=r),Ua(e)?dr(e,vr(t,1,Ua,!0),r,n):[]});function Wo(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var i=null==n?0:ps(n);return i<0&&(i=yn(r+i,0)),Nt(e,lo(t,3),i)}function qo(e,t,n){var i=null==e?0:e.length;if(!i)return-1;var o=i-1;return n!==r&&(o=ps(n),o=n<0?yn(i+o,0):bn(o,i-1)),Nt(e,lo(t,3),o,!0)}function zo(e){return null!=e&&e.length?vr(e,1):[]}function Ko(e){return e&&e.length?e[0]:r}var Uo=Yr(function(e){var t=At(e,vi);return t.length&&t[0]===e[0]?Er(t):[]}),Vo=Yr(function(e){var t=Yo(e),n=At(e,vi);return t===Yo(n)?t=r:n.pop(),n.length&&n[0]===e[0]?Er(n,lo(t,2)):[]}),Jo=Yr(function(e){var t=Yo(e),n=At(e,vi);return(t="function"==typeof t?t:r)&&n.pop(),n.length&&n[0]===e[0]?Er(n,r,t):[]});function Yo(e){var t=null==e?0:e.length;return t?e[t-1]:r}var Xo=Yr(Zo);function Zo(e,t){return e&&e.length&&t&&t.length?Kr(e,t):e}var Qo=no(function(e,t){var n=null==e?0:e.length,r=ar(e,t);return Ur(e,At(t,function(e){return bo(e,n)?+e:e}).sort(_i)),r});function ea(e){return null==e?e:Bn.call(e)}var ta=Yr(function(e){return ci(vr(e,1,Ua,!0))}),na=Yr(function(e){var t=Yo(e);return Ua(t)&&(t=r),ci(vr(e,1,Ua,!0),lo(t,2))}),ra=Yr(function(e){var t=Yo(e);return t="function"==typeof t?t:r,ci(vr(e,1,Ua,!0),r,t)});function ia(e){if(!e||!e.length)return[];var t=0;return e=It(e,function(e){if(Ua(e))return t=yn(e.length,t),!0}),Yt(t,function(t){return At(e,Kt(t))})}function oa(e,t){if(!e||!e.length)return[];var n=ia(e);return null==t?n:At(n,function(e){return _t(t,r,e)})}var aa=Yr(function(e,t){return Ua(e)?dr(e,t):[]}),sa=Yr(function(e){return gi(It(e,Ua))}),la=Yr(function(e){var t=Yo(e);return Ua(t)&&(t=r),gi(It(e,Ua),lo(t,2))}),ua=Yr(function(e){var t=Yo(e);return t="function"==typeof t?t:r,gi(It(e,Ua),r,t)}),ca=Yr(ia),da=Yr(function(e){var t=e.length,n=t>1?e[t-1]:r;return n="function"==typeof n?(e.pop(),n):r,oa(e,n)});function ha(e){var t=Hn(e);return t.__chain__=!0,t}function fa(e,t){return t(e)}var pa=no(function(e){var t=e.length,n=t?e[0]:0,i=this.__wrapped__,o=function(t){return ar(t,e)};return!(t>1||this.__actions__.length)&&i instanceof qn&&bo(n)?((i=i.slice(n,+n+(t?1:0))).__actions__.push({func:fa,args:[o],thisArg:r}),new Wn(i,this.__chain__).thru(function(e){return t&&!e.length&&e.push(r),e})):this.thru(o)}),ga=Ii(function(e,t,n){$e.call(e,n)?++e[n]:or(e,n,1)}),ma=Ti(Wo),va=Ti(qo);function ya(e,t){return(qa(e)?Pt:hr)(e,lo(t,3))}function ba(e,t){return(qa(e)?Et:fr)(e,lo(t,3))}var Ra=Ii(function(e,t,n){$e.call(e,n)?e[n].push(t):or(e,n,[t])}),wa=Yr(function(e,t,r){var i=-1,o="function"==typeof t,a=Ka(e)?n(e.length):[];return hr(e,function(e){a[++i]=o?_t(t,e,r):Mr(e,t,r)}),a}),Sa=Ii(function(e,t,n){or(e,n,t)});function Ba(e,t){return(qa(e)?At:Dr)(e,lo(t,3))}var ka=Ii(function(e,t,n){e[n?0:1].push(t)},function(){return[[],[]]}),Ca=Yr(function(e,t){if(null==e)return[];var n=t.length;return n>1&&Ro(e,t[0],t[1])?t=[]:n>2&&Ro(t[0],t[1],t[2])&&(t=[t[0]]),qr(e,vr(t,1),[])}),_a=ut||function(){return pt.Date.now()};function xa(e,t,n){return t=n?r:t,t=e&&null==t?e.length:t,Xi(e,c,r,r,r,r,t)}function Pa(e,t){var n;if("function"!=typeof t)throw new Ee(i);return e=ps(e),function(){return--e>0&&(n=t.apply(this,arguments)),e<=1&&(t=r),n}}var Ea=Yr(function(e,t,n){var r=1;if(n.length){var i=cn(n,so(Ea));r|=l}return Xi(e,r,t,n,i)}),Ma=Yr(function(e,t,n){var r=3;if(n.length){var i=cn(n,so(Ma));r|=l}return Xi(t,r,e,n,i)});function Ia(e,t,n){var o,a,s,l,u,c,d=0,h=!1,f=!1,p=!0;if("function"!=typeof e)throw new Ee(i);function g(t){var n=o,i=a;return o=a=r,d=t,l=e.apply(i,n)}function m(e){var n=e-c;return c===r||n>=t||n<0||f&&e-d>=s}function v(){var e=_a();if(m(e))return y(e);u=Io(v,function(e){var n=t-(e-c);return f?bn(n,s-(e-d)):n}(e))}function y(e){return u=r,p&&o?g(e):(o=a=r,l)}function b(){var e=_a(),n=m(e);if(o=arguments,a=this,c=e,n){if(u===r)return function(e){return d=e,u=Io(v,t),h?g(e):l}(c);if(f)return Si(u),u=Io(v,t),g(c)}return u===r&&(u=Io(v,t)),l}return t=ms(t)||0,es(n)&&(h=!!n.leading,s=(f="maxWait"in n)?yn(ms(n.maxWait)||0,t):s,p="trailing"in n?!!n.trailing:p),b.cancel=function(){u!==r&&Si(u),d=0,o=c=a=u=r},b.flush=function(){return u===r?l:y(_a())},b}var ja=Yr(function(e,t){return cr(e,1,t)}),Oa=Yr(function(e,t,n){return cr(e,ms(t)||0,n)});function Aa(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new Ee(i);var n=function(){var r=arguments,i=t?t.apply(this,r):r[0],o=n.cache;if(o.has(i))return o.get(i);var a=e.apply(this,r);return n.cache=o.set(i,a)||o,a};return n.cache=new(Aa.Cache||Un),n}function $a(e){if("function"!=typeof e)throw new Ee(i);return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}}Aa.Cache=Un;var Fa=Ri(function(e,t){var n=(t=1==t.length&&qa(t[0])?At(t[0],Zt(lo())):At(vr(t,1),Zt(lo()))).length;return Yr(function(r){for(var i=-1,o=bn(r.length,n);++i<o;)r[i]=t[i].call(this,r[i]);return _t(e,this,r)})}),La=Yr(function(e,t){var n=cn(t,so(La));return Xi(e,l,r,t,n)}),Ta=Yr(function(e,t){var n=cn(t,so(Ta));return Xi(e,u,r,t,n)}),Da=no(function(e,t){return Xi(e,d,r,r,r,t)});function Ha(e,t){return e===t||e!=e&&t!=t}var Na=Ki(_r),Ga=Ki(function(e,t){return e>=t}),Wa=Ir(function(){return arguments}())?Ir:function(e){return ts(e)&&$e.call(e,"callee")&&!Ve.call(e,"callee")},qa=n.isArray,za=Rt?Zt(Rt):function(e){return ts(e)&&Cr(e)==O};function Ka(e){return null!=e&&Qa(e.length)&&!Xa(e)}function Ua(e){return ts(e)&&Ka(e)}var Va=yt||ml,Ja=wt?Zt(wt):function(e){return ts(e)&&Cr(e)==R};function Ya(e){if(!ts(e))return!1;var t=Cr(e);return t==w||"[object DOMException]"==t||"string"==typeof e.message&&"string"==typeof e.name&&!is(e)}function Xa(e){if(!es(e))return!1;var t=Cr(e);return t==S||t==B||"[object AsyncFunction]"==t||"[object Proxy]"==t}function Za(e){return"number"==typeof e&&e==ps(e)}function Qa(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=f}function es(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function ts(e){return null!=e&&"object"==typeof e}var ns=St?Zt(St):function(e){return ts(e)&&go(e)==k};function rs(e){return"number"==typeof e||ts(e)&&Cr(e)==C}function is(e){if(!ts(e)||Cr(e)!=_)return!1;var t=Ke(e);if(null===t)return!0;var n=$e.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&Ae.call(n)==De}var os=Bt?Zt(Bt):function(e){return ts(e)&&Cr(e)==P},as=kt?Zt(kt):function(e){return ts(e)&&go(e)==E};function ss(e){return"string"==typeof e||!qa(e)&&ts(e)&&Cr(e)==M}function ls(e){return"symbol"==typeof e||ts(e)&&Cr(e)==I}var us=Ct?Zt(Ct):function(e){return ts(e)&&Qa(e.length)&&!!st[Cr(e)]},cs=Ki(Tr),ds=Ki(function(e,t){return e<=t});function hs(e){if(!e)return[];if(Ka(e))return ss(e)?pn(e):Ei(e);if(Xe&&e[Xe])return function(e){for(var t,n=[];!(t=e.next()).done;)n.push(t.value);return n}(e[Xe]());var t=go(e);return(t==k?ln:t==E?dn:Hs)(e)}function fs(e){return e?(e=ms(e))===h||e===-1/0?17976931348623157e292*(e<0?-1:1):e==e?e:0:0===e?e:0}function ps(e){var t=fs(e),n=t%1;return t==t?n?t-n:t:0}function gs(e){return e?sr(ps(e),0,g):0}function ms(e){if("number"==typeof e)return e;if(ls(e))return p;if(es(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=es(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=Xt(e);var n=me.test(e);return n||ye.test(e)?dt(e.slice(2),n?2:8):ge.test(e)?p:+e}function vs(e){return Mi(e,js(e))}function ys(e){return null==e?"":ui(e)}var bs=ji(function(e,t){if(ko(t)||Ka(t))Mi(t,Is(t),e);else for(var n in t)$e.call(t,n)&&tr(e,n,t[n])}),Rs=ji(function(e,t){Mi(t,js(t),e)}),ws=ji(function(e,t,n,r){Mi(t,js(t),e,r)}),Ss=ji(function(e,t,n,r){Mi(t,Is(t),e,r)}),Bs=no(ar),ks=Yr(function(e,t){e=_e(e);var n=-1,i=t.length,o=i>2?t[2]:r;for(o&&Ro(t[0],t[1],o)&&(i=1);++n<i;)for(var a=t[n],s=js(a),l=-1,u=s.length;++l<u;){var c=s[l],d=e[c];(d===r||Ha(d,je[c])&&!$e.call(e,c))&&(e[c]=a[c])}return e}),Cs=Yr(function(e){return e.push(r,Qi),_t(As,r,e)});function _s(e,t,n){var i=null==e?r:Br(e,t);return i===r?n:i}function xs(e,t){return null!=e&&mo(e,t,Pr)}var Ps=Ni(function(e,t,n){null!=t&&"function"!=typeof t.toString&&(t=Te.call(t)),e[t]=n},el(rl)),Es=Ni(function(e,t,n){null!=t&&"function"!=typeof t.toString&&(t=Te.call(t)),$e.call(e,t)?e[t].push(n):e[t]=[n]},lo),Ms=Yr(Mr);function Is(e){return Ka(e)?Yn(e):Fr(e)}function js(e){return Ka(e)?Yn(e,!0):Lr(e)}var Os=ji(function(e,t,n){Gr(e,t,n)}),As=ji(function(e,t,n,r){Gr(e,t,n,r)}),$s=no(function(e,t){var n={};if(null==e)return n;var r=!1;t=At(t,function(t){return t=bi(t,e),r||(r=t.length>1),t}),Mi(e,io(e),n),r&&(n=lr(n,7,eo));for(var i=t.length;i--;)di(n,t[i]);return n}),Fs=no(function(e,t){return null==e?{}:function(e,t){return zr(e,t,function(t,n){return xs(e,n)})}(e,t)});function Ls(e,t){if(null==e)return{};var n=At(io(e),function(e){return[e]});return t=lo(t),zr(e,n,function(e,n){return t(e,n[0])})}var Ts=Yi(Is),Ds=Yi(js);function Hs(e){return null==e?[]:Qt(e,Is(e))}var Ns=Fi(function(e,t,n){return t=t.toLowerCase(),e+(n?Gs(t):t)});function Gs(e){return Ys(ys(e).toLowerCase())}function Ws(e){return(e=ys(e))&&e.replace(Re,rn).replace(et,"")}var qs=Fi(function(e,t,n){return e+(n?"-":"")+t.toLowerCase()}),zs=Fi(function(e,t,n){return e+(n?" ":"")+t.toLowerCase()}),Ks=$i("toLowerCase"),Us=Fi(function(e,t,n){return e+(n?"_":"")+t.toLowerCase()}),Vs=Fi(function(e,t,n){return e+(n?" ":"")+Ys(t)}),Js=Fi(function(e,t,n){return e+(n?" ":"")+t.toUpperCase()}),Ys=$i("toUpperCase");function Xs(e,t,n){return e=ys(e),(t=n?r:t)===r?function(e){return it.test(e)}(e)?function(e){return e.match(nt)||[]}(e):function(e){return e.match(ce)||[]}(e):e.match(t)||[]}var Zs=Yr(function(e,t){try{return _t(e,r,t)}catch(e){return Ya(e)?e:new Be(e)}}),Qs=no(function(e,t){return Pt(t,function(t){t=Lo(t),or(e,t,Ea(e[t],e))}),e});function el(e){return function(){return e}}var tl=Di(),nl=Di(!0);function rl(e){return e}function il(e){return $r("function"==typeof e?e:lr(e,1))}var ol=Yr(function(e,t){return function(n){return Mr(n,e,t)}}),al=Yr(function(e,t){return function(n){return Mr(e,n,t)}});function sl(e,t,n){var r=Is(t),i=Sr(t,r);null!=n||es(t)&&(i.length||!r.length)||(n=t,t=e,e=this,i=Sr(t,Is(t)));var o=!(es(n)&&"chain"in n&&!n.chain),a=Xa(e);return Pt(i,function(n){var r=t[n];e[n]=r,a&&(e.prototype[n]=function(){var t=this.__chain__;if(o||t){var n=e(this.__wrapped__);return(n.__actions__=Ei(this.__actions__)).push({func:r,args:arguments,thisArg:e}),n.__chain__=t,n}return r.apply(e,$t([this.value()],arguments))})}),e}function ll(){}var ul=Wi(At),cl=Wi(Mt),dl=Wi(Tt);function hl(e){return wo(e)?Kt(Lo(e)):function(e){return function(t){return Br(t,e)}}(e)}var fl=zi(),pl=zi(!0);function gl(){return[]}function ml(){return!1}var vl=Gi(function(e,t){return e+t},0),yl=Vi("ceil"),bl=Gi(function(e,t){return e/t},1),Rl=Vi("floor"),wl=Gi(function(e,t){return e*t},1),Sl=Vi("round"),Bl=Gi(function(e,t){return e-t},0);return Hn.after=function(e,t){if("function"!=typeof t)throw new Ee(i);return e=ps(e),function(){if(--e<1)return t.apply(this,arguments)}},Hn.ary=xa,Hn.assign=bs,Hn.assignIn=Rs,Hn.assignInWith=ws,Hn.assignWith=Ss,Hn.at=Bs,Hn.before=Pa,Hn.bind=Ea,Hn.bindAll=Qs,Hn.bindKey=Ma,Hn.castArray=function(){if(!arguments.length)return[];var e=arguments[0];return qa(e)?e:[e]},Hn.chain=ha,Hn.chunk=function(e,t,i){t=(i?Ro(e,t,i):t===r)?1:yn(ps(t),0);var o=null==e?0:e.length;if(!o||t<1)return[];for(var a=0,s=0,l=n(ft(o/t));a<o;)l[s++]=ri(e,a,a+=t);return l},Hn.compact=function(e){for(var t=-1,n=null==e?0:e.length,r=0,i=[];++t<n;){var o=e[t];o&&(i[r++]=o)}return i},Hn.concat=function(){var e=arguments.length;if(!e)return[];for(var t=n(e-1),r=arguments[0],i=e;i--;)t[i-1]=arguments[i];return $t(qa(r)?Ei(r):[r],vr(t,1))},Hn.cond=function(e){var t=null==e?0:e.length,n=lo();return e=t?At(e,function(e){if("function"!=typeof e[1])throw new Ee(i);return[n(e[0]),e[1]]}):[],Yr(function(n){for(var r=-1;++r<t;){var i=e[r];if(_t(i[0],this,n))return _t(i[1],this,n)}})},Hn.conforms=function(e){return function(e){var t=Is(e);return function(n){return ur(n,e,t)}}(lr(e,1))},Hn.constant=el,Hn.countBy=ga,Hn.create=function(e,t){var n=Nn(e);return null==t?n:ir(n,t)},Hn.curry=function e(t,n,i){var o=Xi(t,8,r,r,r,r,r,n=i?r:n);return o.placeholder=e.placeholder,o},Hn.curryRight=function e(t,n,i){var o=Xi(t,s,r,r,r,r,r,n=i?r:n);return o.placeholder=e.placeholder,o},Hn.debounce=Ia,Hn.defaults=ks,Hn.defaultsDeep=Cs,Hn.defer=ja,Hn.delay=Oa,Hn.difference=Ho,Hn.differenceBy=No,Hn.differenceWith=Go,Hn.drop=function(e,t,n){var i=null==e?0:e.length;return i?ri(e,(t=n||t===r?1:ps(t))<0?0:t,i):[]},Hn.dropRight=function(e,t,n){var i=null==e?0:e.length;return i?ri(e,0,(t=i-(t=n||t===r?1:ps(t)))<0?0:t):[]},Hn.dropRightWhile=function(e,t){return e&&e.length?fi(e,lo(t,3),!0,!0):[]},Hn.dropWhile=function(e,t){return e&&e.length?fi(e,lo(t,3),!0):[]},Hn.fill=function(e,t,n,i){var o=null==e?0:e.length;return o?(n&&"number"!=typeof n&&Ro(e,t,n)&&(n=0,i=o),function(e,t,n,i){var o=e.length;for((n=ps(n))<0&&(n=-n>o?0:o+n),(i=i===r||i>o?o:ps(i))<0&&(i+=o),i=n>i?0:gs(i);n<i;)e[n++]=t;return e}(e,t,n,i)):[]},Hn.filter=function(e,t){return(qa(e)?It:mr)(e,lo(t,3))},Hn.flatMap=function(e,t){return vr(Ba(e,t),1)},Hn.flatMapDeep=function(e,t){return vr(Ba(e,t),h)},Hn.flatMapDepth=function(e,t,n){return n=n===r?1:ps(n),vr(Ba(e,t),n)},Hn.flatten=zo,Hn.flattenDeep=function(e){return null!=e&&e.length?vr(e,h):[]},Hn.flattenDepth=function(e,t){return null!=e&&e.length?vr(e,t=t===r?1:ps(t)):[]},Hn.flip=function(e){return Xi(e,512)},Hn.flow=tl,Hn.flowRight=nl,Hn.fromPairs=function(e){for(var t=-1,n=null==e?0:e.length,r={};++t<n;){var i=e[t];r[i[0]]=i[1]}return r},Hn.functions=function(e){return null==e?[]:Sr(e,Is(e))},Hn.functionsIn=function(e){return null==e?[]:Sr(e,js(e))},Hn.groupBy=Ra,Hn.initial=function(e){return null!=e&&e.length?ri(e,0,-1):[]},Hn.intersection=Uo,Hn.intersectionBy=Vo,Hn.intersectionWith=Jo,Hn.invert=Ps,Hn.invertBy=Es,Hn.invokeMap=wa,Hn.iteratee=il,Hn.keyBy=Sa,Hn.keys=Is,Hn.keysIn=js,Hn.map=Ba,Hn.mapKeys=function(e,t){var n={};return t=lo(t,3),Rr(e,function(e,r,i){or(n,t(e,r,i),e)}),n},Hn.mapValues=function(e,t){var n={};return t=lo(t,3),Rr(e,function(e,r,i){or(n,r,t(e,r,i))}),n},Hn.matches=function(e){return Hr(lr(e,1))},Hn.matchesProperty=function(e,t){return Nr(e,lr(t,1))},Hn.memoize=Aa,Hn.merge=Os,Hn.mergeWith=As,Hn.method=ol,Hn.methodOf=al,Hn.mixin=sl,Hn.negate=$a,Hn.nthArg=function(e){return e=ps(e),Yr(function(t){return Wr(t,e)})},Hn.omit=$s,Hn.omitBy=function(e,t){return Ls(e,$a(lo(t)))},Hn.once=function(e){return Pa(2,e)},Hn.orderBy=function(e,t,n,i){return null==e?[]:(qa(t)||(t=null==t?[]:[t]),qa(n=i?r:n)||(n=null==n?[]:[n]),qr(e,t,n))},Hn.over=ul,Hn.overArgs=Fa,Hn.overEvery=cl,Hn.overSome=dl,Hn.partial=La,Hn.partialRight=Ta,Hn.partition=ka,Hn.pick=Fs,Hn.pickBy=Ls,Hn.property=hl,Hn.propertyOf=function(e){return function(t){return null==e?r:Br(e,t)}},Hn.pull=Xo,Hn.pullAll=Zo,Hn.pullAllBy=function(e,t,n){return e&&e.length&&t&&t.length?Kr(e,t,lo(n,2)):e},Hn.pullAllWith=function(e,t,n){return e&&e.length&&t&&t.length?Kr(e,t,r,n):e},Hn.pullAt=Qo,Hn.range=fl,Hn.rangeRight=pl,Hn.rearg=Da,Hn.reject=function(e,t){return(qa(e)?It:mr)(e,$a(lo(t,3)))},Hn.remove=function(e,t){var n=[];if(!e||!e.length)return n;var r=-1,i=[],o=e.length;for(t=lo(t,3);++r<o;){var a=e[r];t(a,r,e)&&(n.push(a),i.push(r))}return Ur(e,i),n},Hn.rest=function(e,t){if("function"!=typeof e)throw new Ee(i);return Yr(e,t=t===r?t:ps(t))},Hn.reverse=ea,Hn.sampleSize=function(e,t,n){return t=(n?Ro(e,t,n):t===r)?1:ps(t),(qa(e)?Zn:Zr)(e,t)},Hn.set=function(e,t,n){return null==e?e:Qr(e,t,n)},Hn.setWith=function(e,t,n,i){return i="function"==typeof i?i:r,null==e?e:Qr(e,t,n,i)},Hn.shuffle=function(e){return(qa(e)?Qn:ni)(e)},Hn.slice=function(e,t,n){var i=null==e?0:e.length;return i?(n&&"number"!=typeof n&&Ro(e,t,n)?(t=0,n=i):(t=null==t?0:ps(t),n=n===r?i:ps(n)),ri(e,t,n)):[]},Hn.sortBy=Ca,Hn.sortedUniq=function(e){return e&&e.length?si(e):[]},Hn.sortedUniqBy=function(e,t){return e&&e.length?si(e,lo(t,2)):[]},Hn.split=function(e,t,n){return n&&"number"!=typeof n&&Ro(e,t,n)&&(t=n=r),(n=n===r?g:n>>>0)?(e=ys(e))&&("string"==typeof t||null!=t&&!os(t))&&!(t=ui(t))&&sn(e)?wi(pn(e),0,n):e.split(t,n):[]},Hn.spread=function(e,t){if("function"!=typeof e)throw new Ee(i);return t=null==t?0:yn(ps(t),0),Yr(function(n){var r=n[t],i=wi(n,0,t);return r&&$t(i,r),_t(e,this,i)})},Hn.tail=function(e){var t=null==e?0:e.length;return t?ri(e,1,t):[]},Hn.take=function(e,t,n){return e&&e.length?ri(e,0,(t=n||t===r?1:ps(t))<0?0:t):[]},Hn.takeRight=function(e,t,n){var i=null==e?0:e.length;return i?ri(e,(t=i-(t=n||t===r?1:ps(t)))<0?0:t,i):[]},Hn.takeRightWhile=function(e,t){return e&&e.length?fi(e,lo(t,3),!1,!0):[]},Hn.takeWhile=function(e,t){return e&&e.length?fi(e,lo(t,3)):[]},Hn.tap=function(e,t){return t(e),e},Hn.throttle=function(e,t,n){var r=!0,o=!0;if("function"!=typeof e)throw new Ee(i);return es(n)&&(r="leading"in n?!!n.leading:r,o="trailing"in n?!!n.trailing:o),Ia(e,t,{leading:r,maxWait:t,trailing:o})},Hn.thru=fa,Hn.toArray=hs,Hn.toPairs=Ts,Hn.toPairsIn=Ds,Hn.toPath=function(e){return qa(e)?At(e,Lo):ls(e)?[e]:Ei(Fo(ys(e)))},Hn.toPlainObject=vs,Hn.transform=function(e,t,n){var r=qa(e),i=r||Va(e)||us(e);if(t=lo(t,4),null==n){var o=e&&e.constructor;n=i?r?new o:[]:es(e)&&Xa(o)?Nn(Ke(e)):{}}return(i?Pt:Rr)(e,function(e,r,i){return t(n,e,r,i)}),n},Hn.unary=function(e){return xa(e,1)},Hn.union=ta,Hn.unionBy=na,Hn.unionWith=ra,Hn.uniq=function(e){return e&&e.length?ci(e):[]},Hn.uniqBy=function(e,t){return e&&e.length?ci(e,lo(t,2)):[]},Hn.uniqWith=function(e,t){return t="function"==typeof t?t:r,e&&e.length?ci(e,r,t):[]},Hn.unset=function(e,t){return null==e||di(e,t)},Hn.unzip=ia,Hn.unzipWith=oa,Hn.update=function(e,t,n){return null==e?e:hi(e,t,yi(n))},Hn.updateWith=function(e,t,n,i){return i="function"==typeof i?i:r,null==e?e:hi(e,t,yi(n),i)},Hn.values=Hs,Hn.valuesIn=function(e){return null==e?[]:Qt(e,js(e))},Hn.without=aa,Hn.words=Xs,Hn.wrap=function(e,t){return La(yi(t),e)},Hn.xor=sa,Hn.xorBy=la,Hn.xorWith=ua,Hn.zip=ca,Hn.zipObject=function(e,t){return mi(e||[],t||[],tr)},Hn.zipObjectDeep=function(e,t){return mi(e||[],t||[],Qr)},Hn.zipWith=da,Hn.entries=Ts,Hn.entriesIn=Ds,Hn.extend=Rs,Hn.extendWith=ws,sl(Hn,Hn),Hn.add=vl,Hn.attempt=Zs,Hn.camelCase=Ns,Hn.capitalize=Gs,Hn.ceil=yl,Hn.clamp=function(e,t,n){return n===r&&(n=t,t=r),n!==r&&(n=(n=ms(n))==n?n:0),t!==r&&(t=(t=ms(t))==t?t:0),sr(ms(e),t,n)},Hn.clone=function(e){return lr(e,4)},Hn.cloneDeep=function(e){return lr(e,5)},Hn.cloneDeepWith=function(e,t){return lr(e,5,t="function"==typeof t?t:r)},Hn.cloneWith=function(e,t){return lr(e,4,t="function"==typeof t?t:r)},Hn.conformsTo=function(e,t){return null==t||ur(e,t,Is(t))},Hn.deburr=Ws,Hn.defaultTo=function(e,t){return null==e||e!=e?t:e},Hn.divide=bl,Hn.endsWith=function(e,t,n){e=ys(e),t=ui(t);var i=e.length,o=n=n===r?i:sr(ps(n),0,i);return(n-=t.length)>=0&&e.slice(n,o)==t},Hn.eq=Ha,Hn.escape=function(e){return(e=ys(e))&&Y.test(e)?e.replace(V,on):e},Hn.escapeRegExp=function(e){return(e=ys(e))&&ie.test(e)?e.replace(re,"\\$&"):e},Hn.every=function(e,t,n){var i=qa(e)?Mt:pr;return n&&Ro(e,t,n)&&(t=r),i(e,lo(t,3))},Hn.find=ma,Hn.findIndex=Wo,Hn.findKey=function(e,t){return Ht(e,lo(t,3),Rr)},Hn.findLast=va,Hn.findLastIndex=qo,Hn.findLastKey=function(e,t){return Ht(e,lo(t,3),wr)},Hn.floor=Rl,Hn.forEach=ya,Hn.forEachRight=ba,Hn.forIn=function(e,t){return null==e?e:yr(e,lo(t,3),js)},Hn.forInRight=function(e,t){return null==e?e:br(e,lo(t,3),js)},Hn.forOwn=function(e,t){return e&&Rr(e,lo(t,3))},Hn.forOwnRight=function(e,t){return e&&wr(e,lo(t,3))},Hn.get=_s,Hn.gt=Na,Hn.gte=Ga,Hn.has=function(e,t){return null!=e&&mo(e,t,xr)},Hn.hasIn=xs,Hn.head=Ko,Hn.identity=rl,Hn.includes=function(e,t,n,r){e=Ka(e)?e:Hs(e),n=n&&!r?ps(n):0;var i=e.length;return n<0&&(n=yn(i+n,0)),ss(e)?n<=i&&e.indexOf(t,n)>-1:!!i&&Gt(e,t,n)>-1},Hn.indexOf=function(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var i=null==n?0:ps(n);return i<0&&(i=yn(r+i,0)),Gt(e,t,i)},Hn.inRange=function(e,t,n){return t=fs(t),n===r?(n=t,t=0):n=fs(n),function(e,t,n){return e>=bn(t,n)&&e<yn(t,n)}(e=ms(e),t,n)},Hn.invoke=Ms,Hn.isArguments=Wa,Hn.isArray=qa,Hn.isArrayBuffer=za,Hn.isArrayLike=Ka,Hn.isArrayLikeObject=Ua,Hn.isBoolean=function(e){return!0===e||!1===e||ts(e)&&Cr(e)==b},Hn.isBuffer=Va,Hn.isDate=Ja,Hn.isElement=function(e){return ts(e)&&1===e.nodeType&&!is(e)},Hn.isEmpty=function(e){if(null==e)return!0;if(Ka(e)&&(qa(e)||"string"==typeof e||"function"==typeof e.splice||Va(e)||us(e)||Wa(e)))return!e.length;var t=go(e);if(t==k||t==E)return!e.size;if(ko(e))return!Fr(e).length;for(var n in e)if($e.call(e,n))return!1;return!0},Hn.isEqual=function(e,t){return jr(e,t)},Hn.isEqualWith=function(e,t,n){var i=(n="function"==typeof n?n:r)?n(e,t):r;return i===r?jr(e,t,r,n):!!i},Hn.isError=Ya,Hn.isFinite=function(e){return"number"==typeof e&&bt(e)},Hn.isFunction=Xa,Hn.isInteger=Za,Hn.isLength=Qa,Hn.isMap=ns,Hn.isMatch=function(e,t){return e===t||Or(e,t,co(t))},Hn.isMatchWith=function(e,t,n){return n="function"==typeof n?n:r,Or(e,t,co(t),n)},Hn.isNaN=function(e){return rs(e)&&e!=+e},Hn.isNative=function(e){if(Bo(e))throw new Be("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return Ar(e)},Hn.isNil=function(e){return null==e},Hn.isNull=function(e){return null===e},Hn.isNumber=rs,Hn.isObject=es,Hn.isObjectLike=ts,Hn.isPlainObject=is,Hn.isRegExp=os,Hn.isSafeInteger=function(e){return Za(e)&&e>=-9007199254740991&&e<=f},Hn.isSet=as,Hn.isString=ss,Hn.isSymbol=ls,Hn.isTypedArray=us,Hn.isUndefined=function(e){return e===r},Hn.isWeakMap=function(e){return ts(e)&&go(e)==j},Hn.isWeakSet=function(e){return ts(e)&&"[object WeakSet]"==Cr(e)},Hn.join=function(e,t){return null==e?"":Dt.call(e,t)},Hn.kebabCase=qs,Hn.last=Yo,Hn.lastIndexOf=function(e,t,n){var i=null==e?0:e.length;if(!i)return-1;var o=i;return n!==r&&(o=(o=ps(n))<0?yn(i+o,0):bn(o,i-1)),t==t?function(e,t,n){for(var r=n+1;r--;)if(e[r]===t)return r;return r}(e,t,o):Nt(e,qt,o,!0)},Hn.lowerCase=zs,Hn.lowerFirst=Ks,Hn.lt=cs,Hn.lte=ds,Hn.max=function(e){return e&&e.length?gr(e,rl,_r):r},Hn.maxBy=function(e,t){return e&&e.length?gr(e,lo(t,2),_r):r},Hn.mean=function(e){return zt(e,rl)},Hn.meanBy=function(e,t){return zt(e,lo(t,2))},Hn.min=function(e){return e&&e.length?gr(e,rl,Tr):r},Hn.minBy=function(e,t){return e&&e.length?gr(e,lo(t,2),Tr):r},Hn.stubArray=gl,Hn.stubFalse=ml,Hn.stubObject=function(){return{}},Hn.stubString=function(){return""},Hn.stubTrue=function(){return!0},Hn.multiply=wl,Hn.nth=function(e,t){return e&&e.length?Wr(e,ps(t)):r},Hn.noConflict=function(){return pt._===this&&(pt._=He),this},Hn.noop=ll,Hn.now=_a,Hn.pad=function(e,t,n){e=ys(e);var r=(t=ps(t))?fn(e):0;if(!t||r>=t)return e;var i=(t-r)/2;return qi(gt(i),n)+e+qi(ft(i),n)},Hn.padEnd=function(e,t,n){e=ys(e);var r=(t=ps(t))?fn(e):0;return t&&r<t?e+qi(t-r,n):e},Hn.padStart=function(e,t,n){e=ys(e);var r=(t=ps(t))?fn(e):0;return t&&r<t?qi(t-r,n)+e:e},Hn.parseInt=function(e,t,n){return n||null==t?t=0:t&&(t=+t),wn(ys(e).replace(oe,""),t||0)},Hn.random=function(e,t,n){if(n&&"boolean"!=typeof n&&Ro(e,t,n)&&(t=n=r),n===r&&("boolean"==typeof t?(n=t,t=r):"boolean"==typeof e&&(n=e,e=r)),e===r&&t===r?(e=0,t=1):(e=fs(e),t===r?(t=e,e=0):t=fs(t)),e>t){var i=e;e=t,t=i}if(n||e%1||t%1){var o=Sn();return bn(e+o*(t-e+ct("1e-"+((o+"").length-1))),t)}return Vr(e,t)},Hn.reduce=function(e,t,n){var r=qa(e)?Ft:Vt,i=arguments.length<3;return r(e,lo(t,4),n,i,hr)},Hn.reduceRight=function(e,t,n){var r=qa(e)?Lt:Vt,i=arguments.length<3;return r(e,lo(t,4),n,i,fr)},Hn.repeat=function(e,t,n){return t=(n?Ro(e,t,n):t===r)?1:ps(t),Jr(ys(e),t)},Hn.replace=function(){var e=arguments,t=ys(e[0]);return e.length<3?t:t.replace(e[1],e[2])},Hn.result=function(e,t,n){var i=-1,o=(t=bi(t,e)).length;for(o||(o=1,e=r);++i<o;){var a=null==e?r:e[Lo(t[i])];a===r&&(i=o,a=n),e=Xa(a)?a.call(e):a}return e},Hn.round=Sl,Hn.runInContext=e,Hn.sample=function(e){return(qa(e)?Xn:Xr)(e)},Hn.size=function(e){if(null==e)return 0;if(Ka(e))return ss(e)?fn(e):e.length;var t=go(e);return t==k||t==E?e.size:Fr(e).length},Hn.snakeCase=Us,Hn.some=function(e,t,n){var i=qa(e)?Tt:ii;return n&&Ro(e,t,n)&&(t=r),i(e,lo(t,3))},Hn.sortedIndex=function(e,t){return oi(e,t)},Hn.sortedIndexBy=function(e,t,n){return ai(e,t,lo(n,2))},Hn.sortedIndexOf=function(e,t){var n=null==e?0:e.length;if(n){var r=oi(e,t);if(r<n&&Ha(e[r],t))return r}return-1},Hn.sortedLastIndex=function(e,t){return oi(e,t,!0)},Hn.sortedLastIndexBy=function(e,t,n){return ai(e,t,lo(n,2),!0)},Hn.sortedLastIndexOf=function(e,t){if(null!=e&&e.length){var n=oi(e,t,!0)-1;if(Ha(e[n],t))return n}return-1},Hn.startCase=Vs,Hn.startsWith=function(e,t,n){return e=ys(e),n=null==n?0:sr(ps(n),0,e.length),t=ui(t),e.slice(n,n+t.length)==t},Hn.subtract=Bl,Hn.sum=function(e){return e&&e.length?Jt(e,rl):0},Hn.sumBy=function(e,t){return e&&e.length?Jt(e,lo(t,2)):0},Hn.template=function(e,t,n){var i=Hn.templateSettings;n&&Ro(e,t,n)&&(t=r),e=ys(e),t=ws({},t,i,Zi);var o,a,s=ws({},t.imports,i.imports,Zi),l=Is(s),u=Qt(s,l),c=0,d=t.interpolate||we,h="__p += '",f=xe((t.escape||we).source+"|"+d.source+"|"+(d===Q?fe:we).source+"|"+(t.evaluate||we).source+"|$","g"),p="//# sourceURL="+($e.call(t,"sourceURL")?(t.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++at+"]")+"\n";e.replace(f,function(t,n,r,i,s,l){return r||(r=i),h+=e.slice(c,l).replace(Se,an),n&&(o=!0,h+="' +\n__e("+n+") +\n'"),s&&(a=!0,h+="';\n"+s+";\n__p += '"),r&&(h+="' +\n((__t = ("+r+")) == null ? '' : __t) +\n'"),c=l+t.length,t}),h+="';\n";var g=$e.call(t,"variable")&&t.variable;if(g){if(de.test(g))throw new Be("Invalid `variable` option passed into `_.template`")}else h="with (obj) {\n"+h+"\n}\n";h=(a?h.replace(q,""):h).replace(z,"$1").replace(K,"$1;"),h="function("+(g||"obj")+") {\n"+(g?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(o?", __e = _.escape":"")+(a?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+h+"return __p\n}";var m=Zs(function(){return ke(l,p+"return "+h).apply(r,u)});if(m.source=h,Ya(m))throw m;return m},Hn.times=function(e,t){if((e=ps(e))<1||e>f)return[];var n=g,r=bn(e,g);t=lo(t),e-=g;for(var i=Yt(r,t);++n<e;)t(n);return i},Hn.toFinite=fs,Hn.toInteger=ps,Hn.toLength=gs,Hn.toLower=function(e){return ys(e).toLowerCase()},Hn.toNumber=ms,Hn.toSafeInteger=function(e){return e?sr(ps(e),-9007199254740991,f):0===e?e:0},Hn.toString=ys,Hn.toUpper=function(e){return ys(e).toUpperCase()},Hn.trim=function(e,t,n){if((e=ys(e))&&(n||t===r))return Xt(e);if(!e||!(t=ui(t)))return e;var i=pn(e),o=pn(t);return wi(i,tn(i,o),nn(i,o)+1).join("")},Hn.trimEnd=function(e,t,n){if((e=ys(e))&&(n||t===r))return e.slice(0,gn(e)+1);if(!e||!(t=ui(t)))return e;var i=pn(e);return wi(i,0,nn(i,pn(t))+1).join("")},Hn.trimStart=function(e,t,n){if((e=ys(e))&&(n||t===r))return e.replace(oe,"");if(!e||!(t=ui(t)))return e;var i=pn(e);return wi(i,tn(i,pn(t))).join("")},Hn.truncate=function(e,t){var n=30,i="...";if(es(t)){var o="separator"in t?t.separator:o;n="length"in t?ps(t.length):n,i="omission"in t?ui(t.omission):i}var a=(e=ys(e)).length;if(sn(e)){var s=pn(e);a=s.length}if(n>=a)return e;var l=n-fn(i);if(l<1)return i;var u=s?wi(s,0,l).join(""):e.slice(0,l);if(o===r)return u+i;if(s&&(l+=u.length-l),os(o)){if(e.slice(l).search(o)){var c,d=u;for(o.global||(o=xe(o.source,ys(pe.exec(o))+"g")),o.lastIndex=0;c=o.exec(d);)var h=c.index;u=u.slice(0,h===r?l:h)}}else if(e.indexOf(ui(o),l)!=l){var f=u.lastIndexOf(o);f>-1&&(u=u.slice(0,f))}return u+i},Hn.unescape=function(e){return(e=ys(e))&&J.test(e)?e.replace(U,mn):e},Hn.uniqueId=function(e){var t=++Fe;return ys(e)+t},Hn.upperCase=Js,Hn.upperFirst=Ys,Hn.each=ya,Hn.eachRight=ba,Hn.first=Ko,sl(Hn,function(){var e={};return Rr(Hn,function(t,n){$e.call(Hn.prototype,n)||(e[n]=t)}),e}(),{chain:!1}),Hn.VERSION="4.17.23",Pt(["bind","bindKey","curry","curryRight","partial","partialRight"],function(e){Hn[e].placeholder=Hn}),Pt(["drop","take"],function(e,t){qn.prototype[e]=function(n){n=n===r?1:yn(ps(n),0);var i=this.__filtered__&&!t?new qn(this):this.clone();return i.__filtered__?i.__takeCount__=bn(n,i.__takeCount__):i.__views__.push({size:bn(n,g),type:e+(i.__dir__<0?"Right":"")}),i},qn.prototype[e+"Right"]=function(t){return this.reverse()[e](t).reverse()}}),Pt(["filter","map","takeWhile"],function(e,t){var n=t+1,r=1==n||3==n;qn.prototype[e]=function(e){var t=this.clone();return t.__iteratees__.push({iteratee:lo(e,3),type:n}),t.__filtered__=t.__filtered__||r,t}}),Pt(["head","last"],function(e,t){var n="take"+(t?"Right":"");qn.prototype[e]=function(){return this[n](1).value()[0]}}),Pt(["initial","tail"],function(e,t){var n="drop"+(t?"":"Right");qn.prototype[e]=function(){return this.__filtered__?new qn(this):this[n](1)}}),qn.prototype.compact=function(){return this.filter(rl)},qn.prototype.find=function(e){return this.filter(e).head()},qn.prototype.findLast=function(e){return this.reverse().find(e)},qn.prototype.invokeMap=Yr(function(e,t){return"function"==typeof e?new qn(this):this.map(function(n){return Mr(n,e,t)})}),qn.prototype.reject=function(e){return this.filter($a(lo(e)))},qn.prototype.slice=function(e,t){e=ps(e);var n=this;return n.__filtered__&&(e>0||t<0)?new qn(n):(e<0?n=n.takeRight(-e):e&&(n=n.drop(e)),t!==r&&(n=(t=ps(t))<0?n.dropRight(-t):n.take(t-e)),n)},qn.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},qn.prototype.toArray=function(){return this.take(g)},Rr(qn.prototype,function(e,t){var n=/^(?:filter|find|map|reject)|While$/.test(t),i=/^(?:head|last)$/.test(t),o=Hn[i?"take"+("last"==t?"Right":""):t],a=i||/^find/.test(t);o&&(Hn.prototype[t]=function(){var t=this.__wrapped__,s=i?[1]:arguments,l=t instanceof qn,u=s[0],c=l||qa(t),d=function(e){var t=o.apply(Hn,$t([e],s));return i&&h?t[0]:t};c&&n&&"function"==typeof u&&1!=u.length&&(l=c=!1);var h=this.__chain__,f=!!this.__actions__.length,p=a&&!h,g=l&&!f;if(!a&&c){t=g?t:new qn(this);var m=e.apply(t,s);return m.__actions__.push({func:fa,args:[d],thisArg:r}),new Wn(m,h)}return p&&g?e.apply(this,s):(m=this.thru(d),p?i?m.value()[0]:m.value():m)})}),Pt(["pop","push","shift","sort","splice","unshift"],function(e){var t=Me[e],n=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",r=/^(?:pop|shift)$/.test(e);Hn.prototype[e]=function(){var e=arguments;if(r&&!this.__chain__){var i=this.value();return t.apply(qa(i)?i:[],e)}return this[n](function(n){return t.apply(qa(n)?n:[],e)})}}),Rr(qn.prototype,function(e,t){var n=Hn[t];if(n){var r=n.name+"";$e.call(In,r)||(In[r]=[]),In[r].push({name:t,func:n})}}),In[Hi(r,2).name]=[{name:"wrapper",func:r}],qn.prototype.clone=function(){var e=new qn(this.__wrapped__);return e.__actions__=Ei(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=Ei(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=Ei(this.__views__),e},qn.prototype.reverse=function(){if(this.__filtered__){var e=new qn(this);e.__dir__=-1,e.__filtered__=!0}else(e=this.clone()).__dir__*=-1;return e},qn.prototype.value=function(){var e=this.__wrapped__.value(),t=this.__dir__,n=qa(e),r=t<0,i=n?e.length:0,o=function(e,t,n){for(var r=-1,i=n.length;++r<i;){var o=n[r],a=o.size;switch(o.type){case"drop":e+=a;break;case"dropRight":t-=a;break;case"take":t=bn(t,e+a);break;case"takeRight":e=yn(e,t-a)}}return{start:e,end:t}}(0,i,this.__views__),a=o.start,s=o.end,l=s-a,u=r?s:a-1,c=this.__iteratees__,d=c.length,h=0,f=bn(l,this.__takeCount__);if(!n||!r&&i==l&&f==l)return pi(e,this.__actions__);var p=[];e:for(;l--&&h<f;){for(var g=-1,m=e[u+=t];++g<d;){var v=c[g],y=v.iteratee,b=v.type,R=y(m);if(2==b)m=R;else if(!R){if(1==b)continue e;break e}}p[h++]=m}return p},Hn.prototype.at=pa,Hn.prototype.chain=function(){return ha(this)},Hn.prototype.commit=function(){return new Wn(this.value(),this.__chain__)},Hn.prototype.next=function(){this.__values__===r&&(this.__values__=hs(this.value()));var e=this.__index__>=this.__values__.length;return{done:e,value:e?r:this.__values__[this.__index__++]}},Hn.prototype.plant=function(e){for(var t,n=this;n instanceof Gn;){var i=Do(n);i.__index__=0,i.__values__=r,t?o.__wrapped__=i:t=i;var o=i;n=n.__wrapped__}return o.__wrapped__=e,t},Hn.prototype.reverse=function(){var e=this.__wrapped__;if(e instanceof qn){var t=e;return this.__actions__.length&&(t=new qn(this)),(t=t.reverse()).__actions__.push({func:fa,args:[ea],thisArg:r}),new Wn(t,this.__chain__)}return this.thru(ea)},Hn.prototype.toJSON=Hn.prototype.valueOf=Hn.prototype.value=function(){return pi(this.__wrapped__,this.__actions__)},Hn.prototype.first=Hn.prototype.head,Xe&&(Hn.prototype[Xe]=function(){return this}),Hn}();mt?((mt.exports=vn)._=vn,gt._=vn):pt._=vn}).call(bf)}(yf,yf.exports)),yf.exports);function wf(e,t){const n={Appearance:{label:"Body and clothes",groups:[]},Item:{label:"Items and restraints",groups:[]}};let r;switch(AssetGroup.filter(t).sort((e,t)=>e.Category.localeCompare(t.Category)||e.Description.localeCompare(t.Description)||e.Name.localeCompare(t.Name)).forEach(e=>{n[e.Category]?.groups.push(e)}),e){case"all":r=()=>!0;break;case"none":r=()=>!1;break;default:r=e}return{type:"select-multiple",label:"The item group(s) to which the option will be applied",required:!0,options:Object.values(n).flatMap(({label:e,groups:t})=>t.map(t=>({label:t.Description,value:t.Name,group:e,default:r(t)})))}}function Sf(e,t,n){const r=n.description??[],i=Sh(r)?r:[r],o=Sh(n.label)?n.label:[n.label],a=n.kwargs??{},s=`Hook "${t.name}-${e}-${n.hookName}"`;if("function"!=typeof n.listener)throw new TypeError(`${s}: Invalid "listener" type: "${typeof n.listener}"`);if("string"!=typeof n.hookName)throw new TypeError(`${s}: Invalid "hookName" type: "${typeof n.hookName}"`);if(!n.hookName)throw new Error(`${s}: Invalid "hookName" value; string must be non-empty`);if(!Sh(n.label)&&"string"!=typeof n.label)throw new TypeError(`${s}: Invalid "label" type: "${typeof n.label}"`);if(!o.every(e=>"string"==typeof e||e instanceof HTMLElement))throw new TypeError(`${s}: Invalid "label" array-values; all values must be strings or html elements`);if(!Sh(n.description)&&"string"!=typeof n.description&&null!=n.description)throw new TypeError(`${s}: Invalid "description" type: "${typeof n.description}"`);if(!i.every(e=>"string"==typeof e||e instanceof HTMLElement))throw new TypeError(`${s}: Invalid "description" array-values; all values must be strings or html elements`);if("boolean"!=typeof n.conditional)throw new TypeError(`${s}: Invalid "conditional" type: "${typeof n.conditional}"`);if(null!=n.showConfig&&"boolean"!=typeof n.showConfig)throw new TypeError(`${s}: Invalid "showConfig" type: "${typeof n.showConfig}"`);if(null!=n.kwargs&&!CommonIsObject(n.kwargs))throw new TypeError(`${s}: Invalid "kwargs" type: "${typeof n.kwargs}"`);return function(e,t){for(const[n,r]of Object.entries(e)){if(!n)throw new Error(`${t}: Invalid kwarg "${n}" name; string must be non-empty`);if(!CommonIsObject(r))throw new TypeError(`${t}: Invalid kwarg"${n}" type: "${typeof r}"`);if("string"!=typeof r.type)throw new TypeError(`${t}: Invalid kwarg "${n}.type" type: "${typeof r.type}"`);if("string"!=typeof r.label)throw new TypeError(`${t}: Invalid kwarg "${n}.label" type: "${typeof r.label}"`);if(!r.label)throw new Error(`${t}: Invalid kwarg "${n}.label" value: string must be non-empty`);switch(r.type){case"number":nf(r,n,t);break;case"text":rf(r,n,t);break;case"checkbox":of(r,n,t);break;case"select":case"select-multiple":af(r,n,t);break;default:throw new Error(`${t}: Unknown "${n}" kwarg.type value: "${r.type}"`)}}}(a,s),Object.freeze({hookType:e,registrationData:t,listener:n.listener,hookName:n.hookName,label:o,description:i,conditional:n.conditional,showConfig:n.showConfig??n.conditional,kwargs:a})}const Bf=new class{constructor(){this.validKeys=Object.freeze(new Set(["validateItemUnequip","color","difficulty","craft","typeRecord","property","beforeOutfitEquip","validateItemEquip","beforeItemEquip","afterItemEquip","afterOutfitEquip"])),this.validateItemUnequip=[],this.color=[],this.difficulty=[],this.craft=[],this.typeRecord=[],this.property=[],this.beforeOutfitEquip=[],this.validateItemEquip=[],this.beforeItemEquip=[],this.afterItemEquip=[],this.afterOutfitEquip=[]}values(){return Array.from(this.validKeys).flatMap(e=>this[e].map(e=>e))}get(e,t,n){return this[t]?.find(t=>t.registrationData.name===e&&t.hookName===n)??null}async addEventListener(e,t,n){if("complete"===document.readyState?await GameReadyState.load:await new Promise(e=>globalThis.addEventListener("load",async()=>e(await GameReadyState.load))),this[e].some(e=>e.registrationData.name===t.name&&e.hookName===n.hookName))throw new Error(`Hook "${t.name}-${e}-${n.hookName}" has already been registered`);switch(e){case"validateItemUnequip":case"color":case"difficulty":case"craft":case"typeRecord":case"property":case"validateItemEquip":case"beforeItemEquip":case"afterItemEquip":n?.kwargs?.targetGroups||(n={...n,kwargs:{...n.kwargs,targetGroups:wf("all",e=>e.AllowNone)}})}this[e].push(Sf(e,t,n))}run(e,t,n,r){const i=r[e]??={},o=this[e].map(({listener:r,hookName:o,conditional:a,registrationData:s})=>{i[s.name]??={},i[s.name][o]??={error:[],success:[],skip:[]};const l=`${s.name}-${e}-${o}`;let u,c=n[l];if(c||!a){if(c??={},"newAsset"in t&&t.newAsset&&c.targetGroups)switch(c.targetGroups.type){case"select":if(c.targetGroup.value===t.newAsset.Group.Name)break;return void i[s.name][o].skip.push({event:t,kwargs:c,reason:"Target group mismatch"});case"select-multiple":if(c.targetGroups.value.has(t.newAsset.Group.Name))break;return void i[s.name][o].skip.push({event:t,kwargs:c,reason:"Target group mismatch"})}try{u=r(t,c)}catch(e){return i[s.name][o].error.push({event:t,kwargs:c,reason:e}),null}return i[s.name][o].success.push({event:t,kwargs:c}),u}i[s.name][o].skip.push({event:t,kwargs:c??{},reason:"Disabled event listener"})}).filter(Boolean);return o}};function kf(e,t){const n=Rf.pick(e,"value","type");switch(t?.type){case void 0:return void 0!==n.value&&"string"!=typeof n.value?null:n;case"select":if(void 0!==n.value&&"string"!=typeof n.value){const e=t.options.find(e=>e.default);n.value=e?e.value??e.label:void 0}else if(t.options.some(e=>(e.value??e.label)===n.value)){const e=t.options.find(e=>(e.value??e.label)===n.value);n.value=e?e.value??e.label:void 0}return n;default:return null}}function Cf(e,t){const n=Rf.pick(e,"value","type","state");switch(Sh(e.value)&&(n.value=new Set(e.value)),t?.type){case void 0:return n.value instanceof Set&&["some","all","none"].some(e=>n.state===e)?n:null;case"select-multiple":if(n.value instanceof Set){const e=new Set(t.options.map(e=>e.value??e.label));n.value=new Set(Array.from(n.value).filter(t=>e.has(t)))}else{const e=t.options.filter(e=>e.default);n.value=new Set(e.map(e=>e.value??e.label))}return 0===n.value.size?n.state="none":n.value.size===t.options.length?n.state="all":n.state="some",n;default:return null}}function _f(e,t){const n=Rf.pick(e,"value","type");switch(t?.type){case void 0:return"boolean"!=typeof n.value?null:n;case"checkbox":return"boolean"!=typeof n.value&&(n.value=t.default),n;default:return null}}function xf(e,t){const n=Rf.pick(e,"value","type");switch(t?.type){case void 0:return"number"==typeof n.value&&Number.isFinite(n.value)?n:null;case"number":return"number"==typeof n.value&&Number.isFinite(n.value)||(n.value=t.default),Rf.inRange(n.value,t.min,t.max)||(n.value=Rf.clamp(n.value,t.min,t.max)),"numeric"!==t.inputmode||Number.isInteger(n.value)||(n.value=Math.round(n.value)),n;default:return null}}function Pf(e,t){const n=Rf.pick(e,"value","type");switch(t?.type){case void 0:return"string"!=typeof n.value?null:n;case"text":if("string"!=typeof n.value&&(n.value=t.default),t.default!==n.value&&(null!=t.maxlength&&n.value.length>t.maxlength&&(n.value=n.value.slice(0,t.maxlength)),null!=t.minlength&&n.value.length<t.minlength&&(n.value=n.value.padEnd(t.minlength," ")),t.pattern)){("string"==typeof t.pattern?new RegExp(t.pattern):t.pattern).test(n.value)||(n.value=t.default)}return n;default:return null}}function Ef(e,t,n){const r={Asset:e};return ExtendedItemInit(t,r,!1,!1),n&&function(e,t,n){if(eR(t),null===e||"object"!=typeof e)throw new TypeError('Invalid "item" type: '+typeof e);ExtendedItemSetOptionByRecord(t,e,n,{refresh:!1,push:!1})}(r,t,n),r.Property??{}}const Mf=Object.freeze(["Exclusive","5 Minutes","15 Minutes","1 Hour","4 Hours","High Security"]),If=Object.freeze([Object.freeze({type:"ExclusivePadlock",description:"Exclusive",enabled:!0}),Object.freeze({type:"TimerPasswordPadlock",description:"Timer",time:300,enabled:!0}),Object.freeze({type:"TimerPasswordPadlock",description:"Timer",time:900,enabled:!0}),Object.freeze({type:"TimerPasswordPadlock",description:"Timer",time:3600,enabled:!0}),Object.freeze({type:"TimerPasswordPadlock",description:"Timer",time:14400,enabled:!1}),Object.freeze({type:"HighSecurityPadlock",description:"High security",enabled:!1}),Object.freeze({type:null,description:"No lock",enabled:!1})]);function jf(e,t,n){Eh(t,"seconds",60,14400),Af(e,"TimerPasswordPadlock",n)&&(null==e.Property&&(e.Property={}),e.Property.RemoveTimer=CurrentTime+1e3*t,e.Property.RemoveItem=!0,e.Property.LockSet=!0,e.Property.Password=qh(8))}function Of(e,t){Af(e,"HighSecurityPadlock",t),null==e.Property&&(e.Property={}),e.Property.MemberNumberListKeys=""}function Af(e,t,n){if(null===e||"object"!=typeof e)throw new TypeError('Invalid "item" type: '+typeof e);if("string"!=typeof t)throw new TypeError('Invalid "lockName" type: '+typeof t);eR(n);const r=AssetGet(n.AssetFamily,"ItemMisc",t);if(null==r)throw new Error(`Invalid "lockName" value: ${t}`);return!(null!=InventoryGetLock(e)||!InventoryDoesItemAllowLock(e)||InventoryBlockedOrLimited(n,{Asset:r}))&&(InventoryLock(n,e,{Asset:r},null,!1),!0)}function $f(e,t,n){const r=e.type;switch(r){case"TimerPasswordPadlock":jf(t,e.time,n);break;case"ExclusivePadlock":Af(t,"ExclusivePadlock",n);break;case"HighSecurityPadlock":InventoryDoesItemAllowLock(t)&&t.Craft&&(t.Craft.Property="Puzzling"),Of(t,n);break;case null:break;default:throw new Error(`Unknown flag type: ${r}`,e)}}function Ff(e,t){return e.forEach((e,n)=>{e.enabled=t.includes(n)}),e}function Lf(e){switch(e.type){case"ExclusivePadlock":return"Exclusive";case"HighSecurityPadlock":return"High Security";case"TimerPasswordPadlock":return`${Math.floor(e.time/60)} Minutes`;case null:return"No Lock";default:throw new Error(`Invalid flag type: ${e.type}`)}}const Tf=Object.freeze({NONE:0,CLOTHES:1,UNDERWEAR:2,COSPLAY:3,ALL:4});let Df;function Hf(e,t){switch(e){case Tf.NONE:return()=>!1;case Tf.CLOTHES:return e=>e.Group.AllowNone&&!e.BodyCosplay&&!e.Group.Underwear;case Tf.UNDERWEAR:return e=>e.Group.AllowNone&&!e.BodyCosplay;case Tf.COSPLAY:return e=>!tR(t)?e.Group.AllowNone&&!e.BodyCosplay:e.Group.AllowNone;case Tf.ALL:return e=>!!tR(t)||e.Group.AllowNone&&!e.BodyCosplay;default:throw new Error(`Invalid "stripLevel" value: ${e}`)}}function Nf(e,t){if(void 0===t)return[-1,!1];if(void 0!==t.priority&&void 0!==t.blocksSubSet)return[t.priority,t.blocksSubSet];if(0===t.block.size)return t.priority=0,t.blocksSubSet=!1,[t.priority,t.blocksSubSet];{const n=[];for(const r of t.block)n.push(Nf(e,e.get(r)));return t.priority=1+Math.max(0,...n.map(e=>e[0])),t.blocksSubSet=t.superSet&&n.some(e=>e[1]),[t.priority,t.blocksSubSet]}}function Gf(e,t,n=[]){if(!Sh(e))throw new TypeError('Invalid "itemList" type: '+typeof e);const r=new Map;[e,n].forEach((e,n)=>{for(const{Group:i,Name:o,TypeRecord:a}of e){if(r.has(i))continue;const e=AssetGet(t.AssetFamily,i,o);if(null==e)throw new Error(`Unknown asset: ${i}${o}`);if("Item"!==e.Group.Category)continue;const s=Ef(e,t,a),l={superSet:1===n,block:new Set(...e.Block??[],...s.Block??[])};(e.Effect?.includes("Enclose")||s.Effect?.includes("Enclose"))&&(l.priority=AssetGroup.length,l.blocksSubSet=l.superSet),r.set(i,l)}});for(const[e,t]of r)Nf(r,t);return r}function Wf(e,t){const n=InventoryGetLock(e);if(!InventoryItemHasEffect(e,"Lock"))return!0;if("Decoy"===e.Craft?.Property){if(null==n)return!1;return!["OwnerOnly","LoverOnly","FamilyOnly"].some(t=>n.Asset[t]||e.Asset[t])}const r=Uh.getRuleState("block_keyuse_self"),i=t.IsPlayer()&&r?.inEffect&&r?.isEnforced;switch(n?.Asset?.Name){case"SafewordPadlock":return!0;case"MetalPadlock":case"MistressPadlock":case"MistressTimerPadlock":case"PandoraPadlock":return!i&&!LogQuery("KeyDeposit","Cell")&&t.Inventory.some(e=>e.Asset.Name===`${n.Asset.Name}Key`);case"TimerPasswordPadlock":case"PasswordPadlock":case"CombinationPadlock":return Number(e.Property?.LockMemberNumber)===t.MemberNumber;case"HighSecurityPadlock":{const n=(e?.Property?.MemberNumberListKeys??"").split(",").map(Number);return!i&&_h(n,t.MemberNumber)}default:return!1}}function qf(){return{...this,targetGroup:"targetGroup"in this&&this.targetGroup?this.targetGroup.Name:void 0,newAsset:"newAsset"in this&&this.newAsset?this.newAsset.Name:void 0,oldItem:"oldItem"in this&&this.oldItem?{...this.oldItem,Asset:this.oldItem.Asset.Name,Group:this.oldItem.Asset.Group.Name}:void 0,newItem:"newItem"in this&&this.newItem?{...this.newItem,Asset:this.newItem.Asset.Name,Group:this.newItem.Asset.Group.Name}:void 0,character:"character"in this&&this.character?rc(this.character,"Name","MemberNumber","NickName"):void 0}}function zf(e,t){const n=new Set(t??[]);return new Proxy(Object.seal(Object.defineProperty(e,"toJSON",{value:qf,enumerable:!1})),{set(e,t,...r){if(n.has(t))throw new TypeError(`"${String(t)}" is read-only`);if(t in e)return Reflect.set(e,t,...r);throw new TypeError(`can't define property "${String(t)}": Object is not extensible`)},defineProperty(e,t,...r){if(n.has(t))throw new TypeError(`can't redefine non-configurable property "${String(t)}"`);if(t in e)return Reflect.defineProperty(e,t,...r);throw new TypeError(`can't define property "${String(t)}": Object is not extensible`)},deleteProperty(e,t){if(t in e)throw new TypeError(`property "${String(t)}" is non-configurable and can't be deleted`);return Reflect.deleteProperty(e,t)},isExtensible:()=>!1,setPrototypeOf(){throw new TypeError("can't set prototype of this object")}})}function Kf(e,t,n,r,i,o=null,a=null){const s=Object.fromEntries(Object.entries(i).filter(([e,t])=>Object.entries(t.kwargsConfig).every(([e,n])=>!("required"in n)||!n.required||t.kwargs[e])).map(([e,t])=>[e,t.kwargs]));if(!Sh(t))throw new TypeError('Invalid "itemList" type: '+typeof t);if(function(e){const t=e.Appearance.find(e=>InventoryItemHasEffect(e,"Enclose"));return null!=t&&!Wf(t,e)}(r))return void Ph.log(`Failed to equip all "${e}" wheel of fortune items: cannot unlock enclosing item`);!function(e,t){eR(t);const n=Hf(e,t),r=t.Appearance;for(let e=r.length-1;e>=0;e--){const t=r[e].Asset;t.Group.AllowNone&&"Appearance"===t.Group.Category&&n(t)&&r.splice(e,1)}}(n,r);const l=function(e,t,n){const r=Gf(e,n,t);return t.filter(e=>r.get(e.Group)?.blocksSubSet)}(t,r.Appearance.map(e=>({Group:e.Asset.Group.Name,Name:e.Asset.Name,TypeRecord:e.Property?.TypeRecord,NoEquip:!0})),r),u={activeHooks:i},c=zf({character:r,name:e},["character","name"]);Bf.run("beforeOutfitEquip",c,s,u);const d={},h=new Set,f={};for(const{Name:n,Group:i,Equip:o,NoEquip:a}of[...l,...t]){const t=AssetGet(r.AssetFamily,i,n),l=t?.Group,c=InventoryGet(r,i),p="function"!=typeof o||o(r);if(null!=t&&null!=l)if(p){const o=zf({character:r,name:e,oldItem:c,newAsset:a?null:t,targetGroup:l},["character","name","oldItem","newAsset","targetGroup"]),h=Bf.run("validateItemUnequip",o,s,u);if(0!==h.length){d[`${i}/${n}`]=h;continue}null!=c&&(f[i]=c,InventoryRemove(r,i,!1))}else h.add(i);else d[`${i}/${n}`]=["Unknown asset"]}for(const{Name:n,Group:i,Craft:l,Color:c,TypeRecord:p,Property:g}of t){const t=AssetGet(r.AssetFamily,i,n),m=t?.Group,v=d[`${i}/${n}`],y=f[i]??null;if(null==t||null==m||void 0!==v||h.has(i))continue;const b=zf({character:r,name:e,oldItem:y,newAsset:t},["character","name","oldItem","newAsset"]),R=Bf.run("validateItemEquip",b,s,u);if(R.length){d[`${i}/${n}`]=R;continue}const w=zf({character:r,name:e,oldItem:y,newAsset:t,lock:o?.type??null,color:oa(c??t.DefaultColor),properties:oa(g),difficultyModifier:0,typeRecord:p?oa(p):null,craft:l?Object.seal(rc(l,"Name","Description","Property","Effects")):null},["lock","newAsset","oldItem","name","character"]);Bf.run("beforeItemEquip",w,s,u);const S=zf({character:r,name:e,oldItem:y,newAsset:t,color:w.color??[...t.DefaultColor]},["character","name","oldItem","newAsset","color"]),B=Bf.run("color",S,s,u),k=[...S.color];for(const e of B)for(const[t,n]of e.slice(0,k.length).entries()){if(t>=k.length)break;void 0!==n&&(k[t]=n)}const C=CharacterAppearanceSetItem(r,i,t,k,SkillGetWithRatio(r,"Bondage"),a?.MemberNumber);let _=w.typeRecord;const x=zf({character:r,name:e,oldItem:y,newAsset:t,typeRecord:p??null},["character","name","oldItem","newAsset","typeRecord"]);Bf.run("typeRecord",x,s,u).forEach(e=>{_??={};for(const[t,n]of kh(e))void 0!==n&&(_[t]=n)});const P=oa(g),E=zf({character:r,name:e,oldItem:y,newAsset:t,properties:w.properties??{}},["character","name","oldItem","newAsset","properties"]);if(Bf.run("property",E,s,u).forEach(e=>{for(const[t,n]of kh(e))void 0!==n&&(P[t]=n)}),ExtendedItemSetOptionByRecord(r,C,_,{refresh:!1,push:!1,properties:P}),t.Group.IsItem()&&!t.IsLock&&t.Wear&&t.Enable){let n=oa(l);const o=zf({character:r,name:e,oldItem:y,newAsset:t,craft:w.craft},["character","name","oldItem","newAsset","craft"]);Bf.run("craft",o,s,u).forEach(e=>{n||(n={Name:t.Description,Description:"",Property:"Normal",Effects:{Normal:1},Color:"",Lock:"",Private:!0,Item:t.Name,ItemProperty:null});for(const t of["Name","Description","Property","Effects"]){const r=e[t];null!=r&&(n[t]=r)}}),null!=n&&(C.Craft=n,InventoryCraft(a,r,i,C.Craft,!1,!1))}const M=zf({character:r,name:e,oldItem:y,newAsset:t,difficultyModifier:w.difficultyModifier??0},["character","name","oldItem","newAsset","difficultyModifier"]);C.Difficulty+=Vc(Bf.run("difficulty",M,s,u)),o&&$f(o,C,r);const I=zf({character:r,name:e,oldItem:y,newItem:C,newAsset:t},["character","name","oldItem","newAsset","newItem"]);Bf.run("afterItemEquip",I,s,u)}const p=zf({character:r,name:e},["character","name"]);if(Bf.run("afterOutfitEquip",p,s,u),CharacterRefresh(r,r.IsPlayer(),!1),r.IsPlayer()){ChatRoomCharacterUpdate(r);const t=Object.values(d).length;0!==t&&Ph.log(`Failed to equip ${t} "${e}" wheel of fortune items`,d),Ph.debug(`Fortune wheel '${e}' status`,u)}}function Uf(e,t,n){if("string"!=typeof t||!DynamicDrawTextRegex.test(t))return!1;const r=`${n.Group.Name}${n.Name}`,[i,o]=kh(TextItemDataLookup).find(([e])=>e.includes(r))??["",null];return null!==o&&t.length<=(o.maxLength[e]??-1)}function Vf(e){return 0===Object.keys(e).length}function Jf(e,t){let n;if(!CommonIsObject(e))return!1;n=e;const r=new Set(t.Layer.map(e=>e.Name??t.Name));for(const[e,t]of Object.entries(n))if(e===AssetOverride||r.has(e))if(CommonIsObject(t)){for(const[e,n]of kh(t))e in PoseRecord||e===PoseType.DEFAULT||delete t[e],Number.isInteger(n)?t[e]=$i(n,Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER):delete t[e];Vf(t)&&delete n[e]}else delete n[e];else delete n[e];return Vf(n)}Fh("equipper",{async afterLoad(){Df=CharacterLoadSimple("MBSDummy")}}),Bf.addEventListener("validateItemUnequip",zh,{listener:({character:e,targetGroup:t})=>InventoryGroupIsBlockedForCharacter(e,t.Name,!1)?"InventoryGroupIsBlockedForCharacter":null,hookName:"InventoryGroupIsBlockedForCharacter",label:"Check whether the body area (Asset Group) for a character is blocked and cannot be used.",conditional:!1}),Bf.addEventListener("validateItemUnequip",zh,{listener:({character:e,targetGroup:t})=>InventoryGroupIsBlockedByOwnerRule(e,t.Name)?"InventoryGroupIsBlockedByOwnerRule":null,hookName:"InventoryGroupIsBlockedByOwnerRule",label:"Check whether the body area is blocked by an owner rule.",conditional:!1}),Bf.addEventListener("validateItemUnequip",zh,{listener:({character:e,oldItem:t})=>t&&!Wf(t,e)?"Locked item equipped":null,hookName:"LockedItem",label:"Check whether character can unlock the currently equipped item.",conditional:!1}),Bf.addEventListener("validateItemUnequip",zh,{listener:({character:e,newAsset:t})=>t&&InventoryBlockedOrLimited(e,{Asset:t})?"InventoryBlockedOrLimited":null,hookName:"InventoryBlockedOrLimited",label:"Check whether the new item is blocked or limited.",conditional:!1}),Bf.addEventListener("validateItemUnequip",zh,{listener:({newAsset:e})=>e&&!InventoryChatRoomAllow(e.Category??[])?"InventoryChatRoomAllow":null,hookName:"InventoryChatRoomAllow",label:"Check whether the room has the new item's category blocked or not.",conditional:!1}),Bf.addEventListener("validateItemUnequip",zh,{listener:({character:e,newAsset:t})=>{if(!t)return null;return e.IsPlayer()&&LogQuery("ClubSlave","Management")&&t.Group.IsAppearance()?"Blocked via Club Slave Collar":null},hookName:"IsClubSlave",label:"Check whether the new item is blocked bye virtue of being a club slave.",conditional:!1}),Bf.addEventListener("validateItemUnequip",zh,{listener:({character:e,oldItem:t})=>{if(!e.IsPlayer()||null==t)return null;const n=Uh.getCurseInfo(t.Asset.Group.Name);return n?.active?"Blocked via BCX curse":null},hookName:"BCXCurse",label:"Check whether removal of the old item is blocked due to a BCX curse.",conditional:!1}),Bf.addEventListener("validateItemEquip",zh,{listener:({character:e,newAsset:t})=>{const n=InventoryDisallow(e,t);return n?`InventoryDisallow: ${n}`:null},hookName:"InventoryDisallow",label:"Check whether the new items prerequisites can be satisfied.",conditional:!1});const Yf=Object.freeze({OverridePriority:(e,t)=>{if(xh(e))return!0;if(CommonIsObject(e)){const n=t.Layer.map(e=>e.Name);return kh(e).every(([e,t])=>n.includes(e)&&xh(t))}return!1},Opacity:(e,t)=>"number"==typeof e?e<=t.MaxOpacity&&e>=t.MinOpacity:!!Sh(e)&&e.every((e,n)=>null!=t.Layer[n]&&"number"==typeof e&&e<=1&&e>=0),Text:(e,t)=>Uf("Text",e,t),Text2:(e,t)=>Uf("Text2",e,t),Text3:(e,t)=>Uf("Text3",e,t),ShowText:(e,t)=>"boolean"==typeof e,TriggerValues:(e,t)=>"string"==typeof e&&e.split(",").length===ItemVulvaFuturisticVibratorTriggers.length,AccessMode:(e,t)=>"string"==typeof e&&ItemVulvaFuturisticVibratorAccessModes.includes(e),PunishOrgasm:(e,t)=>"boolean"==typeof e,PunishStandup:(e,t)=>"boolean"==typeof e,Texts:(e,t)=>!!Array.isArray(e)&&(!(e.length<ItemDevicesLuckyWheelMinTexts||e.length>ItemDevicesLuckyWheelMaxTexts)&&e.every(e=>"string"==typeof e&&e.length<=ItemDevicesLuckyWheelMaxTextLength)),TargetAngle:(e,t)=>"number"==typeof e&&e>=0&&e<=360,OverrideHeight:function(e,t){const n=VariableHeightDataLookup[`${t.Group.Name}${t.Name}`];if(void 0===n)return!1;const r=e;return null!==r&&"object"==typeof r&&Number.isInteger(r.Priority)&&"number"==typeof r.Height&&r.Height<=n.maxHeight&&r.Height>=n.minHeight&&(null==r.HeightRatioProportion||"number"==typeof r.HeightRatioProportion&&r.HeightRatioProportion>=0&&r.HeightRatioProportion<=1)},PunishActivity:(e,t)=>"boolean"==typeof e,PunishStruggle:(e,t)=>"boolean"==typeof e,PunishStruggleOther:(e,t)=>"boolean"==typeof e,PunishRequiredSpeechWord:(e,t)=>"string"==typeof e&&e.length<=70,PunishProhibitedSpeechWords:(e,t)=>"string"==typeof e&&e.length<=70,PunishSpeech:(e,t)=>xh(e)&&e>=0&&e<FuturisticTrainingBeltSpeechPunishments.length,PunishRequiredSpeech:(e,t)=>xh(e)&&e>=0&&e<FuturisticTrainingBeltSpeechPunishments.length,PunishProhibitedSpeech:(e,t)=>xh(e)&&e>=0&&e<FuturisticTrainingBeltSpeechPunishments.length,PublicModeCurrent:(e,t)=>xh(e)&&e>=0&&e<FuturisticTrainingBeltModes.length,PublicModePermission:(e,t)=>xh(e)&&e>=0&&e<FuturisticTrainingBeltPermissions.length,ShockLevel:(e,t)=>xh(e)&&e>=0&&e<=2,PortalLinkCode:(e,t)=>"string"==typeof e&&PortalLinkCodeRegex.test(e),OpenPermission:(e,t)=>"boolean"==typeof e,OpenPermissionChastity:(e,t)=>"boolean"==typeof e,OpenPermissionArm:(e,t)=>"boolean"==typeof e,OpenPermissionLeg:(e,t)=>"boolean"==typeof e,BlockRemotes:(e,t)=>"boolean"==typeof e,DrawingLeft:Jf,DrawingTop:Jf});function Xf(e,t){if(null===t||"object"!=typeof t)return{};const n=new Set(["OverridePriority",e.EditOpacity?"Opacity":null,"DrawingTop","DrawingLeft"].filter(e=>null!=e));if(e.Archetype){const r=ExtendedItemGatherOptions({Asset:e,Property:t});for(const e of r){"VariableHeightOption"===e.OptionType&&n.add("OverrideHeight");for(const t of Bh(e.ParentData.baselineProperty??{}))CraftingPropertyExclude.has(t)||n.add(t)}}const r={};for(const[i,o]of kh(t)){const t=Yf[i];null!=o&&n.has(i)&&void 0!==t&&(t(o,e)&&(r[i]=o))}return r}const Zf=Object.freeze(new Map([["Unknown asset",e=>null==e],["Unsupported owner-only asset",e=>e?.OwnerOnly],["Unsupported lovers-only asset",e=>e?.LoverOnly],["Unsupported D/S family-only asset",e=>e?.FamilyOnly],["Unsupported disabled asset",e=>!e?.Enable],["Unsupported script-asset",e=>"Script"===e?.Group?.Category]]));function Qf(e,t,n=!0){for(const[n,r]of Zf)if(r(e))throw new Error(`${n}: ${t.Group}${t.Name}`);let r,i;"string"==typeof t.Color?r=[t.Color]:Array.isArray(t.Color)&&t.Color.every(e=>"string"==typeof e)&&(r=[...t.Color]),null!==t.Craft&&"object"==typeof t.Craft&&(i=Object.assign(oa(t.Craft),{TypeRecord:void 0,OverridePriority:null,Lock:""}),CraftingValidate(i,e,!1));const o=t.Property??{};let a;return CommonIsObject(o.TypeRecord)?a=Object.freeze({...o.TypeRecord}):"string"==typeof o.Type||null===o.Type?a=ExtendedItemTypeToRecord(e,o.Type):"string"==typeof o.Mode&&(a=ExtendedItemTypeToRecord(e,o.Mode)),Object.freeze({Name:t.Name,Group:t.Group,Custom:n,Property:Object.freeze(Xf(e,t.Property)),TypeRecord:a,Color:r,Craft:Object.freeze(i),Equip:void 0})}function ep(e,t){if(!Sh(e))throw new TypeError('Invalid "items" type: '+typeof e);return e.map(e=>function(e,t){const{Group:n,Name:r,Color:i,Craft:o,TypeRecord:a,Property:s}=e,l=AssetGet(t.AssetFamily,n,r);if(null==l)throw new Error(`Unknown asset: ${n}${r}`);return{Group:n,Name:r,Color:na(i),Craft:na(o),Property:Object.assign(Ef(l,t,a),oa(s))}}(e,t))}var tp;class np{get screen(){return this.constructor.screen}get ids(){return this.constructor.ids}get rootParams(){return this.screenParams[this.constructor.ids.root]}constructor(e,t,n){this.parent=e,this.screenParams=su(oa(t),n??{}),this.child=null}resize(e){const t=MainCanvas.canvas.clientHeight/1e3,n=MainCanvas.canvas.clientWidth/2e3;for(const[r,{shape:i,visibility:o}]of kh(this.screenParams)){const a=MainCanvas.canvas.offsetLeft+i[0]*n,s=MainCanvas.canvas.offsetTop+i[1]*t,l=i[2]*n,u=i[3]*t,c=document.getElementById(r),d={left:`${a}px`,top:`${s}px`,width:`${l}px`,height:`${u}px`};e&&(d.fontFamily=CommonGetFontName(),c.toggleAttribute("hidden","hidden"===o)),Object.assign(c.style,d)}}unload(){document.activeElement?.dispatchEvent(new FocusEvent("blur"));for(const e of Bh(this.screenParams)){const t=document.getElementById(e);null!==t&&(t.hidden=!0)}}exit(){document.activeElement?.dispatchEvent(new FocusEvent("blur"));for(const e of Bh(this.screenParams))ElementRemove(e)}async load(){CurrentScreenFunctions?.Unload?.(),ControllerIsActive()&&ControllerClearAreas(),CurrentScreen=this.screen,CurrentScreenFunctions=this.getFunctions(),CurrentDarkFactor=1,CommonGetFont.clearCache(),CommonGetFontName.clearCache(),CurrentScreenFunctions?.Resize?.(!0)}async loadChild(e,...t){return this.child&&this.child.exit(),this.child=new e(this,...t),await this.child.load(),this.child}exitScreens(e){let t=this.parent,n=this.child;for(;null!=n?.child;)n=n.child;for(;n&&n!==this;)n.child=null,n.exit(),n=n.parent;if(e)for(;null!==t&&!(t instanceof rp);)t.child=null,t.exit(),t=t.parent;null!==t&&(t.load(),t.child=null)}getFunctions(){return{Run:this.run?.bind(this)??CommonNoop,Draw:this.draw?.bind(this),Click:this.click?.bind(this)??CommonNoop,Load:this.load.bind(this),Unload:this.unload?.bind(this),Resize:this.resize?.bind(this),Exit:this.exit.bind(this)}}}np.background="Sheet",np.screenParamsDefault={};class rp extends np{constructor(e,t,n,r){super(e,rp.screenParamsDefault,null),this.module=t,this.background=n,this.screenFunctions=Object.freeze({...r})}run(e){return this.screenFunctions.Run(e)}draw(){return this.screenFunctions.Draw?.()}click(e){return this.screenFunctions.Click(e)}load(){return this.screenFunctions.Load?.()??Promise.resolve(void 0)}unload(){return this.screenFunctions.Unload?.()}resize(e){return this.screenFunctions.Resize?.(e)}keyDown(e){return this.screenFunctions.KeyDown?.(e)??!1}exit(){return this.screenFunctions.Exit?.()}}rp.screenParamsDefault={};const ip=Object.freeze({NONE:0,SAVE:1,DELETE:2});class op extends np{get index(){return L(this,tp,"f")}set index(e){Eh(e,"index",0,this.mbsList.length-1),T(this,tp,e,"f")}get mbsObject(){return this.mbsList[L(this,tp,"f")]}hasStorageSpace(){return null!==this.mbsList[this.index]||this.dataSize.value<=this.dataSize.max*this.dataSize.marigin}constructor(e,t,n,r,i,o){super(e,i,o),tp.set(this,0),this.character=r,this.mbsList=t,this.index=n,this.dataSize=Object.seal({value:0,valueRecord:{},max:Sb,marigin:.9})}async load(){const e=Bb(this.character.OnlineSharedSettings);this.dataSize.value=Jc(Object.values(e),e=>Number.isNaN(e)?0:e),this.dataSize.valueRecord=e,super.load()}exit(e=!0,t=ip.NONE){if(super.exit(),!this.character.IsPlayer())return this.exitScreens(e);switch(t){case ip.NONE:break;case ip.SAVE:this.settings.isValid(this.index)&&this.hasStorageSpace()&&(this.mbsList[this.index]=this.settings.writeSettings(),this.mbsList[this.index]?.register());break;case ip.DELETE:{const e=this.mbsList[this.index];this.mbsList[this.index]=null,e?.unregister();break}default:throw new Error(`Unsupported action: ${t}`)}this.exitScreens(e)}}tp=new WeakMap;var ap,sp,lp,up,cp,dp,hp,fp;const pp=Object.freeze({[Tf.NONE]:"None",[Tf.CLOTHES]:"Clothes",[Tf.UNDERWEAR]:"Clothes and underwear",[Tf.COSPLAY]:"Clothes, underwear and cosplay items",[Tf.ALL]:"Clothes, underwear, cosplay items and body"});function gp(e){e=Number.isNaN(e)?60:$i(e,60,14400);const t={h:0,m:0,s:0};return t.h=Math.floor(e/3600),e-=3600*t.h,t.m=Math.floor(e/60),e-=60*t.m,t.s=e,`${t.h.toString().padStart(2,"0")}:${t.m.toString().padStart(2,"0")}:${t.s.toString().padStart(2,"0")}`}function mp(e,t,n){return E.jsx("select",{required:!0,disabled:n,id:e.id,onChange:function(){t[e.level]=$i(Number.parseInt(this.value,10),Tf.NONE,Tf.COSPLAY)},onFocus:function(){try{this.showPicker?.()}catch{return}},children:Object.values(pp).slice(0,4).map((e,t)=>E.jsx("option",{value:t,selected:0===t,children:e}))})}function vp(e){function t(t){if(!this.validity.valid)return this.checked=this.defaultChecked,void t.stopImmediatePropagation();const n=this.closest(".mbs-fwitemset-event"),r=n?.getAttribute("data-name"),i=n?.getAttribute("data-type"),o=n?.getAttribute("data-mod");if(!(r&&i&&o&&n))return void t.stopImmediatePropagation();const a=Array.from(n.querySelectorAll(".mbs-fwitemset-event-kwarg-config"));this.checked?(e.settings.activeHooks.set(`${o}-${i}-${r}`,{modName:o,hookType:i,hookName:r,kwargs:new Map}),a.forEach(e=>{e.toggleAttribute("disabled",!1),e.dispatchEvent(new CustomEvent("change",{detail:"no-preview-refresh"}))})):(e.settings.activeHooks.delete(`${o}-${i}-${r}`),a.forEach(e=>e.toggleAttribute("disabled",!0))),e.reloadPreviewAppearance();const s=n.querySelector("button.mbs-fwitemset-event-collapse");s&&"true"!==s.ariaExpanded&&s.click()}return[E.jsx("span",{id:bp.eventsLabel,children:"Addon-specific options:"}),E.jsx("menu",{id:bp.events,"aria-labelledby":"mbs-fwitemset-events-label",children:Bf.values().sort((e,t)=>e.registrationData.name.localeCompare(t.registrationData.name)||e.hookType.localeCompare(t.hookType)||e.hookName.localeCompare(t.hookName)).map(n=>{if(!n.showConfig)return null;const r=`${n.registrationData.name}-${n.hookType}-${n.hookName}`,i=function(e,t,n){const r=[];for(const[i,o]of Object.entries(t)){let t;switch(o.type){case"text":t=cf(`${e}-${i}`,i,o,n);break;case"number":t=df(`${e}-${i}`,i,o,n);break;case"checkbox":t=hf(0,i,o,n);break;case"select-multiple":case"select":t=pf(`${e}-${i}`,i,o,n);break;default:throw new Error(`Unknown options type: ${o.type}`)}r.push(E.jsxs("label",{id:`${e}-${i}`,class:"mbs-fwitemset-event-kwargs",role:"listitem",children:[E.jsxs("span",{children:[o.label,E.jsx("span",{class:"mbs-fwitemset-event-error-msg"})]}),t]}))}return r}(`${bp.events}-${r}`,n.kwargs,e.settings);i.flatMap(e=>Array.from(e.querySelectorAll("input, select"))).forEach(t=>{t.addEventListener("change",t=>{t instanceof CustomEvent&&"no-preview-refresh"===t.detail||e.reloadPreviewAppearance()})}),0===i.length?i.push(E.jsx("li",{class:"mbs-fwitemset-event-menu-placeholder","aria-hidden":"true",children:E.jsx("b",{children:"—"})})):i.push(E.jsx("li",{class:"mbs-fwitemset-event-menu-placeholder","aria-hidden":"true",children:ElementButton.Create(`${bp.eventsCheckbox}-${r}-collapse2`,function(e){const t=this.closest(".mbs-fwitemset-event")?.querySelector("button.mbs-fwitemset-event-collapse");t?t.click():e.stopImmediatePropagation()},{label:"...",noStyling:!0,labelPosition:"center"},{button:{attributes:{"aria-label":"Uncollapse section"}},label:{attributes:{"aria-hidden":"true"}}})}));const o=E.jsxs("li",{"data-name":n.hookName,"data-mod":n.registrationData.name,"data-type":n.hookType,class:"mbs-fwitemset-event",children:[ElementButton.Create(`${bp.eventsCheckbox}-${r}-collapse`,function(e){if(e.shiftKey){const e="true"===this.ariaExpanded,t=document.getElementById(bp.events),n=t?.querySelectorAll(`button.mbs-fwitemset-event-collapse[aria-expanded="${!e}"`)??[];if(n.forEach(e=>e.click()),n.length&&!e)return void this.click()}const t=this.querySelector(".button-label");t?"true"===this.ariaExpanded?(t.textContent="▼",this.closest(".mbs-fwitemset-event")?.scrollIntoView({behavior:"instant"})):t.textContent="▶":e.stopImmediatePropagation()},{label:"▼",noStyling:!0,role:"checkbox",labelPosition:"center"},{button:{attributes:{"aria-label":"Collapse section","aria-expanded":"true","aria-checked":"true"},classList:["mbs-fwitemset-event-collapse"]},label:{attributes:{"aria-hidden":"true"}}}),E.jsx("input",{type:"checkbox",class:"checkbox mbs-fwitemset-event-checkbox",id:`${bp.eventsCheckbox}-${r}`,onChange:t,"aria-describedby":`${bp.eventsCheckbox}-${r}-description`}),E.jsxs("section",{children:[E.jsxs("p",{children:[E.jsx("label",{for:`${bp.eventsCheckbox}-${r}`,children:E.jsxs("span",{children:[`${n.registrationData.name}: `,n.label]})})," "]}),E.jsx("p",{id:`${bp.eventsCheckbox}-${r}-description`,children:n.description})]}),E.jsx("menu",{class:"mbs-fwitemset-event-menu","aria-label":"Configuration",children:i})]});return o}).filter(Boolean)})]}const yp="mbs-fwitemset",bp=Object.freeze({root:yp,styles:`${yp}-style`,delete:`${yp}-delete`,accept:`${yp}-accept`,cancel:`${yp}-cancel`,exit:`${yp}-exit`,header:`${yp}-header`,midDiv:`${yp}-mid-grid`,botDiv:`${yp}-bot-grid`,outfitName:`${yp}-outfit-name`,outfitInput:`${yp}-outfit-input`,outfitButton:`${yp}-outfit-button`,stripHeader:`${yp}-strip-header`,stripSelect:`${yp}-strip-dropdown`,equipHeader:`${yp}-equip-header`,equipSelect:`${yp}-equip-dropdown`,weightHeader:`${yp}-weight-header`,weightInput:`${yp}-weight-input`,lockHeader:`${yp}-lock-header`,lockGrid:`${yp}-lock-grid`,lockContainer:`${yp}-lock-container`,lockCheckbox:`${yp}-lock-checkbox`,lockTimer:`${yp}-lock-timer`,events:`${yp}-events`,eventsLabel:`${yp}-events-label`,eventsCheckbox:`${yp}-events-checkbox`});class Rp extends op{constructor(e,t,n,r,i=null){const o=!r.IsPlayer();super(e,t,n,r,Rp.screenParamsDefault,i),ap.add(this),cp.set(this,!1),this.settings=new aR(t),this.preview=CharacterLoadSimple("MBSFortuneWheelPreview");const a={Appearance:{label:"Body and clothes",groups:[]},Item:{label:"Items and restraints",groups:[]}};AssetGroup.filter(e=>e.AllowNone).sort((e,t)=>e.Category.localeCompare(t.Category)||e.Description.localeCompare(t.Description)).forEach(e=>{e.Category in a&&a[e.Category].groups.push(e)}),document.body.appendChild(E.jsxs("div",{id:bp.root,class:"mbs-screen",children:[E.jsx("style",{id:bp.styles,children:'#mbs-fwitemset {\n  --gap: min(2dvh, 1dvw);\n  --height: min(7dvh, 3.5dvw);\n  background: unset;\n  grid-template: "menubar menubar menubar menubar menubar menubar menubar" min(9dvh, 4.5dvw) ". . name-input name-input . . ." var(--height) ". . outfit-input outfit-input outfit-button outfit-button outfit-button" var(--height) ". . strip-header lock-header lock-header lock-header lock-header" var(--height) ". . strip-input lock-grid lock-grid lock-grid lock-grid" var(--height) ". . equip-header lock-grid lock-grid lock-grid lock-grid" var(--height) ". . equip-input lock-grid lock-grid lock-grid lock-grid" var(--height) ". . weight-header lock-grid lock-grid lock-grid lock-grid" var(--height) ". . weight-input lock-grid lock-grid lock-grid lock-grid" var(--height) ". . event-header event-header event-header event-header event-header" var(--height) ". . event-menu event-menu event-menu event-menu event-menu" min-content/min(9dvh, 4.5dvw) min(40dvh, 20dvw) auto min(38dvh, 19dvw) min(16dvh, 8dvw) min(9dvh, 4.5dvw) min(9dvh, 4.5dvw);\n  overflow-y: scroll;\n}\n#mbs-fwitemset .button-tooltip {\n  --tooltip-gap: var(--gap);\n}\n\n#mbs-fwitemset-menubar {\n  display: grid;\n  gap: var(--gap);\n  grid-area: menubar;\n  grid-template-columns: subgrid;\n  grid-template-rows: subgrid;\n  padding: 3px;\n}\n#mbs-fwitemset-menubar #mbs-fwitemset-delete {\n  grid-column: 1;\n}\n#mbs-fwitemset-menubar #mbs-fwitemset-header {\n  grid-column: 2/5;\n  margin-left: min(20dvh, 10dvw);\n}\n#mbs-fwitemset-menubar #mbs-fwitemset-accept {\n  grid-column: 5;\n  justify-self: end;\n}\n#mbs-fwitemset-menubar #mbs-fwitemset-cancel {\n  grid-column: 6;\n}\n#mbs-fwitemset-menubar #mbs-fwitemset-exit {\n  grid-column: 7;\n}\n#mbs-fwitemset-menubar .button {\n  height: min(9dvh, 4.5dvw);\n  width: min(9dvh, 4.5dvw);\n}\n\n#mbs-fwitemset-form {\n  background-color: unset;\n  display: grid;\n  grid-column: 1/8;\n  grid-row: 2/12;\n  grid-template-columns: subgrid;\n  grid-template-rows: subgrid;\n  height: calc(8.5 * (var(--height) + var(--gap)));\n  padding: 3px;\n}\n#mbs-fwitemset-form > label, #mbs-fwitemset-form > span {\n  place-self: end start;\n}\n\n#mbs-fwitemset-outfit-name {\n  grid-area: name-input;\n}\n\n#mbs-fwitemset-outfit-input {\n  grid-area: outfit-input;\n}\n\n#mbs-fwitemset-outfit-button {\n  grid-area: outfit-button;\n  grid-template-columns: auto;\n  grid-template-rows: var(--height) auto;\n}\n\n#mbs-fwitemset-strip-header {\n  grid-area: strip-header;\n}\n\n#mbs-fwitemset-strip-dropdown {\n  grid-area: strip-input;\n  width: min(40dvh, 20dvw);\n}\n\n#mbs-fwitemset-equip-header {\n  grid-area: equip-header;\n}\n\n#mbs-fwitemset-equip-dropdown {\n  grid-area: equip-input;\n  width: min(40dvh, 20dvw);\n}\n\n#mbs-fwitemset-weight-header {\n  grid-area: weight-header;\n}\n\n#mbs-fwitemset-weight-input {\n  align-self: start;\n  grid-area: weight-input;\n  height: 100%;\n  width: calc(var(--height) + 16px);\n}\n\n#mbs-fwitemset-lock-header {\n  grid-area: lock-header;\n}\n\n#mbs-fwitemset-lock-grid {\n  align-self: start;\n  display: grid;\n  gap: var(--gap);\n  grid-area: lock-grid;\n  grid-template-columns: 1fr 1fr;\n  margin: unset;\n  padding: unset;\n}\n\n.mbs-fwitemset-lock-container {\n  align-items: center;\n  display: grid;\n  word-wrap: break-word;\n  gap: var(--gap);\n  grid-template-columns: var(--height) auto;\n  list-style-type: none;\n  margin: unset;\n  padding: unset;\n}\n\n.mbs-timer {\n  height: 100%;\n  text-align: center;\n  width: 100%;\n}\n\n#mbs-fwitemset-strip-dropdown-content, #mbs-fwitemset-equip-dropdown-content {\n  width: min-content;\n}\n\n#mbs-fwitemset-events-label {\n  grid-area: event-header;\n}\n\n#mbs-fwitemset-events {\n  grid-area: event-menu;\n  list-style-type: none;\n  margin: unset;\n  padding: unset;\n}\n#mbs-fwitemset-events p {\n  margin-bottom: calc(var(--gap) / 2);\n  margin-top: calc(var(--gap) / 2);\n}\n#mbs-fwitemset-events .mbs-fwitemset-event-menu-placeholder {\n  justify-self: center;\n}\n#mbs-fwitemset-events .mbs-fwitemset-event-menu-placeholder > button {\n  height: var(--height);\n  width: var(--height);\n}\n#mbs-fwitemset-events * ~ .mbs-fwitemset-event-menu-placeholder {\n  display: none;\n}\n#mbs-fwitemset-events .mbs-fwitemset-event-multi-select {\n  background-color: unset;\n  display: grid;\n  gap: var(--gap);\n  grid-template: "all none" var(--height) "select select" auto/1fr 1fr;\n}\n#mbs-fwitemset-events .mbs-fwitemset-event-multi-select button[data-select-all] {\n  grid-area: all;\n}\n#mbs-fwitemset-events .mbs-fwitemset-event-multi-select button:not([data-select-all]) {\n  grid-area: none;\n}\n#mbs-fwitemset-events .mbs-fwitemset-event-multi-select select {\n  grid-area: select;\n}\n#mbs-fwitemset-events .mbs-fwitemset-event-collapse {\n  height: var(--height);\n  width: var(--height);\n}\n#mbs-fwitemset-events .mbs-fwitemset-event-menu {\n  display: block;\n  list-style-type: none;\n  margin: unset;\n  padding: unset;\n  padding-bottom: calc(var(--gap) / 2);\n  padding-top: calc(var(--gap) / 2);\n}\n#mbs-fwitemset-events .mbs-fwitemset-event-menu select {\n  min-height: var(--height);\n  width: 100%;\n}\n#mbs-fwitemset-events .mbs-fwitemset-event-menu input:invalid {\n  background-color: var(--mbs-background-color);\n  box-shadow: unset;\n}\n#mbs-fwitemset-events .mbs-fwitemset-event-menu input:disabled {\n  background-color: color-mix(in srgb, var(--mbs-button-color) 60%, black 40%);\n}\n#mbs-fwitemset-events .mbs-fwitemset-event-menu input[type=text], #mbs-fwitemset-events .mbs-fwitemset-event-menu input[type=number] {\n  border-color: black;\n  direction: ltr;\n  height: 1.15em;\n  width: 100%;\n}\n#mbs-fwitemset-events .mbs-fwitemset-event-kwargs {\n  align-items: center;\n  column-gap: var(--gap);\n  direction: rtl;\n  display: grid;\n  grid-auto-flow: column;\n  grid-template-columns: 3fr 1fr;\n  text-align: left;\n  width: 100%;\n}\n#mbs-fwitemset-events .mbs-fwitemset-event-kwargs:has(select) {\n  display: block;\n  text-align: center;\n}\n#mbs-fwitemset-events .mbs-fwitemset-event-kwargs > * {\n  direction: ltr;\n  margin-block: var(--gap);\n}\n#mbs-fwitemset-events .mbs-fwitemset-event-kwargs:last-of-type > :last-child {\n  margin-block: var(--gap) 0;\n}\n#mbs-fwitemset-events .mbs-fwitemset-event {\n  align-items: center;\n  display: grid;\n  gap: var(--gap);\n  grid-template-columns: min-content min-content auto 45%;\n  padding-right: calc(var(--gap) / 2);\n}\n#mbs-fwitemset-events .mbs-fwitemset-event:nth-child(odd) {\n  background-color: color-mix(in srgb, var(--mbs-background-color), black 15%);\n}\n#mbs-fwitemset-events .mbs-fwitemset-event:has(.mbs-fwitemset-event-collapse[aria-expanded=false]) > .mbs-fwitemset-event-menu > * {\n  display: none;\n}\n#mbs-fwitemset-events .mbs-fwitemset-event:has(.mbs-fwitemset-event-collapse[aria-expanded=false]) > .mbs-fwitemset-event-menu > .mbs-fwitemset-event-menu-placeholder {\n  display: block;\n}\n#mbs-fwitemset-events .mbs-fwitemset-event-checkbox:checked ~ .mbs-fwitemset-event-menu select:invalid:not(:disabled),\n#mbs-fwitemset-events .mbs-fwitemset-event-checkbox:checked ~ .mbs-fwitemset-event-menu input:invalid:not(:disabled) {\n  background-color: #fbb;\n  box-shadow: 0 0 3px 2px #c22;\n}'.toString()}),ElementMenu.Create("mbs-fwitemset-menubar",[E.jsx("h1",{id:bp.header,children:`Customize wheel of fortune item set ${this.index}`}),ElementButton.Create(bp.delete,()=>this.exit(!1,ip.DELETE),{image:"./Icons/Trash.png",tooltip:"Delete item set",tooltipPosition:"right",disabled:o},{button:{attributes:{"screen-generated":void 0}}}),ElementButton.Create(bp.accept,()=>this.exit(!1,ip.SAVE),{image:"./Icons/Accept.png",tooltip:"Save item set:\nMissing outfit",tooltipPosition:"left",disabled:o},{button:{attributes:{form:"mbs-fwitemset-form",type:"submit","screen-generated":void 0}}}),ElementButton.Create(bp.cancel,()=>this.exit(!1,ip.NONE),{image:"./Icons/Cancel.png",tooltip:"Cancel",tooltipPosition:"left"},{button:{attributes:{"screen-generated":void 0}}}),ElementButton.Create(bp.exit,()=>this.exit(!0,ip.NONE),{image:"./Icons/Exit.png",tooltip:"Exit",tooltipPosition:"left"},{button:{attributes:{"screen-generated":void 0}}})],{direction:"ltr"}),E.jsxs("div",{id:"mbs-fwitemset-form",role:"form",class:"scroll-box","aria-labelledby":bp.header,children:[E.jsx("input",{type:"text",id:bp.outfitName,placeholder:"Outfit name","aria-label":"Outfit name",disabled:o,maxLength:70,onInput:e=>{this.settings.name=e.target.value,L(this,ap,"m",lp).call(this,bp.accept)},onFocus:e=>e.target.select()}),E.jsx("input",{type:"text",id:bp.outfitInput,placeholder:"Outfit code","aria-label":"Outfit code",disabled:o,onInput:e=>{this.settings.outfitCache=e.target.value,L(this,ap,"m",lp).call(this,bp.outfitButton)},onFocus:e=>e.target.select()}),ElementButton.Create(bp.outfitButton,()=>L(this,ap,"m",lp).call(this,bp.accept,!0),{tooltip:"Parse the outfit code",label:"Parse",labelPosition:"center",disabled:!0,tooltipPosition:"bottom",tooltipRole:"label"},{label:{attributes:{"aria-hidden":"true"}}}),E.jsx("label",{id:bp.stripHeader,for:bp.stripSelect,children:"Clothing strip level:"}),E.jsx("label",{id:bp.equipHeader,for:bp.equipSelect,children:"Clothing equip level:"}),E.jsx("label",{id:bp.weightHeader,for:bp.weightInput,children:"Wheel option weight:"}),E.jsx("span",{id:bp.lockHeader,children:"Enabled lock types:"}),E.jsx("input",{type:"number",id:bp.weightInput,min:1,max:9,value:1,disabled:o,onInput:e=>{const t=e.target;this.settings.weight=$i(Number.parseInt(t.value,10),1,9)},onWheel:e=>{const t=e.target;if(!t.disabled){if(e.preventDefault(),e.deltaY<0)t.stepUp(1);else{if(!(e.deltaY>0))return;t.stepDown(1)}t.dispatchEvent(new InputEvent("input"))}},onFocus:e=>e.target.select()}),mp({id:bp.stripSelect,level:"stripLevel"},this.settings,o),mp({id:bp.equipSelect,level:"equipLevel"},this.settings,o),E.jsxs("menu",{id:bp.lockGrid,"aria-labelledby":bp.lockHeader,children:[" ",this.settings.flags.map((e,t)=>{let n,r;if("TimerPasswordPadlock"===e.type)n=function(e,t,n){return E.jsx("input",{type:"text",class:"mbs-timer",id:bp.lockTimer+t.toString(),disabled:n,value:gp(e.time),pattern:/([0]?[0-4]:)?([0-6]?[0-9]:)?([0-6]?[0-9])?/.source,maxLength:8,"aria-label":"Configure lock time",onInput:t=>{const n=t.target,[r,i]=[n.selectionStart,n.selectionEnd],o=n.value;if(n.value=o.replace(/[^0-9:]/g,""),n.value!==o&&(null!==r||null!==i)){const e=/[^0-9:]/g,t=Array.from(o).map((t,n)=>e.test(t)?n:-1).filter(e=>-1!==e);null!==r&&(n.selectionStart=t.reduce((e,t)=>e+(r>=t?-1:0),r)),null!==i&&(n.selectionEnd=t.reduce((e,t)=>e+(i>=t?-1:0),i))}const[a,s,l]=n.value.split(":").slice(-3).map(e=>Number.parseInt(e,10)||0),u=3600*a+60*s+l;e.time=$i(u,60,14400)},onBlur:t=>{const n=t.target;if(n.disabled)return;const[r,i,o]=n.value.split(":").slice(-3).map(e=>Number.parseInt(e,10)||0),a=3600*r+60*i+o;n.value=gp(a),e.time=$i(a,60,14400)},onFocus:e=>{const t=e.target,n=t.selectionStart;null!==n&&(n<=2?(t.selectionStart=0,t.selectionEnd=2):n<=5?(t.selectionStart=3,t.selectionEnd=5):n<=8&&(t.selectionStart=6,t.selectionEnd=8))},onWheel:t=>{const n=t.target;if(n.disabled)return void t.stopImmediatePropagation();t.preventDefault();const r=n.value.replace(/[^0-9:]/g,""),[i,o,a]=r.split(":").slice(-3).map(e=>Number.parseInt(e,10)||0);let s=3600*i+60*o+a;if(t.deltaY<0)s+=120;else{if(!(t.deltaY>0))return;s-=120}n.value=gp(s),e.time=$i(s,60,14400)}})}(e,t,o),r="Timer lock";else n=E.jsx("label",{for:bp.lockCheckbox+t.toString(),children:e.description});return E.jsxs("li",{class:bp.lockContainer,id:bp.lockContainer+t.toString(),children:[E.jsx("input",{type:"checkbox",class:`checkbox ${bp.lockCheckbox}`,id:bp.lockCheckbox+t.toString(),disabled:o,checked:e.enabled,onClick:()=>{e.enabled=!e.enabled,L(this,ap,"m",lp).call(this,bp.accept)},"aria-label":r}),n]})})," "]}),vp(this)]})]}))}reloadPreviewAppearance(){if(L(this,cp,"f"))return;if(T(this,cp,!0,"f"),this.preview.Appearance=[...this.character.Appearance],this.preview.OnlineSharedSettings=this.character.OnlineSharedSettings,null===this.settings.itemList)return T(this,cp,!1,"f"),void CharacterRefresh(this.preview,!1,!1);const e=this.settings.equipLevel;L(this,ap,"m",dp).call(this,this.settings.itemList,e)}async load(){await super.load();const e=this.mbsObject;null!==e?L(this,ap,"m",hp).call(this,e):L(this,ap,"m",fp).call(this),this.reloadPreviewAppearance()}draw(){DrawCharacter(this.preview,200,175,.78,!1)}exit(e,t){CharacterDelete(this.preview),super.exit(e,t)}}cp=new WeakMap,ap=new WeakSet,sp=function(){return this.settings.isValid(this.index)&&this.hasStorageSpace()},lp=function(e,t=!1){const n=document.getElementById(e),r=!this.character.IsPlayer();switch(e){case bp.accept:if(t){const e=this.settings.loadFromBase64();n.disabled=r||!(e&&L(this,ap,"m",sp).call(this)),e&&this.reloadPreviewAppearance()}else n.disabled=r||!(null!==this.settings.itemList&&L(this,ap,"m",sp).call(this));break;case bp.outfitButton:n.disabled=r||!this.settings.outfitCache;break;default:throw new Error(`Unsupported tooltip type: ${e}`)}L(this,ap,"m",up).call(this,n)},up=function(e){const t=e.querySelector("[role='tooltip']");if(t)switch(e.id){case bp.accept:{const e="Save item set";this.settings.loadFromBase64()?L(this,ap,"m",sp).call(this)?t.innerText=e:this.settings.name?this.settings.flags.every(e=>!e.enabled)?t.innerText=`${e}:\nMust enable at least one lock type`:this.hasStorageSpace()?t.innerText=`${e}:\nMax allowed OnlineSharedSettings storage size exceeded (${kb(this.dataSize.value)} / ${kb(this.dataSize.max)}`:t.innerText=`${e}:\nDuplicate name`:t.innerText=`${e}:\nMissing name`:t.innerText=`${e}:\nMissing outfit`;break}case bp.outfitButton:{const e="Parse outfit code";this.settings.outfitCache?t.innerText=e:t.innerText=`${e}:\nMissing code`;break}default:throw new Error(`Unsupported tooltip type: ${e.id}`)}},dp=async function(e,t){CharacterReleaseTotal(this.preview);const n=Hf(t,this.preview),r=this.preview.AssetFamily;Kf("MBSPreview",e.filter(({Name:e,Group:t})=>{const i=AssetGet(r,t,e);return null!=i&&("Appearance"!==i.Group.Category||n(i))}),this.settings.stripLevel,this.preview,this.settings.writeSettings(!0).activeHooks,null,Player),T(this,cp,!1,"f")},hp=function(e){const t=this.character.IsPlayer();this.settings.readSettings(e),this.settings.outfitCache=LZString.compressToBase64(JSON.stringify(ep(e.itemList,this.preview))),ElementValue(bp.outfitName,e.name),ElementValue(bp.weightInput,e.weight.toString()),ElementValue(bp.outfitInput,this.settings.outfitCache);for(const[e,t]of this.settings.flags.entries()){if(document.getElementById(`${bp.lockCheckbox}${e}`).checked=t.enabled,"TimerPasswordPadlock"===t.type)ElementValue(`${bp.lockTimer}${e}`,gp(t.time))}const n=document.getElementById(bp.equipSelect),r=document.getElementById(bp.stripSelect);n.value=this.settings.equipLevel.toString(),r.value=this.settings.stripLevel.toString(),L(this,ap,"m",lp).call(this,bp.accept),L(this,ap,"m",lp).call(this,bp.outfitButton);for(const e of document.querySelectorAll(".mbs-fwitemset-event")){const n=`${e.getAttribute("data-mod")??""}-${e.getAttribute("data-type")??""}-${e.getAttribute("data-name")??""}`,r=this.settings.activeHooks.get(n);mf(e,r?.kwargs??new Map,!t||null==r);const i=e.querySelector("input[type='checkbox'].mbs-fwitemset-event-checkbox");i&&(i.checked=null!=r,i.disabled=!t)}},fp=function(){const e=this.character.IsPlayer();this.settings.reset(),L(this,ap,"m",lp).call(this,bp.accept),L(this,ap,"m",lp).call(this,bp.outfitButton);const t=document.getElementById(bp.equipSelect),n=document.getElementById(bp.stripSelect);t.value=this.settings.equipLevel.toString(),n.value=this.settings.stripLevel.toString();const r=document.getElementById(bp.events);r?.querySelectorAll(".mbs-fwitemset-event-checkbox").forEach(e=>e.checked=!1),r&&(!function(e,t){e.querySelectorAll(".mbs-fwitemset-event-kwarg-config").forEach(e=>{gf(e),e.toggleAttribute("disabled",t)})}(r,!0),r.querySelectorAll("input[type='checkbox'].mbs-fwitemset-event-checkbox").forEach(t=>{const n=t;n.checked=!1,n.disabled=!e}))},Rp.ids=bp,Rp.screen="MBS_FWItemSetScreen",Rp.background="Sheet",Rp.screenParamsDefault={[yp]:Object.freeze({shape:[80,60,1840,880],visibility:"visible"})};const wp="mbs-fwcommand",Sp=Object.freeze({root:wp,styles:`${wp}-style`,delete:`${wp}-delete`,accept:`${wp}-accept`,cancel:`${wp}-cancel`,exit:`${wp}-exit`,header:`${wp}-header`,commandInput:`${wp}-command-input`,weightHeader:`${wp}-weight-header`,weightInput:`${wp}-weight-input`});class Bp extends op{constructor(e,t,n,r,i=null){super(e,t,n,r,Bp.screenParamsDefault,i),this.settings=new sR(t);const o=!r.IsPlayer();document.body.appendChild(E.jsxs("div",{id:Sp.root,class:"mbs-screen",children:[E.jsx("style",{id:Sp.styles,children:'#mbs-fwcommand {\n  grid-template: "delete header accept cancel exit" min(9dvh, 4.5dvw) "commandInput commandInput commandInput commandInput commandInput" min(7dvh, 3.5dvw) "weightHeader weightHeader weightHeader weightHeader weightHeader" min(7dvh, 3.5dvw) "weightInput weightInput weightInput weightInput weightInput" min(7dvh, 3.5dvw)/min(9dvh, 4.5dvw) auto min(9dvh, 4.5dvw) min(9dvh, 4.5dvw) min(9dvh, 4.5dvw);\n}\n#mbs-fwcommand .button-tooltip {\n  --tooltip-gap: min(2dvh, 1dvw);\n}\n\n#mbs-fwcommand-delete {\n  grid-area: delete;\n}\n\n#mbs-fwcommand-header {\n  grid-area: header;\n  margin-left: min(20dvh, 10dvw);\n}\n\n#mbs-fwcommand-accept {\n  grid-area: accept;\n}\n\n#mbs-fwcommand-cancel {\n  grid-area: cancel;\n}\n\n#mbs-fwcommand-exit {\n  grid-area: exit;\n}\n\n#mbs-fwcommand-command-input {\n  grid-area: commandInput;\n  height: min(7dvh, 3.5dvw);\n  place-self: self-end center;\n  width: 50%;\n}\n\n#mbs-fwcommand-weight-header {\n  align-self: self-end;\n  grid-area: weightHeader;\n}\n\n#mbs-fwcommand-weight-input {\n  grid-area: weightInput;\n  height: 100%;\n  place-self: start center;\n  width: calc(min(7dvh, 3.5dvw) + 16px);\n}'.toString()}),E.jsx("h1",{id:Sp.header,children:`Customize wheel of fortune command ${this.index}`}),ElementButton.Create(Sp.delete,()=>this.exit(!1,ip.DELETE),{image:"./Icons/Trash.png",tooltip:"Delete command",tooltipPosition:"right"}),ElementButton.Create(Sp.accept,()=>this.exit(!1,ip.SAVE),{image:"./Icons/Accept.png",tooltip:"Save command",tooltipPosition:"left"}),ElementButton.Create(Sp.cancel,()=>this.exit(!1,ip.NONE),{image:"./Icons/Cancel.png",tooltip:"Cancel",tooltipPosition:"left"}),ElementButton.Create(Sp.exit,()=>this.exit(!0,ip.NONE),{image:"./Icons/Exit.png",tooltip:"Exit",tooltipPosition:"left"}),E.jsx("input",{type:"text",id:Sp.commandInput,placeholder:"Role play command",disabled:o,maxLength:70,onInput:e=>{this.settings.name=e.target.value;const t=document.getElementById(Sp.accept);t?.toggleAttribute("disabled",0===this.settings.name.length)},onFocus:e=>e.target.select()}),E.jsx("div",{id:Sp.weightHeader,children:"Wheel option weight:"}),E.jsx("input",{type:"number",id:Sp.weightInput,min:1,max:9,value:1,disabled:o,onInput:e=>{const t=e.target;this.settings.weight=$i(Number.parseInt(t.value,10),1,9)},onWheel:e=>{const t=e.target;if(!t.disabled){if(e.deltaY<0)t.stepUp(1);else{if(!(e.deltaY>0))return;t.stepDown(1)}this.settings.weight=$i(Number.parseInt(t.value,10),1,9)}},onFocus:e=>e.target.select()})]}))}async load(){if(await super.load(),null!==this.mbsObject){this.settings.readSettings(this.mbsObject),ElementValue(Sp.commandInput,this.mbsObject.name),ElementValue(Sp.weightInput,this.mbsObject.weight.toString());const e=document.getElementById(Sp.accept);e?.toggleAttribute("disabled",this.character.IsPlayer())}else this.settings.reset()}}Bp.ids=Sp,Bp.screen="MBS_FWCommandScreen",Bp.background="Sheet",Bp.screenParamsDefault={[wp]:Object.freeze({shape:[80,60,1840,880],visibility:"visible"})};var kp,Cp;function _p(e,t,n){const r=Pb(e.OnlineSharedSettings?.MBS,"OnlineSharedSettings",!1);let i,o=void 0===r?void 0:r[t];if(Array.isArray(o)||(void 0!==o&&Ph.warn(`Failed to load "${e.AccountName}" wheel of fortune ${n}`),o=Array(Xb).fill(null)),e.IsPlayer())i=Player.MBSSettings[t];else{const e=[];i=_b("FortuneWheelItemSets"===t?cR.fromObject:dR.fromObject,o,e),e.forEach(e=>Ph.warn(e))}return i.forEach(e=>e?.register(!1)),i}function xp(e,t){return ElementButton.Create(`${Ep.button}${t}`,()=>{if(t<Xb){const n={[Rp.ids.root]:{shape:e.rootParams.shape}};return e.loadChild(Rp,e.wheelStruct.FortuneWheelItemSets,t,e.character,n)}{const n={[Bp.ids.root]:{shape:e.rootParams.shape}};return e.loadChild(Bp,e.wheelStruct.FortuneWheelCommands,t-Xb,e.character,n)}},{label:" "})}const Pp="mbs-fwselect",Ep=Object.freeze({root:Pp,styles:`${Pp}-style`,exit:`${Pp}-exit`,storage:`${Pp}-storage`,storageInner:`${Pp}-storage-cover`,storageTooltip:`${Pp}-storage-tooltip`,storageFooter:`${Pp}-storage-footer`,buttonOuterGrid:`${Pp}-button-grid-outer`,buttonInnerGrid0:`${Pp}-button-grid-inner0`,buttonInnerGrid1:`${Pp}-button-grid-inner1`,button:`${Pp}-button`,itemSets:`${Pp}-header0`,commandSets:`${Pp}-header1`});class Mp extends np{get wheelList(){return[...this.wheelStruct.FortuneWheelItemSets,...this.wheelStruct.FortuneWheelCommands]}constructor(e,t,n,r=null){super(e,Mp.screenParamsDefault,r),kp.add(this),this.wheelStruct=t,this.character=n,this.dataSize=Object.seal({value:0,valueRecord:{},max:Sb,marigin:.9});const i=this.character.IsPlayer();document.body.appendChild(E.jsxs("div",{id:Ep.root,class:"mbs-screen",children:[E.jsx("style",{id:Ep.styles,children:'#mbs-fwselect {\n  grid-template: ". buttonOuterGrid exit" min(9dvh, 4.5dvw) "storage buttonOuterGrid ." auto "storageFooter buttonOuterGrid ." min(14dvh, 7dvw)/min(30dvh, 15dvw) auto min(20dvh, 10dvw);\n}\n#mbs-fwselect .button-tooltip {\n  --tooltip-gap: min(2dvh, 1dvw);\n}\n\n#mbs-fwselect-exit {\n  grid-area: exit;\n  height: min(9dvh, 4.5dvw);\n  justify-self: end;\n  width: min(9dvh, 4.5dvw);\n}\n\n#mbs-fwselect-storage {\n  background-image: linear-gradient(180deg, #d80000, #d80000 10%, #00d800 60%, #00d800) !important;\n  border: min(0.3dvh, 0.15dvw) solid var(--mbs-border-color);\n  display: grid;\n  grid-area: storage;\n  height: 100%;\n  justify-self: center;\n  width: 35%;\n}\n#mbs-fwselect-storage #mbs-fwselect-storage-tooltip {\n  bottom: unset;\n  left: 15%;\n  position: absolute;\n  visibility: hidden;\n}\n#mbs-fwselect-storage:hover #mbs-fwselect-storage-tooltip {\n  visibility: visible;\n}\n\n#mbs-fwselect-storage-cover {\n  width: 100%;\n}\n\n#mbs-fwselect-storage-footer {\n  grid-area: storageFooter;\n  height: min(7dvh, 3.5dvw);\n  padding-top: min(1dvh, 0.5dvw);\n}\n\n#mbs-fwselect-button-grid-outer {\n  background-color: var(--mbs-background-color);\n  display: grid;\n  grid-area: buttonOuterGrid;\n  grid-template-rows: min(9dvh, 4.5dvw) auto min(9dvh, 4.5dvw) auto;\n  height: 94%;\n  overflow-y: scroll;\n  padding-left: min(2dvh, 1dvw);\n  padding-right: min(2dvh, 1dvw);\n}\n#mbs-fwselect-button-grid-outer .button {\n  height: min(7dvh, 3.5dvw);\n}\n\n#mbs-fwselect-button-grid-inner0, #mbs-fwselect-button-grid-inner1 {\n  display: grid;\n  grid-template-columns: minmax(0, 4fr) minmax(0, 4fr);\n  grid-gap: min(2dvh, 1dvw);\n  padding-bottom: min(2dvh, 1dvw);\n  padding-top: min(2dvh, 1dvw);\n}\n\n#mbs-fwselect-header0, #mbs-fwselect-header1 {\n  background-color: var(--mbs-background-color);\n  display: flex;\n  height: 100%;\n  justify-content: center;\n  position: sticky;\n  top: 0%;\n  z-index: 1;\n}'.toString()}),E.jsxs("div",{id:Ep.buttonOuterGrid,children:[E.jsx("h1",{id:Ep.itemSets,children:i?"Fortune wheel item sets":`${this.character.Nickname??this.character.Name}'s fortune wheel item sets`}),E.jsx("div",{id:Ep.buttonInnerGrid0,children:wc(0,Xb).map(e=>xp(this,e))}),E.jsx("h1",{id:Ep.commandSets,children:i?"Fortune wheel commands":`${this.character.Nickname??this.character.Name}'s fortune wheel commands`}),E.jsx("div",{id:Ep.buttonInnerGrid1,children:wc(Xb,2*Xb).map(e=>xp(this,e))})]}),ElementButton.Create(Ep.exit,()=>this.exit(),{image:"./Icons/Exit.png",tooltip:"Exit",tooltipPosition:"left"}),E.jsxs("div",{id:Ep.storage,children:[E.jsx("div",{id:Ep.storageInner,role:"meter"}),E.jsxs("div",{id:Ep.storageTooltip,class:"button-tooltip",role:"tooltip",children:[E.jsx("h2",{id:Ep.storageTooltip+"-header",children:"OnlineSharedSettings Data Usage"}),E.jsx("ul",{id:Ep.storageTooltip+"-list"})]})]}),E.jsx("div",{id:Ep.storageFooter})]}))}async load(){const e=Bb(this.character.OnlineSharedSettings);this.dataSize.value=Jc(Object.values(e),e=>Number.isNaN(e)?0:e),this.dataSize.valueRecord=e,L(this,kp,"m",Cp).call(this),super.load()}exit(){super.exit(),this.exitScreens(!1)}}kp=new WeakSet,Cp=function(){const e=this.character.IsPlayer();for(const[t,n]of this.wheelList.entries()){const r=document.getElementById(`${Ep.button}${t}`);r&&(r.querySelector(".button-label")?.replaceChildren(`${(t%Xb).toString().padStart(2)}: ${n?.name??"<Empty>"}`),r.disabled=null===n&&!e)}const t=document.getElementById(Ep.storage),n=document.getElementById(Ep.storageInner),r=document.getElementById(Ep.storageFooter);if(e){const e=$i(kb(this.dataSize.value),0,9999),i=100*e/(Sb/1e3);r.innerText=`${e} / ${Sb/1e3} KB`,n.style.height=100-i+"%",n.style.backgroundColor="var(--mbs-background-color)",n.style.borderBottom="min(0.3dvh, 0.15dvw) solid var(--mbs-border-color)",i>=90&&(t.style.boxShadow="0 0 min(2dvh, 1dvw) red");const o=/\W/g;let a=Object.entries(this.dataSize.valueRecord).map(([e,t])=>[e.replaceAll(o,""),Number.isNaN(t)?"Unknown":`${kb(t)} KB`]);a.length>=11&&(a=a.slice(0,10),a.push(["...",""]));const s=document.getElementById(Ep.storageTooltip+"-list");s.innerHTML="";for(const[e,t]of a)s.appendChild(E.jsxs("li",{children:[E.jsx("span",{style:{float:"left"},children:e}),E.jsx("span",{style:{float:"right",paddingLeft:"min(7dvh, 3.5dvw)"},children:t})]}))}else{const e=document.getElementById(Ep.storageTooltip);r.innerText=`- / ${Sb/1e3} KB`,n.style.height="100%",n.style.backgroundColor="gray",e.style.display="none"}},Mp.ids=Ep,Mp.screen="MBS_FWSelectScreen",Mp.background="Sheet",Mp.screenParamsDefault={[Pp]:Object.freeze({shape:[80,60,1840,880],visibility:"visible"})};var Ip,jp,Op,Ap,$p,Fp,Lp,Tp;let Dp;const Hp=Object.freeze({builtinBC:0,builtinMBS:1,customMBS:2});let Np,Gp,Wp,qp;Fh("preset_screen",{async afterLoad(){Dp=await TextCache.buildAsync("Screens/MiniGame/WheelFortune/Text_WheelFortune.csv")}});const zp="mbs-fwpreset",Kp=Object.freeze({root:zp,styles:`${zp}-style`,delete:`${zp}-delete`,accept:`${zp}-accept`,save:`${zp}-save`,exit:`${zp}-exit`,header:`${zp}-header`,midDiv:`${zp}-mid-div`,nameDiv:`${zp}-name-div`,nameHeader:`${zp}-name-header`,nameInput:`${zp}-name-input`,nameDropdown:`${zp}-name-dropdown`,builtinBC:`${zp}-builtin-bc`,builtinBCColor:`${zp}-builtin-bc-color`,builtinBCTooltip:`${zp}-builtin-bc-tooltip`,builtinBCTooltipHeader:`${zp}-builtin-bc-tooltip-header`,builtinBCTooltipList:`${zp}-builtin-bc-tooltip-list`,builtinBCDiv:`${zp}-builtin-bc-div`,builtinBCHeader:`${zp}-builtin-bc-header`,builtinMBS:`${zp}-builtin-mbs`,builtinMBSColor:`${zp}-builtin-mbs-color`,builtinMBSTooltip:`${zp}-builtin-mbs-button-tooltip`,builtinMBSTooltipHeader:`${zp}-builtin-mbs-button-tooltip-header`,builtinMBSTooltipList:`${zp}-builtin-mbs-button-tooltip-list`,builtinMBSDiv:`${zp}-builtin-mbs-div`,builtinMBSHeader:`${zp}-builtin-mbs-header`,customMBS:`${zp}-custom-mbs`,customMBSColor:`${zp}-custom-mbs-color`,customMBSTooltip:`${zp}-custom-mbs-button-tooltip`,customMBSTooltipHeader:`${zp}-custom-mbs-button-tooltip-header`,customMBSTooltipList:`${zp}-custom-mbs-button-tooltip-list`,customMBSDiv:`${zp}-custom-mbs-div`,customMBSHeader:`${zp}-custom-mbs-header`});class Up extends np{get index(){return L(this,jp,"f")}set index(e){Eh(e,"index",0,this.presets.length-1),L(this,jp,"f")!==e&&(T(this,jp,e,"f"),L(this,Ip,"m",Tp).call(this))}constructor(e,t,n=null){!function(){if(void 0!==Np)return;const e=/^([a-zA-Z0-9_\s]+) for ([0-9]+) (minutes|hours)$/,t=WheelFortuneOption.filter(e=>void 0===e.Custom),n=new Set,r={};for(const i of t){const t=Dp.get(`Option${i.ID}`),o=e.exec(t);if(!o){r[i.ID]={header:t,type:Hp.builtinBC},n.add(t);continue}const[a,s]=[o[1],o[3]];let l=Number.parseInt(o[2]);"hours"===s&&(l*=60),n.add(a),r[i.ID]={header:a,description:`${l} Minutes`,type:Hp.builtinBC}}Np=Array.from(n),Gp=Object.fromEntries(Object.entries(r).map(([e,t])=>[e,{...t,index:Np.indexOf(t.header)}]));const i=256;Wp=Object.fromEntries(Xp.flatMap((e,t)=>e.flags.map((n,r)=>[String.fromCharCode(i+16*t+r),{header:e.name,description:Lf(n),index:t,type:Hp.builtinMBS}]))),qp=Object.fromEntries(wc(512,1536).map((e,t)=>{const n=String.fromCharCode(e),r=Math.floor(t/i);let o;switch(r){case 0:case 2:o=(0===r?0:16)+Math.floor(t%i/16);break;case 1:case 3:o=(1===r?0:16)+Math.floor(t%i/16)+32;break;default:throw new RangeError(`Index ${t} lies out of the [0, 2**10) range`)}return[n,{header:"<Empty>",type:Hp.customMBS,index:o}]}))}(),super(e,Up.screenParamsDefault,n),Ip.add(this),this.activePreset={name:"<PLACEHOLDER>",ids:new Set},jp.set(this,0),this.presets=t,this.queueServer=new Set,this.idMapping={...oa(Gp),...oa(Wp),...oa(qp)};const r=this;document.body.appendChild(E.jsxs("div",{id:Kp.root,class:"mbs-screen",children:[E.jsx("style",{id:Kp.styles,children:'#mbs-fwpreset {\n  grid-template: "delete header accept save exit" min(9dvh, 4.5dvw) "mid mid mid mid mid" auto/min(9dvh, 4.5dvw) auto min(9dvh, 4.5dvw) min(9dvh, 4.5dvw) min(9dvh, 4.5dvw);\n}\n#mbs-fwpreset .button-tooltip {\n  --tooltip-gap: min(2dvh, 1dvw);\n}\n\n#mbs-fwpreset-delete {\n  grid-area: delete;\n}\n\n#mbs-fwpreset-header {\n  grid-area: header;\n  margin-left: min(20dvh, 10dvw);\n}\n\n#mbs-fwpreset-accept {\n  grid-area: accept;\n}\n\n#mbs-fwpreset-save {\n  grid-area: save;\n}\n\n#mbs-fwpreset-exit {\n  grid-area: exit;\n}\n\n#mbs-fwpreset-mid-div {\n  display: grid;\n  grid-area: mid;\n  text-align: center;\n  grid-gap: min(2dvh, 1dvw);\n  grid-template: "name-header builtin-bc-header builtin-mbs-header custom-mbs-header" min(9dvh, 4.5dvw) "name builtin-bc builtin-mbs custom-mbs" auto/auto min-content min-content min-content;\n  justify-items: center;\n  justify-self: center;\n  width: 100%;\n}\n#mbs-fwpreset-mid-div > p {\n  text-wrap: nowrap;\n}\n\n#mbs-fwpreset-name-header {\n  grid-area: name-header;\n}\n\n#mbs-fwpreset-builtin-bc-header {\n  grid-area: builtin-bc-header;\n}\n\n#mbs-fwpreset-builtin-mbs-header {\n  grid-area: builtin-mbs-header;\n}\n\n#mbs-fwpreset-custom-mbs-header {\n  grid-area: custom-mbs-header;\n}\n\n.mbs-fwpreset-grid {\n  display: grid;\n  grid-gap: min(1.2dvh, 0.6dvw);\n  grid-auto-flow: column;\n  grid-template-rows: repeat(8, min(7dvh, 3.5dvw));\n  width: fit-content;\n}\n\n#mbs-fwpreset-name-div {\n  grid-area: name;\n}\n\n#mbs-fwpreset-name-input {\n  height: min(7dvh, 3.5dvw);\n  width: min(35dvh, 17.5dvw);\n}\n\n#mbs-fwpreset-name-dropdown {\n  height: min(7dvh, 3.5dvw);\n  margin-top: min(2dvh, 1dvw);\n  width: min(36dvh, 18dvw);\n}\n\n#mbs-fwpreset-builtin-bc-div {\n  grid-area: builtin-bc;\n  grid-template-columns: repeat(4, min(7dvh, 3.5dvw));\n}\n\n#mbs-fwpreset-builtin-mbs-div {\n  grid-area: builtin-mbs;\n  grid-template-columns: min(7dvh, 3.5dvw);\n}\n\n#mbs-fwpreset-custom-mbs-div {\n  grid-area: custom-mbs;\n  grid-template-columns: repeat(8, min(7dvh, 3.5dvw));\n}\n\n.mbs-fwpreset {\n  border: min(0.2dvh, 0.1dvw) solid black;\n}\n.mbs-fwpreset::before {\n  content: "";\n  height: 90%;\n  left: 5%;\n  position: absolute;\n  top: 5%;\n  width: 90%;\n}\n.mbs-fwpreset[data-color=red]::before {\n  background-color: red;\n}\n.mbs-fwpreset[data-color=green]::before {\n  background-color: green;\n}'.toString()}),E.jsxs("h1",{id:Kp.header,children:["Wheel of Fortune preset ",this.index]}),ElementButton.Create(Kp.delete,()=>this.deletePreset(),{disabled:!0,image:"./Icons/Trash.png",tooltip:"Delete the current preset",tooltipPosition:"right"}),ElementButton.Create(Kp.accept,()=>this.equipPreset(),{disabled:!0,image:"./Icons/Accept.png",tooltip:"Equip the current preset",tooltipPosition:"left"}),ElementButton.Create(Kp.save,()=>this.savePreset(),{image:"./Icons/Save.png",tooltip:"Save the current preset",tooltipPosition:"left"}),ElementButton.Create(Kp.exit,()=>this.exit(!1),{image:"./Icons/Exit.png",tooltip:"Exit",tooltipPosition:"left"}),E.jsxs("div",{id:Kp.midDiv,children:[E.jsx("p",{id:Kp.nameHeader,children:"Preset Name"}),E.jsx("p",{id:Kp.builtinBCHeader,children:"Builtin BC Options"}),E.jsx("p",{id:Kp.builtinMBSHeader,children:"Builtin MBS Options"}),E.jsx("p",{id:Kp.customMBSHeader,children:"Custom MBS Options"}),E.jsxs("div",{id:Kp.nameDiv,children:[E.jsx("input",{type:"text",id:Kp.nameInput,maxLength:20,onFocus:e=>e.target.select(),onInput:e=>this.activePreset.name=e.target.value}),ElementCreateDropdown(Kp.nameDropdown,Object.values(this.presets).map((e,t)=>({attributes:{value:t,label:`${t}: ${e?.name??"<Empty>"}`}})),function(){r.index=this.selectedIndex})]}),E.jsx("div",{id:Kp.builtinBCDiv,class:"mbs-fwpreset-grid",children:L(this,Ip,"m",$p).call(this,Hp.builtinBC)}),E.jsx("div",{id:Kp.builtinMBSDiv,class:"mbs-fwpreset-grid",children:L(this,Ip,"m",$p).call(this,Hp.builtinMBS)}),E.jsx("div",{id:Kp.customMBSDiv,class:"mbs-fwpreset-grid",children:L(this,Ip,"m",$p).call(this,Hp.customMBS)})]})]}))}savePreset(){const e=this.presets[this.index],t={name:this.activePreset.name,ids:nR(Array.from(this.activePreset.ids).sort().join(""))};t.name===e?.name&&t.ids===e?.ids||(this.presets[this.index]=t,this.queueServer.add(Cb.SETTINGS),L(this,Ip,"m",Lp).call(this))}equipPreset(){const e=nR(Array.from(this.activePreset.ids).sort().join(""));Player.OnlineSharedSettings&&Player.OnlineSharedSettings.WheelFortune!==e&&(Player.OnlineSharedSettings.WheelFortune=e,this.queueServer.add(Cb.SHARED))}deletePreset(){null!==this.presets[this.index]&&(this.queueServer.add(Cb.SETTINGS),this.presets[this.index]=null,L(this,Ip,"m",Tp).call(this))}async load(){await super.load(),L(this,Ip,"m",Op).call(this),L(this,Ip,"m",Tp).call(this)}exit(e=!0){super.exit(),this.queueServer.size&&Ib(Array.from(this.queueServer),!0),this.exitScreens(e)}}function Vp(e){if(null===e||"object"!=typeof e)throw new TypeError('Invalid "character" type: '+typeof e);if(!e.IsSimple()&&!e.IsPlayer())throw new Error("Expected a simple or player character");if(tR(e)){!function(e,t,n){if(!Sh(e))throw new TypeError('Invalid "groupNames" type: '+typeof e);if("string"!=typeof n)throw new TypeError('Invalid "color" type: '+typeof e);for(const r of e){const e=InventoryGet(t,r);null!=e&&(e.Color=Array(e.Asset.ColorableLayerCount).fill(n))}}(["HairAccessory1","HairAccessory2","HairAccessory3","HairBack","HairFront","BodyUpper","BodyLower","Wings","TailStraps","Nipples","Blush","Mouth"],e,"#484747")}}jp=new WeakMap,Ip=new WeakSet,Op=function(){const e=[...Player.MBSSettings.FortuneWheelItemSets,...Player.MBSSettings.FortuneWheelCommands];for(const[t,n]of e.entries()){let e=512;if(e+=t<32?t>=16?16*(16+t):16*t:t>=48?16*t:16*(16+t),n instanceof cR)for(const[t,r]of n.flags.entries()){const i=String.fromCharCode(e+t);this.idMapping[i].description=Lf(r),this.idMapping[i].header=n.name}else if(n instanceof dR){const t=String.fromCharCode(e);this.idMapping[t].header=n.name,delete this.idMapping[t].description}else for(const t of wc(16)){const n=String.fromCharCode(e+t);this.idMapping[n].header="<Empty>",delete this.idMapping[n].description}}},Ap=function(e,t,n,r){const i=e.toString();return ElementButton.Create(`${r.root}${i}`,function(){this.focus()},{noStyling:!0,tooltipPosition:n,tooltip:[E.jsx("h2",{id:r.tooltipHeader+i,"data-prefix":t??""}),E.jsx("ul",{id:r.tooltipList+i})]},{button:{classList:["mbs-fwpreset"],dataAttributes:{color:"red"}}})},$p=function(e){let t,n,r;const i=L(this,Ip,"m",Fp).call(this,e);switch(e){case Hp.builtinBC:t=Np,n="right";break;case Hp.builtinMBS:t=Xp,n="bottom";break;case Hp.customMBS:t=[...Player.MBSSettings.FortuneWheelItemSets,...Player.MBSSettings.FortuneWheelCommands],n="left",r=(e,t)=>t>=Xb?`Command Set ${t-32}: `:`Item Set ${t}: `;break;default:throw new Error(`Unknown type: ${e}`)}return t.map((e,t)=>L(this,Ip,"m",Ap).call(this,t,r?.(e,t),n,i))},Fp=function(e){switch(e){case Hp.builtinBC:return{root:Kp.builtinBC,color:Kp.builtinBCColor,tooltip:Kp.builtinBCTooltip,tooltipHeader:Kp.builtinBCTooltipHeader,tooltipList:Kp.builtinBCTooltipList};case Hp.builtinMBS:return{root:Kp.builtinMBS,color:Kp.builtinMBSColor,tooltip:Kp.builtinMBSTooltip,tooltipHeader:Kp.builtinMBSTooltipHeader,tooltipList:Kp.builtinMBSTooltipList};case Hp.customMBS:return{root:Kp.customMBS,color:Kp.customMBSColor,tooltip:Kp.customMBSTooltip,tooltipHeader:Kp.customMBSTooltipHeader,tooltipList:Kp.customMBSTooltipList};default:throw new Error(`Unknown type: ${e}`)}},Lp=function(){const e=this.presets[L(this,jp,"f")],t=document.getElementById(Kp.nameInput),n=document.getElementById(Kp.nameDropdown);t.placeholder=`Preset ${this.index}`,n.selectedIndex=L(this,jp,"f");const r=document.getElementById(Kp.delete),i=r?.querySelector(".button-tooltip"),o=document.getElementById(Kp.accept),a=o?.querySelector(".button-tooltip"),s=document.getElementById(Kp.header);null===e?(t.value="",r.disabled=!0,o.disabled=!0,i?.replaceChildren("Delete the current preset:",E.jsx("br",{}),"unsaved preset"),a?.replaceChildren("Equip the current preset:",E.jsx("br",{}),"unsaved preset"),s.innerText=`Wheel of Fortune preset ${this.index} (unsaved)`):(t.value=e.name,r.disabled=!1,o.disabled=!1,i?.replaceChildren("Delete the current preset"),a?.replaceChildren("Equip the current preset"),s.innerText=`Wheel of Fortune preset ${this.index}`)},Tp=function(){const e=this.presets[L(this,jp,"f")];this.activePreset=null!==e?{name:e.name,ids:new Set(e.ids)}:{name:"<Empty>",ids:new Set(Player.OnlineSharedSettings?.WheelFortune??WheelFortuneDefault)},L(this,Ip,"m",Lp).call(this);const t={[Hp.builtinBC]:{},[Hp.builtinMBS]:{},[Hp.customMBS]:{}};for(const[e,{type:n,index:r,description:i,header:o}]of Object.entries(this.idMapping)){const a=this.activePreset.ids.has(e),s=t[n][r]??={header:o,enabled:a,description:[]};s.enabled||=a,i&&a&&s.description.push(i)}for(const e of Object.values(Hp)){const n=L(this,Ip,"m",Fp).call(this,e);for(const[r,i]of Object.entries(t[e])){document.getElementById(`${n.root}${r}`).dataset.color=i.enabled?"green":"red";const e=document.getElementById(`${n.tooltipHeader}${r}`);e.innerText=(e.dataset.prefix??"")+i.header;const t=document.getElementById(`${n.tooltipList}${r}`);t.innerHTML="";for(const e of i.description)t.appendChild(E.jsx("li",{children:e}))}}},Up.background="Sheet",Up.screen="MBS_WheelPresetScreen",Up.ids=Kp,Up.screenParamsDefault={[zp]:Object.freeze({shape:[80,60,1840,880],visibility:"visible"})};const Jp={Suit:{ReverseBunnySuit:[0,1]},SuitLower:{Catsuit:[0,1]},Mask:{FaceVeil:[1]},ItemHands:{FuturisticMittens:[0,1]},ItemHead:{InteractiveVRHeadset:[0]},ItemMouth2:{DuctTape:[0]},ItemMouth3:{FuturisticMuzzle:[3],DuctTape:[0]},ItemPelvis:{SciFiPleasurePanties:[0,2,4,5]},ItemNeck:{BonedNeckCorset:[2,3]},ItemNeckRestraints:{CollarChainShort:[0]},ItemTorso2:{FuturisticHarness:[0,1,2]},ItemEars:{FuturisticEarphones:[1]},ItemAddon:{CeilingChain:[0]},ItemNipplesPiercings:{RoundPiercing:[1,2]},ItemLegs:{FrogtieStraps:[2],DuctTape:[0]},ItemHood:{DroneMask:[2]},ItemFeet:{DuctTape:[0]},ItemArms:{DuctTape:[0]}};let Yp,Xp,Zp,Qp,eg;Bf.addEventListener("beforeOutfitEquip",zh,{listener:e=>Vp(e.character),hookName:"statueSetBodyColor",label:"Color the entire body gray (statue color) before equipping any wheel items.",conditional:!0,showConfig:!1});class tg extends rp{constructor(){super(null,"WheelFortune","MiniGame",{Run:WheelFortuneRun,Click:WheelFortuneClick,Exit:WheelFortuneExit,Load:async()=>CommonSetScreen("MiniGame","WheelFortune")}),this.character=Player,this.FortuneWheelItemSets=Array(Xb).fill(null),this.FortuneWheelCommands=Array(Xb).fill(null),this.weightedIDs=this.character.OnlineSharedSettings?.WheelFortune??WheelFortuneDefault}initialize(){if(null==WheelFortuneCharacter)throw new Error("Cannot load the fortune wheel UI while `WheelFortuneCharacter == null`");WheelFortuneOption=[...Zp],WheelFortuneDefault=Qp,this.character=WheelFortuneCharacter,this.FortuneWheelItemSets=_p(WheelFortuneCharacter,"FortuneWheelItemSets","item sets"),this.FortuneWheelCommands=_p(WheelFortuneCharacter,"FortuneWheelCommands","commands"),this.weightedIDs=function(e){const t=Array.from(e).flatMap(e=>{const t=WheelFortuneOption.find(t=>t.ID===e);return void 0===t?[]:Array(t.Weight??1).fill(e)});if(0===t.length)return"";const n=[];for(;n.length<50;)n.push(...Dc(t,Math.random));return n.join("")}(this.character.OnlineSharedSettings?.WheelFortune??WheelFortuneDefault)}}function ng(){if(eg.initialize(),null!=TextScreenCache)for(const{Description:e,Custom:t,ID:n}of WheelFortuneOption)void 0!==e&&(TextScreenCache.cache[`Option${n}`]=t?`*${e}`:e)}function rg(){if(null!=TextScreenCache)for(const{Description:e,Custom:t,ID:n}of WheelFortuneOption)void 0!==e&&(TextScreenCache.cache[`Option${n}`]=t?`*${e}`:e)}tg.screen="WheelFortune",Fh("fortune_wheel",{async afterLoad(){const e={exit:[1830,60,90,90],roll:[1720,60,90,90],select:[1610,60,90,90],preset:[1500,60,90,90]};if(Ph.log("Initializing wheel of fortune hooks"),function(){const e=String.fromCharCode(256),t=WheelFortuneOption.find(t=>void 0===t.Custom&&t.ID>=e);return void 0===t||(Ph.warn("Aborting wheel of fortune hook initialization: Found one or more builtin wheel of fortune option-IDs outside of the extended ASCII range",t),!1)}())switch(Kh.patchFunction("WheelFortuneRun",{'DrawTextWrap(TextGet(textTag), 1375, 200, 550, 200, "White")':";",'DrawButton(1720, 60, 90, 90, "", (WheelFortuneVelocity == 0 && !isInvalidWheel) ? "White" : "Silver", "Icons/Random.png", TextGet("Random"), isInvalidWheel);':";"}),Kh.hookFunction("WheelFortuneLoad",11,(e,t)=>(ng(),t(e))),Kh.hookFunction("WheelFortuneCustomizeLoad",0,(e,t)=>(rg(),t(e))),Kh.hookFunction("WheelFortuneRun",0,(t,n)=>{const r=Player.MBSSettings.RollWhenRestrained||!Player.IsRestrained();r||(WheelFortuneForced=!1),n(t);const i=0===WheelFortuneVelocity,o=i?"White":"Silver",a=WheelFortuneCharacter?.Nickname??WheelFortuneCharacter?.Name,s=WheelFortuneCharacter?.IsPlayer()?"MBS: Configure custom options":`MBS: View ${a}'s option config`;DrawButton(...e.select,"",o,"Icons/Crafting.png",s,!i);const l=!(0!==WheelFortuneVelocity||!WheelFortuneCharacter?.IsPlayer()),u=l?"White":"Silver",c=WheelFortuneCharacter?.Nickname??WheelFortuneCharacter?.Name,d=WheelFortuneCharacter?.IsPlayer()?"MBS: Configure option presets":`MBS: View ${c}'s option presets`;DrawButton(...e.preset,"",u,"Icons/Crafting.png",d,!l);const h=0==WheelFortuneVelocity&&r&&WheelFortuneList.length>0?"White":"Silver";DrawButton(...e.roll,"",h,"Icons/Random.png",r?TextGet("Random"):"MBS: Cannot spin while restrained",!r);let f="";f=0===WheelFortuneList.length?TextGet("Invalid"):0!==WheelFortuneVelocity?TextGet("Wait"):r?WheelFortuneForced?TextGet("Forced"):TextGet("Title"):"MBS: Cannot spin the wheel of fortune while restrained",DrawTextWrap(f,1375,200,550,200,"White")}),Kh.hookFunction("WheelFortuneClick",0,(t,n)=>{if(Player.MBSSettings.RollWhenRestrained||!Player.IsRestrained()||(WheelFortuneForced=!1,!MouseIn(...e.roll))){if(0===WheelFortuneVelocity&&MouseIn(...e.select)){const e={FortuneWheelItemSets:eg.FortuneWheelItemSets,FortuneWheelCommands:eg.FortuneWheelCommands};eg.loadChild(Mp,e,eg.character)}else 0===WheelFortuneVelocity&&MouseIn(...e.preset)&&WheelFortuneCharacter?.IsPlayer()&&eg.loadChild(Up,WheelFortuneCharacter.MBSSettings.FortuneWheelPresets);return n(t)}}),Kh.hookFunction("WheelFortuneMouseUp",11,(e,t)=>{!Player.MBSSettings.RollWhenRestrained&&Player.IsRestrained()||t(e)}),Kh.hookFunction("WheelFortuneMouseDown",11,(e,t)=>{!Player.MBSSettings.RollWhenRestrained&&Player.IsRestrained()||t(e)}),Kh.hookFunction("WheelFortuneDrawWheel",11,([e,...t],n)=>n([eg.weightedIDs,...t])),eg=new tg,Bf.addEventListener("color",zh,{listener:({character:e,newAsset:t},n)=>{const r="select"===n.sourceGroup?.type&&n.sourceGroup.value,i=r?InventoryGet(e,r):null;if(!i)return;let o;if(o="string"==typeof i.Color?i.Color:Sh(i.Color)&&"string"==typeof i.Color[0]?i.Color[0]:i.Asset.DefaultColor[0],!o)return;const a=Jp[t.Group.Name]?.[t.Name];if(a){const e=Array(t.ColorableLayerCount).fill(void 0);return a.slice(0,t.ColorableLayerCount).forEach(t=>e[t]=o),e}return Array(t.ColorableLayerCount).fill(o)},hookName:"copyItemColor",label:"Copy the color from one item and apply it to others.",conditional:!0,kwargs:{sourceGroup:{type:"select",label:"The item group from which the color will be copied",required:!0,options:wf(e=>"HairFront"===e.Name,e=>e.AllowColorize).options},targetGroups:{...wf(e=>e.IsRestraint,e=>e.AllowNone&&e.AllowColorize),label:"The item group(s) to which the color will be copied"}}}),Bf.addEventListener("typeRecord",zh,{listener:({newAsset:e})=>{switch(e.Archetype){case ExtendedArchetype.TYPED:case ExtendedArchetype.VIBRATING:{const t=ExtendedItemGetData(e,e.Archetype),n=(t?.options??[]).map(e=>e.Property.TypeRecord);return Ic(n)}case ExtendedArchetype.MODULAR:{const t=ExtendedItemGetData(e,e.Archetype);let n;for(const e of t?.modules??[]){const t=e.Options.map(e=>e.Property.TypeRecord),r=Ic(t);r&&(n=Object.assign(n??{},r))}return n}default:return null}},hookName:"randomizeType",label:"Randomize the (extended item) type of specified items.",conditional:!0,kwargs:{targetGroups:wf("none",e=>e.AllowNone)}}),CurrentScreen){case"WheelFortune":return ng();case"WheelFortuneCustomize":return rg()}},async afterMBS(){Ph.log("Initializing wheel of fortune module"),Yp=function(){const e=Ch(kh({leash_candy:[{Name:"ReverseBunnySuit",Group:"Suit"},{Name:"Catsuit",Group:"SuitLower"},{Name:"FaceVeil",Group:"Mask",Color:["#000","Default"]},{Name:"FuturisticMittens",Group:"ItemHands",TypeRecord:{typed:0},Craft:{Property:"Secure",Name:"Permanent PSO Mittens"}},{Name:"InteractiveVRHeadset",Group:"ItemHead",TypeRecord:{b:3,f:3,g:1},Craft:{Property:"Secure",Name:"Permanent PSO Headset"}},{Name:"LargeDildo",Group:"ItemMouth",Craft:{Property:"Secure",Name:"Permanent PSO Dildo",Description:"Specially made to fill a PSOs mouth and throat"}},{Name:"LatexBallMuzzleGag",Group:"ItemMouth2",Craft:{Property:"Secure",Name:"Permanent PSO Muzzle",Description:"Forcing the dildo in and keeping it secure"}},{Name:"FuturisticMuzzle",Group:"ItemMouth3",TypeRecord:{n:1,h:0,s:3},Craft:{Property:"Secure",Name:"Permanent PSO Muzzle",Description:"Keeping your cries muffled"}},{Name:"FuturisticVibrator",Group:"ItemVulva",TypeRecord:{vibrating:9},Craft:{Property:"Secure",Name:"Permanent PSO Vibe",Description:"Specially made to fill a PSO"}},{Name:"SciFiPleasurePanties",Group:"ItemPelvis",TypeRecord:{c:3,i:4,o:1,s:2},Craft:{Property:"Secure",Name:"Permanent PSO Panties",Description:"No escape and no Orgasms"}},{Name:"BonedNeckCorset",Group:"ItemNeck",Color:["#222222","#888888","#AA2121","#AA2121","#888888"],TypeRecord:{typed:1},Craft:{Property:"Secure",Name:"Permanent PSO Collar"}},{Name:"CollarChainShort",Group:"ItemNeckRestraints",Craft:{Property:"Secure",Name:"Permanent PSO Chain",Description:"To keep a PSO on their knees"},Property:{OverridePriority:7}},{Name:"StrictLeatherPetCrawler",Group:"ItemArms",Craft:{Property:"Secure",Name:"Permanent PSO Suit",Description:"Extra tight and unremovable"}},{Name:"HeavyLatexCorset",Group:"ItemTorso",TypeRecord:{typed:0},Craft:{Property:"Secure",Name:"Permanent PSO Corset",Description:"Extra tight and specially molded"}},{Name:"FuturisticHarness",Group:"ItemTorso2",TypeRecord:{typed:0},Craft:{Property:"Secure",Name:"Permanent PSO Harness",Description:"Special harness that constantly shrinks...."},Property:{OverridePriority:23}},{Name:"FuturisticEarphones",Group:"ItemEars",TypeRecord:{typed:0},Craft:{Property:"Secure",Name:"Permanent PSO Earphones"},Color:["#0F0F0F","Default","Default"]},{Name:"CeilingChain",Group:"ItemAddon",TypeRecord:{typed:0},Craft:{Property:"Secure",Name:"Permanent PSO Chain",Description:"Never to escape"}},{Name:"RoundPiercing",Group:"ItemNipplesPiercings",TypeRecord:{typed:1},Craft:{Property:"Secure",Name:"Permanent PSO Piercings"},Color:["#000000","Default","Default"]},{Name:"CollarAutoShockUnit",Group:"ItemNeckAccessories",TypeRecord:{s:2,y:0},Craft:{Property:"Secure",Name:"Permanent PSO Shock Unit"}},{Name:"FrogtieStraps",Group:"ItemLegs",Craft:{Property:"Secure",Name:"Permanent PSO Straps",Description:"To keep a PSO on their knees"}},{Name:"DroneMask",Group:"ItemHood",TypeRecord:{m:0,e:0,p:1,g:0,s:1,h:2,j:0},Craft:{Property:"Thin",Name:"Permanent PSO Mask"}}],mummy:[{Name:"DuctTape",Group:"ItemFeet",TypeRecord:{typed:0},Craft:{Property:"Secure",Name:"Mummy Wrappings",Description:"A bundle of resilient cloth wrappings"}},{Name:"DuctTape",Group:"ItemLegs",TypeRecord:{typed:0},Craft:{Property:"Secure",Name:"Mummy Wrappings",Description:"A bundle of resilient cloth wrappings"}},{Name:"DuctTape",Group:"ItemHands",TypeRecord:{typed:0},Craft:{Property:"Secure",Name:"Mummy Wrappings",Description:"A bundle of resilient cloth wrappings"}},{Name:"DuctTape",Group:"ItemArms",TypeRecord:{typed:0},Craft:{Property:"Secure",Name:"Mummy Wrappings",Description:"A bundle of resilient cloth wrappings"}},{Name:"LargeDildo",Group:"ItemMouth",Craft:{Property:"Large",Name:"Rubber Mouth Sealant",Description:"A rubber mass molded to shape of your mouth"}},{Name:"DuctTape",Group:"ItemMouth2",TypeRecord:{typed:0},Craft:{Property:"Large",Name:"Mummy Wrappings",Description:"A bundle of resilient cloth wrappings"}},{Name:"DuctTape",Group:"ItemMouth3",TypeRecord:{typed:0},Craft:{Property:"Large",Name:"Mummy Wrappings",Description:"A bundle of resilient cloth wrappings"},Equip:()=>Math.random()>.5}],maid:[{Name:"LaceBands",Group:"Bracelet",Color:["#aaaaaa","#151515"]},{Name:"MaidOutfit2",Group:"Cloth",Color:["#0C0C0C","#919194","#9C9C9F"]},{Name:"CatsuitCollar",Group:"ClothAccessory",Color:["#0E0E0E"]},{Name:"MaidHairband1",Group:"Hat",Color:["#979797"]},{Name:"Socks6",Group:"Socks",Color:["#0D0D0D","#919194"]},{Name:"HeartTop",Group:"Bra",Color:["#0E0E0E"]},{Name:"FuturisticHeels2",Group:"Shoes",Color:["#101010","Default","#F1FAFF","#898989","#898989"],TypeRecord:{typed:1}},{Name:"MaidCollar",Group:"ItemNeck",Color:["#DCDCDC","#1B1B1B","Default"],Craft:{Property:"Secure",Name:"Maid Collar",Description:"A tight fitting yet comfortable collar"}},{Name:"FuturisticMittens",Group:"ItemHands",Color:["#FFFFFF","#FFFFFF","#2E2E2E","#050505"],TypeRecord:{typed:0},Craft:{Property:"Secure",Name:"Maid Mittens",Description:"For keeping a maid out of trouble"}},{Name:"FuturisticHeels2",Group:"ItemBoots",Color:["#101010","#101010","Default","#F1FAFF","#898989","#898989","#898989"],TypeRecord:{typed:1},Craft:{Property:"Secure",Name:"Maid Heels",Description:"For keeping a maid on their toes"}},{Name:"WiredEgg",Group:"ItemVulva",Color:["Default","#141414"],TypeRecord:{vibrating:1},Craft:{Property:"Arousing",Name:"Maid Teaser",Description:"A little reminder to keep a maid on edge"},Property:{OverridePriority:21}},{Name:"StraitLeotard",Group:"ItemArms",Color:["#FFFFFF","#1A1A1A","#FFFFFF"],TypeRecord:{cl:1,co:1,np:0,vp:0},Craft:{Property:"Secure",Name:"Maid Jacket",Description:"For keeping a maid out of trouble"}},{Name:"LeatherAnkleCuffs",Group:"ItemFeet",Color:["#969696","#191919","#969696"],TypeRecord:{typed:0},Craft:{Property:"Secure",Name:"Maid Cuffs",Description:"For keeping a maid out of trouble"}},{Name:"BallGag",Group:"ItemMouth",TypeRecord:{typed:2},Craft:{Property:"Large",Name:"Maid Silencer",Description:"Silence is golden"}}],statue:[{Name:"ReverseBunnySuit",Group:"SuitLower",Color:["#1B1B1B"],Equip:e=>tR(e)},{Name:"SeamlessCatsuit",Group:"SuitLower",Color:["#484747"],Equip:e=>!tR(e)},{Name:"SeamlessCatsuit",Group:"Suit",Color:["#484747"],Equip:e=>!tR(e)},{Name:"ReverseBunnySuit",Group:"Cloth",Color:["#1B1B1B","#1B1B1B"]},{Name:"BondageSkirt",Group:"ClothLower",Color:["#484747","#333333","#333333"]},{Name:"CatsuitCollar",Group:"ClothAccessory",Color:["#484747"]},{Name:"HighCollar",Group:"ItemNeck",Color:["#363636","#717171"],Craft:{Property:"Secure",Name:"Statue Neck"}},{Name:"LargeDildo",Group:"ItemMouth",Color:["#333333"],Craft:{Property:"Large",Name:"Mouth Sealant"},Property:{OverridePriority:27}},{Name:"LatexPostureCollar",Group:"ItemMouth2",Color:["Default"],Craft:{Property:"Large",Name:"Mouth Sealant"},Property:{OverridePriority:28}},{Name:"LatexBallMuzzleGag",Group:"ItemMouth3",Color:["#A1A1A1"],Craft:{Property:"Large",Name:"Mouth Sealant"}},{Name:"KirugumiMask",Group:"ItemHood",Color:["#484747","#484747","#484747","#484747"],TypeRecord:{e:0,m:3,b:0,br:0,op:0,ms:0},Craft:{Property:"Secure",Name:"Statue's Visage"}},{Name:"MonoHeel",Group:"ItemBoots",Color:["#737070","#737070","#101010"],TypeRecord:{typed:0},Craft:{Property:"Secure",Name:"Statue Base"}},{Name:"FuturisticMittens",Group:"ItemHands",Color:["#767676","#5F5F5F","#3C3C3C","#4F4F4F"],TypeRecord:{typed:0},Craft:{Property:"Secure",Name:"Statue Hands"}},{Name:"SmoothLeatherArmbinder1",Group:"ItemArms",Color:["#191919","#3D3D3D","#191919","#191919","#191919"],Craft:{Property:"Secure",Name:"Statue Arms"}}]}).map(([e,t])=>{const n=Object.freeze(t.map(t=>{let n;if(null!==t.Craft&&"object"==typeof t.Craft){const r=AssetGet(Player.AssetFamily,t.Group,t.Name);if(null==r)throw new Error(`Invalid ${e} item: ${t.Group}${t.Name}`);n={...t.Craft,Item:t.Name,Private:!0,Lock:"",TypeRecord:void 0,Name:t.Craft.Name||r.Description,MemberNumber:void 0,MemberName:""},CraftingValidate(n,r,!1)}return Object.freeze({...t,Custom:!1,Property:Object.freeze(t.Property??{}),TypeRecord:t.TypeRecord,Craft:Object.freeze(n),Color:t.Color,Equip:t.Equip})}));return[e,n]}));return Object.freeze(e)}(),Xp=Object.freeze([new cR("PSO Bondage",Yp.leash_candy,Player.MBSSettings.FortuneWheelItemSets,Tf.UNDERWEAR,Tf.UNDERWEAR,Ff(If.map(na),[0,1,2,3,4,5]),!1,void 0,{"color-MBS-copyItemColor":{modName:"MBS",hookType:"color",hookName:"copyItemColor",kwargs:{sourceGroup:{type:"select",value:"HairFront"}}}}),new cR("Mummification",Yp.mummy,Player.MBSSettings.FortuneWheelItemSets,Tf.CLOTHES,Tf.UNDERWEAR,Ff(If.map(na),[3]),!1,void 0,{"color-MBS-copyItemColor":{modName:"MBS",hookType:"color",hookName:"copyItemColor",kwargs:{sourceGroup:{type:"select",value:"HairFront"}},get kwargsConfig(){return Bf.get(this.modName,this.hookType,this.hookName)?.kwargs??{}}},"typeRecord-MBS-randomizeType":{modName:"MBS",hookType:"typeRecord",hookName:"randomizeType",kwargs:{targetGroups:{type:"select-multiple",state:"some",value:new Set(["ItemLegs","ItemFeet","ItemArms","ItemMouth2","ItemMouth3"])}},get kwargsConfig(){return Bf.get(this.modName,this.hookType,this.hookName)?.kwargs??{}}}}),new cR("Bondage Maid",Yp.maid,Player.MBSSettings.FortuneWheelItemSets,Tf.UNDERWEAR,Tf.UNDERWEAR,Ff(If.map(na),[0,1,2,3]),!1),new cR("Petrification",Yp.statue,Player.MBSSettings.FortuneWheelItemSets,Tf.UNDERWEAR,Tf.UNDERWEAR,Ff(If.map(na),[0,1,2,3]),!1,void 0,{"beforeOutfitEquip-MBS-statueSetBodyColor":{modName:"MBS",hookType:"beforeOutfitEquip",hookName:"statueSetBodyColor",kwargs:{}}})]),Xp.forEach(e=>e.register(!1)),Zp=Object.freeze(WheelFortuneOption.filter(e=>!e.Custom)),Qp=WheelFortuneDefault,Ib([Cb.SHARED])}});const ig="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:global,og=Object.keys,ag=Array.isArray;function sg(e,t){return"object"!=typeof t||og(t).forEach(function(n){e[n]=t[n]}),e}"undefined"==typeof Promise||ig.Promise||(ig.Promise=Promise);const lg=Object.getPrototypeOf,ug={}.hasOwnProperty;function cg(e,t){return ug.call(e,t)}function dg(e,t){"function"==typeof t&&(t=t(lg(e))),("undefined"==typeof Reflect?og:Reflect.ownKeys)(t).forEach(n=>{fg(e,n,t[n])})}const hg=Object.defineProperty;function fg(e,t,n,r){hg(e,t,sg(n&&cg(n,"get")&&"function"==typeof n.get?{get:n.get,set:n.set,configurable:!0}:{value:n,configurable:!0,writable:!0},r))}function pg(e){return{from:function(t){return e.prototype=Object.create(t.prototype),fg(e.prototype,"constructor",e),{extend:dg.bind(null,e.prototype)}}}}const gg=Object.getOwnPropertyDescriptor;function mg(e,t){let n;return gg(e,t)||(n=lg(e))&&mg(n,t)}const vg=[].slice;function yg(e,t,n){return vg.call(e,t,n)}function bg(e,t){return t(e)}function Rg(e){if(!e)throw new Error("Assertion Failed")}function wg(e){ig.setImmediate?setImmediate(e):setTimeout(e,0)}function Sg(e,t){if("string"==typeof t&&cg(e,t))return e[t];if(!t)return e;if("string"!=typeof t){for(var n=[],r=0,i=t.length;r<i;++r){var o=Sg(e,t[r]);n.push(o)}return n}var a=t.indexOf(".");if(-1!==a){var s=e[t.substr(0,a)];return null==s?void 0:Sg(s,t.substr(a+1))}}function Bg(e,t,n){if(e&&void 0!==t&&(!("isFrozen"in Object)||!Object.isFrozen(e)))if("string"!=typeof t&&"length"in t){Rg("string"!=typeof n&&"length"in n);for(var r=0,i=t.length;r<i;++r)Bg(e,t[r],n[r])}else{var o=t.indexOf(".");if(-1!==o){var a=t.substr(0,o),s=t.substr(o+1);if(""===s)void 0===n?ag(e)&&!isNaN(parseInt(a))?e.splice(a,1):delete e[a]:e[a]=n;else{var l=e[a];l&&cg(e,a)||(l=e[a]={}),Bg(l,s,n)}}else void 0===n?ag(e)&&!isNaN(parseInt(t))?e.splice(t,1):delete e[t]:e[t]=n}}function kg(e){var t={};for(var n in e)cg(e,n)&&(t[n]=e[n]);return t}const Cg=[].concat;function _g(e){return Cg.apply([],e)}const xg="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(_g([8,16,32,64].map(e=>["Int","Uint","Float"].map(t=>t+e+"Array")))).filter(e=>ig[e]),Pg=new Set(xg.map(e=>ig[e]));function Eg(e){const t={};for(const n in e)if(cg(e,n)){const r=e[n];t[n]=!r||"object"!=typeof r||Pg.has(r.constructor)?r:Eg(r)}return t}let Mg=null;function Ig(e){Mg=new WeakMap;const t=jg(e);return Mg=null,t}function jg(e){if(!e||"object"!=typeof e)return e;let t=Mg.get(e);if(t)return t;if(ag(e)){t=[],Mg.set(e,t);for(var n=0,r=e.length;n<r;++n)t.push(jg(e[n]))}else if(Pg.has(e.constructor))t=e;else{const n=lg(e);for(var i in t=n===Object.prototype?{}:Object.create(n),Mg.set(e,t),e)cg(e,i)&&(t[i]=jg(e[i]))}return t}const{toString:Og}={};function Ag(e){return Og.call(e).slice(8,-1)}const $g="undefined"!=typeof Symbol?Symbol.iterator:"@@iterator",Fg="symbol"==typeof $g?function(e){var t;return null!=e&&(t=e[$g])&&t.apply(e)}:function(){return null};function Lg(e,t){const n=e.indexOf(t);return n>=0&&e.splice(n,1),n>=0}const Tg={};function Dg(e){var t,n,r,i;if(1===arguments.length){if(ag(e))return e.slice();if(this===Tg&&"string"==typeof e)return[e];if(i=Fg(e)){for(n=[];!(r=i.next()).done;)n.push(r.value);return n}if(null==e)return[e];if("number"==typeof(t=e.length)){for(n=new Array(t);t--;)n[t]=e[t];return n}return[e]}for(t=arguments.length,n=new Array(t);t--;)n[t]=arguments[t];return n}const Hg="undefined"!=typeof Symbol?e=>"AsyncFunction"===e[Symbol.toStringTag]:()=>!1;var Ng=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],Gg=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(Ng),Wg={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function qg(e,t){this.name=e,this.message=t}function zg(e,t){return e+". Errors: "+Object.keys(t).map(e=>t[e].toString()).filter((e,t,n)=>n.indexOf(e)===t).join("\n")}function Kg(e,t,n,r){this.failures=t,this.failedKeys=r,this.successCount=n,this.message=zg(e,t)}function Ug(e,t){this.name="BulkError",this.failures=Object.keys(t).map(e=>t[e]),this.failuresByPos=t,this.message=zg(e,this.failures)}pg(qg).from(Error).extend({toString:function(){return this.name+": "+this.message}}),pg(Kg).from(qg),pg(Ug).from(qg);var Vg=Gg.reduce((e,t)=>(e[t]=t+"Error",e),{});const Jg=qg;var Yg=Gg.reduce((e,t)=>{var n=t+"Error";function r(e,r){this.name=n,e?"string"==typeof e?(this.message=`${e}${r?"\n "+r:""}`,this.inner=r||null):"object"==typeof e&&(this.message=`${e.name} ${e.message}`,this.inner=e):(this.message=Wg[t]||n,this.inner=null)}return pg(r).from(Jg),e[t]=r,e},{});Yg.Syntax=SyntaxError,Yg.Type=TypeError,Yg.Range=RangeError;var Xg=Ng.reduce((e,t)=>(e[t+"Error"]=Yg[t],e),{}),Zg=Gg.reduce((e,t)=>(-1===["Syntax","Type","Range"].indexOf(t)&&(e[t+"Error"]=Yg[t]),e),{});function Qg(){}function em(e){return e}function tm(e,t){return null==e||e===em?t:function(n){return t(e(n))}}function nm(e,t){return function(){e.apply(this,arguments),t.apply(this,arguments)}}function rm(e,t){return e===Qg?t:function(){var n=e.apply(this,arguments);void 0!==n&&(arguments[0]=n);var r=this.onsuccess,i=this.onerror;this.onsuccess=null,this.onerror=null;var o=t.apply(this,arguments);return r&&(this.onsuccess=this.onsuccess?nm(r,this.onsuccess):r),i&&(this.onerror=this.onerror?nm(i,this.onerror):i),void 0!==o?o:n}}function im(e,t){return e===Qg?t:function(){e.apply(this,arguments);var n=this.onsuccess,r=this.onerror;this.onsuccess=this.onerror=null,t.apply(this,arguments),n&&(this.onsuccess=this.onsuccess?nm(n,this.onsuccess):n),r&&(this.onerror=this.onerror?nm(r,this.onerror):r)}}function om(e,t){return e===Qg?t:function(n){var r=e.apply(this,arguments);sg(n,r);var i=this.onsuccess,o=this.onerror;this.onsuccess=null,this.onerror=null;var a=t.apply(this,arguments);return i&&(this.onsuccess=this.onsuccess?nm(i,this.onsuccess):i),o&&(this.onerror=this.onerror?nm(o,this.onerror):o),void 0===r?void 0===a?void 0:a:sg(r,a)}}function am(e,t){return e===Qg?t:function(){return!1!==t.apply(this,arguments)&&e.apply(this,arguments)}}function sm(e,t){return e===Qg?t:function(){var n=e.apply(this,arguments);if(n&&"function"==typeof n.then){for(var r=this,i=arguments.length,o=new Array(i);i--;)o[i]=arguments[i];return n.then(function(){return t.apply(r,o)})}return t.apply(this,arguments)}}Zg.ModifyError=Kg,Zg.DexieError=qg,Zg.BulkError=Ug;var lm="undefined"!=typeof location&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function um(e,t){lm=e}var cm={};const[dm,hm,fm]="undefined"==typeof Promise?[]:(()=>{let e=Promise.resolve();if("undefined"==typeof crypto||!crypto.subtle)return[e,lg(e),e];const t=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[t,lg(t),e]})(),pm=hm&&hm.then,gm=dm&&dm.constructor,mm=!!fm;var vm=function(e,t){Cm.push([e,t]),bm&&(queueMicrotask(Fm),bm=!1)},ym=!0,bm=!0,Rm=[],wm=[],Sm=em,Bm={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:Qg,pgp:!1,env:{},finalize:Qg},km=Bm,Cm=[],_m=0,xm=[];function Pm(e){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var t=this._PSD=km;if("function"!=typeof e){if(e!==cm)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(!1===this._state&&jm(this,this._value))}this._state=null,this._value=null,++t.ref,Im(this,e)}const Em={get:function(){var e=km,t=Km;function n(n,r){var i=!e.global&&(e!==km||t!==Km);const o=i&&!Ym();var a=new Pm((t,a)=>{Am(this,new Mm(rv(n,e,i,o),rv(r,e,i,o),t,a,e))});return this._consoleTask&&(a._consoleTask=this._consoleTask),a}return n.prototype=cm,n},set:function(e){fg(this,"then",e&&e.prototype===cm?Em:{get:function(){return e},set:Em.set})}};function Mm(e,t,n,r,i){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.resolve=n,this.reject=r,this.psd=i}function Im(e,t){try{t(t=>{if(null===e._state){if(t===e)throw new TypeError("A promise cannot be resolved with itself.");var n=e._lib&&Lm();t&&"function"==typeof t.then?Im(e,(e,n)=>{t instanceof Pm?t._then(e,n):t.then(e,n)}):(e._state=!0,e._value=t,Om(e)),n&&Tm()}},jm.bind(null,e))}catch(t){jm(e,t)}}function jm(e,t){if(wm.push(t),null===e._state){var n=e._lib&&Lm();t=Sm(t),e._state=!1,e._value=t,function(e){Rm.some(t=>t._value===e._value)||Rm.push(e)}(e),Om(e),n&&Tm()}}function Om(e){var t=e._listeners;e._listeners=[];for(var n=0,r=t.length;n<r;++n)Am(e,t[n]);var i=e._PSD;--i.ref||i.finalize(),0===_m&&(++_m,vm(()=>{0==--_m&&Dm()},[]))}function Am(e,t){if(null!==e._state){var n=e._state?t.onFulfilled:t.onRejected;if(null===n)return(e._state?t.resolve:t.reject)(e._value);++t.psd.ref,++_m,vm($m,[n,e,t])}else e._listeners.push(t)}function $m(e,t,n){try{var r,i=t._value;!t._state&&wm.length&&(wm=[]),r=lm&&t._consoleTask?t._consoleTask.run(()=>e(i)):e(i),t._state||-1!==wm.indexOf(i)||function(e){for(var t=Rm.length;t;)if(Rm[--t]._value===e._value)return void Rm.splice(t,1)}(t),n.resolve(r)}catch(e){n.reject(e)}finally{0==--_m&&Dm(),--n.psd.ref||n.psd.finalize()}}function Fm(){nv(Bm,()=>{Lm()&&Tm()})}function Lm(){var e=ym;return ym=!1,bm=!1,e}function Tm(){var e,t,n;do{for(;Cm.length>0;)for(e=Cm,Cm=[],n=e.length,t=0;t<n;++t){var r=e[t];r[0].apply(null,r[1])}}while(Cm.length>0);ym=!0,bm=!0}function Dm(){var e=Rm;Rm=[],e.forEach(e=>{e._PSD.onunhandled.call(null,e._value,e)});for(var t=xm.slice(0),n=t.length;n;)t[--n]()}function Hm(e){return new Pm(cm,!1,e)}function Nm(e,t){var n=km;return function(){var r=Lm(),i=km;try{return ev(n,!0),e.apply(this,arguments)}catch(e){t&&t(e)}finally{ev(i,!1),r&&Tm()}}}dg(Pm.prototype,{then:Em,_then:function(e,t){Am(this,new Mm(null,null,e,t,km))},catch:function(e){if(1===arguments.length)return this.then(null,e);var t=arguments[0],n=arguments[1];return"function"==typeof t?this.then(null,e=>e instanceof t?n(e):Hm(e)):this.then(null,e=>e&&e.name===t?n(e):Hm(e))},finally:function(e){return this.then(t=>Pm.resolve(e()).then(()=>t),t=>Pm.resolve(e()).then(()=>Hm(t)))},timeout:function(e,t){return e<1/0?new Pm((n,r)=>{var i=setTimeout(()=>r(new Yg.Timeout(t)),e);this.then(n,r).finally(clearTimeout.bind(null,i))}):this}}),"undefined"!=typeof Symbol&&Symbol.toStringTag&&fg(Pm.prototype,Symbol.toStringTag,"Dexie.Promise"),Bm.env=tv(),dg(Pm,{all:function(){var e=Dg.apply(null,arguments).map(Xm);return new Pm(function(t,n){0===e.length&&t([]);var r=e.length;e.forEach((i,o)=>Pm.resolve(i).then(n=>{e[o]=n,--r||t(e)},n))})},resolve:e=>e instanceof Pm?e:e&&"function"==typeof e.then?new Pm((t,n)=>{e.then(t,n)}):new Pm(cm,!0,e),reject:Hm,race:function(){var e=Dg.apply(null,arguments).map(Xm);return new Pm((t,n)=>{e.map(e=>Pm.resolve(e).then(t,n))})},PSD:{get:()=>km,set:e=>km=e},totalEchoes:{get:()=>Km},newPSD:Vm,usePSD:nv,scheduler:{get:()=>vm,set:e=>{vm=e}},rejectionMapper:{get:()=>Sm,set:e=>{Sm=e}},follow:(e,t)=>new Pm((n,r)=>Vm((t,n)=>{var r=km;r.unhandleds=[],r.onunhandled=n,r.finalize=nm(function(){!function(e){xm.push(function t(){e(),xm.splice(xm.indexOf(t),1)}),++_m,vm(()=>{0==--_m&&Dm()},[])}(()=>{0===this.unhandleds.length?t():n(this.unhandleds[0])})},r.finalize),e()},t,n,r))}),gm&&(gm.allSettled&&fg(Pm,"allSettled",function(){const e=Dg.apply(null,arguments).map(Xm);return new Pm(t=>{0===e.length&&t([]);let n=e.length;const r=new Array(n);e.forEach((e,i)=>Pm.resolve(e).then(e=>r[i]={status:"fulfilled",value:e},e=>r[i]={status:"rejected",reason:e}).then(()=>--n||t(r)))})}),gm.any&&"undefined"!=typeof AggregateError&&fg(Pm,"any",function(){const e=Dg.apply(null,arguments).map(Xm);return new Pm((t,n)=>{0===e.length&&n(new AggregateError([]));let r=e.length;const i=new Array(r);e.forEach((e,o)=>Pm.resolve(e).then(e=>t(e),e=>{i[o]=e,--r||n(new AggregateError(i))}))})}),gm.withResolvers&&(Pm.withResolvers=gm.withResolvers));const Gm={awaits:0,echoes:0,id:0};var Wm=0,qm=[],zm=0,Km=0,Um=0;function Vm(e,t,n,r){var i=km,o=Object.create(i);o.parent=i,o.ref=0,o.global=!1,o.id=++Um,Bm.env,o.env=mm?{Promise:Pm,PromiseProp:{value:Pm,configurable:!0,writable:!0},all:Pm.all,race:Pm.race,allSettled:Pm.allSettled,any:Pm.any,resolve:Pm.resolve,reject:Pm.reject}:{},t&&sg(o,t),++i.ref,o.finalize=function(){--this.parent.ref||this.parent.finalize()};var a=nv(o,e,n,r);return 0===o.ref&&o.finalize(),a}function Jm(){return Gm.id||(Gm.id=++Wm),++Gm.awaits,Gm.echoes+=100,Gm.id}function Ym(){return!!Gm.awaits&&(0==--Gm.awaits&&(Gm.id=0),Gm.echoes=100*Gm.awaits,!0)}function Xm(e){return Gm.echoes&&e&&e.constructor===gm?(Jm(),e.then(e=>(Ym(),e),e=>(Ym(),ov(e)))):e}function Zm(e){++Km,Gm.echoes&&0!=--Gm.echoes||(Gm.echoes=Gm.awaits=Gm.id=0),qm.push(km),ev(e,!0)}function Qm(){var e=qm[qm.length-1];qm.pop(),ev(e,!1)}function ev(e,t){var n=km;if((t?!Gm.echoes||zm++&&e===km:!zm||--zm&&e===km)||queueMicrotask(t?Zm.bind(null,e):Qm),e!==km&&(km=e,n===Bm&&(Bm.env=tv()),mm)){var r=Bm.env.Promise,i=e.env;(n.global||e.global)&&(Object.defineProperty(ig,"Promise",i.PromiseProp),r.all=i.all,r.race=i.race,r.resolve=i.resolve,r.reject=i.reject,i.allSettled&&(r.allSettled=i.allSettled),i.any&&(r.any=i.any))}}function tv(){var e=ig.Promise;return mm?{Promise:e,PromiseProp:Object.getOwnPropertyDescriptor(ig,"Promise"),all:e.all,race:e.race,allSettled:e.allSettled,any:e.any,resolve:e.resolve,reject:e.reject}:{}}function nv(e,t,n,r,i){var o=km;try{return ev(e,!0),t(n,r,i)}finally{ev(o,!1)}}function rv(e,t,n,r){return"function"!=typeof e?e:function(){var i=km;n&&Jm(),ev(t,!0);try{return e.apply(this,arguments)}finally{ev(i,!1),r&&queueMicrotask(Ym)}}}function iv(e){Promise===gm&&0===Gm.echoes?0===zm?e():enqueueNativeMicroTask(e):setTimeout(e,0)}-1===(""+pm).indexOf("[native code]")&&(Jm=Ym=Qg);var ov=Pm.reject;function av(e,t,n,r){if(e.idbdb&&(e._state.openComplete||km.letThrough||e._vip)){var i=e._createTransaction(t,n,e._dbSchema);try{i.create(),e._state.PR1398_maxLoop=3}catch(i){return i.name===Vg.InvalidState&&e.isOpen()&&--e._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),e.close({disableAutoOpen:!1}),e.open().then(()=>av(e,t,n,r))):ov(i)}return i._promise(t,(e,t)=>Vm(()=>(km.trans=i,r(e,t,i)))).then(e=>{if("readwrite"===t)try{i.idbtrans.commit()}catch{}return"readonly"===t?e:i._completion.then(()=>e)})}if(e._state.openComplete)return ov(new Yg.DatabaseClosed(e._state.dbOpenError));if(!e._state.isBeingOpened){if(!e._state.autoOpen)return ov(new Yg.DatabaseClosed);e.open().catch(Qg)}return e._state.dbReadyPromise.then(()=>av(e,t,n,r))}const sv=String.fromCharCode(65535),lv="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",uv=[];function cv(e,t){return e?t?function(){return e.apply(this,arguments)&&t.apply(this,arguments)}:e:t}const dv={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function hv(e){return"string"!=typeof e||/\./.test(e)?e=>e:t=>(void 0===t[e]&&e in t&&delete(t=Ig(t))[e],t)}function fv(){throw Yg.Type("Entity instances must never be new:ed. Instances are generated by the framework bypassing the constructor.")}function pv(e,t){try{const n=gv(e),r=gv(t);if(n!==r)return"Array"===n?1:"Array"===r?-1:"binary"===n?1:"binary"===r?-1:"string"===n?1:"string"===r?-1:"Date"===n?1:"Date"!==r?NaN:-1;switch(n){case"number":case"Date":case"string":return e>t?1:e<t?-1:0;case"binary":return function(e,t){const n=e.length,r=t.length,i=n<r?n:r;for(let n=0;n<i;++n)if(e[n]!==t[n])return e[n]<t[n]?-1:1;return n===r?0:n<r?-1:1}(mv(e),mv(t));case"Array":return function(e,t){const n=e.length,r=t.length,i=n<r?n:r;for(let n=0;n<i;++n){const r=pv(e[n],t[n]);if(0!==r)return r}return n===r?0:n<r?-1:1}(e,t)}}catch{}return NaN}function gv(e){const t=typeof e;if("object"!==t)return t;if(ArrayBuffer.isView(e))return"binary";const n=Ag(e);return"ArrayBuffer"===n?"binary":n}function mv(e){return e instanceof Uint8Array?e:ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):new Uint8Array(e)}function vv(e,t,n){const{yProps:r}=e.schema;return r?(t&&n.numFailures>0&&(t=t.filter((e,t)=>!n.failures[t])),Promise.all(r.map(({updatesTable:n})=>t?e.db.table(n).where("k").anyOf(t).delete():e.db.table(n).clear())).then(()=>n)):n}class yv{_trans(e,t,n){const r=this._tx||km.trans,i=this.name,o=lm&&"undefined"!=typeof console&&console.createTask&&console.createTask(`Dexie: ${"readonly"===e?"read":"write"} ${this.name}`);function a(e,n,r){if(!r.schema[i])throw new Yg.NotFound("Table "+i+" not part of transaction");return t(r.idbtrans,r)}const s=Lm();try{let t=r&&r.db._novip===this.db._novip?r===km.trans?r._promise(e,a,n):Vm(()=>r._promise(e,a,n),{trans:r,transless:km.transless||km}):av(this.db,e,[this.name],a);return o&&(t._consoleTask=o,t=t.catch(e=>(console.trace(e),ov(e)))),t}finally{s&&Tm()}}get(e,t){return e&&e.constructor===Object?this.where(e).first(t):null==e?ov(new Yg.Type("Invalid argument to Table.get()")):this._trans("readonly",t=>this.core.get({trans:t,key:e}).then(e=>this.hook.reading.fire(e))).then(t)}where(e){if("string"==typeof e)return new this.db.WhereClause(this,e);if(ag(e))return new this.db.WhereClause(this,`[${e.join("+")}]`);const t=og(e);if(1===t.length)return this.where(t[0]).equals(e[t[0]]);const n=this.schema.indexes.concat(this.schema.primKey).filter(e=>{if(e.compound&&t.every(t=>e.keyPath.indexOf(t)>=0)){for(let n=0;n<t.length;++n)if(-1===t.indexOf(e.keyPath[n]))return!1;return!0}return!1}).sort((e,t)=>e.keyPath.length-t.keyPath.length)[0];if(n&&this.db._maxKey!==sv){const r=n.keyPath.slice(0,t.length);return this.where(r).equals(r.map(t=>e[t]))}!n&&lm&&console.warn(`The query ${JSON.stringify(e)} on ${this.name} would benefit from a compound index [${t.join("+")}]`);const{idxByName:r}=this.schema;function i(e,t){return 0===pv(e,t)}const[o,a]=t.reduce(([t,n],o)=>{const a=r[o],s=e[o];return[t||a,t||!a?cv(n,a&&a.multi?e=>{const t=Sg(e,o);return ag(t)&&t.some(e=>i(s,e))}:e=>i(s,Sg(e,o))):n]},[null,null]);return o?this.where(o.name).equals(e[o.keyPath]).filter(a):n?this.filter(a):this.where(t).equals("")}filter(e){return this.toCollection().and(e)}count(e){return this.toCollection().count(e)}offset(e){return this.toCollection().offset(e)}limit(e){return this.toCollection().limit(e)}each(e){return this.toCollection().each(e)}toArray(e){return this.toCollection().toArray(e)}toCollection(){return new this.db.Collection(new this.db.WhereClause(this))}orderBy(e){return new this.db.Collection(new this.db.WhereClause(this,ag(e)?`[${e.join("+")}]`:e))}reverse(){return this.toCollection().reverse()}mapToClass(e){const{db:t,name:n}=this;this.schema.mappedClass=e,e.prototype instanceof fv&&(e=class extends e{get db(){return t}table(){return n}});const r=new Set;for(let t=e.prototype;t;t=lg(t))Object.getOwnPropertyNames(t).forEach(e=>r.add(e));const i=t=>{if(!t)return t;const n=Object.create(e.prototype);for(let e in t)if(!r.has(e))try{n[e]=t[e]}catch(e){}return n};return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=i,this.hook("reading",i),e}defineClass(){return this.mapToClass(function(e){sg(this,e)})}add(e,t){const{auto:n,keyPath:r}=this.schema.primKey;let i=e;return r&&n&&(i=hv(r)(e)),this._trans("readwrite",e=>this.core.mutate({trans:e,type:"add",keys:null!=t?[t]:null,values:[i]})).then(e=>e.numFailures?Pm.reject(e.failures[0]):e.lastResult).then(t=>{if(r)try{Bg(e,r,t)}catch(e){}return t})}update(e,t){if("object"!=typeof e||ag(e))return this.where(":id").equals(e).modify(t);{const n=Sg(e,this.schema.primKey.keyPath);return void 0===n?ov(new Yg.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(n).modify(t)}}put(e,t){const{auto:n,keyPath:r}=this.schema.primKey;let i=e;return r&&n&&(i=hv(r)(e)),this._trans("readwrite",e=>this.core.mutate({trans:e,type:"put",values:[i],keys:null!=t?[t]:null})).then(e=>e.numFailures?Pm.reject(e.failures[0]):e.lastResult).then(t=>{if(r)try{Bg(e,r,t)}catch(e){}return t})}delete(e){return this._trans("readwrite",t=>this.core.mutate({trans:t,type:"delete",keys:[e]}).then(t=>vv(this,[e],t)).then(e=>e.numFailures?Pm.reject(e.failures[0]):void 0))}clear(){return this._trans("readwrite",e=>this.core.mutate({trans:e,type:"deleteRange",range:dv}).then(e=>vv(this,null,e))).then(e=>e.numFailures?Pm.reject(e.failures[0]):void 0)}bulkGet(e){return this._trans("readonly",t=>this.core.getMany({keys:e,trans:t}).then(e=>e.map(e=>this.hook.reading.fire(e))))}bulkAdd(e,t,n){const r=Array.isArray(t)?t:void 0,i=(n=n||(r?void 0:t))?n.allKeys:void 0;return this._trans("readwrite",t=>{const{auto:n,keyPath:o}=this.schema.primKey;if(o&&r)throw new Yg.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(r&&r.length!==e.length)throw new Yg.InvalidArgument("Arguments objects and keys must have the same length");const a=e.length;let s=o&&n?e.map(hv(o)):e;return this.core.mutate({trans:t,type:"add",keys:r,values:s,wantResults:i}).then(({numFailures:e,results:t,lastResult:n,failures:r})=>{if(0===e)return i?t:n;throw new Ug(`${this.name}.bulkAdd(): ${e} of ${a} operations failed`,r)})})}bulkPut(e,t,n){const r=Array.isArray(t)?t:void 0,i=(n=n||(r?void 0:t))?n.allKeys:void 0;return this._trans("readwrite",t=>{const{auto:n,keyPath:o}=this.schema.primKey;if(o&&r)throw new Yg.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(r&&r.length!==e.length)throw new Yg.InvalidArgument("Arguments objects and keys must have the same length");const a=e.length;let s=o&&n?e.map(hv(o)):e;return this.core.mutate({trans:t,type:"put",keys:r,values:s,wantResults:i}).then(({numFailures:e,results:t,lastResult:n,failures:r})=>{if(0===e)return i?t:n;throw new Ug(`${this.name}.bulkPut(): ${e} of ${a} operations failed`,r)})})}bulkUpdate(e){const t=this.core,n=e.map(e=>e.key),r=e.map(e=>e.changes),i=[];return this._trans("readwrite",o=>t.getMany({trans:o,keys:n,cache:"clone"}).then(a=>{const s=[],l=[];e.forEach(({key:e,changes:t},n)=>{const r=a[n];if(r){for(const n of Object.keys(t)){const i=t[n];if(n===this.schema.primKey.keyPath){if(0!==pv(i,e))throw new Yg.Constraint("Cannot update primary key in bulkUpdate()")}else Bg(r,n,i)}i.push(n),s.push(e),l.push(r)}});const u=s.length;return t.mutate({trans:o,type:"put",keys:s,values:l,updates:{keys:n,changeSpecs:r}}).then(({numFailures:e,failures:t})=>{if(0===e)return u;for(const e of Object.keys(t)){const n=i[Number(e)];if(null!=n){const r=t[e];delete t[e],t[n]=r}}throw new Ug(`${this.name}.bulkUpdate(): ${e} of ${u} operations failed`,t)})}))}bulkDelete(e){const t=e.length;return this._trans("readwrite",t=>this.core.mutate({trans:t,type:"delete",keys:e}).then(t=>vv(this,e,t))).then(({numFailures:e,lastResult:n,failures:r})=>{if(0===e)return n;throw new Ug(`${this.name}.bulkDelete(): ${e} of ${t} operations failed`,r)})}}function bv(e){var t={},n=function(n,r){if(r){for(var i=arguments.length,o=new Array(i-1);--i;)o[i-1]=arguments[i];return t[n].subscribe.apply(null,o),e}if("string"==typeof n)return t[n]};n.addEventType=o;for(var r=1,i=arguments.length;r<i;++r)o(arguments[r]);return n;function o(e,r,i){if("object"==typeof e)return a(e);r||(r=am),i||(i=Qg);var o={subscribers:[],fire:i,subscribe:function(e){-1===o.subscribers.indexOf(e)&&(o.subscribers.push(e),o.fire=r(o.fire,e))},unsubscribe:function(e){o.subscribers=o.subscribers.filter(function(t){return t!==e}),o.fire=o.subscribers.reduce(r,i)}};return t[e]=n[e]=o,o}function a(e){og(e).forEach(function(t){var n=e[t];if(ag(n))o(t,e[t][0],e[t][1]);else{if("asap"!==n)throw new Yg.InvalidArgument("Invalid event config");var r=o(t,em,function(){for(var e=arguments.length,t=new Array(e);e--;)t[e]=arguments[e];r.subscribers.forEach(function(e){wg(function(){e.apply(null,t)})})})}})}}function Rv(e,t){return pg(t).from({prototype:e}),t}function wv(e,t){return!(e.filter||e.algorithm||e.or)&&(t?e.justLimit:!e.replayFilter)}function Sv(e,t){e.filter=cv(e.filter,t)}function Bv(e,t,n){var r=e.replayFilter;e.replayFilter=r?()=>cv(r(),t()):t,e.justLimit=n&&!r}function kv(e,t){if(e.isPrimKey)return t.primaryKey;const n=t.getIndexByKeyPath(e.index);if(!n)throw new Yg.Schema("KeyPath "+e.index+" on object store "+t.name+" is not indexed");return n}function Cv(e,t,n){const r=kv(e,t.schema);return t.openCursor({trans:n,values:!e.keysOnly,reverse:"prev"===e.dir,unique:!!e.unique,query:{index:r,range:e.range}})}function _v(e,t,n,r){const i=e.replayFilter?cv(e.filter,e.replayFilter()):e.filter;if(e.or){const o={},a=(e,n,r)=>{if(!i||i(n,r,e=>n.stop(e),e=>n.fail(e))){var a=n.primaryKey,s=""+a;"[object ArrayBuffer]"===s&&(s=""+new Uint8Array(a)),cg(o,s)||(o[s]=!0,t(e,n,r))}};return Promise.all([e.or._iterate(a,n),xv(Cv(e,r,n),e.algorithm,a,!e.keysOnly&&e.valueMapper)])}return xv(Cv(e,r,n),cv(e.algorithm,i),t,!e.keysOnly&&e.valueMapper)}function xv(e,t,n,r){var i=Nm(r?(e,t,i)=>n(r(e),t,i):n);return e.then(e=>{if(e)return e.start(()=>{var n=()=>e.continue();t&&!t(e,e=>n=e,t=>{e.stop(t),n=Qg},t=>{e.fail(t),n=Qg})||i(e.value,e,e=>n=e),n()})})}class Pv{execute(e){const t=this["@@propmod"];if(void 0!==t.add){const n=t.add;if(ag(n))return[...ag(e)?e:[],...n].sort();if("number"==typeof n)return(Number(e)||0)+n;if("bigint"==typeof n)try{return BigInt(e)+n}catch{return BigInt(0)+n}throw new TypeError(`Invalid term ${n}`)}if(void 0!==t.remove){const n=t.remove;if(ag(n))return ag(e)?e.filter(e=>!n.includes(e)).sort():[];if("number"==typeof n)return Number(e)-n;if("bigint"==typeof n)try{return BigInt(e)-n}catch{return BigInt(0)-n}throw new TypeError(`Invalid subtrahend ${n}`)}const n=t.replacePrefix?.[0];return n&&"string"==typeof e&&e.startsWith(n)?t.replacePrefix[1]+e.substring(n.length):e}constructor(e){this["@@propmod"]=e}}class Ev{_read(e,t){var n=this._ctx;return n.error?n.table._trans(null,ov.bind(null,n.error)):n.table._trans("readonly",e).then(t)}_write(e){var t=this._ctx;return t.error?t.table._trans(null,ov.bind(null,t.error)):t.table._trans("readwrite",e,"locked")}_addAlgorithm(e){var t=this._ctx;t.algorithm=cv(t.algorithm,e)}_iterate(e,t){return _v(this._ctx,e,t,this._ctx.table.core)}clone(e){var t=Object.create(this.constructor.prototype),n=Object.create(this._ctx);return e&&sg(n,e),t._ctx=n,t}raw(){return this._ctx.valueMapper=null,this}each(e){var t=this._ctx;return this._read(n=>_v(t,e,n,t.table.core))}count(e){return this._read(e=>{const t=this._ctx,n=t.table.core;if(wv(t,!0))return n.count({trans:e,query:{index:kv(t,n.schema),range:t.range}}).then(e=>Math.min(e,t.limit));var r=0;return _v(t,()=>(++r,!1),e,n).then(()=>r)}).then(e)}sortBy(e,t){const n=e.split(".").reverse(),r=n[0],i=n.length-1;function o(e,t){return t?o(e[n[t]],t-1):e[r]}var a="next"===this._ctx.dir?1:-1;function s(e,t){return pv(o(e,i),o(t,i))*a}return this.toArray(function(e){return e.sort(s)}).then(t)}toArray(e){return this._read(e=>{var t=this._ctx;if("next"===t.dir&&wv(t,!0)&&t.limit>0){const{valueMapper:n}=t,r=kv(t,t.table.core.schema);return t.table.core.query({trans:e,limit:t.limit,values:!0,query:{index:r,range:t.range}}).then(({result:e})=>n?e.map(n):e)}{const n=[];return _v(t,e=>n.push(e),e,t.table.core).then(()=>n)}},e)}offset(e){var t=this._ctx;return e<=0||(t.offset+=e,wv(t)?Bv(t,()=>{var t=e;return(e,n)=>0===t||(1===t?(--t,!1):(n(()=>{e.advance(t),t=0}),!1))}):Bv(t,()=>{var t=e;return()=>--t<0})),this}limit(e){return this._ctx.limit=Math.min(this._ctx.limit,e),Bv(this._ctx,()=>{var t=e;return function(e,n,r){return--t<=0&&n(r),t>=0}},!0),this}until(e,t){return Sv(this._ctx,function(n,r,i){return!e(n.value)||(r(i),t)}),this}first(e){return this.limit(1).toArray(function(e){return e[0]}).then(e)}last(e){return this.reverse().first(e)}filter(e){var t,n;return Sv(this._ctx,function(t){return e(t.value)}),t=this._ctx,n=e,t.isMatch=cv(t.isMatch,n),this}and(e){return this.filter(e)}or(e){return new this.db.WhereClause(this._ctx.table,e,this)}reverse(){return this._ctx.dir="prev"===this._ctx.dir?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this}desc(){return this.reverse()}eachKey(e){var t=this._ctx;return t.keysOnly=!t.isMatch,this.each(function(t,n){e(n.key,n)})}eachUniqueKey(e){return this._ctx.unique="unique",this.eachKey(e)}eachPrimaryKey(e){var t=this._ctx;return t.keysOnly=!t.isMatch,this.each(function(t,n){e(n.primaryKey,n)})}keys(e){var t=this._ctx;t.keysOnly=!t.isMatch;var n=[];return this.each(function(e,t){n.push(t.key)}).then(function(){return n}).then(e)}primaryKeys(e){var t=this._ctx;if("next"===t.dir&&wv(t,!0)&&t.limit>0)return this._read(e=>{var n=kv(t,t.table.core.schema);return t.table.core.query({trans:e,values:!1,limit:t.limit,query:{index:n,range:t.range}})}).then(({result:e})=>e).then(e);t.keysOnly=!t.isMatch;var n=[];return this.each(function(e,t){n.push(t.primaryKey)}).then(function(){return n}).then(e)}uniqueKeys(e){return this._ctx.unique="unique",this.keys(e)}firstKey(e){return this.limit(1).keys(function(e){return e[0]}).then(e)}lastKey(e){return this.reverse().firstKey(e)}distinct(){var e=this._ctx,t=e.index&&e.table.schema.idxByName[e.index];if(!t||!t.multi)return this;var n={};return Sv(this._ctx,function(e){var t=e.primaryKey.toString(),r=cg(n,t);return n[t]=!0,!r}),this}modify(e){var t=this._ctx;return this._write(n=>{var r;if("function"==typeof e)r=e;else{var i=og(e),o=i.length;r=function(t){let n=!1;for(let r=0;r<o;++r){let o=i[r],a=e[o],s=Sg(t,o);a instanceof Pv?(Bg(t,o,a.execute(s)),n=!0):s!==a&&(Bg(t,o,a),n=!0)}return n}}const a=t.table.core,{outbound:s,extractKey:l}=a.schema.primaryKey;let u=200;const c=this.db._options.modifyChunkSize;c&&(u="object"==typeof c?c[a.name]||c["*"]||200:c);const d=[];let h=0;const f=[],p=(e,t)=>{const{failures:n,numFailures:r}=t;h+=e-r;for(let e of og(n))d.push(n[e])},g=e===Mv;return this.clone().primaryKeys().then(i=>{const o=wv(t)&&t.limit===1/0&&("function"!=typeof e||g)&&{index:t.index,range:t.range},c=d=>{const h=Math.min(u,i.length-d),f=i.slice(d,d+h);return(g?Promise.resolve([]):a.getMany({trans:n,keys:f,cache:"immutable"})).then(m=>{const v=[],y=[],b=s?[]:null,R=g?f:[];if(!g)for(let e=0;e<h;++e){const t=m[e],n={value:Ig(t),primKey:i[d+e]};!1!==r.call(n,n.value,n)&&(null==n.value?R.push(i[d+e]):s||0===pv(l(t),l(n.value))?(y.push(n.value),s&&b.push(i[d+e])):(R.push(i[d+e]),v.push(n.value)))}return Promise.resolve(v.length>0&&a.mutate({trans:n,type:"add",values:v}).then(e=>{for(let t in e.failures)R.splice(parseInt(t),1);p(v.length,e)})).then(()=>(y.length>0||o&&"object"==typeof e)&&a.mutate({trans:n,type:"put",keys:b,values:y,criteria:o,changeSpec:"function"!=typeof e&&e,isAdditionalChunk:d>0}).then(e=>p(y.length,e))).then(()=>(R.length>0||o&&g)&&a.mutate({trans:n,type:"delete",keys:R,criteria:o,isAdditionalChunk:d>0}).then(e=>vv(t.table,R,e)).then(e=>p(R.length,e))).then(()=>i.length>d+h&&c(d+u))})};return c(0).then(()=>{if(d.length>0)throw new Kg("Error modifying one or more objects",d,h,f);return i.length})})})}delete(){var e=this._ctx,t=e.range;return!wv(e)||e.table.schema.yProps||!e.isPrimKey&&3!==t.type?this.modify(Mv):this._write(n=>{const{primaryKey:r}=e.table.core.schema,i=t;return e.table.core.count({trans:n,query:{index:r,range:i}}).then(t=>e.table.core.mutate({trans:n,type:"deleteRange",range:i}).then(({failures:e,numFailures:n})=>{if(n)throw new Kg("Could not delete some values",Object.keys(e).map(t=>e[t]),t-n);return t-n}))})}}const Mv=(e,t)=>t.value=null;function Iv(e,t){return e<t?-1:e===t?0:1}function jv(e,t){return e>t?-1:e===t?0:1}function Ov(e,t,n){var r=e instanceof Dv?new e.Collection(e):e;return r._ctx.error=n?new n(t):new TypeError(t),r}function Av(e){return new e.Collection(e,()=>Tv("")).limit(0)}function $v(e,t,n,r,i,o){for(var a=Math.min(e.length,r.length),s=-1,l=0;l<a;++l){var u=t[l];if(u!==r[l])return i(e[l],n[l])<0?e.substr(0,l)+n[l]+n.substr(l+1):i(e[l],r[l])<0?e.substr(0,l)+r[l]+n.substr(l+1):s>=0?e.substr(0,s)+t[s]+n.substr(s+1):null;i(e[l],u)<0&&(s=l)}return a<r.length&&"next"===o?e+n.substr(e.length):a<e.length&&"prev"===o?e.substr(0,n.length):s<0?null:e.substr(0,s)+r[s]+n.substr(s+1)}function Fv(e,t,n,r){var i,o,a,s,l,u,c,d=n.length;if(!n.every(e=>"string"==typeof e))return Ov(e,"String expected.");function h(e){i=function(e){return"next"===e?e=>e.toUpperCase():e=>e.toLowerCase()}(e),o=function(e){return"next"===e?e=>e.toLowerCase():e=>e.toUpperCase()}(e),a="next"===e?Iv:jv;var t=n.map(function(e){return{lower:o(e),upper:i(e)}}).sort(function(e,t){return a(e.lower,t.lower)});s=t.map(function(e){return e.upper}),l=t.map(function(e){return e.lower}),u=e,c="next"===e?"":r}h("next");var f=new e.Collection(e,()=>Lv(s[0],l[d-1]+r));f._ondirectionchange=function(e){h(e)};var p=0;return f._addAlgorithm(function(e,n,r){var i=e.key;if("string"!=typeof i)return!1;var h=o(i);if(t(h,l,p))return!0;for(var f=null,g=p;g<d;++g){var m=$v(i,h,s[g],l[g],a,u);null===m&&null===f?p=g+1:(null===f||a(f,m)>0)&&(f=m)}return n(null!==f?function(){e.continue(f+c)}:r),!1}),f}function Lv(e,t,n,r){return{type:2,lower:e,upper:t,lowerOpen:n,upperOpen:r}}function Tv(e){return{type:1,lower:e,upper:e}}class Dv{get Collection(){return this._ctx.table.db.Collection}between(e,t,n,r){n=!1!==n,r=!0===r;try{return this._cmp(e,t)>0||0===this._cmp(e,t)&&(n||r)&&(!n||!r)?Av(this):new this.Collection(this,()=>Lv(e,t,!n,!r))}catch(e){return Ov(this,lv)}}equals(e){return null==e?Ov(this,lv):new this.Collection(this,()=>Tv(e))}above(e){return null==e?Ov(this,lv):new this.Collection(this,()=>Lv(e,void 0,!0))}aboveOrEqual(e){return null==e?Ov(this,lv):new this.Collection(this,()=>Lv(e,void 0,!1))}below(e){return null==e?Ov(this,lv):new this.Collection(this,()=>Lv(void 0,e,!1,!0))}belowOrEqual(e){return null==e?Ov(this,lv):new this.Collection(this,()=>Lv(void 0,e))}startsWith(e){return"string"!=typeof e?Ov(this,"String expected."):this.between(e,e+sv,!0,!0)}startsWithIgnoreCase(e){return""===e?this.startsWith(e):Fv(this,(e,t)=>0===e.indexOf(t[0]),[e],sv)}equalsIgnoreCase(e){return Fv(this,(e,t)=>e===t[0],[e],"")}anyOfIgnoreCase(){var e=Dg.apply(Tg,arguments);return 0===e.length?Av(this):Fv(this,(e,t)=>-1!==t.indexOf(e),e,"")}startsWithAnyOfIgnoreCase(){var e=Dg.apply(Tg,arguments);return 0===e.length?Av(this):Fv(this,(e,t)=>t.some(t=>0===e.indexOf(t)),e,sv)}anyOf(){const e=Dg.apply(Tg,arguments);let t=this._cmp;try{e.sort(t)}catch(e){return Ov(this,lv)}if(0===e.length)return Av(this);const n=new this.Collection(this,()=>Lv(e[0],e[e.length-1]));n._ondirectionchange=n=>{t="next"===n?this._ascending:this._descending,e.sort(t)};let r=0;return n._addAlgorithm((n,i,o)=>{const a=n.key;for(;t(a,e[r])>0;)if(++r,r===e.length)return i(o),!1;return 0===t(a,e[r])||(i(()=>{n.continue(e[r])}),!1)}),n}notEqual(e){return this.inAnyRange([[-1/0,e],[e,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})}noneOf(){const e=Dg.apply(Tg,arguments);if(0===e.length)return new this.Collection(this);try{e.sort(this._ascending)}catch(e){return Ov(this,lv)}const t=e.reduce((e,t)=>e?e.concat([[e[e.length-1][1],t]]):[[-1/0,t]],null);return t.push([e[e.length-1],this.db._maxKey]),this.inAnyRange(t,{includeLowers:!1,includeUppers:!1})}inAnyRange(e,t){const n=this._cmp,r=this._ascending,i=this._descending,o=this._min,a=this._max;if(0===e.length)return Av(this);if(!e.every(e=>void 0!==e[0]&&void 0!==e[1]&&r(e[0],e[1])<=0))return Ov(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",Yg.InvalidArgument);const s=!t||!1!==t.includeLowers,l=t&&!0===t.includeUppers;let u,c=r;function d(e,t){return c(e[0],t[0])}try{u=e.reduce(function(e,t){let r=0,i=e.length;for(;r<i;++r){const i=e[r];if(n(t[0],i[1])<0&&n(t[1],i[0])>0){i[0]=o(i[0],t[0]),i[1]=a(i[1],t[1]);break}}return r===i&&e.push(t),e},[]),u.sort(d)}catch(e){return Ov(this,lv)}let h=0;const f=l?e=>r(e,u[h][1])>0:e=>r(e,u[h][1])>=0,p=s?e=>i(e,u[h][0])>0:e=>i(e,u[h][0])>=0;let g=f;const m=new this.Collection(this,()=>Lv(u[0][0],u[u.length-1][1],!s,!l));return m._ondirectionchange=e=>{"next"===e?(g=f,c=r):(g=p,c=i),u.sort(d)},m._addAlgorithm((e,t,n)=>{for(var i=e.key;g(i);)if(++h,h===u.length)return t(n),!1;return!!function(e){return!f(e)&&!p(e)}(i)||(0===this._cmp(i,u[h][1])||0===this._cmp(i,u[h][0])||t(()=>{c===r?e.continue(u[h][0]):e.continue(u[h][1])}),!1)}),m}startsWithAnyOf(){const e=Dg.apply(Tg,arguments);return e.every(e=>"string"==typeof e)?0===e.length?Av(this):this.inAnyRange(e.map(e=>[e,e+sv])):Ov(this,"startsWithAnyOf() only works with strings")}}function Hv(e){return Nm(function(t){return Nv(t),e(t.target.error),!1})}function Nv(e){e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault()}const Gv=bv(null,"storagemutated");class Wv{_lock(){return Rg(!km.global),++this._reculock,1!==this._reculock||km.global||(km.lockOwnerFor=this),this}_unlock(){if(Rg(!km.global),0==--this._reculock)for(km.global||(km.lockOwnerFor=null);this._blockedFuncs.length>0&&!this._locked();){var e=this._blockedFuncs.shift();try{nv(e[1],e[0])}catch(e){}}return this}_locked(){return this._reculock&&km.lockOwnerFor!==this}create(e){if(!this.mode)return this;const t=this.db.idbdb,n=this.db._state.dbOpenError;if(Rg(!this.idbtrans),!e&&!t)switch(n&&n.name){case"DatabaseClosedError":throw new Yg.DatabaseClosed(n);case"MissingAPIError":throw new Yg.MissingAPI(n.message,n);default:throw new Yg.OpenFailed(n)}if(!this.active)throw new Yg.TransactionInactive;return Rg(null===this._completion._state),(e=this.idbtrans=e||(this.db.core?this.db.core.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability}):t.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability}))).onerror=Nm(t=>{Nv(t),this._reject(e.error)}),e.onabort=Nm(t=>{Nv(t),this.active&&this._reject(new Yg.Abort(e.error)),this.active=!1,this.on("abort").fire(t)}),e.oncomplete=Nm(()=>{this.active=!1,this._resolve(),"mutatedParts"in e&&Gv.storagemutated.fire(e.mutatedParts)}),this}_promise(e,t,n){if("readwrite"===e&&"readwrite"!==this.mode)return ov(new Yg.ReadOnly("Transaction is readonly"));if(!this.active)return ov(new Yg.TransactionInactive);if(this._locked())return new Pm((r,i)=>{this._blockedFuncs.push([()=>{this._promise(e,t,n).then(r,i)},km])});if(n)return Vm(()=>{var e=new Pm((e,n)=>{this._lock();const r=t(e,n,this);r&&r.then&&r.then(e,n)});return e.finally(()=>this._unlock()),e._lib=!0,e});var r=new Pm((e,n)=>{var r=t(e,n,this);r&&r.then&&r.then(e,n)});return r._lib=!0,r}_root(){return this.parent?this.parent._root():this}waitFor(e){var t=this._root();const n=Pm.resolve(e);if(t._waitingFor)t._waitingFor=t._waitingFor.then(()=>n);else{t._waitingFor=n,t._waitingQueue=[];var r=t.idbtrans.objectStore(t.storeNames[0]);!function e(){for(++t._spinCount;t._waitingQueue.length;)t._waitingQueue.shift()();t._waitingFor&&(r.get(-1/0).onsuccess=e)}()}var i=t._waitingFor;return new Pm((e,r)=>{n.then(n=>t._waitingQueue.push(Nm(e.bind(null,n))),e=>t._waitingQueue.push(Nm(r.bind(null,e)))).finally(()=>{t._waitingFor===i&&(t._waitingFor=null)})})}abort(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new Yg.Abort))}table(e){const t=this._memoizedTables||(this._memoizedTables={});if(cg(t,e))return t[e];const n=this.schema[e];if(!n)throw new Yg.NotFound("Table "+e+" not part of transaction");const r=new this.db.Table(e,n,this);return r.core=this.db.core.table(e),t[e]=r,r}}function qv(e,t,n,r,i,o,a,s){return{name:e,keyPath:t,unique:n,multi:r,auto:i,compound:o,src:(n&&!a?"&":"")+(r?"*":"")+(i?"++":"")+zv(t),type:s}}function zv(e){return"string"==typeof e?e:e?"["+[].join.call(e,"+")+"]":""}function Kv(e,t,n){return{name:e,primKey:t,indexes:n,mappedClass:null,idxByName:(r=n,i=e=>[e.name,e],r.reduce((e,t,n)=>{var r=i(t);return r&&(e[r[0]]=r[1]),e},{}))};var r,i}let Uv=e=>{try{return e.only([[]]),Uv=()=>[[]],[[]]}catch(e){return Uv=()=>sv,sv}};function Vv(e){return null==e?()=>{}:"string"==typeof e?function(e){return 1===e.split(".").length?t=>t[e]:t=>Sg(t,e)}(e):t=>Sg(t,e)}function Jv(e){return[].slice.call(e)}let Yv=0;function Xv(e){return null==e?":id":"string"==typeof e?e:`[${e.join("+")}]`}function Zv(e,t,n){function r(e){if(3===e.type)return null;if(4===e.type)throw new Error("Cannot convert never type to IDBKeyRange");const{lower:n,upper:r,lowerOpen:i,upperOpen:o}=e;return void 0===n?void 0===r?null:t.upperBound(r,!!o):void 0===r?t.lowerBound(n,!!i):t.bound(n,r,!!i,!!o)}const{schema:i,hasGetAll:o}=function(e,t){const n=Jv(e.objectStoreNames);return{schema:{name:e.name,tables:n.map(e=>t.objectStore(e)).map(e=>{const{keyPath:t,autoIncrement:n}=e,r=ag(t),i=null==t,o={},a={name:e.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:i,compound:r,keyPath:t,autoIncrement:n,unique:!0,extractKey:Vv(t)},indexes:Jv(e.indexNames).map(t=>e.index(t)).map(e=>{const{name:t,unique:n,multiEntry:r,keyPath:i}=e,a={name:t,compound:ag(i),keyPath:i,unique:n,multiEntry:r,extractKey:Vv(i)};return o[Xv(i)]=a,a}),getIndexByKeyPath:e=>o[Xv(e)]};return o[":id"]=a.primaryKey,null!=t&&(o[Xv(t)]=a.primaryKey),a})},hasGetAll:n.length>0&&"getAll"in t.objectStore(n[0])&&!("undefined"!=typeof navigator&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}}(e,n),a=i.tables.map(e=>function(e){const t=e.name;return{name:t,schema:e,mutate:function({trans:e,type:n,keys:i,values:o,range:a}){return new Promise((s,l)=>{s=Nm(s);const u=e.objectStore(t),c=null==u.keyPath,d="put"===n||"add"===n;if(!d&&"delete"!==n&&"deleteRange"!==n)throw new Error("Invalid operation type: "+n);const{length:h}=i||o||{length:1};if(i&&o&&i.length!==o.length)throw new Error("Given keys array must have same length as given values array.");if(0===h)return s({numFailures:0,failures:{},results:[],lastResult:void 0});let f;const p=[],g=[];let m=0;const v=e=>{++m,Nv(e)};if("deleteRange"===n){if(4===a.type)return s({numFailures:m,failures:g,results:[],lastResult:void 0});3===a.type?p.push(f=u.clear()):p.push(f=u.delete(r(a)))}else{const[e,t]=d?c?[o,i]:[o,null]:[i,null];if(d)for(let r=0;r<h;++r)p.push(f=t&&void 0!==t[r]?u[n](e[r],t[r]):u[n](e[r])),f.onerror=v;else for(let t=0;t<h;++t)p.push(f=u[n](e[t])),f.onerror=v}const y=e=>{const t=e.target.result;p.forEach((e,t)=>null!=e.error&&(g[t]=e.error)),s({numFailures:m,failures:g,results:"delete"===n?i:p.map(e=>e.result),lastResult:t})};f.onerror=e=>{v(e),y(e)},f.onsuccess=y})},getMany:({trans:e,keys:n})=>new Promise((r,i)=>{r=Nm(r);const o=e.objectStore(t),a=n.length,s=new Array(a);let l,u=0,c=0;const d=e=>{const t=e.target;s[t._pos]=t.result,++c===u&&r(s)},h=Hv(i);for(let e=0;e<a;++e)null!=n[e]&&(l=o.get(n[e]),l._pos=e,l.onsuccess=d,l.onerror=h,++u);0===u&&r(s)}),get:({trans:e,key:n})=>new Promise((r,i)=>{r=Nm(r);const o=e.objectStore(t).get(n);o.onsuccess=e=>r(e.target.result),o.onerror=Hv(i)}),query:function(e){return n=>new Promise((i,o)=>{i=Nm(i);const{trans:a,values:s,limit:l,query:u}=n,c=l===1/0?void 0:l,{index:d,range:h}=u,f=a.objectStore(t),p=d.isPrimaryKey?f:f.index(d.name),g=r(h);if(0===l)return i({result:[]});if(e){const e=s?p.getAll(g,c):p.getAllKeys(g,c);e.onsuccess=e=>i({result:e.target.result}),e.onerror=Hv(o)}else{let e=0;const t=s||!("openKeyCursor"in p)?p.openCursor(g):p.openKeyCursor(g),n=[];t.onsuccess=r=>{const o=t.result;return o?(n.push(s?o.value:o.primaryKey),++e===l?i({result:n}):void o.continue()):i({result:n})},t.onerror=Hv(o)}})}(o),openCursor:function({trans:e,values:n,query:i,reverse:o,unique:a}){return new Promise((s,l)=>{s=Nm(s);const{index:u,range:c}=i,d=e.objectStore(t),h=u.isPrimaryKey?d:d.index(u.name),f=o?a?"prevunique":"prev":a?"nextunique":"next",p=n||!("openKeyCursor"in h)?h.openCursor(r(c),f):h.openKeyCursor(r(c),f);p.onerror=Hv(l),p.onsuccess=Nm(t=>{const n=p.result;if(!n)return void s(null);n.___id=++Yv,n.done=!1;const r=n.continue.bind(n);let i=n.continuePrimaryKey;i&&(i=i.bind(n));const o=n.advance.bind(n),a=()=>{throw new Error("Cursor not stopped")};n.trans=e,n.stop=n.continue=n.continuePrimaryKey=n.advance=()=>{throw new Error("Cursor not started")},n.fail=Nm(l),n.next=function(){let e=1;return this.start(()=>e--?this.continue():this.stop()).then(()=>this)},n.start=e=>{const t=new Promise((e,t)=>{e=Nm(e),p.onerror=Hv(t),n.fail=t,n.stop=t=>{n.stop=n.continue=n.continuePrimaryKey=n.advance=a,e(t)}}),s=()=>{if(p.result)try{e()}catch(e){n.fail(e)}else n.done=!0,n.start=()=>{throw new Error("Cursor behind last entry")},n.stop()};return p.onsuccess=Nm(e=>{p.onsuccess=s,s()}),n.continue=r,n.continuePrimaryKey=i,n.advance=o,s(),t},s(n)},l)})},count({query:e,trans:n}){const{index:i,range:o}=e;return new Promise((e,a)=>{const s=n.objectStore(t),l=i.isPrimaryKey?s:s.index(i.name),u=r(o),c=u?l.count(u):l.count();c.onsuccess=Nm(t=>e(t.target.result)),c.onerror=Hv(a)})}}}(e)),s={};return a.forEach(e=>s[e.name]=e),{stack:"dbcore",transaction:e.transaction.bind(e),table(e){if(!s[e])throw new Error(`Table '${e}' not found`);return s[e]},MIN_KEY:-1/0,MAX_KEY:Uv(t),schema:i}}function Qv(e,t){const n=t.db,r=function(e,t,{IDBKeyRange:n,indexedDB:r},i){const o=function(e,t){return t.reduce((e,{create:t})=>({...e,...t(e)}),e)}(Zv(t,n,i),e.dbcore);return{dbcore:o}}(e._middlewares,n,e._deps,t);e.core=r.dbcore,e.tables.forEach(t=>{const n=t.name;e.core.schema.tables.some(e=>e.name===n)&&(t.core=e.core.table(n),e[n]instanceof e.Table&&(e[n].core=t.core))})}function ey(e,t,n,r){n.forEach(n=>{const i=r[n];t.forEach(t=>{const r=mg(t,n);(!r||"value"in r&&void 0===r.value)&&(t===e.Transaction.prototype||t instanceof e.Transaction?fg(t,n,{get(){return this.table(n)},set(e){hg(this,n,{value:e,writable:!0,configurable:!0,enumerable:!0})}}):t[n]=new e.Table(n,i))})})}function ty(e,t){t.forEach(t=>{for(let n in t)t[n]instanceof e.Table&&delete t[n]})}function ny(e,t){return e._cfg.version-t._cfg.version}function ry(e,t,n,r){const i=e._dbSchema;n.objectStoreNames.contains("$meta")&&!i.$meta&&(i.$meta=Kv("$meta",cy("")[0],[]),e._storeNames.push("$meta"));const o=e._createTransaction("readwrite",e._storeNames,i);o.create(n),o._completion.catch(r);const a=o._reject.bind(o),s=km.transless||km;Vm(()=>{if(km.trans=o,km.transless=s,0!==t)return Qv(e,n),function(e,t,n){return t.storeNames.includes("$meta")?t.table("$meta").get("version").then(e=>null!=e?e:n):Pm.resolve(n)}(0,o,t).then(t=>function(e,t,n,r){const i=[],o=e._versions;let a=e._dbSchema=ly(e,e.idbdb,r);const s=o.filter(e=>e._cfg.version>=t);if(0===s.length)return Pm.resolve();return s.forEach(o=>{i.push(()=>{const i=a,s=o._cfg.dbschema;uy(e,i,r),uy(e,s,r),a=e._dbSchema=s;const l=iy(i,s);l.add.forEach(e=>{oy(r,e[0],e[1].primKey,e[1].indexes)}),l.change.forEach(e=>{if(e.recreate)throw new Yg.Upgrade("Not yet support for changing primary key");{const t=r.objectStore(e.name);e.add.forEach(e=>sy(t,e)),e.change.forEach(e=>{t.deleteIndex(e.name),sy(t,e)}),e.del.forEach(e=>t.deleteIndex(e))}});const u=o._cfg.contentUpgrade;if(u&&o._cfg.version>t){Qv(e,r),n._memoizedTables={};let t=kg(s);l.del.forEach(e=>{t[e]=i[e]}),ty(e,[e.Transaction.prototype]),ey(e,[e.Transaction.prototype],og(t),t),n.schema=t;const o=Hg(u);let a;o&&Jm();const c=Pm.follow(()=>{if(a=u(n),a&&o){var e=Ym.bind(null,null);a.then(e,e)}});return a&&"function"==typeof a.then?Pm.resolve(a):c.then(()=>a)}}),i.push(t=>{!function(e,t){[].slice.call(t.db.objectStoreNames).forEach(n=>null==e[n]&&t.db.deleteObjectStore(n))}(o._cfg.dbschema,t),ty(e,[e.Transaction.prototype]),ey(e,[e.Transaction.prototype],e._storeNames,e._dbSchema),n.schema=e._dbSchema}),i.push(t=>{e.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(e.idbdb.version/10)===o._cfg.version?(e.idbdb.deleteObjectStore("$meta"),delete e._dbSchema.$meta,e._storeNames=e._storeNames.filter(e=>"$meta"!==e)):t.objectStore("$meta").put(o._cfg.version,"version"))})}),function e(){return i.length?Pm.resolve(i.shift()(n.idbtrans)).then(e):Pm.resolve()}().then(()=>{ay(a,r)})}(e,t,o,n)).catch(a);og(i).forEach(e=>{oy(n,e,i[e].primKey,i[e].indexes)}),Qv(e,n),Pm.follow(()=>e.on.populate.fire(o)).catch(a)})}function iy(e,t){const n={del:[],add:[],change:[]};let r;for(r in e)t[r]||n.del.push(r);for(r in t){const i=e[r],o=t[r];if(i){const e={name:r,def:o,recreate:!1,del:[],add:[],change:[]};if(""+(i.primKey.keyPath||"")!=""+(o.primKey.keyPath||"")||i.primKey.auto!==o.primKey.auto)e.recreate=!0,n.change.push(e);else{const t=i.idxByName,r=o.idxByName;let a;for(a in t)r[a]||e.del.push(a);for(a in r){const n=t[a],i=r[a];n?n.src!==i.src&&e.change.push(i):e.add.push(i)}(e.del.length>0||e.add.length>0||e.change.length>0)&&n.change.push(e)}}else n.add.push([r,o])}return n}function oy(e,t,n,r){const i=e.db.createObjectStore(t,n.keyPath?{keyPath:n.keyPath,autoIncrement:n.auto}:{autoIncrement:n.auto});return r.forEach(e=>sy(i,e)),i}function ay(e,t){og(e).forEach(n=>{t.db.objectStoreNames.contains(n)||(lm&&console.debug("Dexie: Creating missing table",n),oy(t,n,e[n].primKey,e[n].indexes))})}function sy(e,t){e.createIndex(t.name,t.keyPath,{unique:t.unique,multiEntry:t.multi})}function ly(e,t,n){const r={};return yg(t.objectStoreNames,0).forEach(e=>{const t=n.objectStore(e);let i=t.keyPath;const o=qv(zv(i),i||"",!0,!1,!!t.autoIncrement,i&&"string"!=typeof i,!0),a=[];for(let e=0;e<t.indexNames.length;++e){const n=t.index(t.indexNames[e]);i=n.keyPath;var s=qv(n.name,i,!!n.unique,!!n.multiEntry,!1,i&&"string"!=typeof i,!1);a.push(s)}r[e]=Kv(e,o,a)}),r}function uy(e,t,n){const r=n.db.objectStoreNames;for(let i=0;i<r.length;++i){const o=r[i],a=n.objectStore(o);e._hasGetAll="getAll"in a;for(let e=0;e<a.indexNames.length;++e){const n=a.indexNames[e],r=a.index(n).keyPath,i="string"==typeof r?r:"["+yg(r).join("+")+"]";if(t[o]){const e=t[o].idxByName[i];e&&(e.name=n,delete t[o].idxByName[i],t[o].idxByName[n]=e)}}}"undefined"!=typeof navigator&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&ig.WorkerGlobalScope&&ig instanceof ig.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(e._hasGetAll=!1)}function cy(e){return e.split(",").map((e,t)=>{const n=e.split(":"),r=n[1]?.trim(),i=(e=n[0].trim()).replace(/([&*]|\+\+)/g,""),o=/^\[/.test(i)?i.match(/^\[(.*)\]$/)[1].split("+"):i;return qv(i,o||null,/\&/.test(e),/\*/.test(e),/\+\+/.test(e),ag(o),0===t,r)})}class dy{_createTableSchema(e,t,n){return Kv(e,t,n)}_parseIndexSyntax(e){return cy(e)}_parseStoresSpec(e,t){og(e).forEach(n=>{if(null!==e[n]){let r=this._parseIndexSyntax(e[n]);const i=r.shift();if(!i)throw new Yg.Schema("Invalid schema for table "+n+": "+e[n]);if(i.unique=!0,i.multi)throw new Yg.Schema("Primary key cannot be multiEntry*");r.forEach(e=>{if(e.auto)throw new Yg.Schema("Only primary key can be marked as autoIncrement (++)");if(!e.keyPath)throw new Yg.Schema("Index must have a name and cannot be an empty string")});const o=this._createTableSchema(n,i,r);t[n]=o}})}stores(e){const t=this.db;this._cfg.storesSource=this._cfg.storesSource?sg(this._cfg.storesSource,e):e;const n=t._versions,r={};let i={};return n.forEach(e=>{sg(r,e._cfg.storesSource),i=e._cfg.dbschema={},e._parseStoresSpec(r,i)}),t._dbSchema=i,ty(t,[t._allTables,t,t.Transaction.prototype]),ey(t,[t._allTables,t,t.Transaction.prototype,this._cfg.tables],og(i),i),t._storeNames=og(i),this}upgrade(e){return this._cfg.contentUpgrade=sm(this._cfg.contentUpgrade||Qg,e),this}}function hy(e,t){let n=e._dbNamesDB;return n||(n=e._dbNamesDB=new Yy("__dbnames",{addons:[],indexedDB:e,IDBKeyRange:t}),n.version(1).stores({dbnames:"name"})),n.table("dbnames")}function fy(e){return e&&"function"==typeof e.databases}function py(e){return Vm(function(){return km.letThrough=!0,e()})}function gy(){var e;return!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(t){var n=function(){return indexedDB.databases().finally(t)};e=setInterval(n,100),n()}).finally(function(){return clearInterval(e)}):Promise.resolve()}function my(e){return!("from"in e)}const vy=function(e,t){if(!this){const t=new vy;return e&&"d"in e&&sg(t,e),t}sg(this,arguments.length?{d:1,from:e,to:arguments.length>1?t:e}:{d:0})};function yy(e,t,n){const r=pv(t,n);if(isNaN(r))return;if(r>0)throw RangeError();if(my(e))return sg(e,{from:t,to:n,d:1});const i=e.l,o=e.r;if(pv(n,e.from)<0)return i?yy(i,t,n):e.l={from:t,to:n,d:1,l:null,r:null},wy(e);if(pv(t,e.to)>0)return o?yy(o,t,n):e.r={from:t,to:n,d:1,l:null,r:null},wy(e);pv(t,e.from)<0&&(e.from=t,e.l=null,e.d=o?o.d+1:1),pv(n,e.to)>0&&(e.to=n,e.r=null,e.d=e.l?e.l.d+1:1);const a=!e.r;i&&!e.l&&by(e,i),o&&a&&by(e,o)}function by(e,t){my(t)||function e(t,{from:n,to:r,l:i,r:o}){yy(t,n,r),i&&e(t,i),o&&e(t,o)}(e,t)}function Ry(e){let t=my(e)?null:{s:0,n:e};return{next(e){const n=arguments.length>0;for(;t;)switch(t.s){case 0:if(t.s=1,n)for(;t.n.l&&pv(e,t.n.from)<0;)t={up:t,n:t.n.l,s:1};else for(;t.n.l;)t={up:t,n:t.n.l,s:1};case 1:if(t.s=2,!n||pv(e,t.n.to)<=0)return{value:t.n,done:!1};case 2:if(t.n.r){t.s=3,t={up:t,n:t.n.r,s:0};continue}case 3:t=t.up}return{done:!0}}}}function wy(e){const t=(e.r?.d||0)-(e.l?.d||0),n=t>1?"r":t<-1?"l":"";if(n){const t="r"===n?"l":"r",r={...e},i=e[n];e.from=i.from,e.to=i.to,e[n]=i[n],r[n]=i[t],e[t]=r,r.d=Sy(r)}e.d=Sy(e)}function Sy({r:e,l:t}){return(e?t?Math.max(e.d,t.d):e.d:t?t.d:0)+1}function By(e,t){return og(t).forEach(n=>{e[n]?by(e[n],t[n]):e[n]=Eg(t[n])}),e}function ky(e,t){return e.all||t.all||Object.keys(e).some(n=>t[n]&&function(e,t){const n=Ry(t);let r=n.next();if(r.done)return!1;let i=r.value;const o=Ry(e);let a=o.next(i.from),s=a.value;for(;!r.done&&!a.done;){if(pv(s.from,i.to)<=0&&pv(s.to,i.from)>=0)return!0;pv(i.from,s.from)<0?i=(r=n.next(s.from)).value:s=(a=o.next(i.from)).value}return!1}(t[n],e[n]))}dg(vy.prototype,{add(e){return by(this,e),this},addKey(e){return yy(this,e,e),this},addKeys(e){return e.forEach(e=>yy(this,e,e)),this},hasKey(e){const t=Ry(this).next(e).value;return t&&pv(t.from,e)<=0&&pv(t.to,e)>=0},[$g](){return Ry(this)}});const Cy={};let _y={},xy=!1;function Py(e,t=!1){By(_y,e),xy||(xy=!0,setTimeout(()=>{xy=!1;const e=_y;_y={},Ey(e,!1)},0))}function Ey(e,t=!1){const n=new Set;if(e.all)for(const r of Object.values(Cy))My(r,e,n,t);else for(const r in e){const i=/^idb\:\/\/(.*)\/(.*)\//.exec(r);if(i){const[,r,o]=i,a=Cy[`idb://${r}/${o}`];a&&My(a,e,n,t)}}n.forEach(e=>e())}function My(e,t,n,r){const i=[];for(const[o,a]of Object.entries(e.queries.query)){const e=[];for(const i of a)ky(t,i.obsSet)?i.subscribers.forEach(e=>n.add(e)):r&&e.push(i);r&&i.push([o,e])}if(r)for(const[t,n]of i)e.queries.query[t]=n}function Iy(e){var t=t=>e.next(t),n=i(t),r=i(t=>e.throw(t));function i(e){return t=>{var i=e(t),o=i.value;return i.done?o:o&&"function"==typeof o.then?o.then(n,r):ag(o)?Promise.all(o).then(n,r):n(o)}}return i(t)()}function jy(e,t,n){var r=arguments.length;if(r<2)throw new Yg.InvalidArgument("Too few arguments");for(var i=new Array(r-1);--r;)i[r-1]=arguments[r];return n=i.pop(),[e,_g(i),n]}function Oy(e,t,n,r,i){return Pm.resolve().then(()=>{const o=km.transless||km,a=e._createTransaction(t,n,e._dbSchema,r);a.explicit=!0;const s={trans:a,transless:o};if(r)a.idbtrans=r.idbtrans;else try{a.create(),a.idbtrans._explicit=!0,e._state.PR1398_maxLoop=3}catch(r){return r.name===Vg.InvalidState&&e.isOpen()&&--e._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),e.close({disableAutoOpen:!1}),e.open().then(()=>Oy(e,t,n,null,i))):ov(r)}const l=Hg(i);let u;l&&Jm();const c=Pm.follow(()=>{if(u=i.call(a,a),u)if(l){var e=Ym.bind(null,null);u.then(e,e)}else"function"==typeof u.next&&"function"==typeof u.throw&&(u=Iy(u))},s);return(u&&"function"==typeof u.then?Pm.resolve(u).then(e=>a.active?e:ov(new Yg.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))):c.then(()=>u)).then(e=>(r&&a._resolve(),a._completion.then(()=>e))).catch(e=>(a._reject(e),ov(e)))})}function Ay(e,t,n){const r=ag(e)?e.slice():[e];for(let e=0;e<n;++e)r.push(t);return r}const $y={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(e){return{...e,table(t){const n=e.table(t),{schema:r}=n,i={},o=[];function a(e,t,n){const r=Xv(e),s=i[r]=i[r]||[],l=null==e?0:"string"==typeof e?1:e.length,u=t>0,c={...n,name:u?`${r}(virtual-from:${n.name})`:n.name,lowLevelIndex:n,isVirtual:u,keyTail:t,keyLength:l,extractKey:Vv(e),unique:!u&&n.unique};return s.push(c),c.isPrimaryKey||o.push(c),l>1&&a(2===l?e[0]:e.slice(0,l-1),t+1,n),s.sort((e,t)=>e.keyTail-t.keyTail),c}const s=a(r.primaryKey.keyPath,0,r.primaryKey);i[":id"]=[s];for(const e of r.indexes)a(e.keyPath,0,e);function l(t){const n=t.query.index;return n.isVirtual?{...t,query:{index:n.lowLevelIndex,range:(r=t.query.range,i=n.keyTail,{type:1===r.type?2:r.type,lower:Ay(r.lower,r.lowerOpen?e.MAX_KEY:e.MIN_KEY,i),lowerOpen:!0,upper:Ay(r.upper,r.upperOpen?e.MIN_KEY:e.MAX_KEY,i),upperOpen:!0})}}:t;var r,i}const u={...n,schema:{...r,primaryKey:s,indexes:o,getIndexByKeyPath:function(e){const t=i[Xv(e)];return t&&t[0]}},count:e=>n.count(l(e)),query:e=>n.query(l(e)),openCursor(t){const{keyTail:r,isVirtual:i,keyLength:o}=t.query.index;return i?n.openCursor(l(t)).then(n=>n&&function(n){const i=Object.create(n,{continue:{value:function(i){null!=i?n.continue(Ay(i,t.reverse?e.MAX_KEY:e.MIN_KEY,r)):t.unique?n.continue(n.key.slice(0,o).concat(t.reverse?e.MIN_KEY:e.MAX_KEY,r)):n.continue()}},continuePrimaryKey:{value(t,i){n.continuePrimaryKey(Ay(t,e.MAX_KEY,r),i)}},primaryKey:{get:()=>n.primaryKey},key:{get(){const e=n.key;return 1===o?e[0]:e.slice(0,o)}},value:{get:()=>n.value}});return i}(n)):n.openCursor(t)}};return u}}}};function Fy(e,t,n,r){return n=n||{},r=r||"",og(e).forEach(i=>{if(cg(t,i)){var o=e[i],a=t[i];if("object"==typeof o&&"object"==typeof a&&o&&a){const e=Ag(o);e!==Ag(a)?n[r+i]=t[i]:"Object"===e?Fy(o,a,n,r+i+"."):o!==a&&(n[r+i]=t[i])}else o!==a&&(n[r+i]=t[i])}else n[r+i]=void 0}),og(t).forEach(i=>{cg(e,i)||(n[r+i]=t[i])}),n}function Ly(e,t){return"delete"===t.type?t.keys:t.keys||t.values.map(e.extractKey)}const Ty={stack:"dbcore",name:"HooksMiddleware",level:2,create:e=>({...e,table(t){const n=e.table(t),{primaryKey:r}=n.schema,i={...n,mutate(e){const i=km.trans,{deleting:o,creating:a,updating:s}=i.table(t).hook;switch(e.type){case"add":if(a.fire===Qg)break;return i._promise("readwrite",()=>l(e),!0);case"put":if(a.fire===Qg&&s.fire===Qg)break;return i._promise("readwrite",()=>l(e),!0);case"delete":if(o.fire===Qg)break;return i._promise("readwrite",()=>l(e),!0);case"deleteRange":if(o.fire===Qg)break;return i._promise("readwrite",()=>function(e){return u(e.trans,e.range,1e4)}(e),!0)}return n.mutate(e);function l(e){const t=km.trans,i=e.keys||Ly(r,e);if(!i)throw new Error("Keys missing");return"delete"!==(e="add"===e.type||"put"===e.type?{...e,keys:i}:{...e}).type&&(e.values=[...e.values]),e.keys&&(e.keys=[...e.keys]),function(e,t,n){return"add"===t.type?Promise.resolve([]):e.getMany({trans:t.trans,keys:n,cache:"immutable"})}(n,e,i).then(l=>{const u=i.map((n,i)=>{const u=l[i],c={onerror:null,onsuccess:null};if("delete"===e.type)o.fire.call(c,n,u,t);else if("add"===e.type||void 0===u){const o=a.fire.call(c,n,e.values[i],t);null==n&&null!=o&&(n=o,e.keys[i]=n,r.outbound||Bg(e.values[i],r.keyPath,n))}else{const r=Fy(u,e.values[i]),o=s.fire.call(c,r,n,u,t);if(o){const t=e.values[i];Object.keys(o).forEach(e=>{cg(t,e)?t[e]=o[e]:Bg(t,e,o[e])})}}return c});return n.mutate(e).then(({failures:t,results:n,numFailures:r,lastResult:o})=>{for(let r=0;r<i.length;++r){const o=n?n[r]:i[r],a=u[r];null==o?a.onerror&&a.onerror(t[r]):a.onsuccess&&a.onsuccess("put"===e.type&&l[r]?e.values[r]:o)}return{failures:t,results:n,numFailures:r,lastResult:o}}).catch(e=>(u.forEach(t=>t.onerror&&t.onerror(e)),Promise.reject(e)))})}function u(e,t,i){return n.query({trans:e,values:!1,query:{index:r,range:t},limit:i}).then(({result:n})=>l({type:"delete",keys:n,trans:e}).then(r=>r.numFailures>0?Promise.reject(r.failures[0]):n.length<i?{failures:[],numFailures:0,lastResult:void 0}:u(e,{...t,lower:n[n.length-1],lowerOpen:!0},i)))}}};return i}})};function Dy(e,t,n){try{if(!t)return null;if(t.keys.length<e.length)return null;const r=[];for(let i=0,o=0;i<t.keys.length&&o<e.length;++i)0===pv(t.keys[i],e[o])&&(r.push(n?Ig(t.values[i]):t.values[i]),++o);return r.length===e.length?r:null}catch{return null}}const Hy={stack:"dbcore",level:-1,create:e=>({table:t=>{const n=e.table(t);return{...n,getMany:e=>{if(!e.cache)return n.getMany(e);const t=Dy(e.keys,e.trans._cache,"clone"===e.cache);return t?Pm.resolve(t):n.getMany(e).then(t=>(e.trans._cache={keys:e.keys,values:"clone"===e.cache?Ig(t):t},t))},mutate:e=>("add"!==e.type&&(e.trans._cache=null),n.mutate(e))}}})};function Ny(e,t){return"readonly"===e.trans.mode&&!!e.subscr&&!e.trans.explicit&&"disabled"!==e.trans.db._options.cache&&!t.schema.primaryKey.outbound}function Gy(e,t){switch(e){case"query":return t.values&&!t.unique;case"get":case"getMany":case"count":case"openCursor":return!1}}const Wy={stack:"dbcore",level:0,name:"Observability",create:e=>{const t=e.schema.name,n=new vy(e.MIN_KEY,e.MAX_KEY);return{...e,transaction:(t,n,r)=>{if(km.subscr&&"readonly"!==n)throw new Yg.ReadOnly(`Readwrite transaction in liveQuery context. Querier source: ${km.querier}`);return e.transaction(t,n,r)},table:r=>{const i=e.table(r),{schema:o}=i,{primaryKey:a,indexes:s}=o,{extractKey:l,outbound:u}=a,c=a.autoIncrement&&s.filter(e=>e.compound&&e.keyPath.includes(a.keyPath)),d={...i,mutate:s=>{const l=s.trans,u=s.mutatedParts||(s.mutatedParts={}),d=e=>{const n=`idb://${t}/${r}/${e}`;return u[n]||(u[n]=new vy)},h=d(""),f=d(":dels"),{type:p}=s;let[g,m]="deleteRange"===s.type?[s.range]:"delete"===s.type?[s.keys]:s.values.length<50?[Ly(a,s).filter(e=>e),s.values]:[];const v=s.trans._cache;if(ag(g)){h.addKeys(g);const e="delete"===p||g.length===m.length?Dy(g,v):null;e||f.addKeys(g),(e||m)&&function(e,t,n,r){t.indexes.forEach(function(t){const i=e(t.name||"");function o(e){return null!=e?t.extractKey(e):null}const a=e=>t.multiEntry&&ag(e)?e.forEach(e=>i.addKey(e)):i.addKey(e);(n||r).forEach((e,t)=>{const i=n&&o(n[t]),s=r&&o(r[t]);0!==pv(i,s)&&(null!=i&&a(i),null!=s&&a(s))})})}(d,o,e,m)}else if(g){const t={from:g.lower??e.MIN_KEY,to:g.upper??e.MAX_KEY};f.add(t),h.add(t)}else h.add(n),f.add(n),o.indexes.forEach(e=>d(e.name).add(n));return i.mutate(s).then(e=>(!g||"add"!==s.type&&"put"!==s.type||(h.addKeys(e.results),c&&c.forEach(t=>{const n=s.values.map(e=>t.extractKey(e)),r=t.keyPath.findIndex(e=>e===a.keyPath);for(let t=0,i=e.results.length;t<i;++t)n[t][r]=e.results[t];d(t.name).addKeys(n)})),l.mutatedParts=By(l.mutatedParts||{},u),e))}},h=({query:{index:t,range:n}})=>[t,new vy(n.lower??e.MIN_KEY,n.upper??e.MAX_KEY)],f={get:e=>[a,new vy(e.key)],getMany:e=>[a,(new vy).addKeys(e.keys)],count:h,query:h,openCursor:h};return og(f).forEach(e=>{d[e]=function(o){const{subscr:a}=km,s=!!a;const c=Ny(km,i)&&Gy(e,o)?o.obsSet={}:a;if(s){const a=e=>{const n=`idb://${t}/${r}/${e}`;return c[n]||(c[n]=new vy)},s=a(""),d=a(":dels"),[h,p]=f[e](o);if("query"===e&&h.isPrimaryKey&&!o.values?d.add(p):a(h.name||"").add(p),!h.isPrimaryKey){if("count"!==e){const t="query"===e&&u&&o.values&&i.query({...o,values:!1});return i[e].apply(this,arguments).then(n=>{if("query"===e){if(u&&o.values)return t.then(({result:e})=>(s.addKeys(e),n));const e=o.values?n.result.map(l):n.result;o.values?s.addKeys(e):d.addKeys(e)}else if("openCursor"===e){const e=n,t=o.values;return e&&Object.create(e,{key:{get:()=>(d.addKey(e.primaryKey),e.key)},primaryKey:{get(){const t=e.primaryKey;return d.addKey(t),t}},value:{get:()=>(t&&s.addKey(e.primaryKey),e.value)}})}return n})}d.add(n)}}return i[e].apply(this,arguments)}}),d}}}};function qy(e,t,n){if(0===n.numFailures)return t;if("deleteRange"===t.type)return null;const r=t.keys?t.keys.length:"values"in t&&t.values?t.values.length:1;if(n.numFailures===r)return null;const i={...t};return ag(i.keys)&&(i.keys=i.keys.filter((e,t)=>!(t in n.failures))),"values"in i&&ag(i.values)&&(i.values=i.values.filter((e,t)=>!(t in n.failures))),i}function zy(e,t){return function(e,t){return void 0===t.lower||(t.lowerOpen?pv(e,t.lower)>0:pv(e,t.lower)>=0)}(e,t)&&function(e,t){return void 0===t.upper||(t.upperOpen?pv(e,t.upper)<0:pv(e,t.upper)<=0)}(e,t)}function Ky(e,t,n,r,i,o){if(!n||0===n.length)return e;const a=t.query.index,{multiEntry:s}=a,l=t.query.range,u=r.schema.primaryKey.extractKey,c=a.extractKey,d=(a.lowLevelIndex||a).extractKey;let h=n.reduce((e,n)=>{let r=e;const i=[];if("add"===n.type||"put"===n.type){const e=new vy;for(let t=n.values.length-1;t>=0;--t){const r=n.values[t],o=u(r);if(e.hasKey(o))continue;const a=c(r);(s&&ag(a)?a.some(e=>zy(e,l)):zy(a,l))&&(e.addKey(o),i.push(r))}}switch(n.type){case"add":{const n=(new vy).addKeys(t.values?e.map(e=>u(e)):e);r=e.concat(t.values?i.filter(e=>{const t=u(e);return!n.hasKey(t)&&(n.addKey(t),!0)}):i.map(e=>u(e)).filter(e=>!n.hasKey(e)&&(n.addKey(e),!0)));break}case"put":{const o=(new vy).addKeys(n.values.map(e=>u(e)));r=e.filter(e=>!o.hasKey(t.values?u(e):e)).concat(t.values?i:i.map(e=>u(e)));break}case"delete":const o=(new vy).addKeys(n.keys);r=e.filter(e=>!o.hasKey(t.values?u(e):e));break;case"deleteRange":const a=n.range;r=e.filter(e=>!zy(u(e),a))}return r},e);return h===e?e:(h.sort((e,t)=>pv(d(e),d(t))||pv(u(e),u(t))),t.limit&&t.limit<1/0&&(h.length>t.limit?h.length=t.limit:e.length===t.limit&&h.length<t.limit&&(i.dirty=!0)),o?Object.freeze(h):h)}function Uy(e,t){return 0===pv(e.lower,t.lower)&&0===pv(e.upper,t.upper)&&!!e.lowerOpen==!!t.lowerOpen&&!!e.upperOpen==!!t.upperOpen}const Vy={stack:"dbcore",level:0,name:"Cache",create:e=>{const t=e.schema.name,n={...e,transaction:(n,r,i)=>{const o=e.transaction(n,r,i);if("readwrite"===r){const i=new AbortController,{signal:a}=i,s=a=>()=>{if(i.abort(),"readwrite"===r){const r=new Set;for(const i of n){const n=Cy[`idb://${t}/${i}`];if(n){const t=e.table(i),s=n.optimisticOps.filter(e=>e.trans===o);if(o._explicit&&a&&o.mutatedParts)for(const e of Object.values(n.queries.query))for(const t of e.slice())ky(t.obsSet,o.mutatedParts)&&(Lg(e,t),t.subscribers.forEach(e=>r.add(e)));else if(s.length>0){n.optimisticOps=n.optimisticOps.filter(e=>e.trans!==o);for(const e of Object.values(n.queries.query))for(const n of e.slice())if(null!=n.res&&o.mutatedParts)if(a&&!n.dirty){const i=Object.isFrozen(n.res),o=Ky(n.res,n.req,s,t,n,i);n.dirty?(Lg(e,n),n.subscribers.forEach(e=>r.add(e))):o!==n.res&&(n.res=o,n.promise=Pm.resolve({result:o}))}else n.dirty&&Lg(e,n),n.subscribers.forEach(e=>r.add(e))}}}r.forEach(e=>e())}};o.addEventListener("abort",s(!1),{signal:a}),o.addEventListener("error",s(!1),{signal:a}),o.addEventListener("complete",s(!0),{signal:a})}return o},table(n){const r=e.table(n),i=r.schema.primaryKey,o={...r,mutate(e){const o=km.trans;if(i.outbound||"disabled"===o.db._options.cache||o.explicit||"readwrite"!==o.idbtrans.mode)return r.mutate(e);const a=Cy[`idb://${t}/${n}`];if(!a)return r.mutate(e);const s=r.mutate(e);return"add"!==e.type&&"put"!==e.type||!(e.values.length>=50||Ly(i,e).some(e=>null==e))?(a.optimisticOps.push(e),e.mutatedParts&&Py(e.mutatedParts),s.then(t=>{if(t.numFailures>0){Lg(a.optimisticOps,e);const n=qy(0,e,t);n&&a.optimisticOps.push(n),e.mutatedParts&&Py(e.mutatedParts)}}),s.catch(()=>{Lg(a.optimisticOps,e),e.mutatedParts&&Py(e.mutatedParts)})):s.then(t=>{const n=qy(0,{...e,values:e.values.map((e,n)=>{if(t.failures[n])return e;const r=i.keyPath?.includes(".")?Ig(e):{...e};return Bg(r,i.keyPath,t.results[n]),r})},t);a.optimisticOps.push(n),queueMicrotask(()=>e.mutatedParts&&Py(e.mutatedParts))}),s},query(e){if(!Ny(km,r)||!Gy("query",e))return r.query(e);const i="immutable"===km.trans?.db._options.cache,{requery:o,signal:a}=km;let[s,l,u,c]=function(e,t,n,r){const i=Cy[`idb://${e}/${t}`];if(!i)return[];const o=i.queries[n];if(!o)return[null,!1,i,null];const a=o[(r.query?r.query.index.name:null)||""];if(!a)return[null,!1,i,null];switch(n){case"query":const e=a.find(e=>e.req.limit===r.limit&&e.req.values===r.values&&Uy(e.req.query.range,r.query.range));return e?[e,!0,i,a]:[a.find(e=>("limit"in e.req?e.req.limit:1/0)>=r.limit&&(!r.values||e.req.values)&&function(e,t){return function(e,t,n,r){if(void 0===e)return void 0!==t?-1:0;if(void 0===t)return 1;const i=pv(e,t);if(0===i){if(n&&r)return 0;if(n)return 1;if(r)return-1}return i}(e.lower,t.lower,e.lowerOpen,t.lowerOpen)<=0&&function(e,t,n,r){if(void 0===e)return void 0!==t?1:0;if(void 0===t)return-1;const i=pv(e,t);if(0===i){if(n&&r)return 0;if(n)return-1;if(r)return 1}return i}(e.upper,t.upper,e.upperOpen,t.upperOpen)>=0}(e.req.query.range,r.query.range)),!1,i,a];case"count":const t=a.find(e=>Uy(e.req.query.range,r.query.range));return[t,!!t,i,a]}}(t,n,"query",e);if(s&&l)s.obsSet=e.obsSet;else{const o=r.query(e).then(e=>{const t=e.result;if(s&&(s.res=t),i){for(let e=0,n=t.length;e<n;++e)Object.freeze(t[e]);Object.freeze(t)}else e.result=Ig(t);return e}).catch(e=>(c&&s&&Lg(c,s),Promise.reject(e)));s={obsSet:e.obsSet,promise:o,subscribers:new Set,type:"query",req:e,dirty:!1},c?c.push(s):(c=[s],u||(u=Cy[`idb://${t}/${n}`]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}}),u.queries.query[e.query.index.name||""]=c)}return function(e,t,n,r){e.subscribers.add(n),r.addEventListener("abort",()=>{e.subscribers.delete(n),0===e.subscribers.size&&function(e,t){setTimeout(()=>{0===e.subscribers.size&&Lg(t,e)},3e3)}(e,t)})}(s,c,o,a),s.promise.then(t=>({result:Ky(t.result,e,u?.optimisticOps,r,s,i)}))}};return o}};return n}};function Jy(e,t){return new Proxy(e,{get:(e,n,r)=>"db"===n?t:Reflect.get(e,n,r)})}class Yy{constructor(e,t){this._middlewares={},this.verno=0;const n=Yy.dependencies;this._options=t={addons:Yy.addons,autoOpen:!0,indexedDB:n.indexedDB,IDBKeyRange:n.IDBKeyRange,cache:"cloned",...t},this._deps={indexedDB:t.indexedDB,IDBKeyRange:t.IDBKeyRange};const{addons:r}=t;this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;const i={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:Qg,dbReadyPromise:null,cancelOpen:Qg,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:t.autoOpen};var o;i.dbReadyPromise=new Pm(e=>{i.dbReadyResolve=e}),i.openCanceller=new Pm((e,t)=>{i.cancelOpen=t}),this._state=i,this.name=e,this.on=bv(this,"populate","blocked","versionchange","close",{ready:[sm,Qg]}),this.once=(e,t)=>{const n=(...r)=>{this.on(e).unsubscribe(n),t.apply(this,r)};return this.on(e,n)},this.on.ready.subscribe=bg(this.on.ready.subscribe,e=>(t,n)=>{Yy.vip(()=>{const r=this._state;if(r.openComplete)r.dbOpenError||Pm.resolve().then(t),n&&e(t);else if(r.onReadyBeingFired)r.onReadyBeingFired.push(t),n&&e(t);else{e(t);const r=this;n||e(function e(){r.on.ready.unsubscribe(t),r.on.ready.unsubscribe(e)})}})}),this.Collection=(o=this,Rv(Ev.prototype,function(e,t){this.db=o;let n=dv,r=null;if(t)try{n=t()}catch(e){r=e}const i=e._ctx,a=i.table,s=a.hook.reading.fire;this._ctx={table:a,index:i.index,isPrimKey:!i.index||a.schema.primKey.keyPath&&i.index===a.schema.primKey.name,range:n,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:r,or:i.or,valueMapper:s!==em?s:null}})),this.Table=function(e){return Rv(yv.prototype,function(t,n,r){this.db=e,this._tx=r,this.name=t,this.schema=n,this.hook=e._allTables[t]?e._allTables[t].hook:bv(null,{creating:[rm,Qg],reading:[tm,em],updating:[om,Qg],deleting:[im,Qg]})})}(this),this.Transaction=function(e){return Rv(Wv.prototype,function(t,n,r,i,o){"readonly"!==t&&n.forEach(e=>{const t=r[e]?.yProps;t&&(n=n.concat(t.map(e=>e.updatesTable)))}),this.db=e,this.mode=t,this.storeNames=n,this.schema=r,this.chromeTransactionDurability=i,this.idbtrans=null,this.on=bv(this,"complete","error","abort"),this.parent=o||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new Pm((e,t)=>{this._resolve=e,this._reject=t}),this._completion.then(()=>{this.active=!1,this.on.complete.fire()},e=>{var t=this.active;return this.active=!1,this.on.error.fire(e),this.parent?this.parent._reject(e):t&&this.idbtrans&&this.idbtrans.abort(),ov(e)})})}(this),this.Version=function(e){return Rv(dy.prototype,function(t){this.db=e,this._cfg={version:t,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})}(this),this.WhereClause=function(e){return Rv(Dv.prototype,function(t,n,r){if(this.db=e,this._ctx={table:t,index:":id"===n?null:n,or:r},this._cmp=this._ascending=pv,this._descending=(e,t)=>pv(t,e),this._max=(e,t)=>pv(e,t)>0?e:t,this._min=(e,t)=>pv(e,t)<0?e:t,this._IDBKeyRange=e._deps.IDBKeyRange,!this._IDBKeyRange)throw new Yg.MissingAPI})}(this),this.on("versionchange",e=>{e.newVersion>0?console.warn(`Another connection wants to upgrade database '${this.name}'. Closing db now to resume the upgrade.`):console.warn(`Another connection wants to delete database '${this.name}'. Closing db now to resume the delete request.`),this.close({disableAutoOpen:!1})}),this.on("blocked",e=>{!e.newVersion||e.newVersion<e.oldVersion?console.warn(`Dexie.delete('${this.name}') was blocked`):console.warn(`Upgrade '${this.name}' blocked by other connection holding version ${e.oldVersion/10}`)}),this._maxKey=Uv(t.IDBKeyRange),this._createTransaction=(e,t,n,r)=>new this.Transaction(e,t,n,this._options.chromeTransactionDurability,r),this._fireOnBlocked=e=>{this.on("blocked").fire(e),uv.filter(e=>e.name===this.name&&e!==this&&!e._state.vcFired).map(t=>t.on("versionchange").fire(e))},this.use(Hy),this.use(Vy),this.use(Wy),this.use($y),this.use(Ty);const a=new Proxy(this,{get:(e,t,n)=>{if("_vip"===t)return!0;if("table"===t)return e=>Jy(this.table(e),a);const r=Reflect.get(e,t,n);return r instanceof yv?Jy(r,a):"tables"===t?r.map(e=>Jy(e,a)):"_createTransaction"===t?function(){return Jy(r.apply(this,arguments),a)}:r}});this.vip=a,r.forEach(e=>e(this))}version(e){if(isNaN(e)||e<.1)throw new Yg.Type("Given version is not a positive number");if(e=Math.round(10*e)/10,this.idbdb||this._state.isBeingOpened)throw new Yg.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,e);const t=this._versions;var n=t.filter(t=>t._cfg.version===e)[0];return n||(n=new this.Version(e),t.push(n),t.sort(ny),n.stores({}),this._state.autoSchema=!1,n)}_whenReady(e){return this.idbdb&&(this._state.openComplete||km.letThrough||this._vip)?e():new Pm((e,t)=>{if(this._state.openComplete)return t(new Yg.DatabaseClosed(this._state.dbOpenError));if(!this._state.isBeingOpened){if(!this._state.autoOpen)return void t(new Yg.DatabaseClosed);this.open().catch(Qg)}this._state.dbReadyPromise.then(e,t)}).then(e)}use({stack:e,create:t,level:n,name:r}){r&&this.unuse({stack:e,name:r});const i=this._middlewares[e]||(this._middlewares[e]=[]);return i.push({stack:e,create:t,level:null==n?10:n,name:r}),i.sort((e,t)=>e.level-t.level),this}unuse({stack:e,name:t,create:n}){return e&&this._middlewares[e]&&(this._middlewares[e]=this._middlewares[e].filter(e=>n?e.create!==n:!!t&&e.name!==t)),this}open(){return nv(Bm,()=>function(e){const t=e._state,{indexedDB:n}=e._deps;if(t.isBeingOpened||e.idbdb)return t.dbReadyPromise.then(()=>t.dbOpenError?ov(t.dbOpenError):e);t.isBeingOpened=!0,t.dbOpenError=null,t.openComplete=!1;const r=t.openCanceller;let i=Math.round(10*e.verno),o=!1;function a(){if(t.openCanceller!==r)throw new Yg.DatabaseClosed("db.open() was cancelled")}let s=t.dbReadyResolve,l=null,u=!1;const c=()=>new Pm((r,s)=>{if(a(),!n)throw new Yg.MissingAPI;const d=e.name,h=t.autoSchema||!i?n.open(d):n.open(d,i);if(!h)throw new Yg.MissingAPI;h.onerror=Hv(s),h.onblocked=Nm(e._fireOnBlocked),h.onupgradeneeded=Nm(r=>{if(l=h.transaction,t.autoSchema&&!e._options.allowEmptyDB){h.onerror=Nv,l.abort(),h.result.close();const e=n.deleteDatabase(d);e.onsuccess=e.onerror=Nm(()=>{s(new Yg.NoSuchDatabase(`Database ${d} doesnt exist`))})}else{l.onerror=Hv(s);const t=r.oldVersion>Math.pow(2,62)?0:r.oldVersion;u=t<1,e.idbdb=h.result,o&&function(e,t){ay(e._dbSchema,t),t.db.version%10!=0||t.objectStoreNames.contains("$meta")||t.db.createObjectStore("$meta").add(Math.ceil(t.db.version/10-1),"version");const n=ly(0,e.idbdb,t);uy(e,e._dbSchema,t);const r=iy(n,e._dbSchema);for(const e of r.change){if(e.change.length||e.recreate)return void console.warn(`Unable to patch indexes of table ${e.name} because it has changes on the type of index or primary key.`);const n=t.objectStore(e.name);e.add.forEach(t=>{lm&&console.debug(`Dexie upgrade patch: Creating missing index ${e.name}.${t.src}`),sy(n,t)})}}(e,l),ry(e,t/10,l,s)}},s),h.onsuccess=Nm(()=>{l=null;const n=e.idbdb=h.result,a=yg(n.objectStoreNames);if(a.length>0)try{const l=n.transaction(1===(s=a).length?s[0]:s,"readonly");if(t.autoSchema)!function(e,t,n){e.verno=t.version/10;const r=e._dbSchema=ly(0,t,n);e._storeNames=yg(t.objectStoreNames,0),ey(e,[e._allTables],og(r),r)}(e,n,l);else if(uy(e,e._dbSchema,l),!function(e,t){const n=iy(ly(0,e.idbdb,t),e._dbSchema);return!(n.add.length||n.change.some(e=>e.add.length||e.change.length))}(e,l)&&!o)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),n.close(),i=n.version+1,o=!0,r(c());Qv(e,l)}catch(e){}var s;uv.push(e),n.onversionchange=Nm(n=>{t.vcFired=!0,e.on("versionchange").fire(n)}),n.onclose=Nm(t=>{e.on("close").fire(t)}),u&&function({indexedDB:e,IDBKeyRange:t},n){!fy(e)&&"__dbnames"!==n&&hy(e,t).put({name:n}).catch(Qg)}(e._deps,d),r()},s)}).catch(e=>{switch(e?.name){case"UnknownError":if(t.PR1398_maxLoop>0)return t.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),c();break;case"VersionError":if(i>0)return i=0,c()}return Pm.reject(e)});return Pm.race([r,("undefined"==typeof navigator?Pm.resolve():gy()).then(c)]).then(()=>(a(),t.onReadyBeingFired=[],Pm.resolve(py(()=>e.on.ready.fire(e.vip))).then(function n(){if(t.onReadyBeingFired.length>0){let r=t.onReadyBeingFired.reduce(sm,Qg);return t.onReadyBeingFired=[],Pm.resolve(py(()=>r(e.vip))).then(n)}}))).finally(()=>{t.openCanceller===r&&(t.onReadyBeingFired=null,t.isBeingOpened=!1)}).catch(n=>{t.dbOpenError=n;try{l&&l.abort()}catch{}return r===t.openCanceller&&e._close(),ov(n)}).finally(()=>{t.openComplete=!0,s()}).then(()=>{if(u){const t={};e.tables.forEach(n=>{n.schema.indexes.forEach(r=>{r.name&&(t[`idb://${e.name}/${n.name}/${r.name}`]=new vy(-1/0,[[[]]]))}),t[`idb://${e.name}/${n.name}/`]=t[`idb://${e.name}/${n.name}/:dels`]=new vy(-1/0,[[[]]])}),Gv("storagemutated").fire(t),Ey(t,!0)}return e})}(this))}_close(){this.on.close.fire(new CustomEvent("close"));const e=this._state,t=uv.indexOf(this);if(t>=0&&uv.splice(t,1),this.idbdb){try{this.idbdb.close()}catch(e){}this.idbdb=null}e.isBeingOpened||(e.dbReadyPromise=new Pm(t=>{e.dbReadyResolve=t}),e.openCanceller=new Pm((t,n)=>{e.cancelOpen=n}))}close({disableAutoOpen:e}={disableAutoOpen:!0}){const t=this._state;e?(t.isBeingOpened&&t.cancelOpen(new Yg.DatabaseClosed),this._close(),t.autoOpen=!1,t.dbOpenError=new Yg.DatabaseClosed):(this._close(),t.autoOpen=this._options.autoOpen||t.isBeingOpened,t.openComplete=!1,t.dbOpenError=null)}delete(e={disableAutoOpen:!0}){const t=arguments.length>0&&"object"!=typeof arguments[0],n=this._state;return new Pm((r,i)=>{const o=()=>{this.close(e);var t=this._deps.indexedDB.deleteDatabase(this.name);t.onsuccess=Nm(()=>{!function({indexedDB:e,IDBKeyRange:t},n){!fy(e)&&"__dbnames"!==n&&hy(e,t).delete(n).catch(Qg)}(this._deps,this.name),r()}),t.onerror=Hv(i),t.onblocked=this._fireOnBlocked};if(t)throw new Yg.InvalidArgument("Invalid closeOptions argument to db.delete()");n.isBeingOpened?n.dbReadyPromise.then(o):o()})}backendDB(){return this.idbdb}isOpen(){return null!==this.idbdb}hasBeenClosed(){const e=this._state.dbOpenError;return e&&"DatabaseClosed"===e.name}hasFailed(){return null!==this._state.dbOpenError}dynamicallyOpened(){return this._state.autoSchema}get tables(){return og(this._allTables).map(e=>this._allTables[e])}transaction(){const e=jy.apply(this,arguments);return this._transaction.apply(this,e)}_transaction(e,t,n){let r=km.trans;r&&r.db===this&&-1===e.indexOf("!")||(r=null);const i=-1!==e.indexOf("?");let o,a;e=e.replace("!","").replace("?","");try{if(a=t.map(e=>{var t=e instanceof this.Table?e.name:e;if("string"!=typeof t)throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return t}),"r"==e||"readonly"===e)o="readonly";else{if("rw"!=e&&"readwrite"!=e)throw new Yg.InvalidArgument("Invalid transaction mode: "+e);o="readwrite"}if(r){if("readonly"===r.mode&&"readwrite"===o){if(!i)throw new Yg.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");r=null}r&&a.forEach(e=>{if(r&&-1===r.storeNames.indexOf(e)){if(!i)throw new Yg.SubTransaction("Table "+e+" not included in parent transaction.");r=null}}),i&&r&&!r.active&&(r=null)}}catch(e){return r?r._promise(null,(t,n)=>{n(e)}):ov(e)}const s=Oy.bind(null,this,o,a,r,n);return r?r._promise(o,s,"lock"):km.trans?nv(km.transless,()=>this._whenReady(s)):this._whenReady(s)}table(e){if(!cg(this._allTables,e))throw new Yg.InvalidTable(`Table ${e} does not exist`);return this._allTables[e]}}const Xy="undefined"!=typeof Symbol&&"observable"in Symbol?Symbol.observable:"@@observable";class Zy{constructor(e){this._subscribe=e}subscribe(e,t,n){return this._subscribe(e&&"function"!=typeof e?e:{next:e,error:t,complete:n})}[Xy](){return this}}let Qy;try{Qy={indexedDB:ig.indexedDB||ig.mozIndexedDB||ig.webkitIndexedDB||ig.msIndexedDB,IDBKeyRange:ig.IDBKeyRange||ig.webkitIDBKeyRange}}catch(ig){Qy={indexedDB:null,IDBKeyRange:null}}const eb=Yy;function tb(e){let t=rb;try{rb=!0,Gv.storagemutated.fire(e),Ey(e,!0)}finally{rb=t}}dg(eb,{...Zg,delete:e=>new eb(e,{addons:[]}).delete(),exists:e=>new eb(e,{addons:[]}).open().then(e=>(e.close(),!0)).catch("NoSuchDatabaseError",()=>!1),getDatabaseNames(e){try{return function({indexedDB:e,IDBKeyRange:t}){return fy(e)?Promise.resolve(e.databases()).then(e=>e.map(e=>e.name).filter(e=>"__dbnames"!==e)):hy(e,t).toCollection().primaryKeys()}(eb.dependencies).then(e)}catch{return ov(new Yg.MissingAPI)}},defineClass:()=>function(e){sg(this,e)},ignoreTransaction:e=>km.trans?nv(km.transless,e):e(),vip:py,async:function(e){return function(){try{var t=Iy(e.apply(this,arguments));return t&&"function"==typeof t.then?t:Pm.resolve(t)}catch(e){return ov(e)}}},spawn:function(e,t,n){try{var r=Iy(e.apply(n,t||[]));return r&&"function"==typeof r.then?r:Pm.resolve(r)}catch(e){return ov(e)}},currentTransaction:{get:()=>km.trans||null},waitFor:function(e,t){const n=Pm.resolve("function"==typeof e?eb.ignoreTransaction(e):e).timeout(t||6e4);return km.trans?km.trans.waitFor(n):n},Promise:Pm,debug:{get:()=>lm,set:e=>{um(e)}},derive:pg,extend:sg,props:dg,override:bg,Events:bv,on:Gv,liveQuery:function(e){let t,n=!1;const r=new Zy(r=>{const i=Hg(e);let o,a=!1,s={},l={};const u={get closed(){return a},unsubscribe:()=>{a||(a=!0,o&&o.abort(),c&&Gv.storagemutated.unsubscribe(h))}};r.start&&r.start(u);let c=!1;const d=()=>iv(f),h=e=>{By(s,e),ky(l,s)&&d()},f=()=>{if(a||!Qy.indexedDB)return;s={};const u={};o&&o.abort(),o=new AbortController;const f={subscr:u,signal:o.signal,requery:d,querier:e,trans:null},p=function(t){const n=Lm();try{i&&Jm();let n=Vm(e,t);return i&&(n=n.finally(Ym)),n}finally{n&&Tm()}}(f);Promise.resolve(p).then(e=>{n=!0,t=e,a||f.signal.aborted||(s={},l=u,function(e){for(const t in e)if(cg(e,t))return!1;return!0}(l)||c||(Gv("storagemutated",h),c=!0),iv(()=>!a&&r.next&&r.next(e)))},e=>{n=!1,["DatabaseClosedError","AbortError"].includes(e?.name)||a||iv(()=>{a||r.error&&r.error(e)})})};return setTimeout(d,0),u});return r.hasValue=()=>n,r.getValue=()=>t,r},extendObservabilitySet:By,getByKeyPath:Sg,setByKeyPath:Bg,delByKeyPath:function(e,t){"string"==typeof t?Bg(e,t,void 0):"length"in t&&[].map.call(t,function(t){Bg(e,t,void 0)})},shallowClone:kg,deepClone:Ig,getObjectDiff:Fy,cmp:pv,asap:wg,minKey:-1/0,addons:[],connections:uv,errnames:Vg,dependencies:Qy,cache:Cy,semVer:"4.2.0",version:"4.2.0".split(".").map(e=>parseInt(e)).reduce((e,t,n)=>e+t/Math.pow(10,2*n))}),eb.maxKey=Uv(eb.dependencies.IDBKeyRange),"undefined"!=typeof dispatchEvent&&"undefined"!=typeof addEventListener&&(Gv("storagemutated",e=>{if(!rb){let t;t=new CustomEvent("x-storagemutated-1",{detail:e}),rb=!0,dispatchEvent(t),rb=!1}}),addEventListener("x-storagemutated-1",({detail:e})=>{rb||tb(e)}));let nb,rb=!1,ib=()=>{};"undefined"!=typeof BroadcastChannel&&(ib=()=>{nb=new BroadcastChannel("x-storagemutated-1"),nb.onmessage=e=>e.data&&tb(e.data)},ib(),"function"==typeof nb.unref&&nb.unref(),Gv("storagemutated",e=>{rb||nb.postMessage(e)})),"undefined"!=typeof addEventListener&&(addEventListener("pagehide",e=>{if(!Yy.disableBfCache&&e.persisted){lm&&console.debug("Dexie: handling persisted pagehide"),nb?.close();for(const e of uv)e.close({disableAutoOpen:!1})}}),addEventListener("pageshow",e=>{!Yy.disableBfCache&&e.persisted&&(lm&&console.debug("Dexie: handling persisted pageshow"),ib(),tb({all:new vy(-1/0,[[]])}))})),Pm.rejectionMapper=function(e,t){if(!e||e instanceof qg||e instanceof TypeError||e instanceof SyntaxError||!e.name||!Xg[e.name])return e;var n=new Xg[e.name](t||e.message,e);return"stack"in e&&fg(n,"stack",{get:function(){return this.inner.stack}}),n},um(lm);function ob(e){const n=function(e){const t=new DataView(new ArrayBuffer(4),0);return t.setUint8(0,Rf.clamp(e.major,0,255)),t.setUint8(1,Rf.clamp(e.minor,0,255)),t.setUint16(2,Rf.clamp(e.micro,0,65535)),t.getUint32(0)}(jh.fromVersion(t)),r=new Yy(`mbs_${e}`);return r.version(n).stores({crafting:"id"}),r}function ab(e,t){if(!CommonIsObject(e))return null;const n=e;switch(CraftingValidate(n)){case CraftingStatusType.OK:case CraftingStatusType.ERROR:return n;case CraftingStatusType.CRITICAL_ERROR:return Ph.error(`Removing corrupt crafting item ${t}: "${n?.Name} (${n?.Item})"`),null}}const sb=Object.freeze({header:"mbs-crafting-header-prefix",button:"mbs-crafting-info",buttonBrowser:"mbs-crafting-info-browser",buttonMBS:"mbs-crafting-info-marker",style:"mbs-crafting-styles"});var lb,ub,cb,db,hb,fb;Fh("crafting",{async afterLoad(){Ph.log("Initializing crafting hooks");const{maxBC:e,maxMBSLocal:t}={maxBC:200,maxMBSLocal:600};Kh.patchFunction("CraftingClick",{[`if (CraftingOffset < 0) CraftingOffset = ${e} - 20;`]:`if (CraftingOffset < 0) CraftingOffset = ${e+t} - 20;`,[`if (CraftingOffset >= ${e}) CraftingOffset = 0;`]:`if (CraftingOffset >= ${e+t}) CraftingOffset = 0;`}),Kh.patchFunction("CraftingRun",{["/ ${"+e.toString()+" / 20}."]:`/ ${(e+t)/20}.`,'TextGet("SelectDestroy")':`(CraftingOffset >= ${e} ? (CraftingOffset >= ${e} ? 'MBS (Browser): ' : 'MBS (Account): ') : '') + TextGet("SelectDestroy")`,'TextGet("SelectSlot")':`(CraftingOffset >= ${e} ? (CraftingOffset >= ${e} ? 'MBS (Browser): ' : 'MBS (Account): ') : '') + TextGet("SelectSlot")`}),Kh.patchFunction("CraftingJSON.encode",{[`const max = Math.max(${e}, crafts.length);`]:`const max = Math.max(${e+t}, crafts.length);`}),Kh.patchFunction("CraftingJSON.eventListeners.changeFile",{[`}).slice(0, ${e});`]:`}).slice(0, ${e+t});`}),Kh.hookFunction("CraftingModeSet",0,([e,...t],n)=>{const r=n([e,...t]);return"Name"===e&&async function(){let e=document.getElementById(sb.header);if(!e){e=E.jsx("span",{id:sb.header});const t=document.querySelector(`#${CraftingID.root} h1`);t?.prepend(e)}let t=document.getElementById(sb.button);t||(t=ElementButton.Create(sb.button,()=>null,{image:"./Icons/Question.png",tooltip:[E.jsxs("span",{id:sb.buttonBrowser,children:[E.jsx("p",{style:{marginBottom:"0.5em"},children:"Extra MBS crafting slot stored locally in your Browser."}),E.jsxs("p",{style:{marginTop:"0.5em"},children:["These crafts are ",E.jsx("em",{children:"exclusively"})," available for this specific combination of web browser, BC account and BC URL (",E.jsx("code",{children:window.location.href}),"). As such, it will ",E.jsx("em",{children:"not"})," be shared between the EU, US and Asia servers."]})]})],tooltipPosition:"left",tooltipRole:"description"},{button:{attributes:{"aria-label":"Show MBS extra crafting slot description","aria-disabled":"true"},children:[E.jsx("span",{"aria-hidden":"true",id:sb.buttonMBS,children:"MBS"})]}}),document.getElementById(CraftingID.menuBar)?.append(t));const{maxBC:n}={maxBC:200,maxMBSLocal:600};CraftingSlot<n?(e.replaceChildren(),t.hidden=!0):(e.replaceChildren("MBS (Browser): "),t.hidden=!1)}(),r})},async afterMBS(){Ph.log("Initializing crafting cache"),document.getElementById(sb.style)||document.body.append(E.jsx("style",{id:sb.style,children:"#crafting-screen h1 {\n  padding-left: unset;\n}\n\n#mbs-crafting-info {\n  direction: ltr;\n  height: var(--menu-button-size);\n  width: var(--menu-button-size);\n}\n#mbs-crafting-info #mbs-crafting-info-marker {\n  -webkit-text-stroke: 1px white;\n  bottom: min(0.2dvh, 0.1dvw);\n  font-size: 0.5em;\n  font-weight: 900;\n  position: absolute;\n  right: min(0.2dvh, 0.1dvw);\n}\n#mbs-crafting-info [role=tooltip] {\n  text-wrap: unset;\n  top: 0%;\n  transform: unset;\n  width: min(100dvh, 50dvw);\n}\n#mbs-crafting-info #mbs-crafting-info-browser {\n  display: none;\n}\n#mbs-crafting-info #mbs-crafting-info-browser > p {\n  margin-block: unset;\n}".toString()}));const{maxBC:e,maxMBSLocal:t}={maxBC:200,maxMBSLocal:600},n=ob(Player.MemberNumber);Gh(Player.Crafting,e+t,null);for(const[t,r]of(await async function(e){const{maxBC:t,maxMBSLocal:n}={maxBC:200,maxMBSLocal:600},r=e.table("crafting"),i=(await r.bulkGet(Rf.range(0,n))).map((e,n)=>ab(e?.data,t+n)),o=i.filter(e=>null!=e).length;return Ph.debug(`Loading all ${o} crafts from indexedDB`),i}(n)).entries())Player.Crafting[t+e]=r;n.close({disableAutoOpen:!1}),Kh.hookFunction("CraftingSaveServer",0,(r,i)=>{if(Rf.inRange(CraftingSlot,e,e+t)){const t=CraftingSlot-e,r=Player.Crafting[CraftingSlot];return void function(e,t,n){const{maxBC:r}={maxBC:200,maxMBSLocal:600},i=e.table("crafting");n?(Ph.debug(`Saving craft ${t+r} to indexedDB: ${n.Name} (${n.Item})`),i.put({id:t,data:n})):(Ph.debug(`Deleting craft ${t+r} from indexedDB`),i.delete(t))}(n,t,r)}const o=Player.Crafting;Player.Crafting=o?.slice(0,e),i(r),Player.Crafting=o,0===CraftingSlot&&"Name"!==CraftingMode&&async function(e,t){const n=t.map((e,t)=>null!=e?{id:t,data:e}:e),r=[],i=[];for(const[e,t]of n.entries())null==t?i.push(e):r.push(e);Ph.debug(`Saving all ${r.length} crafts to indexedDB`);const o=e.table("crafting");Promise.all([o.bulkPut(n.filter(e=>null!=e)),o.bulkDelete(i)])}(n,Player.Crafting.slice(e,e+t))}),Kh.hookFunction("CraftingExit",0,(e,t)=>("Slot"===CraftingMode&&n.close({disableAutoOpen:!1}),t(e))),null!=Player.MBSSettings.CraftingCache&&(!function(e,t){const{maxBC:n}={maxBC:200,maxMBSLocal:600};if(e.Crafting??=[],Gh(e.Crafting,n,null),!t)return;const r=LZString.compressToUTF16(t),i=CraftingDecompressServerData(r),o=[];for(const[e,t]of i.entries())if(null!=t)e:switch(CraftingValidate(t)){case CraftingStatusType.OK:case CraftingStatusType.ERROR:o.push(t);break e;case CraftingStatusType.CRITICAL_ERROR:Ph.error(`Removing corrupt crafting item ${n+e}: "${t?.Name} (${t?.Item})"`),o.push(null)}if(!o.length)return;let a=0;for(const[t,n]of e.Crafting.entries()){if(t<80)continue;const r=o[a];if(!r)break;null==n&&(a++,e.Crafting[t]=r)}if(o[a]&&confirm("Failed to move all MBS server crafts to BC.\nWould you like to download them?")){const t=URL.createObjectURL(new Blob([JSON.stringify(CraftingJSON.encode(o),null,4)],{type:"application/json"})),n=new Date,r=ElementCreate({tag:"a",parent:document.body,attributes:{href:t,hidden:!0,download:`craft${e.MemberNumber}-MBS-${n.getFullYear()}-${n.getMonth().toString().padStart(2,"0")}-${n.getDay().toString().padStart(2,"0")}.json`}});r.click(),r.remove(),URL.revokeObjectURL(t)}e.IsPlayer()&&CraftingSaveServer()}(Player,Player.MBSSettings.CraftingCache),Player.MBSSettings.CraftingCache=void 0,Ib([Cb.SETTINGS]))}});ub=new WeakMap,cb=new WeakMap,db=new WeakMap,hb=new WeakMap,lb=new WeakSet,fb=async function(e,t){const n=await fetch(t).then(t=>t.ok?(Ph.debug(`Successfully fetched '${e}' json`,t),t.json()):(Ph.debug(`Failed to fetch '${e}' json`,t),Promise.resolve(null))).catch(e=>(Ph.error(e),null));if(null!==n)switch(e){case"phoneticDict":T(this,ub,Object.freeze(n),"f"),T(this,db,!0,"f");break;case"gagData":T(this,cb,Object.freeze(n),"f"),T(this,hb,!0,"f");break;default:throw new Error(`Invalid type: ${e}`)}};const pb=new class{constructor(){lb.add(this),ub.set(this,Object.freeze({})),cb.set(this,Object.freeze({})),db.set(this,!1),hb.set(this,!1)}get gagData(){return L(this,hb,"f")||L(this,lb,"m",fb).call(this,"gagData","https://bananarama92.github.io/MBS/devel/vendor/gag_data.json"),L(this,cb,"f")}get phoneticDict(){return L(this,db,"f")||L(this,lb,"m",fb).call(this,"phoneticDict","https://bananarama92.github.io/MBS/devel/vendor/en_US.json"),L(this,ub,"f")}init(){this.gagData,this.phoneticDict}},gb=Object.freeze({LIGHT:3,MEDIUM:6,HEAVY:9,KILO_HEAVY:12,MEGA_HEAVY:15,GIGA_HEAVY:18,MAX:21}),mb=Object.freeze(new Set(["aɪ","aʊ","b","d","dʒ","eɪ","f","h","i","j","k","m","n","oʊ","p","s","t","tʃ","u","v","w","z","æ","ð","ŋ","ɑ","ɔ","ɔɪ","ə","ɛ","ɝ","ɡ","ɪ","ɪə","ɫ","ɹ","ʃ","ʊ","ʒ","θ"])),vb=/\p{L}/u;function yb(e){const t=e.toLowerCase(),n=pb.phoneticDict[t];if(void 0===n)return;const r=wc(0,n.length).map(e=>[]);for(const e of Nd(n,r)){const[t,n]=e;let r=0;for(;r<t.length;){const e=t[r],i=t.slice(r,r+2);mb.has(i)?(n.push(i),r+=2):(n.push(e),r+=1)}}return r}function bb(e,t){let n=e=>e;if(null!=e?.dropChars){const r={level:t,levelMin:e.dropChars.levelMin??gb.HEAVY,levelMax:e.dropChars.levelMax??gb.MAX,maxFrac:e.dropChars.maxFrac??.5};n=e=>function(e,t){const{level:n,levelMax:r,levelMin:i,maxFrac:o}=t;if(n<i)return e;const a=Array.from(e),s=Math.max(o,o*(n-i)/(r-i)),l=Math.floor(a.length*s);return e.slice(0,a.length-l).padEnd(a.length-Math.floor(l/2))}(e,r)}return{dropChars:n,character:e?.character??null,fallback:e?.fallback??(e=>Kh.callOriginal("SpeechGarbleByGagLevel",[e[1],e[0],e[2]])),ignoreOOC:e?.ignoreOOC??!1,perSyllable:e?.perSyllable??!1}}function Rb(e,t,n=null){if(e&&e.HasEffect("OpenMouth")&&!e.HasEffect("BlockMouth"))return pb.gagData["Ring Gag"]??{};e:if(null!==n){const e=Math.floor(t/3);if(0===e)break e;t/3-e>n.syllable/n.syllableMax&&(t=3*(1+e))}return t<=gb.LIGHT?pb.gagData["Cleave Gag"]??{}:t<=gb.MEDIUM?pb.gagData["Ball Gag"]??{}:pb.gagData["Dildo Gag"]??{}}function wb(e,t,n=null){const{dropChars:r,fallback:i,character:o,ignoreOOC:a,perSyllable:s}=bb(n,t);let l="";const u=function(e,t=!1){const n=SpeechGetOOCRanges(e).values();let r=n.next();if(r.done||t)return[{words:e,ooc:!1}];const i=[];let o=0;for(;!r.done;){const t=r.value.start,a=t+r.value.length;i.push({words:e.slice(o,t),ooc:!1}),i.push({words:e.slice(t,a),ooc:!0}),r=n.next(),o=a}return i.push({words:e.slice(o),ooc:!1}),i}(e,a);for(const e of u){if(e.ooc){l+=e.words;continue}let n="",a=[];const u=e.words.length-1;for(const[c,d]of Array.from(e.words).entries()){const e=vb.test(d);if(e&&(n+=d,a.push(d.toUpperCase()===d),c<u))continue;const h=yb(n);if(h){const e=r(h.flatMap((e,n)=>{const r=s?{syllable:n+1,syllableMax:h.length}:null,i=Rb(o,t,r);return e.map(e=>i[e]?.SOUND??"")}).join(""));a.every(Boolean)?l+=e.toUpperCase():a[0]&&e.length>0?l+=`${e[0].toUpperCase()}${e.slice(1)}`:l+=e}else l+=i([n,t]);n="",a=[],e||(l+=i([d,t]))}}return l}Fh("garbling",{async afterMBS(){Ph.log("Initializing garbling module"),Kh.patchFunction("SpeechTransformProcess",{"text = SpeechTransformGagGarble(text, intensity, ignoreOOC);":"text = SpeechTransformGagGarble(text, intensity, ignoreOOC, C);"}),Kh.hookFunction("SpeechTransformGagGarble",0,([e,t,n,...r],i)=>{const o=r[0];if(t&&e&&Player.MBSSettings.AlternativeGarbling){return wb(e,t,{dropChars:Player.MBSSettings.DropTrailing?{}:void 0,perSyllable:Player.MBSSettings.GarblePerSyllable,fallback:i,ignoreOOC:n,character:o})}return i([e,t,n,...r])})}});const Sb=18e4;function Bb(e){const t=[],n=CommonIsObject(e)?e:{};for(const[e,r]of Object.entries(n))try{const n=JSON.stringify(r??"");t.push([e,(new TextEncoder).encode(n).byteLength])}catch{t.push([e,NaN])}return Object.fromEntries(t.sort(([e,t],[n,r])=>{t=Math.round(t/100),r=Math.round(r/100);const i=Number.isNaN(t),o=Number.isNaN(r);return t===r||i&&o?e.localeCompare(n):i||o?o?-1:1:r-t}))}function kb(e){return Math.round(e/100)/10}const Cb=Object.freeze({SETTINGS:0,SHARED:1});function _b(e,t,n){Array.isArray(t)?t.length>Xb&&(Wh(t,Xb),n.push([`Trimming too long wheel of fortune item list: ${t.length}/${Xb}`])):(t=[],n.push(["Re-initializing invalid wheel of fortune item list: "+typeof t]));const r=Object.seal(Array(Xb).fill(null));return t.forEach((t,i)=>{if(null!==t)try{(r[i]=e(r,t)).register(!1)}catch(e){n.push([`Failed to load corrupted custom wheel of fortune item ${i}`,e])}}),r}function xb(e,t){Array.isArray(e)?e.length>Zb&&(Wh(e,Zb),t.push([`Trimming too long wheel of fortune preset list: ${e.length}/${Zb}`])):(e=[],t.push(["Re-initializing invalid wheel of fortune preset list: "+typeof e]));const n=Object.seal(Array(Zb).fill(null));return e.forEach((e,r)=>{if(null===e)return;if(Array.isArray(e)||"object"!=typeof e||"string"!=typeof e.ids)return void t.push([`Failed to load corrupted custom wheel of fortune preset ${r}`]);const{name:i,ids:o}=e;n[r]={name:"string"==typeof i&&i.length>0&&i.length<=20?i:`Preset ${r}`,ids:o}}),n}function Pb(e,t,n=!0){let r=null;try{if(e&&"string"==typeof e){let t=LZString.decompressFromUTF16(e);t||(t=LZString.decompressFromBase64(e)),r=JSON.parse(t||"null")}}catch(e){n&&Ph.warn(`failed to load corrupted MBS ${t}`,e)}return null!==r&&"object"==typeof r?r:{}}function Eb(e=null,n=!0){if(void 0===Player.OnlineSharedSettings)throw new Error('"Player.OnlineSharedSettings" still uninitialized');e??={...Pb(Player.OnlineSettings?.MBS,"OnlineSettings"),...Pb(Player.ExtensionSettings.MBS,"ExtensionSettings"),...Pb(Player.OnlineSharedSettings.MBS,"OnlineSharedSettings")};const r=void 0!==e.Version&&function(e){if(void 0===e)return Ph.log("Detecting first-time MBS initialization"),!1;const n=jh.fromVersion(t);let r;try{r=jh.fromVersion(e)}catch(t){return Ph.warn(`Failed to parse previous MBS version: ${e}`,t),!1}return n.greater(r)?(Ph.log(`Upgrading MBS from ${e} to ${t}`),!0):!!n.lesser(r)&&(Ph.warn(`Downgrading MBS from ${e} to ${t}`),!1)}(Player.OnlineSharedSettings.MBSVersion??Player.OnlineSettings?.MBSVersion);let i=!1;void 0!==Player.OnlineSettings?.MBSVersion&&(delete Player.OnlineSettings.MBSVersion,i=!0),Player.OnlineSettings?.MBS&&(delete Player.OnlineSettings.MBS,i=!0),i&&ServerAccountUpdate.QueueData({OnlineSettings:Player.OnlineSettings});const o=function(e){const n={AlternativeGarbling:[],CraftingCache:[],DropTrailing:[],FortuneWheelCommands:[],FortuneWheelItemSets:[],FortuneWheelPresets:[],LockedWhenRestrained:[],GarblePerSyllable:[],RollWhenRestrained:[],ShowChangelog:[],Version:[]},r={AlternativeGarbling:!1,DropTrailing:!1,GarblePerSyllable:!1,LockedWhenRestrained:!1,RollWhenRestrained:!0,ShowChangelog:!0};for(const[t,i]of kh(r))void 0!==e[t]&&(typeof e[t]!=typeof i?n[t]=[[`Invalid type, expected a ${typeof i}: ${typeof n[t]}`]]:r[t]=e[t]);const i={AlternativeGarbling:r.AlternativeGarbling,CraftingCache:"string"==typeof e.CraftingCache?e.CraftingCache:void 0,DropTrailing:r.DropTrailing,FortuneWheelCommands:_b(dR.fromObject,e.FortuneWheelCommands??[],n.FortuneWheelCommands),FortuneWheelItemSets:_b(cR.fromObject,e.FortuneWheelSets??e.FortuneWheelItemSets??[],n.FortuneWheelItemSets),FortuneWheelPresets:xb(e.FortuneWheelPresets??[],n.FortuneWheelPresets),LockedWhenRestrained:r.LockedWhenRestrained,GarblePerSyllable:r.GarblePerSyllable,RollWhenRestrained:r.RollWhenRestrained,ShowChangelog:r.ShowChangelog,Version:t};return i.AlternativeGarbling&&pb.init(),{settings:i,ok:0===Jc(Object.values(n).map(e=>e.length)),err:Ch(kh(n).filter(([e,t])=>t.length>0))}}(e);if((o.ok||n)&&(Player.MBSSettings=o.settings,Player.MBSSettings.ShowChangelog&&r)){const e=jh.fromVersion(t);Qh(`v${e.major}${e.minor}${e.micro}`)}return o.ok||(Ph.warn("Encountered and fixed one or more errors while parsing MBS settings",o.err),n&&function(e){const t=Ch(kh(e).map(([e,t])=>[e,t.map(e=>e.join(", "))])),n=`Encountered one or more errors while parsing MBS settings:\n\n${JSON.stringify(t,void 0,4)}`;"number"==typeof Player.MemberNumber&&ServerAccountBeep({MemberNumber:Player.MemberNumber,MemberName:"MBS",ChatRoomName:"MBS Settings Error",Private:!0,Message:n,ChatRoomSpace:"",BeepType:""})}(o.err)),Player.OnlineSharedSettings.WheelFortune??=WheelFortuneDefault,o}function Mb(){delete Player.ExtensionSettings.MBS,void 0!==Player.OnlineSharedSettings&&(delete Player.OnlineSharedSettings.MBSVersion,delete Player.OnlineSharedSettings.MBS,Player.OnlineSharedSettings.WheelFortune=Qp),WheelFortuneOption=WheelFortuneOption.filter(e=>!0!==e.Custom),WheelFortuneDefault=Qp,Player.Crafting=Player.Crafting.slice(0,"R120"===GameVersion?80:200),Player.MBSSettings=Object.seal({AlternativeGarbling:!1,CraftingCache:void 0,DropTrailing:!1,FortuneWheelCommands:Object.seal(Array(Xb).fill(null)),FortuneWheelItemSets:Object.seal(Array(Xb).fill(null)),FortuneWheelPresets:Object.seal(Array(Zb).fill(null)),GarblePerSyllable:!1,LockedWhenRestrained:!1,RollWhenRestrained:!0,ShowChangelog:!0,Version:t}),async function(e){Ph.debug(`Deleting indexedDB database ${e}`),new Yy(`mbs_${e}`).delete()}(Player.MemberNumber),ServerAccountUpdate.QueueData({ExtensionSettings:Player.ExtensionSettings,OnlineSharedSettings:Player.OnlineSharedSettings},!0),Ph.log("Settings successfully reset"),jb()}function Ib(e,n=!0){if(void 0===Player.OnlineSharedSettings)throw new Error("Player.OnlineSharedSettings is still uninitialized");const r={};if(e.includes(Cb.SETTINGS)){const e=bu(Player.MBSSettings,"FortuneWheelItemSets","FortuneWheelCommands");Player.ExtensionSettings.MBS=LZString.compressToUTF16(JSON.stringify(e)),n&&(r["ExtensionSettings.MBS"]=Player.ExtensionSettings.MBS)}if(e.includes(Cb.SHARED)){const e=Object.freeze({FortuneWheelItemSets:Player.MBSSettings.FortuneWheelItemSets,FortuneWheelCommands:Player.MBSSettings.FortuneWheelCommands});Player.OnlineSharedSettings.MBS=LZString.compressToUTF16(JSON.stringify(e)),Player.OnlineSharedSettings.MBSVersion=t,n&&(Player.OnlineSharedSettings.WheelFortune=nR(Player.OnlineSharedSettings.WheelFortune),r.OnlineSharedSettings=Player.OnlineSharedSettings)}n&&ServerAccountUpdate.QueueData(r)}function jb(){const e=["ExtensionSettings","OnlineSharedSettings"];for(const t of e){const e=Bb(Player[t]),n=Object.fromEntries(Object.entries(e).map(([e,t])=>[e,kb(t)])),r=kb(Jc(Object.values(e),e=>Number.isNaN(e)?0:e));r>=.9*Sb/1e3?Ph.warn(`Total ${t} data usage at ${r} / ${Sb/1e3} KB`,n):Ph.log(`Total ${t} data usage at ${r} / ${Sb/1e3} KB`,n)}}const Ob=Object.freeze({OK:0,ERROR:1,EMPTY_SETTINGS:2,WARN:3});Fh("settings",{async afterLogin(){Eb(),Ib([Cb.SETTINGS,Cb.SHARED],!1),Ph.log("Initializing settings module"),jb()}});var Ab,$b,Fb,Lb,Tb,Db,Hb,Nb,Gb;class Wb extends rp{constructor(){super(null,"Character","Preference",{Run:PreferenceRun,Click:PreferenceClick,Exit:PreferenceExit,Load:async()=>{await CommonSetScreen("Character","Preference"),PreferenceOpenSubscreen("Extensions")}})}}Wb.screen="Preference";const qb="mbs-preference",zb=Object.freeze({root:qb,styles:`${qb}-style`,header:`${qb}-header`,menubar:`${qb}-menubar`,exit:`${qb}-exit`,exitButton:`${qb}-exit-button`,settingsGrid:`${qb}-settings`,wheelButton:`${qb}-wheel-button`,wheelHeader:`${qb}-wheel-header`,miscHeader:`${qb}-misc-header`,garbleHeader:`${qb}-garble-header`,wheelLabel:`${qb}-wheel-label`,rollRestrainedLabel:`${qb}-roll-restrained-label`,lockSettingsLabel:`${qb}-lock-settings-label`,garbleLabel:`${qb}-garble-label`,garbleTrailingLabel:`${qb}-garble-trailing-label`,garbleSyllableLabel:`${qb}-garble-syllable-label`,extendedCraftLabel:`${qb}-extended-craft-label`,changelogLabel:`${qb}-changelog-label`,miscGrid:`${qb}-misc`,reset:`${qb}-reset`,resetButton:`${qb}-reset-button`,resetTooltip:`${qb}-reset-tooltip`,resetScreen:`${qb}-reset-screen`,resetBackground:`${qb}-reset-background`,resetGrid:`${qb}-reset-grid`,resetAccept:`${qb}-reset-accept`,resetCancel:`${qb}-reset-cancel`,import:`${qb}-import`,export:`${qb}-export`,changelog:`${qb}-changelog`});class Kb extends np{constructor(e,n=null){super(e,Kb.screenParamsDefault,n),Ab.add(this),document.body.appendChild(E.jsxs("div",{id:zb.root,class:"mbs-screen","aria-labelledby":zb.header,children:[E.jsx("style",{id:zb.styles,children:'.mbs-preference-settings-pair {\n  grid-column-gap: min(3dvh, 1.5dvw);\n  display: grid;\n  grid-template-columns: min(9dvh, 4.5dvw) auto;\n  padding-right: min(6dvh, 3dvw);\n  text-align: justify;\n}\n.mbs-preference-settings-pair button {\n  height: min(9dvh, 4.5dvw);\n  width: min(9dvh, 4.5dvw);\n}\n.mbs-preference-settings-pair > p {\n  margin: 0;\n}\n\n#mbs-preference {\n  grid-template: "header header menubar" min(9dvh, 4.5dvw) "settings misc misc" auto/auto min(29dvh, 14.5dvw) min(9dvh, 4.5dvw);\n}\n#mbs-preference p {\n  margin-bottom: 0.5em;\n  margin-top: 0.5em;\n}\n#mbs-preference .button-tooltip {\n  --tooltip-gap: min(2dvh, 1dvw);\n}\n\n#mbs-preference-header {\n  grid-area: header;\n}\n\n#mbs-preference-menubar {\n  direction: ltr;\n  display: grid;\n  grid-area: menubar;\n}\n#mbs-preference-menubar button {\n  height: min(9dvh, 4.5dvw);\n  width: min(9dvh, 4.5dvw);\n}\n\n#mbs-preference-exit {\n  grid-area: exit;\n}\n\n#mbs-preference-settings {\n  display: grid;\n  grid-area: settings;\n  height: 100%;\n  overflow: hidden scroll;\n  grid-gap: min(2dvh, 1dvw);\n}\n\n#mbs-preference-misc {\n  align-self: self-end;\n  grid-area: misc;\n  margin: unset;\n  padding: unset;\n}\n#mbs-preference-misc li {\n  list-style-type: none;\n}\n#mbs-preference-misc li:not(:last-child) {\n  padding-bottom: min(2dvh, 1dvw);\n}\n#mbs-preference-misc button {\n  height: min(9dvh, 4.5dvw);\n  width: 100%;\n}\n#mbs-preference-misc .button-label {\n  font-size: inherit;\n  left: calc(2% + min(90px, 9dvh, 4.5dvw));\n  width: calc(96% - min(90px, 9dvh, 4.5dvw));\n}\n#mbs-preference-misc .button-image {\n  height: min(90px, 9dvh, 4.5dvw);\n  left: 2%;\n  top: 50%;\n  transform: translateY(-50%);\n  width: min(90px, 9dvh, 4.5dvw);\n}\n\n#mbs-preference-reset {\n  grid-area: reset;\n  grid-template-columns: min(40dvh, 20dvw);\n}\n#mbs-preference-reset button:not(:hover) {\n  background-color: pink;\n}\n\n#mbs-preference-import {\n  grid-area: import;\n  grid-template-columns: min(19dvh, 9.5dvw);\n}\n\n#mbs-preference-export {\n  grid-area: export;\n  grid-template-columns: min(19dvh, 9.5dvw);\n}\n\n#mbs-preference-changelog {\n  grid-area: changelog;\n  grid-template-columns: min(40dvh, 20dvw);\n}\n\n#mbs-preference-reset-screen {\n  align-items: center;\n  background-color: rgba(0, 0, 0, 0.7);\n  z-index: 2;\n}\n\n#mbs-preference-reset-background {\n  background: url("https://bananarama92.github.io/MBS/main/images/SheetMBS.png") var(--mbs-background-color);\n  background-blend-mode: multiply;\n  background-position: center;\n  background-repeat: no-repeat;\n  background-size: contain;\n  box-sizing: border-box;\n  height: 80%;\n  justify-self: center;\n  mask-image: url("https://bananarama92.github.io/MBS/main/images/SheetMBS.png");\n  mask-position: center;\n  mask-repeat: no-repeat;\n  mask-size: contain;\n  padding: min(6dvh, 3dvw);\n  padding-top: min(3dvh, 1.5dvw);\n  position: relative;\n  width: 80%;\n  word-break: break-word;\n}\n\n#mbs-preference-reset-grid {\n  display: grid;\n  grid-template-columns: auto auto;\n  justify-items: center;\n  padding-top: min(10dvh, 5dvw);\n}\n#mbs-preference-reset-grid .button {\n  height: min(9dvh, 4.5dvw);\n  width: min(27dvh, 13.5dvw);\n}'.toString()}),E.jsx("h1",{id:zb.header,children:`Maid's Bondage Scripts ${t}`}),ElementMenu.Create(zb.menubar,[ElementButton.Create(zb.exit,this.exit.bind(this),{image:"Icons/Exit.png",tooltip:"Exit"})],{direction:"rtl"}),E.jsxs("main",{id:zb.settingsGrid,role:"form","aria-label":"Configure MBS",children:[E.jsxs("section",{"aria-labelledby":zb.wheelHeader,children:[E.jsx("h2",{id:zb.wheelHeader,children:"Wheel of fortune settings"}),E.jsxs("p",{class:"mbs-preference-settings-pair",children:[ElementButton.Create(zb.wheelButton,L(this,Ab,"m",Nb).bind(this),{image:"Icons/Crafting.png"},{button:{attributes:{"aria-labelledby":zb.wheelLabel}}}),E.jsx("span",{id:zb.wheelLabel,children:"Configure the wheel of fortune"})]}),E.jsxs("p",{class:"mbs-preference-settings-pair",children:[E.jsx("input",{type:"checkbox",class:"checkbox",name:"RollWhenRestrained",onClick:L(this,Ab,"m",$b).bind(this),"aria-labelledby":zb.rollRestrainedLabel}),E.jsx("span",{id:zb.rollRestrainedLabel,children:"Allow wheel rolling while restrained"})]}),E.jsxs("p",{class:"mbs-preference-settings-pair",children:[E.jsx("input",{type:"checkbox",class:"checkbox",name:"LockedWhenRestrained",onClick:L(this,Ab,"m",$b).bind(this),"aria-labelledby":zb.lockSettingsLabel}),E.jsx("span",{id:zb.lockSettingsLabel,children:"Lock MBS settings while restrained"})]})]}),E.jsxs("section",{"aria-labelledby":zb.garbleHeader,children:[E.jsx("h2",{id:zb.garbleHeader,children:"Garbling settings"}),E.jsxs("p",{class:"mbs-preference-settings-pair",children:[E.jsx("input",{type:"checkbox",class:"checkbox",name:"AlternativeGarbling",onClick:L(this,Ab,"m",$b).bind(this),"aria-labelledby":zb.garbleLabel}),E.jsxs("span",{id:zb.garbleLabel,children:[E.jsxs("p",{children:[E.jsx("strong",{children:"Experimental"}),": whether gags will use an alternative form of, more phonetically accurate, speech garbling based on ",E.jsx("a",{href:"https://github.com/CordeliaMist/Dalamud-GagSpeak",target:"_blank",children:"Dalamud-GagSpeak"})]}),E.jsxs("p",{children:["Incompatible-ish with ",E.jsx("a",{href:"https://wce-docs.vercel.app/docs/intro",target:"_blank",children:"WCE/FBC"}),"'s garbling anti-cheat as of the moment"]})]})]}),E.jsxs("p",{class:"mbs-preference-settings-pair",children:[E.jsx("input",{type:"checkbox",class:"checkbox",name:"DropTrailing",onClick:L(this,Ab,"m",$b).bind(this),"aria-labelledby":zb.garbleTrailingLabel}),E.jsx("span",{id:zb.garbleTrailingLabel,children:"Whether to heaviest gags will drop up to half of all trailing characters when alternate garbling is enabled"})]}),E.jsxs("p",{class:"mbs-preference-settings-pair",children:[E.jsx("input",{type:"checkbox",class:"checkbox",name:"GarblePerSyllable",onClick:L(this,Ab,"m",$b).bind(this),"aria-labelledby":zb.garbleSyllableLabel}),E.jsx("span",{id:zb.garbleSyllableLabel,children:"Interpolate between the three alternative garbling levels, allowing for a more gradual increase in garbling strength (on a syllable by syllable basis) as the gag level increases"})]})]}),E.jsxs("section",{"aria-labelledby":zb.miscHeader,children:[E.jsx("h2",{id:zb.miscHeader,children:"Misc settings"}),E.jsxs("div",{class:"mbs-preference-settings-pair",children:[E.jsx("input",{type:"checkbox",class:"checkbox",name:"ShowChangelog",onClick:L(this,Ab,"m",$b).bind(this),"aria-labelledby":zb.changelogLabel}),E.jsx("span",{id:zb.changelogLabel,children:"Show the MBS changelog in chat whenever a new MBS version is released"})]})]})]}),E.jsxs("menu",{id:zb.miscGrid,children:[E.jsx("li",{children:ElementButton.Create(zb.resetButton,L(this,Ab,"m",Tb).bind(this),{image:"Icons/ServiceBell.png",label:"Reset MBS",tooltip:"Clear all MBS data",labelPosition:"center"})}),E.jsx("li",{children:ElementButton.Create(zb.import,L(this,Ab,"m",Fb).bind(this),{image:"Icons/Upload.png",label:"Import",tooltip:"Import MBS settings",labelPosition:"center"})}),E.jsx("li",{children:ElementButton.Create(zb.export,L(this,Ab,"m",Lb).bind(this),{image:"Icons/Download.png",label:"Export",tooltip:"Export MBS settings",labelPosition:"center"})}),E.jsx("li",{children:ElementButton.Create(zb.changelog,()=>open(Zh(),"_blank"),{image:"Icons/Changelog.png",label:"Latest Changes",tooltip:"Open the MBS changelog",labelPosition:"center"})})]})]})),document.body.appendChild(E.jsx("div",{id:zb.resetScreen,class:"mbs-screen","screen-generated":Kb.screen,children:E.jsxs("div",{id:zb.resetBackground,children:[E.jsx("h1",{children:"MBS data reset"}),E.jsx("p",{children:E.jsx("strong",{children:"- Warning -"})}),E.jsxs("p",{children:["If you confirm, ",E.jsx("i",{children:"all"})," MBS data (including settings, overrides, and current states) will be permanently reset!"]}),E.jsx("p",{children:"You will be able to continue using MBS, but all of your configuration will be reset to default!"}),E.jsx("p",{children:E.jsx("strong",{children:"This action cannot be undone!"})}),E.jsxs("div",{id:zb.resetGrid,children:[ElementButton.Create(zb.resetAccept,()=>L(this,Ab,"m",Hb).call(this),{disabled:!0,label:"Confirm (10)"}),ElementButton.Create(zb.resetCancel,()=>this.exit(),{label:"Cancel"})]})]})}))}async load(){L(this,Ab,"m",Gb).call(this),super.load()}draw(){DrawCharacter(Player,50,50,.9)}exit(){const e=document.getElementById(zb.resetScreen);e.hidden?(super.exit(),this.exitScreens(!1)):e.hidden=!0}}let Ub;var Vb,Jb,Yb;Ab=new WeakSet,$b=function(e){const t=e.target.name;if(t in Player.MBSSettings)switch(Player.MBSSettings[t]=!Player.MBSSettings[t],Ib([Cb.SETTINGS]),t){case"AlternativeGarbling":Player.MBSSettings[t]&&pb.init();break;case"LockedWhenRestrained":L(this,Ab,"m",Gb).call(this)}},Fb=function(){const e=prompt("Please paste MBS settings.\nImporting settings will overwrite existing settings. Are you sure?");if(!e)return;const t=function(e){Ph.log("Importing new MBS settings");let t=null,n=null;try{t=JSON.parse(LZString.decompressFromBase64(e.trim())||"{}")}catch(e){n=e}if(n||null===t||"object"!=typeof t||Sh(t))return Ph.error("Aborting, failed to parse corrupted MBS settings",n),{status:Ob.ERROR,ok:!1};if(0===Object.keys(t).length)return Ph.error("Aborting, detected empty or corrupted MBS settings"),{status:Ob.EMPTY_SETTINGS,ok:!1};const r=Eb(t,!1);return r.ok?(Ib([Cb.SETTINGS,Cb.SHARED],!0),jb(),{status:Ob.OK,...r}):{status:Ob.WARN,...r}}(e);switch(t.status){case Ob.OK:return Ph.log("Settings successfully updated"),alert("Settings successfully updated!");case Ob.ERROR:return alert("ERROR: Detected corrupted MBS settings.\nNo changes were made.");case Ob.EMPTY_SETTINGS:return alert("ERROR: Detected empty or corrupted MBS settings.\nNo changes were made.");case Ob.WARN:return void(confirm("WARNING: MBS successfully parsed the settings but found one or more invalid fields; please check the browser console for more details.\nAre you sure you want to continue?")&&(Player.MBSSettings=t.settings,Ib([Cb.SETTINGS,Cb.SHARED],!0),jb(),Ph.log("Settings successfully updated"),alert("Settings successfully updated!")));default:throw new Error(`Unknown status type: ${t.status}`)}},Lb=function(){const e=LZString.compressToBase64(JSON.stringify(Player.MBSSettings));navigator.clipboard.writeText(e),alert("MBS settings copied to clipboard.")},Tb=function(){const e=document.getElementById(zb.resetScreen),t=document.getElementById(zb.resetAccept);e.hidden=!1,t.disabled=!0,L(this,Ab,"m",Db).call(this,t)},Db=async function(e){const t=e.querySelector(".button-label");let n=9;for(;n>=0;)await new Promise(e=>setTimeout(e,1e3)),t?.replaceChildren(`Confirm (${n})`),n--;t?.replaceChildren("Confirm"),e.disabled=!1},Hb=function(){Mb(),this.exit()},Nb=async function(){const e={FortuneWheelItemSets:_p(Player,"FortuneWheelItemSets","item sets"),FortuneWheelCommands:_p(Player,"FortuneWheelCommands","commands")},[t,n,r,i]=this.screenParams[this.ids.root].shape,o={[Mp.ids.root]:{shape:[95,n,r+(t-95),i]}};this.loadChild(Mp,e,Player,o)},Gb=function(){const e=Player.IsRestrained()&&Player.MBSSettings.LockedWhenRestrained;for(const t of document.querySelectorAll(`#${zb.settingsGrid} input[type="checkbox"]`))t.name in Player.MBSSettings&&(t.checked=Player.MBSSettings[t.name],t.disabled=e)},Kb.screen="MBS_PreferenceScreen",Kb.ids=zb,Kb.screenParamsDefault={[qb]:Object.freeze({shape:[525,75,1380,850],visibility:"visible"}),[zb.resetScreen]:Object.freeze({shape:[0,0,2e3,1e3],visibility:"hidden"})},Fh("settings_screen",{async afterMBS(){Ub=new Wb,PreferenceRegisterExtensionSetting({Identifier:"MBS",load(){Ub.loadChild(Kb)},run(){},click(){},exit(){},ButtonText:"MBS Settings",Image:"Icons/Maid.png"})}});const Xb=32,Zb=8,Qb=Object.freeze(["Blue","Gold","Gray","Green","Orange","Purple","Red","Yellow"]);function eR(e){if(null===e||"object"!=typeof e)throw new TypeError('Invalid "character" type: '+typeof e);if(!e.IsSimple()&&!e.IsPlayer())throw new Error("Expected a simple or player character")}function tR(e){if(!(e.OnlineSharedSettings?.BlockBodyCosplay??!0))return!0;const t=Uh.getRuleState("alt_allow_changing_appearance");return!(null===t||!e.IsPlayer())&&(t.inEffect&&t.isEnforced&&(t.customData?.minimumRole??-1)>3)}function nR(e){if("string"!=typeof e)throw new TypeError('Invalid "IDs" type: '+typeof e);let t="";for(const n of WheelFortuneOption)e.includes(n.ID)&&(t+=n.ID);return t}function rR(){return"undefined"!=typeof Player&&void 0!==Player.MBSSettings}const iR=Object.freeze({"PSO Bondage":0,Mummification:1,"Bondage Maid":2,Petrification:3});class oR{constructor(e,t){this.name=null,this.mbsList=e,this.weight=Number.isInteger(t)?$i(t,1,9):1}reset(){this.name=null,this.weight=1}isValid(e=null){return!!this.name&&this.mbsList.every((t,n)=>n===e||t?.name!==this.name)}toString(){return Mh(typeof this,this.toJSON())}}class aR extends oR{get stripLevel(){return this.stripIter.value}set stripLevel(e){const t=this.stripIter.list.indexOf(e);this.stripIter.setPosition(t)}get equipLevel(){return this.equipIter.value}set equipLevel(e){const t=this.equipIter.list.indexOf(e);this.equipIter.setPosition(t)}constructor(e,t){super(e,t),this.itemList=null,this.flags=Object.freeze(If.map(e=>Object.seal({...e}))),this.outfitCache=null,this.stripIter=new Vh([Tf.NONE,Tf.CLOTHES,Tf.UNDERWEAR,Tf.COSPLAY],Tf.UNDERWEAR),this.equipIter=new Vh([Tf.NONE,Tf.CLOTHES,Tf.UNDERWEAR,Tf.COSPLAY],Tf.UNDERWEAR),this.activeHooks=new Map}reset(){super.reset(),this.itemList=null,this.outfitCache=null,this.stripLevel=Tf.UNDERWEAR,this.equipLevel=Tf.UNDERWEAR,this.activeHooks.clear(),If.forEach((e,t)=>Object.assign(this.flags[t],e))}readSettings(e){if(!(e instanceof cR))throw new TypeError('Invalid "ItemSet" type: '+typeof e);this.name=e.name,this.itemList=e.itemList,this.stripLevel=e.stripLevel,this.equipLevel=e.equipLevel,this.outfitCache=null,this.weight=e.weight,this.activeHooks.clear();for(const[t,n]of Object.entries(e.activeHooks))this.activeHooks.set(t,{...n,kwargs:new Map(Object.entries(n.kwargs))});e.flags.forEach((e,t)=>Object.assign(this.flags[t],e))}writeSettings(e=!1){let t=this.name;if(e&&(t??="preview"),null===t||null===this.itemList)throw new Error('Cannot create an ItemSet while "name" or "itemList" is null');const n={};for(const[e,t]of this.activeHooks)n[e]={...t,kwargs:Object.fromEntries(t.kwargs),get kwargsConfig(){return Bf.get(this.modName,this.hookType,this.hookName)?.kwargs??{}}};return new cR(t,this.itemList,this.mbsList,this.stripLevel,this.equipLevel,this.flags,!0,this.weight,n)}loadFromBase64(){if(null===this.outfitCache)return!1;let e,t;try{e=JSON.parse(LZString.decompressFromBase64(this.outfitCache.trim())),t=function(e){if(!Sh(e)){if(null===e||"object"!=typeof e)throw new TypeError('Invalid "items" type: '+typeof e);e=[e]}const t=[],n=new Map,r=new Set;return e.forEach((e,i)=>{let o=null;try{o=AssetGet("Female3DCG",e.Group,e.Name);const n=Qf(o,e);!r.has(e.Group)&&null!=o&&(o.Group.IsItem()||o.Group.IsAppearance()&&o.Group.AllowNone)&&(r.add(e.Group),t.push(n))}catch(e){let t=`${o?.Group?.Name}${o?.Name}`;t.includes("undefined")&&(t=`Item ${i}`),n.set(t,e)}}),0!==n.size&&Ph.log(`Failed to parse ${n.size} of the provided items`,n),t}(e)}catch(e){return Ph.warn("Failed to parse outfit code:",e),!1}return 0!==t.length&&(this.itemList=Object.freeze(function(e,t=Df){const n=Gf(e,t);return Dc(e,e=>n.get(e.Group)?.priority??1/0)}(t)),!0)}isValid(e=null){return super.isValid(e)&&null!==this.itemList&&this.flags.some(e=>e.enabled)}toJSON(){const e={};for(const[t,n]of this.activeHooks){const r={};for(const[e,t]of n.kwargs)if("select-multiple"===t.type)r[e]={...t,value:Array.from(t.value)};else r[e]=t;e[t]={...n,kwargs:r}}return{name:this.name,itemList:this.itemList,stripLevel:this.stripLevel,equipLevel:this.equipLevel,flags:this.flags,outfitCache:this.outfitCache,activeHooks:e}}}class sR extends oR{readSettings(e){if(!(e instanceof dR))throw new TypeError('Invalid "command" type: '+typeof e);this.name=e.name,this.weight=e.weight}writeSettings(){if(null===this.name)throw new Error('Cannot create a Command while "name" is null');return new dR(this.name,this.mbsList,this.weight)}toJSON(){return{name:this.name}}}class lR{get children(){return L(this,Vb,"f")}get index(){return this.mbsList.findIndex(e=>e===this)}constructor(e,t,n,r){Vb.set(this,null),this.name=e,this.custom=t,this.mbsList=n,this.weight=r}static validate(e){throw new Error("Trying to call an abstract method")}static fromObject(...e){throw new Error("Trying to call an abstract method")}register(){T(this,Vb,this.toOptions(),"f")}unregister(){T(this,Vb,null,"f")}toString(){return Mh(typeof this,this.toJSON())}}Vb=new WeakMap;class uR extends lR{constructor(){super(...arguments),Jb.add(this)}register(e=!0){super.register();let t=L(this,Jb,"m",Yb).call(this);for(const e of this.children){const n=WheelFortuneOption.findIndex(t=>t.ID===e.ID);-1!==n?(WheelFortuneOption[n]=e,e.Default&&!WheelFortuneDefault.includes(e.ID)&&(WheelFortuneDefault+=e.ID)):(WheelFortuneOption.splice(t,0,e),e.Default&&(WheelFortuneDefault+=e.ID)),t+=1}e&&Ib([Cb.SHARED])}unregister(e=!0){const t=this.children?.map(e=>e.ID)??[];super.unregister(),WheelFortuneOption=WheelFortuneOption.filter(e=>!t.includes(e.ID)),WheelFortuneDefault=Array.from(WheelFortuneDefault).filter(e=>!t.includes(e)).join(""),e&&Ib([Cb.SHARED])}}Jb=new WeakSet,Yb=function(){if(this.children?.length){const e=this.children[0].ID,t=WheelFortuneOption.findIndex(t=>t.ID>=e);return-1===t?WheelFortuneOption.length:t}return WheelFortuneOption.length};class cR extends uR{constructor(e,t,n,r,i,o,a,s,l){const u=cR.validate({name:e,itemList:t,mbsList:n,stripLevel:r,equipLevel:i,flags:o,custom:a,weight:s,activeHooks:l});super(u.name,u.custom,u.mbsList,u.weight),this.itemList=u.itemList,this.stripLevel=u.stripLevel,this.equipLevel=u.equipLevel,this.flags=u.flags,this.activeHooks=u.activeHooks}static validate(e){if("string"!=typeof e.name)throw new TypeError('Invalid "name" type: '+typeof e.name);if(!Sh(e.itemList))throw new TypeError('Invalid "itemList" type: '+typeof e.itemList);{const t=[],n=[];for(let r of e.itemList){const e=AssetGet("Female3DCG",r.Group,r.Name);null!=e?(e.Group.IsItem()||e.Group.IsAppearance()&&e.Group.AllowNone)&&(r.TypeRecord||void 0===r.Type||(r=Object.freeze({...bu(r,"Type"),TypeRecord:ExtendedItemTypeToRecord(e,r.Type)})),t.push(r)):n.push(`${r.Group}:${r.Name}`)}e.itemList=Object.freeze(t),0!==n.length&&Ph.warn(`Found ${n.length} items in wheel of fortune item set "${this.name}": ${n}`)}if(!Sh(e.mbsList))throw new TypeError('Invalid "mbsList" type: '+typeof e.mbsList);if(_h(Object.values(Tf),e.stripLevel)||(e.stripLevel=Tf.UNDERWEAR),_h(Object.values(Tf),e.equipLevel)||(e.stripLevel=Tf.UNDERWEAR),Sh(e.flags)){let t;if(e.flags.every(e=>"string"==typeof e)){t=function(e){return If.map((t,n)=>{const r={...t};return r.enabled=e.includes(Mf[n]),r})}(e.flags)}else t=function(e){return If.map((t,n)=>{const r=e[n];if(null===r||"object"!=typeof r||r.type!==t.type)return{...t};const i="boolean"==typeof r.enabled?r.enabled:t.enabled;switch(r.type){case"TimerPasswordPadlock":return Number.isInteger(r.time)&&r.time>=1&&r.time<=86400?{type:r.type,description:t.description,time:r.time,enabled:i}:{...t};case"ExclusivePadlock":case"HighSecurityPadlock":case null:return{type:r.type,description:t.description,enabled:i};default:return{...t}}})}(e.flags);t.every(e=>!e.enabled)&&(t[0].enabled=!0),e.flags=Object.freeze(t.map(e=>Object.freeze(e)))}else e.flags=If;return"boolean"!=typeof e.custom&&(e.custom=!0),Number.isInteger(e.weight)?e.weight=$i(e.weight,1,9):e.weight=1,CommonIsObject(e.activeHooks)?e.activeHooks=function(e,t){const n={};for(const r of Object.values(e))if(CommonIsObject(r)&&"string"==typeof r.hookName&&"string"==typeof r.hookType&&"string"==typeof r.modName&&"object"==typeof r.kwargs&&null!==r.kwargs){const e={},i=t[r.hookType]?.find(e=>e.hookName===r.hookName&&e.hookType===r.hookType)?.kwargs??{};for(const[t,n]of Object.entries(r.kwargs)){const r=n,o=i[t];if(!CommonIsObject(r))continue;let a;switch(r.type){case"select":a=kf(r,o);break;case"select-multiple":a=Cf(r,o);break;case"checkbox":a=_f(r,o);break;case"text":a=Pf(r,o);break;case"number":a=xf(r,o)}null!=a&&(e[t]=a)}n[`${r.modName}-${r.hookType}-${r.hookName}`]=Object.freeze({...r,kwargs:e,get kwargsConfig(){return Bf.get(r.modName,r.hookType,r.hookName)?.kwargs??{}}})}return n}(e.activeHooks,Bf):e.activeHooks={},e}static fromObject(e,t){const n=[t.name,t.itemList,e,t.stripLevel,t.equipLevel,t.flags,t.custom,t.weight,t.activeHooks];return new cR(...n)}scriptFactory(e,t){const n=this.itemList.map(({Name:e,Group:t})=>AssetGet(Player.AssetFamily,t,e));return r=>{r??=Player;const i=WheelFortuneCharacter??r,o=Hf(this.equipLevel,r),a=this.itemList.filter((e,t)=>{const r=n[t];return null!=r&&("Appearance"!==r.Group.Category||o(r))});Kf(this.name,a,this.stripLevel,r,t,e,i)}}getIDs(){const e=[];for(const[t,n]of this.flags.entries())n.enabled&&e.push(t);let t;if(this.custom){if(t=256*(2+Math.floor(this.index/16))+16*this.index,t<0)throw new Error(`Item set "${this.name}" absent from currently selected fortune wheel sets`)}else if(t=256+16*iR[this.name],Number.isNaN(t))throw new Error(`Unknown default item set "${this.name}"`);return Jh(t,e)}toOptions(){const e=this.flags.filter(e=>e.enabled),t=this.getIDs();return e.map((e,n)=>{const r=null===e.type?this.name:`${this.name}: ${Lf(e)}`;let i=!0;switch(e.type){case"HighSecurityPadlock":case null:i=!1;break;case"TimerPasswordPadlock":i=4!==n}return{ID:t[n],Color:Ic(Qb),Script:this.scriptFactory(e,this.activeHooks),Description:r,Default:i,Custom:this.custom,Parent:this,Flag:e,Weight:this.weight}})}toJSON(){const e={};for(const[t,n]of Object.entries(this.activeHooks)){const r={};for(const[e,t]of Object.entries(n.kwargs))if("select-multiple"===t.type)r[e]={...t,value:Array.from(t.value)};else r[e]=t;e[t]={...n,kwargs:r}}return{name:this.name,itemList:this.itemList,stripLevel:this.stripLevel,equipLevel:this.equipLevel,flags:this.flags,custom:this.custom,weight:this.weight,activeHooks:e}}}class dR extends uR{constructor(e,t,n){const r=dR.validate({name:e,mbsList:t,weight:n});super(r.name,!0,r.mbsList,r.weight)}static validate(e){if("string"!=typeof e.name)throw new TypeError('Invalid "name" type: '+typeof e.name);if(!Array.isArray(e.mbsList))throw new TypeError('Invalid "mbsList" type: '+typeof e.mbsList);return Number.isInteger(e.weight)?e.weight=$i(e.weight,1,9):e.weight=1,e}static fromObject(e,t){const n=[t.name,e,t.weight];return new dR(...n)}toOptions(){const[e]=this.getIDs();return[{ID:e,Color:Ic(Qb),Description:this.name,Default:!0,Custom:this.custom,Parent:this,Script:void 0,Flag:void 0,Weight:this.weight}]}getIDs(){const e=256*(3+Math.floor(this.index/16))+this.index;return[String.fromCharCode(e)]}toJSON(){return{name:this.name,weight:this.weight}}}let hR=null;function fR(){return null===hR&&(hR=CharacterLoadSimple("MBSAPI")),hR}var pR=Object.freeze({__proto__:null,getAll:function(){if(!rR())return Ph.error("MBS not fully loaded yet"),{};const e=Player.MBSSettings.FortuneWheelItemSets,t={};for(const[n,r]of e.entries())null!==r&&(t[r.name]={name:r.name,index:n,items:ep(r.itemList,fR())});return t},getByIndex:function(e){if("number"!=typeof e)throw new TypeError('Invalid "index" type: '+typeof e);if(!rR())return void Ph.error("MBS not fully loaded yet");const t=Player.MBSSettings.FortuneWheelItemSets[e];return null==t?void 0:{name:t.name,index:e,items:ep(t.itemList,fR())}},getByName:function(e){if("string"!=typeof e)throw new TypeError('Invalid "name" type: '+typeof e);if(!rR())return void Ph.error("MBS not fully loaded yet");let t=-1;const n=Player.MBSSettings.FortuneWheelItemSets.find((n,r)=>{const i=n?.name===e;return i&&(t=r),i});return null==n?void 0:{name:e,index:t,items:ep(n.itemList,fR())}},getIndices:function(){return rR()?Player.MBSSettings.FortuneWheelItemSets.filter(e=>null!==e).map((e,t)=>t):(Ph.error("MBS not fully loaded yet"),[])},getNames:function(){return rR()?Player.MBSSettings.FortuneWheelItemSets.filter(e=>null!==e).map(e=>e.name):(Ph.error("MBS not fully loaded yet"),[])}});const gR=Object.freeze({backgroundColor:"--mbs-background-color",buttonColor:"--mbs-button-color",buttonHoverColor:"--mbs-hover-color",tooltipColor:"--mbs-tooltip-color",borderColor:"--mbs-border-color",textColor:"--mbs-text-color"}),mR=Object.freeze({backgroundColor:"white",buttonColor:"white",buttonHoverColor:"cyan",tooltipColor:"lightyellow",borderColor:"black",textColor:"black"});var vR=Object.freeze({__proto__:null,DEFAULT_STYLE:mR,getStyle:function(){const e=document.querySelector(":root");return e?Ch(kh(gR).map(([t,n])=>[t,e.style.getPropertyValue(n)||mR[t]])):(Ph.error(":root selector missing in document"),{...mR})},setStyle:function(e){if("object"!=typeof e)throw new TypeError(`Invalid style type: "${typeof e}"`);if(null===e)throw new Error("Invalid style value: null");const t=document.querySelector(":root");if(t)for(const[n,r]of kh(gR)){const i=e[n];void 0!==i&&t.style.setProperty(r,i)}else Ph.error(":root selector missing in document")}});const yR=Object.freeze(new Set(["beforeOutfitEquip","validateItemEquip","beforeItemEquip","afterItemEquip","afterOutfitEquip"]));var bR=Object.freeze({__proto__:null,addEventListener:function(e,t,n){if(!yR.has(e))throw new Error(`Invalid hook type "${e}"`);const r=wh.getModsInfo().find(e=>e.name===t);if(!r)throw new Error(`Addon "${t}" is not registered in bcModSdk`);if("mbs"===t.normalize().toLowerCase())throw new Error('Cannot register event listener to addon "MBS"');const i={...Rf.pick(n,"listener","hookName","label","description","kwargs"),conditional:!0,showConfig:!0};Bf.addEventListener(e,r,i)},listEventListeners:function(){const e={};for(const t of Bf.values()){const n=t.hookType;yR.has(t.hookType)&&(e[t.registrationData.name]??={},(e[t.registrationData.name][n]??=new Set).add(t.hookName))}return e}});const RR=Object.freeze({major:1,minor:5});function wR(e,t){return t instanceof Set?Array.from(t):t instanceof Map?Object.fromEntries(t):t instanceof Error?{...t}:t instanceof Date?t.toString():t}const SR=function(){return rR()?JSON.stringify({log:Ph,settings:Player.MBSSettings},wR,4):JSON.stringify({log:Ph,settings:"ERROR: MBS not fully loaded yet"},void 0,4)};Fh("api",{async afterLogin(){"undefined"!=typeof FUSAM&&"function"==typeof FUSAM.registerDebugMethod&&FUSAM.registerDebugMethod("mbs",SR)}});const BR="raises",kR="passes";function CR(e,t,n){if(!t)throw void 0===n?new Error(`${e}`):new Error(`${e}: ${n}`)}function _R(e,t,n){try{t()}catch(t){const r=t;if(r?.message!==n)throw new Error(`${e}: Invalid error message\nExpected error: "${n}"\nObserved error: "${r?.message}"`);return}throw new Error(`${e}: Failed to raise an error`)}function xR(e,t){try{return t()}catch(t){throw new Error(`${e}: Unexpected error message: ${t}`,{cause:t})}}function PR(e,t,n,r){if(r=r??jR,!Hl(t,n))throw new Error(`${e}: Passed objects not equal:\nObserved: ${r(t)}\nExpected: ${r(n)}`)}function ER(e,t,n){if(typeof t!==n)throw new Error(`${e}: Invalid object type "${typeof t}", expected "${n}"`)}function MR(e,t,n){if(t.length!==n)throw new Error(`${e}: Invalid object length ${t.length}, expected ${n}`)}function IR(e,t){switch(typeof t){case"undefined":return"__UNDEFINED__";case"function":return"__FUNCTION__";case"symbol":return"__SYMBOL__";default:return t}}function jR(e){return JSON.stringify(e,IR,1)}var OR=Object.freeze({__proto__:null,test_LoopIterator:function(){const e="test_LoopIterator";[{args:[void 0],excMessage:'Invalid "iterable" type: undefined'},{args:[[]],excMessage:'Passed "iterable" must contain at least one element'},{args:[[1],.5],excMessage:'"index" must be an integer: 0.5'},{args:[[0,1],3],excMessage:'"index" must fall in the [0, 1] interval: 3'}].forEach(({args:t,excMessage:n},r)=>{_R(`${e}:constructor:${BR}:${r}`,()=>new Vh(...t),n)});const t=new Vh([0,1,2,3],0);let n;PR(`${e}:list:${kR}:0`,t.list,[0,1,2,3]),PR(`${e}:index:${kR}:0`,t.index,0),PR(`${e}:value:${kR}:0`,t.index,0),ER(`${e}:[Symbol.iterator]:${kR}:0`,t[Symbol.iterator],"function"),n=xR(`${e}:next:${kR}:0`,()=>t.next(!1)),PR(`${e}:next:${kR}:0`,n,1),PR(`${e}:next:${kR}:0`,t.index,0),n=xR(`${e}:next:${kR}:0`,()=>t.next()),PR(`${e}:next:${kR}:0`,n,1),PR(`${e}:next:${kR}:0`,t.index,1),_R(`${e}:setPosition:${BR}:0`,()=>t.setPosition(10),'"index" must fall in the [0, 3] interval: 10'),xR(`${e}:setPosition:${kR}:0`,()=>t.setPosition(0)),PR(`${e}:setPosition:${kR}:0`,t.index,0),n=xR(`${e}:previous:${kR}:0`,()=>t.previous(!1)),PR(`${e}:previous:${kR}:0`,n,3),PR(`${e}:previous:${kR}:0`,t.index,0),n=xR(`${e}:previous:${kR}:0`,()=>t.previous()),PR(`${e}:previous:${kR}:0`,n,3),PR(`${e}:previous:${kR}:0`,t.index,3),n=xR(`${e}:toString:${kR}:0`,()=>t.toString()),ER(`${e}:toString:${kR}:0`,n,"string"),n=xR(`${e}:toJSON:${kR}:0`,()=>t.toJSON()),PR(`${e}:toJSON:${kR}:0`,t.toJSON(),{list:[0,1,2,3],index:3})},test_MBS_VERSION:function(){ER(`test_MBS_VERSION:${kR}:0`,t,"string")},test_Version:function(){const e="test_Version";[{args:["bob",0,0,!1],excMessage:'Invalid "major" type: string'},{args:[0,"bob",0,!1],excMessage:'Invalid "minor" type: string'},{args:[0,0,"bob",!1],excMessage:'Invalid "micro" type: string'},{args:[0,0,0,"bob"],excMessage:'Invalid "beta" type: string'}].forEach(({args:t,excMessage:n},r)=>{_R(`${e}:constructor:${BR}:${r}`,()=>new jh(...t),n)});const t=new jh(1,0,5),n=new jh(2,3,1),r=new jh(0,99,5,!0);PR(`${e}:major:${kR}:0`,t.major,1),PR(`${e}:minor:${kR}:0`,t.minor,0),PR(`${e}:micro:${kR}:0`,t.micro,5),PR(`${e}:beta:${kR}:0`,t.beta,!1),CR(`${e}:equal:${kR}:0`,!t.equal(null)),CR(`${e}:equal:${kR}:1`,t.equal(t)),CR(`${e}:equal:${kR}:2`,!t.equal(n)),CR(`${e}:equal:${kR}:3`,!t.equal(r)),CR(`${e}:greater:${kR}:0`,!t.greater(null)),CR(`${e}:greater:${kR}:1`,!t.greater(t)),CR(`${e}:greater:${kR}:2`,!t.greater(n)),CR(`${e}:greater:${kR}:3`,t.greater(r)),CR(`${e}:lesser:${kR}:0`,!t.lesser(null)),CR(`${e}:lesser:${kR}:1`,!t.lesser(t)),CR(`${e}:lesser:${kR}:2`,t.lesser(n)),CR(`${e}:lesser:${kR}:3`,!t.lesser(r)),CR(`${e}:greaterOrEqual:${kR}:0`,!t.greaterOrEqual(null)),CR(`${e}:greaterOrEqual:${kR}:1`,t.greaterOrEqual(t)),CR(`${e}:greaterOrEqual:${kR}:2`,!t.greaterOrEqual(n)),CR(`${e}:greaterOrEqual:${kR}:3`,t.greaterOrEqual(r)),CR(`${e}:lesserOrEqual:${kR}:0`,!t.lesserOrEqual(null)),CR(`${e}:lesserOrEqual:${kR}:1`,t.lesserOrEqual(t)),CR(`${e}:lesserOrEqual:${kR}:2`,t.lesserOrEqual(n)),CR(`${e}:lesserOrEqual:${kR}:3`,!t.lesserOrEqual(r));let i=xR(`${e}:fromVersion:${kR}:0`,()=>jh.fromVersion("1.0.5"));PR(`${e}:fromVersion:${kR}:0`,i,t),_R(`${e}:fromVersion:${BR}:0`,()=>jh.fromVersion(void 0),'Invalid "version": undefined'),i=xR(`${e}:fromVersion:${kR}:0`,()=>jh.fromBCVersion("R109Beta3")),PR(`${e}:fromVersion:${kR}:0`,i,new jh(109,0,0,!0)),_R(`${e}:fromVersion:${BR}:0`,()=>jh.fromVersion(void 0),'Invalid "version": undefined'),i=xR(`${e}:toString:${kR}:0`,()=>t.toString()),ER(`${e}:toString:${kR}:0`,i,"string"),i=xR(`${e}:toJSON:${kR}:0`,()=>t.toJSON()),PR(`${e}:toJSON:${kR}:0`,i,{major:1,minor:0,micro:5,beta:!1})},test_generateIDs:function(){const e="test_generateIDs";[{args:[0,void 0],excMessage:'Invalid "indices" type: undefined'},{args:[65535,[5]],excMessage:'"stop" must fall in the [65536, 65535] interval: 65541'}].forEach(({args:t,excMessage:n},r)=>{_R(`${e}:${BR}:${r}`,()=>Jh(...t),n)}),[{args:[80,[0,4,6]],output:["P","T","V"]},{args:[1024,[0,4,1]],output:["Ѐ","Є","Ё"]},{args:[0,[]],output:[]}].forEach(({args:t,output:n},r)=>{const i=xR(`${e}:${kR}:${r}`,()=>Jh(...t));PR(`${e}:${kR}:${r}`,i,n)})},test_getRandomPassword:function(){const e="test_getRandomPassword";[{args:[void 0],excMessage:'Invalid "n" type: undefined'}].forEach(({args:t,excMessage:n},r)=>{_R(`${e}:${BR}:${r}`,()=>qh(...t),n)}),wc(0,9).forEach(t=>{const n=xR(`${e}:${kR}:${t}`,()=>qh(t));ER(`${e}:${kR}:${t}`,n,"string"),MR(`${e}:${kR}:${t}`,n,t)})},test_isIterable:function(){const e="test_isIterable";[{args:[null],output:!1},{args:[1],output:!1},{args:[[1]],output:!0},{args:[new Set],output:!0}].forEach(({args:t,output:n},r)=>{const i=xR(`${e}:${kR}:${r}`,()=>Yh(...t));PR(`${e}:${kR}:${r}`,i,n)})},test_padArray:function(){const e="test_padArray";[{args:[[],.5,null],excMessage:'"n" must be an integer: 0.5'},{args:[void 0,5,null],excMessage:'Invalid "list" type: undefined'}].forEach(({args:t,excMessage:n},r)=>{_R(`${e}:${BR}:${r}`,()=>Gh(...t),n)}),[{args:[["a","b","c"],5,"test"],output:["a","b","c","test","test"]},{args:[["a","b","c"],2,"test"],output:["a","b","c"]}].forEach(({args:t,output:n},r)=>{const i=xR(`${e}:${kR}:${r}`,()=>Gh(...t));PR(`${e}:${kR}:${r}`,i,n)})},test_trimArray:function(){const e="test_trimArray";[{args:[[],.5],excMessage:'"n" must be an integer: 0.5'},{args:[void 0,5],excMessage:'Invalid "list" type: undefined'}].forEach(({args:t,excMessage:n},r)=>{_R(`${e}:${BR}:${r}`,()=>Wh(...t),n)}),[{args:[["a","b","c"],1],output:["a"]},{args:[["a","b","c"],4],output:["a","b","c"]}].forEach(({args:t,output:n},r)=>{const i=xR(`${e}:${kR}:${r}`,()=>Wh(...t));PR(`${e}:${kR}:${r}`,i,n)})},test_validateInt:function(){const e="test_validateInt";[{args:[.5,"test"],excMessage:'"test" must be an integer: 0.5'},{args:["test","test"],excMessage:'Invalid "test" type: string'},{args:[5,"test",10],excMessage:'"test" must fall in the [10, Infinity] interval: 5'},{args:[5,"test",0,3],excMessage:'"test" must fall in the [0, 3] interval: 5'}].forEach(({args:t,excMessage:n},r)=>{_R(`${e}:${BR}:${r}`,()=>Eh(...t),n)}),xR(`${e}:${kR}:0`,()=>Eh(0,"test"))}});var AR=Object.freeze({__proto__:null,test_FORTUNE_WHEEL_COLORS:function(){const e="test_FORTUNE_WHEEL_COLORS";CR(`${e}:${kR}:0`,Array.isArray(Qb)),CR(`${e}:${kR}:0`,Qb.every(e=>"string"==typeof e))},test_FORTUNE_WHEEL_MAX_SETS:function(){const e="test_FORTUNE_WHEEL_MAX_SETS";ER(`${e}:${kR}:0`,Xb,"number"),CR(`${e}:${kR}:0`,Number.isInteger(Xb)),CR(`${e}:${kR}:0`,Xb>=0)},test_canChangeCosplay:function(){const e="test_canChangeCosplay",t=wc(0,3).map(t=>`${e}${t}`),n=t.map(e=>{const t=CharacterLoadSimple(e);return t.OnlineSharedSettings=t.OnlineSharedSettings??{},t});try{n[1].OnlineSharedSettings={...n[1].OnlineSharedSettings??{},BlockBodyCosplay:!1},n[2].OnlineSharedSettings={...n[1].OnlineSharedSettings??{},BlockBodyCosplay:!0};[{args:[n[0]],output:!1},{args:[n[1]],output:!0},{args:[n[2]],output:!1}].forEach(({args:t,output:n},r)=>{const i=xR(`${e}:${kR}:${r}`,()=>tR(...t));PR(`${e}:${kR}:${r}`,i,n)})}finally{n.forEach(e=>CharacterDelete(e))}},test_equipHighSecLock:function(){const e="test_equipHighSecLock",t=CharacterLoadSimple(e);try{const n=AssetGet(t.AssetFamily,"ItemArms","LatexArmbinder");if(null==n)throw new Error;const r={Asset:n};xR(`${e}:${kR}:0`,()=>Of(r,t)),PR(`${e}:${kR}:0`,r.Property?.MemberNumberListKeys,"")}finally{CharacterDelete(t)}},test_equipLock:function(){const e="test_equipLock",t=wc(0,5).map(t=>`${e}-${t}`),n=t.map(CharacterLoadSimple);try{n[4].PermissionItems["ItemMisc/ExclusivePadlock"]=PreferencePermissionGetDefault(),n[4].PermissionItems["ItemMisc/ExclusivePadlock"].Permission="Block",InventoryWear(n[2],"LatexArmbinder","ItemArms"),InventoryLock(n[2],n[2].Appearance.at(-1),"ExclusivePadlock");const t=AssetGet(n[0].AssetFamily,"ItemArms","LatexArmbinder"),r=AssetGet(n[0].AssetFamily,"ItemArms","NylonRope");if(null==t||null==r)throw new Error;const i={Asset:t};[{args:["bob","ExclusivePadlock",n[0]],excMessage:'Invalid "item" type: string'},{args:[i,0,n[0]],excMessage:'Invalid "lockName" type: number'},{args:[i,"bob",n[0]],excMessage:'Invalid "lockName" value: bob'},{args:[i,"ExclusivePadlock",1],excMessage:'Invalid "character" type: number'}].forEach(({args:t,excMessage:n},r)=>{_R(`${e}:${BR}:${r}`,()=>Af(...t),n)});[{args:[i,"ExclusivePadlock",n[1]],output:!0},{args:[i,"ExclusivePadlock",n[2]],output:!1},{args:[{Asset:r},"ExclusivePadlock",n[3]],output:!1},{args:[i,"ExclusivePadlock",n[4]],output:!1}].forEach(({args:t,output:n},r)=>{const i=xR(`${e}:${kR}:${r}`,()=>Af(...t));PR(`${e}:${kR}:0`,i,n)})}finally{n.forEach(e=>CharacterDelete(e))}},test_equipTimerLock:function(){const e="test_equipTimerLock",t=CharacterLoadSimple(e);try{const n=AssetGet(t.AssetFamily,"ItemArms","LatexArmbinder");if(null==n)throw new Error;const r={Asset:n};_R(`${e}:${BR}:0`,()=>jf(r,void 0,t),'Invalid "seconds" type: undefined'),xR(`${e}:${kR}:0`,()=>jf(r,99,t)),CR(`${e}:${kR}:0`,(r.Property?.RemoveTimer??1/0)<=CurrentTime+198e4),PR(`${e}:${kR}:0`,r.Property?.RemoveItem,!0),PR(`${e}:${kR}:0`,r.Property?.LockSet,!0),ER(`${e}:${kR}:0`,r.Property?.Password,"string")}finally{CharacterDelete(t)}},test_sanitizeWheelFortuneIDs:function(){const e="test_sanitizeWheelFortuneIDs";_R(`${e}:${BR}:0`,()=>nR(void 0),'Invalid "IDs" type: undefined'),[{args:["ABC"],output:"ABC"},{args:["A䀁"],output:"A"}].forEach(({args:t,output:n},r)=>{const i=xR(`${e}:${kR}:${r}`,()=>nR(...t));PR(`${e}:${kR}:${r}`,i,n)})},test_settingsMBSLoaded:function(){const e="test_settingsMBSLoaded",t=xR(`${e}:${kR}:0`,rR);PR(`${e}:${kR}:0`,t,!0)}});const $R=Object.freeze({Mummification:e=>({...e,TypeRecord:void 0})});var FR=Object.freeze({__proto__:null,test_builtinMBSWheel:function(){const e="test_builtinMBSWheel",t=dr(Object.values(Xp).map(e=>e.children??[])),n=t.map(e=>e.Description),r=n.map(e=>CharacterLoadSimple(e));try{t.forEach(t=>{if(!(t.Parent instanceof cR))return;const n=CharacterLoadSimple(t.Description);t.Script(n);for(let r of t.Parent.itemList){const i=InventoryGet(n,r.Group);if(void 0!==r.Equip)continue;CR(`${e}:${t.Description}:${r.Group}:${r.Name}:${kR}`,null!=i);const o=$R[t.Parent.name]??(e=>e),a=o(Qf(i.Asset,{...i,Group:i.Asset.Group.Name,Name:i.Asset.Name,Color:void 0===r.Color?void 0:i.Color},!1),n);null!==a&&(r={...r,Property:{...a.Property,...r.Property},Equip:void 0,Craft:void 0!==r.Craft&&"HighSecurityPadlock"===t.Flag.type&&InventoryDoesItemAllowLock(i)?{...r.Craft,Property:"Puzzling"}:r.Craft},PR(`${e}:${t.Description}:${r.Group}:${r.Name}:${kR}`,a,r))}})}finally{r.forEach(e=>CharacterDelete(e))}}});const LR=function(){if(!rR())return Ph.warn("MBS not fully loaded yet"),!1;const e={...OR,...AR,...FR},t={};for(const[n,r]of kh(e))try{r()}catch(e){t[n]=e}return 0===Object.values(t).length||(Ph.warn(t),!1)};Fh("backgrounds",{async afterLoad(){const e={[`${Rp.screen}Background`]:Rp.background,[`${Bp.screen}Background`]:Bp.background,[`${Mp.screen}Background`]:Mp.background,[`${Kb.screen}Background`]:Kb.background,[`${Up.screen}Background`]:Up.background},t=globalThis;Object.assign(t,e)}});const TR=new Set;Fh("backport",{async afterLoad(){GameVersion,document.getElementById("mbs-backport-style")||document.body.append(E.jsx("style",{id:"mbs-backport-style",children:"/* stylelint-disable no-empty-source */".toString()})),TR.size?Ph.log("Initializing R125 backports",Dc(Array.from(TR))):Ph.log("No R125 backports")}});var DR={BandAnklet:"R111",HeelBinders:"R111",LegFur:"R111",Ribbon:"R111",Ribbon1:"R111"},HR={BandAnklet:"R111",HeelBinders:"R111",LegFur:"R111",Ribbon:"R111",Ribbon1:"R111"},NR={"":"R111"},GR={"":"R111"},WR={Blush:"R98"},qR={Large:"R98",Normal:"R98",Small:"R98",XLarge:"R98"},zR={BodyWritings:"R103",FacePaints:"R111",FaceScars:"R109",Splatters:"R114",WombTattoos:"R101"},KR={EchoV1:"R117",EchoV2:"R118",Original:"R117"},UR={FlatMedium:"R98",FlatSmall:"R98",Large:"R98",Normal:"R98",Small:"R98",XLarge:"R98"},VR={Bandage:"R117",Bandeau1:"R98",Bikini1:"R98",BondageBra1:"R98",Bra1:"R98",Bra10:"R98",Bra2:"R98",Bra7:"R98",Bra8:"R98",Bra9:"R98",BunnySuit:"R98",Bustier1:"R98",Camisole:"R98",ChineseBra1:"R98",ClamShell:"R98",CoconutBra:"R98",CorsetBikini1:"R98",CowPrintedBra:"R98",CuteBikini1:"R98",DominatrixLeotard:"R98",FishnetBikini1:"R98",FlowerBra:"R98",FrameBra1:"R98",FrameBra2:"R98",FullLatexBra:"R98",FullLatexBra2:"R98",HaremBra:"R98",HarnessBra1:"R98",HarnessBra2:"R98",HeartTop:"R98",KittyBra1:"R98",LatexBra1:"R98",LatexBunnySuit:"R98",LeatherBreastBinder:"R98",LeatherBunnyHollowBra:"R117",LeatherStrapBra1:"R98",LeatherVestSuit:"R104",MaidBra:"R117",MaidBra1:"R98",MeshTop:"R113",OrnateMetalBra:"R116",OuvertPerl1:"R98",Ribbons:"R98",Sarashi1:"R98",SatinCorset:"R117",SexyBeachBra1:"R98",SexyBikini1:"R98",SexyBikini2:"R98",SexyBikini3:"R98",SexyBikiniBra1:"R98",ShinyLeotard:"R114",SleevelessSlimLatexLeotard:"R98",SportBra:"R120",SportSwimsuit:"R120",StarHarnessBra:"R98",StrapBra:"R98",StuddedHarness:"R98",Swimsuit1:"R98",Swimsuit2:"R98",Swimsuit3:"R98"},JR={Band1:"R98",BowBand:"R98",KinkBracelet:"R98",LaceBands:"R98",LesBand:"R98",SpikeBands:"R98",WristWatch:"R103",Wristband:"R98"},YR={AdmiralTop:"R98",AdultBabyDress1:"R98",AdultBabyDress2:"R98",AdultBabyDress3:"R98",AdultBabyDress4:"R98",AnimeGirl:"R106",BabydollDress1:"R98",BartenderVest:"R115",BartenderVestM:"R115",Blouse1:"R98",Bodice1:"R98",BodyTowel1:"R98",BondageBustier1:"R98",BondageBustier2:"R98",BondageDress1:"R98",BondageDress2:"R98",BridesmaidDress1:"R98",BusinessSuit:"R101",ButtonShirt:"R98",CheerleaderTop:"R98",ChineseDress1:"R98",ChineseDress2:"R98",CocktailDress:"R116",CollegeOutfit1:"R98",ComfyTop:"R98",CorsetDress:"R101",CorsetShirt:"R98",CropTop:"R98",CustomTShirt:"R103",Dress2:"R98",Dress3:"R98",DressFur:"R98",EveningGown:"R102",FishnetTop:"R98",FlowerDress:"R98",FrilledShirt:"R98",FurCoat:"R98",FuzzyDress:"R98",Gown1:"R98",Gown2Top:"R98",Gown3:"R98",GrandMage:"R98",HeavyLeatherDress:"R102",Hoodie:"R98",Jacket:"R98",LaceBabydoll:"R98",LatexHobbleDress:"R106",LatexLacedSuit:"R98",LatexTankTop:"R98",LatexTop:"R98",Laurel:"R98",LeatherBolero:"R98",LeatherCorsetTop1:"R98",LeatherCropTop:"R98",MaidApron1:"R98",MaidApron2:"R98",MaidBikini:"R116",MaidLatex:"R101",MaidOutfit1:"R98",MaidOutfit2:"R98",MaleTankTop1:"R98",MeshTop:"R113",MistressTop:"R98",NunRobes:"R104",NurseUniform:"R98",OffTheShoulderTop:"R119",RetroGirdle:"R98",ReverseBunnySuit:"R98",RibbonCorset:"R112",Robe1:"R98",RuffledDress:"R124",SeethroughTop:"R98",ShoulderlessTop:"R98",SlaveRags:"R98",SleevelessTop:"R98",SteampunkCorsetTop1:"R98",StudentOutfit1:"R98",StudentOutfit2:"R98",StudentOutfit3:"R98",SummerDress:"R98",SuspenderTop1:"R98",Sweater1:"R98",TShirt1:"R98",TShirt2:"R98",TeacherOutfit1:"R98",TennisShirt1:"R98",VirginKiller1:"R98",WeddingDress1:"R98",WeddingDress2:"R98",Yukata1:"R98",YuletideVelvetWarmth:"R104"},XR={Bib:"R98",BodyWritings:"R103",Bouquet:"R98",BowBackAccessory:"R104",BowBelt:"R124",BugLegs:"R98",BunnyCollarCuffs:"R98",Camera1:"R98",Cape:"R98",CatsuitCollar:"R98",ComboBelt:"R112",FacePaint:"R98",FaceWritings:"R112",FrillyApron:"R98",FurBolero:"R98",FuzzyScarf:"R121",Glitter:"R98",HoodedCloak:"R116",JewelrySet:"R98",Kissmark:"R98",KissmarkDummy:"R98",LargeBelt:"R98",LargeBeltClassic:"R121",LargeNeckFur:"R109",LatexApron:"R101",LeatherBeltCloth:"R111",LeatherStraps:"R98",Poncho:"R98",RuffledCollar:"R120",SatinScarf:"R112",Scarf:"R98",SideRuffles:"R116",SmallNeckFur:"R109",SpikyNeckFur:"R109",StudentOutfit3Bow1:"R98",StudentOutfit3Bow2:"R98",StudentOutfit3Bow3:"R98",StudentOutfit3Scarf:"R98",VampiricCloak:"R121",WitchShawl:"R121",WombTattoos:"R101",XmasLongShawl:"R121",XmasShortShawl:"R121",ZipperBelt:"R99"},ZR={ASRubberSkirt:"R107",AdmiralSkirt:"R98",AsymmetricSkirt:"R98",BaggyJeans:"R121",BondageSkirt:"R98",BusinessSkirt:"R98",BusinessTrousers:"R101",CheerleaderSkirt:"R98",ChineseSkirt1:"R98",ClothSkirt1:"R98",CollegeSkirt:"R98",CrossSkirt:"R98",CrossSkirtLight:"R98",ElegantSkirt:"R98",Gown2Skirt:"R98",GymShorts:"R120",HaremPants:"R98",HaremPants2:"R98",HulaSkirt:"R98",JeanSkirt:"R98",Jeans1:"R98",Jeans2:"R98",JeansShorts:"R98",LatexPants1:"R98",LatexSkirt1:"R98",LatexSkirt2:"R98",Leggings1:"R98",Leggings2:"R98",LongLeatherSkirt:"R98",LongPleatedSkirt:"R98",LongSkirt1:"R98",MageSkirt:"R98",MidLegSkirt:"R112",MiniDenimHotPants:"R121",MistressBottom:"R98",OpenLeatherSkirt:"R121",PVCHobbleSkirt:"R121",Pajama1:"R98",PantBoots:"R98",PencilSkirt:"R98",PleatedSkirt:"R98",RuffledMiniskirt:"R120",RuffledSkirt:"R98",SatinSkirt:"R105",ShortPencilSkirt:"R98",ShortPlaidSkirt:"R98",Shorts1:"R98",SkinnyJeans:"R123",Skirt1:"R98",Skirt2:"R98",Skirt3:"R98",TennisSkirt1:"R98",TulleSkirt:"R98",Tutu:"R98",UtilityKilt:"R113",Waspie1:"R98",Waspie2:"R98",Waspie3:"R98",YogaPants:"R121"},QR={AdmiralTop:"R117",BartenderVest:"R120",BartenderVestM:"R120",BusinessSuit:"R117",FurCoat:"R117",Hoodie:"R121",JacketHoodie:"R120",LeatherJacket:"R117",Robe1:"R117"},ew={BarrelCorset:"R118",ClassicLatexCorset:"R98",Corset1:"R98",Corset2:"R98",Corset3:"R98",Corset4:"R98",Corset5:"R98",Corset6:"R98",CorsetDress:"R101",ExtremeCorset:"R115",LatexCorset1:"R98",LeatherCorsetTop1:"R98",RibbonCorset:"R112",SatinCorset:"R118",SteampunkCorsetTop1:"R98",TightCorset:"R107",Underbust:"R98"},tw={AmberFam:"R119",AzureCorp:"R119",BCRules:"R120",BTG:"R120",BTeacher:"R120",BondageCollege:"R120",Bonk:"R120",Bullseye:"R120",ControlPad1:"R120",CyberTechCorp:"R123",DataRoom:"R120",DemonsBar:"R119",DenOfSin:"R119",Dominant:"R120",Eclipse:"R120",Elite:"R120",FireBite:"R125",Gangriels:"R119",HWood:"R120",Hogtied:"R120",Keys:"R120",LukeChill:"R119",Malkuth:"R119",RadFrog:"R120",Raiders:"R120",RatAss:"R119",Shibari:"R120",SkullDecal:"R123",SlaveHelpline:"R119",SpreaderBar:"R125",Staff:"R120",VoidOrder:"R119",WhiteMoon:"R120",ZamStick:"R120",ZamStickII:"R120"},nw={Emoticon:"R98"},rw={Eyebrows1:"R98",Eyebrows2:"R98",Eyebrows7:"R98",Eyebrows8:"R98"},iw={Eyes1:"R98",Eyes10:"R98",Eyes11:"R98",Eyes12:"R98",Eyes13:"R98",Eyes14:"R99",Eyes15:"R117",Eyes2:"R98",Eyes3:"R98",Eyes4:"R98",Eyes5:"R98",Eyes6:"R98",Eyes7:"R98",Eyes8:"R98",Eyes9:"R98"},ow={Eyes1:"R98",Eyes10:"R98",Eyes11:"R98",Eyes12:"R98",Eyes13:"R98",Eyes14:"R99",Eyes15:"R117",Eyes2:"R98",Eyes3:"R98",Eyes4:"R98",Eyes5:"R98",Eyes6:"R98",Eyes7:"R98",Eyes8:"R98",Eyes9:"R98"},aw={CatEye:"R98",CatEye2:"R98",LargeBlurred:"R98",LargeSolid:"R98",SmallBlurred:"R98",SmallSolid:"R98",SuperstarBlurred:"R98",SuperstarSolid:"R98",Tanuki:"R98",UndershadowedBlurred:"R98",UndershadowedSolid:"R98",Wings:"R98"},sw={AnimalNoses:"R112",FacePaint:"R119",FaceScars:"R112",FaceWritings:"R112",Splatters:"R114"},lw={BigBeard:"R98",ChinstrapBeard:"R98",Goatee:"R98",Handlebar:"R115",LargeBeard:"R115",LargeGoatee:"R115",MediumBeard:"R98",Moustache:"R98",MoustacheBeard:"R98",MuttonChops:"R115",VanDyke:"R115",VanDykeHandlebar:"R115",XLBeard:"R115",XLGoatie:"R115",XLMoustache:"R115",XXLBeard:"R115",XXLBeardHandlebar:"R115",XXLBeardXLStache:"R115"},uw={Fluids:"R98"},cw={BowBelt:"R124",ButterflyGarter:"R115",ComboBelt:"R112",DropBag:"R98",FemPelvisHarness:"R114",GarterBelt:"R98",GarterBelt2:"R98",GarterBelt3:"R98",HipHarness:"R107",Tentacles:"R98",WaistLegHarness:"R111"},dw={CatGlasses:"R98",EyePatch1:"R98",Glasses1:"R98",Glasses2:"R98",Glasses3:"R98",Glasses4:"R98",Glasses5:"R98",Glasses6:"R98",Goggles:"R98",GradientSunglasses:"R98",HalfRimGlasses:"R121",JokeGlasses:"R98",Monocle:"R121",Pincenez:"R106",RoundSunglasses:"R114",ShutterSunshades:"R121",StreetEyewear:"R100",SunGlasses1:"R98",SunGlasses2:"R98",SunGlassesClear:"R98",VGlasses:"R98",VintageSunglasses:"R121"},hw={AnimeGirlGloves:"R106",BikerGloves:"R98",Catsuit:"R98",CheerleaderPomPoms:"R98",CowPrintedGloves:"R98",FingerlessGloves:"R98",FishnetGloves:"R98",Gloves1:"R98",Gloves2:"R98",Gloves3:"R98",GlovesFur:"R98",HaremGlove:"R98",LatexElbowGloves:"R98",LatexShortGloves:"R98",MistressGloves:"R98",OperaGloves:"R105",SeethroughSuit:"R98",WarmGloves:"R103"},fw={Antennae:"R98",AquaticEars:"R111",BatWings:"R98",BigLynxEars:"R98",BunnyEars1:"R98",BunnyEars2:"R98",CowEars:"R104",CowHorns:"R98",CustomizableCatEars:"R119",CustomizableCowEars:"R119",CustomizableElfEars:"R119",CustomizableFluffyEars1:"R119",CustomizableFluffyEars2:"R119",CustomizableFluffyEars3:"R119",CyberEars:"R117",CyberneticEars1:"R108",DildocornHorn:"R98",EarWarmer:"R103",Ears1:"R98",Ears2:"R98",ElfEars:"R98",FloppyBunnyEars:"R117",FoxEars1:"R98",FoxEars2:"R98",FoxEars3:"R98",GiantBow1:"R98",HairFeathers1:"R98",HairFlower1:"R98",Halo:"R98",Headset1:"R101",Horns:"R98",Horns2:"R98",Horns3:"R98",Horns4:"R104",Horns5:"R104",KittenEars1:"R98",KittenEars2:"R98",MouseEars1:"R98",MouseEars2:"R98",Onihorns:"R109",PonyEars1:"R98",PuppyEars1:"R98",PuppyEars2:"R98",RaccoonEars1:"R98",Ribbons1:"R98",Ribbons2:"R98",Ribbons3:"R98",Ribbons4:"R98",SkunkEars:"R109",SuccubusHorns:"R98",UnicornHorn:"R98",WeddingVeil1:"R98",WolfEars1:"R98",WolfEars2:"R98"},pw={Antennae:"R98",AquaticEars:"R111",BatWings:"R98",BigLynxEars:"R116",BunnyEars1:"R98",BunnyEars2:"R98",CowEars:"R104",CowHorns:"R98",CustomizableCatEars:"R119",CustomizableCowEars:"R119",CustomizableElfEars:"R119",CustomizableFluffyEars1:"R119",CustomizableFluffyEars2:"R119",CustomizableFluffyEars3:"R119",CyberEars:"R117",CyberneticEars1:"R111",DildocornHorn:"R98",Ears1:"R98",Ears2:"R98",ElfEars:"R98",FloppyBunnyEars:"R117",FoxEars1:"R98",FoxEars2:"R98",FoxEars3:"R98",Horns:"R98",Horns2:"R98",Horns3:"R98",Horns4:"R104",Horns5:"R104",KittenEars1:"R98",KittenEars2:"R98",MouseEars1:"R98",MouseEars2:"R98",Onihorns:"R109",PonyEars1:"R98",PuppyEars1:"R98",PuppyEars2:"R98",RaccoonEars1:"R98",SkunkEars:"R109",SuccubusHorns:"R98",UnicornHorn:"R98",WolfEars1:"R98",WolfEars2:"R98"},gw={EarWarmer:"R103",GiantBow1:"R98",HairFeathers1:"R98",HairFlower1:"R98",Halo:"R98",Headset1:"R101",Ribbons1:"R98",Ribbons2:"R98",Ribbons3:"R98",Ribbons4:"R98",WeddingVeil1:"R98"},mw={HairBack1:"R98",HairBack10:"R98",HairBack10b:"R98",HairBack11:"R98",HairBack12:"R98",HairBack12b:"R98",HairBack13:"R98",HairBack13b:"R98",HairBack14:"R98",HairBack15:"R98",HairBack15b:"R98",HairBack16:"R98",HairBack17:"R98",HairBack18:"R98",HairBack18b:"R98",HairBack19:"R98",HairBack19b:"R98",HairBack1b:"R98",HairBack2:"R98",HairBack20:"R98",HairBack20b:"R98",HairBack21:"R98",HairBack22:"R98",HairBack23:"R98",HairBack24:"R98",HairBack25:"R98",HairBack26:"R98",HairBack27:"R98",HairBack28:"R98",HairBack29:"R98",HairBack2b:"R98",HairBack30:"R98",HairBack31:"R98",HairBack32:"R98",HairBack33:"R98",HairBack34:"R98",HairBack35:"R98",HairBack36:"R98",HairBack37:"R98",HairBack38:"R98",HairBack39:"R98",HairBack4:"R98",HairBack40:"R98",HairBack41:"R98",HairBack42:"R98",HairBack43:"R98",HairBack44:"R98",HairBack45:"R98",HairBack46:"R98",HairBack47:"R98",HairBack48:"R98",HairBack49:"R98",HairBack4b:"R98",HairBack5:"R98",HairBack50:"R98",HairBack51:"R98",HairBack52:"R98",HairBack53:"R98",HairBack54:"R98",HairBack54b:"R98",HairBack55:"R98",HairBack55b:"R98",HairBack56:"R98",HairBack56b:"R98",HairBack57:"R98",HairBack57b:"R98",HairBack57c:"R98",HairBack57d:"R102",HairBack58:"R103",HairBack58b:"R103",HairBack59:"R103",HairBack5b:"R98",HairBack6:"R98",HairBack60:"R103",HairBack61:"R103",HairBack62:"R104",HairBack63:"R104",HairBack64:"R112",HairBack65:"R112",HairBack65b:"R112",HairBack66:"R112",HairBack67:"R112",HairBack68:"R112",HairBack69:"R112",HairBack69b:"R112",HairBack6b:"R98",HairBack7:"R98",HairBack70:"R112",HairBack70b:"R112",HairBack71:"R112",HairBack72:"R112",HairBack73:"R112",HairBack74:"R112",HairBack75:"R112",HairBack76:"R112",HairBack76b:"R112",HairBack77:"R112",HairBack77b:"R112",HairBack77c:"R112",HairBack78:"R112",HairBack78b:"R112",HairBack78c:"R112",HairBack79:"R115",HairBack7b:"R98",HairBack7c:"R98",HairBack8:"R98",HairBack80:"R115",HairBack81:"R115",HairBack82:"R115",HairBack83:"R115",HairBack84:"R115",HairBack9:"R98",HairBack9b:"R98",HairNone:"R98",ScalyBackHair:"R109"},vw={HairFront1:"R98",HairFront10:"R98",HairFront10b:"R98",HairFront11:"R98",HairFront11b:"R98",HairFront12:"R98",HairFront12b:"R98",HairFront13:"R98",HairFront13b:"R98",HairFront14:"R98",HairFront14b:"R98",HairFront15:"R98",HairFront16:"R98",HairFront17:"R98",HairFront17b:"R98",HairFront18:"R98",HairFront19:"R98",HairFront1b:"R98",HairFront2:"R98",HairFront20:"R98",HairFront21:"R98",HairFront22:"R98",HairFront22b:"R98",HairFront23:"R98",HairFront23b:"R98",HairFront24:"R98",HairFront25:"R98",HairFront26:"R98",HairFront27:"R98",HairFront28:"R98",HairFront28b:"R98",HairFront29:"R98",HairFront29b:"R98",HairFront2b:"R98",HairFront3:"R98",HairFront30:"R98",HairFront31:"R98",HairFront32:"R98",HairFront33:"R98",HairFront33b:"R98",HairFront34:"R98",HairFront35:"R98",HairFront36:"R98",HairFront37:"R98",HairFront37b:"R98",HairFront38:"R98",HairFront38b:"R98",HairFront39:"R98",HairFront39b:"R98",HairFront3b:"R98",HairFront4:"R98",HairFront40:"R98",HairFront40b:"R98",HairFront41:"R98",HairFront41b:"R98",HairFront42:"R98",HairFront42b:"R98",HairFront43:"R98",HairFront43b:"R98",HairFront44:"R98",HairFront44b:"R98",HairFront45:"R98",HairFront45b:"R98",HairFront46:"R98",HairFront46b:"R98",HairFront47:"R98",HairFront47b:"R98",HairFront48:"R98",HairFront48b:"R98",HairFront49:"R98",HairFront4b:"R98",HairFront5:"R98",HairFront50:"R98",HairFront51:"R98",HairFront51b:"R98",HairFront52:"R98",HairFront52b:"R98",HairFront53:"R98",HairFront54:"R103",HairFront55:"R103",HairFront56:"R103",HairFront57:"R104",HairFront58:"R108",HairFront59:"R109",HairFront5b:"R98",HairFront6:"R98",HairFront60:"R109",HairFront61:"R109",HairFront62a:"R110",HairFront62b:"R110",HairFront63:"R112",HairFront64:"R112",HairFront65:"R113",HairFront66:"R115",HairFront67:"R115",HairFront68:"R115",HairFront69:"R115",HairFront6b:"R98",HairFront7:"R98",HairFront70:"R115",HairFront71:"R115",HairFront72:"R115",HairFront73:"R115",HairFront74:"R115",HairFront7b:"R98",HairFront8:"R98",HairFront8b:"R98",HairFront9:"R98",HairFront9b:"R98",ScalyHair:"R109"},yw={CatsuitGloves:"R111",Claws:"R111",Fingernails:"R111",Rings:"R111"},bw={CatsuitGloves:"R111",Claws:"R111",Fingernails:"R111",Rings:"R111"},Rw={"":"R111"},ww={"":"R111"},Sw={AnimeGirlTiara:"R106",BakerBoyHat:"R98",BallCapBack:"R98",BallCapFront:"R98",Band1:"R98",Band2:"R98",Bandana:"R98",Beanie:"R98",Beret1:"R98",Bonnet1:"R98",Bonnet2:"R98",BunnySuccubus2:"R98",CaptainHat1:"R98",CheapHelmet:"R107",CollegeDunce:"R98",CowboyHat:"R98",Crown1:"R98",Crown2:"R98",Crown3:"R98",Crown4:"R98",Crown5:"R98",FacePaint:"R98",FlatCap:"R120",FlowerCrown:"R98",FurHeadband:"R98",Gat:"R120",HeadTowel1:"R98",LatexHabit:"R98",MaidHairband1:"R98",MaidLatexHairband:"R101",NunHabit:"R98",NunVeil:"R104",NurseCap:"R98",PirateBandana1:"R98",PirateHat:"R98",PoliceWomanHat:"R98",PoppyCrown:"R98",ReindeerBand:"R98",RoseCrown:"R98",Santa1:"R98",SmallHat1:"R98",SwimCap:"R98",Tiara1:"R98",Veil1:"R98",Veil2:"R98",VintageHat:"R106",WitchHat1:"R98"},Bw={Default:"R98",NoEars:"R98",SmallEars:"R98"},kw={H0900:"R98",H0910:"R98",H0920:"R98",H0930:"R98",H0940:"R98",H0950:"R98",H0960:"R98",H0970:"R98",H0980:"R98",H0990:"R98",H1000:"R98"},Cw={BedChains:"R98",BedRopes:"R98",BedStraps:"R98",BedTape:"R98",CeilingChain:"R98",CeilingNeckCuff:"R115",CeilingRope:"R98",Covers:"R98"},_w={ArmbinderJacket:"R98",ArmbinderSuit:"R107",BedMetalCuffs:"R110",BitchSuit:"R98",Bolero:"R98",BondageBouquet:"R98",BondageBra:"R98",BoxTieArmbinder:"R98",CanvasStraitjacket1:"R98",CeilingShackles:"R98",Chains:"R98",CollarCuffs:"R98",CollarMetalcuffs:"R103",DuctTape:"R98",FourLimbsShackles:"R98",FullBodyLeatherHarness:"R98",FullBodyShackles:"R98",FullLatexSuit:"R98",FurStraitJacket:"R98",FuturisticArmbinder:"R98",FuturisticCuffs:"R98",FuturisticStraitjacket:"R98",HeavyYoke:"R98",HempRope:"R98",HighSecurityStraitJacket:"R98",HighStyleSteelCuffs:"R98",InflatableDress:"R112",InflatableStraightLeotard:"R98",LatexArmbinder:"R98",LatexBoxtieLeotard:"R98",LatexButterflyLeotard:"R98",LatexSleevelessLeotard:"R98",LeatherArmSplints:"R98",LeatherArmbinder:"R98",LeatherCuffs:"R98",LeatherDeluxeCuffs:"R98",LeatherStraitJacket:"R98",Manacles:"R98",MedicalBedRestraints:"R98",MermaidSuit:"R98",MetalCuffs:"R98",NylonRope:"R98",OrnateCuffs:"R98",PantyhoseBody:"R98",PantyhoseBodyOpen:"R98",PawPaddedPetsuitArms:"R119",PetCrawler:"R98",Pillory:"R98",PlasticWrap:"R98",PrisonLockdownSuit:"R98",PrisonSJ:"R98",Ribbons:"R98",SeamlessLatexArmbinder:"R98",SeamlessStraitDress:"R98",SeamlessStraitDressOpen:"R98",ShinyArmbinder:"R98",ShinyPetSuit:"R98",ShinyStraitjacket:"R98",SleepSac:"R98",Slime:"R98",SmoothLeatherArmbinder1:"R98",SteelBelt:"R115",SteelCuffs:"R98",StraitDress:"R98",StraitDressOpen:"R98",StraitJacket:"R98",StraitLeotard:"R98",StrappedPetsuitArms:"R119",StrictLeatherPetCrawler:"R98",SturdyLeatherBelts:"R98",Tentacles:"R98",ThinLeatherStraps:"R98",TightJacket:"R98",TightJacketCrotch:"R98",TransportJacket:"R98",UnderBedBondageCuffs:"R98",Web:"R98",WoodenCuffs:"R98",WrappedBlanket:"R98",WristShackles:"R98",Yoke:"R98",Zipties:"R98"},xw={BalletHeels:"R98",BalletHeels1:"R98",BalletMittens:"R112",BalletWedges:"R98",FuturisticHeels:"R98",FuturisticHeels2:"R98",HeellessHoof:"R113",HighThighBoots:"R98",HoofBoots:"R115",LeatherFootMitts1:"R98",LeatherToeCuffs:"R98",LockingBoots1:"R98",LockingHeels:"R98",LockingHeels2:"R98",LockingShoes1:"R98",LockingShoes2:"R98",MetalBallet:"R100",MonoHeel:"R98",PonyBoots:"R98",ShortPonyBoots:"R98",SingleBalletBoot:"R120",Slime:"R98",StrictPonyBoots:"R104",ThighHighLatexHeels:"R98",ToeCuffs:"R98",ToeTape:"R98",ToeTie:"R98",TormentHeels:"R103",ZipperBBoots:"R120",Zipties:"R98"},Pw={ChastityPlate:"R105",ForbiddenChastityBra:"R98",FuturisticBra:"R98",FuturisticBra2:"R98",LeatherBreastBinder:"R98",LeatherStrapBra1:"R123",MetalChastityBra:"R98",OrnateChastityBra:"R98",PolishedChastityBra:"R98",Ribbons:"R98",TickleBra:"R98"},Ew={AnalBeads:"R98",AnalBeads2:"R98",AnalHook:"R98",BlackButtPlug:"R98",BunnyTailPlug1:"R98",BunnyTailPlug2:"R98",BunnyTailVibePlug:"R98",ButtPlugLock:"R98",ButtPump:"R98",Cowtail:"R98",DemonPlug:"R98",EggVibePlugXXL:"R98",FoxTail:"R122",FoxTails:"R98",FuckPlug:"R119",HollowButtPlug:"R98",HorsetailPlug:"R98",HorsetailPlug1:"R98",InflVibeButtPlug:"R98",KittenTail1:"R98",KittenTail2:"R98",LockingVibePlug:"R98",MouseTail1:"R98",MouseTail2:"R98",PenisPlug:"R98",PuppyTailPlug:"R98",PuppyTailPlug1:"R98",RaccoonButtPlug:"R98",RaccoonTailPlug:"R98",ShockPlug:"R98",Stitches:"R98",SuccubusButtPlug:"R98",SuccubusHeartButtPlug:"R98",TailButtPlug:"R98",Tentacles:"R98",VibratingButtplug:"R98",VibratingDildoPlug:"R98",WolfTail1:"R98",WolfTail2:"R98",WolfTail3:"R98"},Mw={BBQ:"R98",Bed:"R98",BondageBench:"R98",BrickWall:"R107",BurlapSack:"R98",Cage:"R98",Cement:"R106",ChangingTable:"R98",Coffin:"R98",ConcealingCloak:"R98",Crib:"R98",CryoCapsule:"R98",Cushion:"R98",DisplayCase:"R98",DollBox:"R98",Enema:"R122",ExclusiveWaitress:"R113",Familiar:"R98",FoldingScreen:"R98",FuckMachine:"R98",FurBlanketWrap:"R98",FuturisticCrate:"R98",GiftBox:"R123",GlueFloor:"R105",Highchair:"R116",InflatableBodyBag:"R98",KabeshiriWall:"R98",Kennel:"R98",LeatherCage:"R115",LittleMonster:"R98",Locker:"R98",LowCage:"R98",LuckyWheel:"R98",MedicalBed:"R98",Microphone:"R120",MilkCan:"R98",Net:"R98",OneBarGirl:"R105",OneBarPrison:"R98",PersonalCage:"R98",PetBed:"R98",PetBowl:"R98",PogoBall:"R112",Pole:"R98",Potty:"R122",SaddleStand:"R98",SingleBalletBoot:"R120",SmallDisplayCase:"R98",SmallLocker:"R98",SmallWoodenBox:"R98",SmallWoodenBoxOpenHead:"R98",Snowman:"R98",StrapOnSmooth:"R98",StrapOnStuds:"R98",Sybian:"R98",TheDisplayFrame:"R98",TheHangingFrame:"R101",Throne:"R113",TransportWoodenBox:"R98",Trolley:"R99",VacBedDeluxe:"R98",VacCube:"R98",Vacbed:"R98",VacbedClear:"R98",WaterCell:"R98",WetFloor:"R98",WheelFortune:"R98",WoodenBox:"R98",WoodenBoxOpenHead:"R98",WoodenHorse:"R98",WoodenRack:"R98",WoodenStocks:"R98","X-Cross":"R98",XFrame:"R124"},Iw={BluetoothEarbuds:"R98",CustomizableCatEars:"R122",CustomizableCowEars:"R122",CustomizableElfEars:"R122",CustomizableFluffyEars1:"R122",CustomizableFluffyEars2:"R122",CustomizableFluffyEars3:"R122",FuturisticEarphones:"R98",HeadphoneEarPlugs:"R98",Headphones:"R98",HeavyDutyEarPlugs:"R98",LightDutyEarPlugs:"R98"},jw={AnkleShackles:"R98",BallChain:"R98",Chains:"R98",DuctTape:"R98",EscortAnkleCuffs:"R98",FloorShackles:"R98",FuturisticAnkleCuffs:"R98",HeavyAnkleCuffs:"R98",HeavySpreaderMetal:"R98",HeelBinders:"R110",HempRope:"R98",HighStyleSteelAnkleCuffs:"R98",Irish8Cuffs:"R98",KneeOvernighter:"R110",LeatherAnkleCuffs:"R98",LeatherBelt:"R98",LeatherDeluxeAnkleCuffs:"R98",MassiveAnkleCuffs:"R110",MedicalBedRestraints:"R98",NylonRope:"R98",OrnateAnkleCuffs:"R98",PlasticWrap:"R98",Slime:"R98",SpreaderDildoBar:"R98",SpreaderMetal:"R98",SpreaderVibratingDildoBar:"R98",SteelAnkleCuffs:"R98",SturdyLeatherBelts:"R98",SuspensionCuffs:"R98",Tentacles:"R98",WoodenCuffs:"R98",Zipties:"R98"},Ow={AnimeGirlWand:"R106",BabyPowder:"R122",Baguette:"R98",Ballgag:"R98",Belt:"R98",Brick:"R107",Broom:"R98",BunPlush:"R98",CandleWax:"R98",Cane:"R98",CattleProd:"R98",Cigarette:"R119",Crop:"R98",Diaper:"R122",DragonPlush:"R123",ElectricToothbrush:"R98",Feather:"R98",FeatherDuster:"R98",Flogger:"R98",FoamRoll:"R120",ForSaleSign:"R98",FoxPlush:"R98",Gavel:"R98",GiftBox:"R123",GlassEmpty:"R98",GlassFilled:"R98",GlueTube:"R105",Hairbrush:"R98",HeartCrop:"R98",IceCube:"R98",Karl:"R98",KeyProp:"R98",Kyosensu:"R115",LargeDildo:"R98",LongDuster:"R98",LongSock:"R98",Lotion:"R98",MedicalInjector:"R98",MiniDolls:"R122",Mug:"R98",Paddle:"R98",Panties:"R98",PetPotato:"R98",PetToy:"R98",Phone1:"R98",Phone2:"R98",PlasticWrap:"R98",Plushie:"R120",Popcorn:"R99",PortalTablet:"R98",PotionBottle:"R98",RainbowWand:"R98",RopeCoilLong:"R98",RopeCoilShort:"R98",Ruler:"R98",Scissors:"R98",Shark:"R98",ShockRemote:"R98",ShockWand:"R98",SmallDildo:"R98",SmallVibratingWand:"R98",Smartphone:"R99",Spatula:"R98",Sword:"R98",TapeRoll:"R98",TennisRacket:"R98",Toothbrush:"R98",Towel:"R98",Trowel:"R107",Uchiwa:"R115",VibeRemote:"R98",VibratingWand:"R98",Vibrator:"R98",WartenbergWheel:"R98",Whip:"R98",WhipPaddle:"R98",Wipes:"R122"},Aw={BalletBootsMittens:"R121",CheerleaderPomPoms:"R98",DuctTape:"R98",ElbowLengthMittens:"R103",FoamMittens:"R120",FullMittens:"R110",FuturisticMittens:"R98",GlueMittens:"R105",HempRopeCuffs:"R107",HoofMittens:"R98",LatexBondageMitts:"R111",LeatherMittens:"R98",PaddedLeatherMittens:"R98",PaddedMittens:"R98",PawMittens:"R98",PolishedMittens:"R98",PonyMittensBinder:"R100",SmoothLeatherMittens1:"R98"},$w={AnimeLenses:"R98",AsylumBlindfold:"R115",BigMouthHood:"R101",BlackoutLenses:"R98",ClothBlindfold:"R98",DroneMask:"R98",DuctTape:"R98",FrilledSleepMask:"R98",FullBlindfold:"R98",FurScarf:"R98",FuturisticMask:"R98",HypnoticVisor:"R117",InteractiveVRHeadset:"R98",InteractiveVisor:"R98",Kigu2Hood:"R112",KittyBlindfold:"R98",LatexBlindfold:"R98",LeatherBlindfold:"R98",LeatherSlimMask:"R98",LeatherSlimMaskOpenEyes:"R98",LeatherSlimMaskOpenMouth:"R98",LewdBlindfold:"R98",MedicalPatch:"R98",PaddedBlindfold:"R98",Pantyhose:"R98",PrisonLockdownBlindfold:"R98",Ribbons:"R98",RopeBlindfold:"R98",ScarfBlindfold:"R98",SleepMask:"R98",Slime:"R98",SmallBlindfold:"R98",Snorkel:"R98",Stitches:"R98",StuddedBlindfold:"R98",Tentacles:"R98",WebBlindfold:"R98"},Fw={AccentHood:"R98",Balloon:"R111",BigMouthHood:"R101",BlanketHood:"R98",CanvasHood:"R98",CollarHood:"R98",CorsetHood:"R98",CowHood:"R98",CreepyIronMask:"R114",CustomBallHood:"R109",CustomLatexHood:"R98",DobermanMask:"R98",DogHood:"R98",DroneMask:"R98",FestivalFoxMask:"R98",FoxHood:"R98",FoxyMask:"R98",Fu:"R104",FuturisticHelmet:"R98",GGTSHelmet:"R98",GP9GasMask:"R98",GasMask:"R98",GwenHood:"R98",HalloIII:"R115",HarnessCatMask:"R98",HeadboxSeethrough:"R98",InflatableGagMask:"R98",InflatedBallHood:"R98",Kigu2Hood:"R112",KirugumiMask:"R98",KittyHood:"R98",LampHeadHood:"R98",LatexBunny:"R98",LatexDogHood:"R98",LatexDogMask:"R98",LatexHabit:"R98",LatexHoodOpenHair:"R98",LeatherHood:"R98",LeatherHoodOpenEyes:"R98",LeatherHoodOpenMouth:"R98",LeatherHoodSealed:"R98",LeatherHoodSensDep:"R98",OldGasMask:"R98",OpenFaceHood:"R98",OpenMouthPlugHood:"R98",PantyHood:"R98",Pantyhose:"R98",Paperbag:"R104",PolishedSteelHood:"R98",PonyHood:"R98",PumpkinHead:"R98",RubberMask:"R107",SackHood:"R98",SensoryDeprivationHood:"R98",Slime:"R98",SpaceMask:"R100",TechnoHelmet1:"R98",TransparentLatexHood:"R121",VacHood:"R98",ZipperHood:"R98"},Lw={BarrelCorset:"R115",Chains:"R98",DuctTape:"R98",FrogtieMetalCuffs:"R103",FrogtieStraps:"R98",FuturisticLegCuffs:"R98",HempRope:"R98",HobbleSkirt:"R98",LeatherBelt:"R98",LeatherDeluxeLegCuffs:"R98",LeatherLegCuffs:"R98",LegBinder:"R98",MedicalBedRestraints:"R98",MermaidTail:"R98",NylonRope:"R98",OrnateLegCuffs:"R98",PawPaddedPetsuitLegs:"R119",PlasticWrap:"R98",Ribbons:"R98",SeamlessHobbleSkirt:"R98",SeamlessLegBinder:"R98",ShinyLegBinder:"R98",Slime:"R98",StrappedPetsuitLegs:"R119",SturdyLeatherBelts:"R98",Tentacles:"R98",Zipties:"R98"},Tw={BountySuitcase:"R98",BountySuitcaseEmpty:"R98",BunPlush:"R98",CombinationPadlock:"R98",ExclusivePadlock:"R98",FamilyPadlock:"R98",FamilyPadlockKey:"R98",FoxPlush:"R98",HighSecurityPadlock:"R98",IntricatePadlock:"R98",Karl:"R98",Lockpicks:"R98",LoversPadlock:"R98",LoversPadlockKey:"R98",LoversTimerPadlock:"R98",MetalCuffsKey:"R98",MetalPadlock:"R98",MetalPadlockKey:"R98",MiniDolls:"R122",MistressPadlock:"R98",MistressPadlockKey:"R98",MistressTimerPadlock:"R98",OwnerPadlock:"R98",OwnerPadlockKey:"R98",OwnerTimerPadlock:"R98",PandoraPadlock:"R98",PandoraPadlockKey:"R98",PasswordPadlock:"R98",PetPost:"R98",PetPotato:"R98",Plushie:"R120",PortalLinkPadlock:"R98",SafewordPadlock:"R98",ServingTray:"R98",TeddyBear:"R98",TimerPadlock:"R98",TimerPasswordPadlock:"R98",WoodenMaidTray:"R98",WoodenMaidTrayFull:"R98",WoodenPaddle:"R98",WoodenSign:"R98"},Dw={AOMGag:"R113",AsylumMuzzle:"R115",Ball:"R98",BallGag:"R98",BallGagMask:"R98",BambooGag:"R98",BigMouth:"R98",BitGag:"R98",BoneGag:"R98",CageMuzzle:"R98",CaneGag:"R98",CarrotGag:"R98",ChloroformCloth:"R98",ChopstickGag:"R98",Cigarette:"R119",ClothGag:"R98",ClothStuffing:"R98",CompGag:"R120",CropGag:"R98",CupholderGag:"R98",DeepthroatGag:"R98",DentalGag:"R98",DildoGag:"R98",DildoPlugGag:"R98",DogMuzzleExposed:"R98",DuctTape:"R98",DusterGag:"R98",FoxyHarnessPanelGag:"R98",FunnelGag:"R98",FurScarf:"R98",FuturisticHarnessBallGag:"R98",FuturisticHarnessPanelGag:"R98",FuturisticMuzzle:"R98",FuturisticPanelGag:"R98",GasMaskGag:"R98",GenitalGag:"R107",GlueGag:"R105",HarnessBallGag:"R98",HarnessBallGag1:"R98",HarnessPacifierGag:"R98",HarnessPanelGag:"R98",HarnessPonyBits:"R98",HookGagMask:"R98",HorrorMuzzle:"R114",Kissmark:"R102",KittyGag:"R98",KittyHarnessPanelGag:"R98",KittyMuzzleGag:"R98",LargeDildo:"R98",LatexBallMuzzleGag:"R98",LatexMuzzleMask:"R99",LatexPostureCollar:"R98",LatexRespirator:"R102",LatexSheathGag:"R98",LeatherCorsetCollar:"R98",LewdGag:"R98",LipGag:"R98",MedicalMask:"R98",MilkBottle:"R98",ModularGag:"R99",MouthFeatureGag:"R102",MuzzleGag:"R98",OTNPlugGag:"R98",OverfilledGag:"R110",PaciGag:"R98",PacifierGag:"R98",PaddedFaceMask:"R102",PantiesMask:"R98",PantyStuffing:"R98",PlasticWrap:"R98",PlugGag:"R98",PonyGag:"R98",PremiumMuzzle:"R110",PrisonLockdownGag:"R98",PumpGag:"R98",PumpkinGag:"R98",QualityHarnessGag:"R106",RegressedMilk:"R98",RegularSleepingPill:"R98",Ribbons:"R98",RingGag:"R98",RopeBallGag:"R98",RopeGag:"R98",RoseBallGag:"R123",ScarfGag:"R98",ShoeGag:"R98",Slime:"R98",SockStuffing:"R98",SpiderGag:"R98",SteelMuzzleGag:"R98",StitchedMuzzleGag:"R98",Stitches:"R102",TechnoGag:"R98",Tentacles:"R98",TonguePiercingGag:"R100",TongueStrapGag:"R98",WebGag:"R98",WiffleGag:"R98",XLBoneGag:"R98",XmasStickerGag:"R111"},Hw={AOMGag:"R113",AsylumMuzzle:"R115",Ball:"R103",BallGag:"R98",BallGagMask:"R98",BambooGag:"R103",BigMouth:"R103",BitGag:"R98",BoneGag:"R98",CageMuzzle:"R98",CaneGag:"R103",CarrotGag:"R98",ChloroformCloth:"R98",ChopstickGag:"R103",ClothGag:"R98",ClothStuffing:"R103",CompGag:"R120",CropGag:"R103",CupholderGag:"R98",DeepthroatGag:"R103",DentalGag:"R103",DildoGag:"R98",DildoPlugGag:"R103",DogMuzzleExposed:"R103",DuctTape:"R98",DusterGag:"R98",FoxyHarnessPanelGag:"R98",FunnelGag:"R103",FurScarf:"R98",FuturisticHarnessBallGag:"R101",FuturisticHarnessPanelGag:"R101",FuturisticMuzzle:"R98",FuturisticPanelGag:"R101",GasMaskGag:"R98",GenitalGag:"R107",GlueGag:"R105",HarnessBallGag:"R98",HarnessBallGag1:"R98",HarnessPacifierGag:"R98",HarnessPanelGag:"R98",HarnessPonyBits:"R98",HookGagMask:"R103",HorrorMuzzle:"R114",Kissmark:"R102",KittyGag:"R98",KittyHarnessPanelGag:"R98",KittyMuzzleGag:"R98",LargeDildo:"R103",LatexBallMuzzleGag:"R98",LatexMuzzleMask:"R99",LatexPostureCollar:"R98",LatexRespirator:"R102",LatexSheathGag:"R103",LeatherCorsetCollar:"R98",LewdGag:"R98",LipGag:"R98",MedicalMask:"R98",MilkBottle:"R103",ModularGag:"R99",MouthFeatureGag:"R98",MuzzleGag:"R98",OTNPlugGag:"R103",OverfilledGag:"R110",PaciGag:"R98",PacifierGag:"R103",PaddedFaceMask:"R102",PantiesMask:"R98",PantyStuffing:"R103",PlasticWrap:"R98",PlugGag:"R103",PonyGag:"R98",PremiumMuzzle:"R110",PrisonLockdownGag:"R98",PumpGag:"R103",PumpkinGag:"R98",QualityHarnessGag:"R106",RegressedMilk:"R98",RegularSleepingPill:"R103",Ribbons:"R98",RingGag:"R98",RopeBallGag:"R98",RopeGag:"R98",RoseBallGag:"R123",ScarfGag:"R98",ShoeGag:"R98",Slime:"R98",SockStuffing:"R103",SpiderGag:"R98",SteelMuzzleGag:"R98",StitchedMuzzleGag:"R98",Stitches:"R102",TechnoGag:"R103",Tentacles:"R98",TonguePiercingGag:"R103",TongueStrapGag:"R103",WebGag:"R98",WiffleGag:"R98",XLBoneGag:"R98",XmasStickerGag:"R111"},Nw={AOMGag:"R113",AsylumMuzzle:"R115",Ball:"R103",BallGag:"R98",BallGagMask:"R98",BambooGag:"R103",BigMouth:"R103",BitGag:"R98",BoneGag:"R98",CageMuzzle:"R98",CaneGag:"R103",CarrotGag:"R98",ChloroformCloth:"R98",ChopstickGag:"R103",ClothGag:"R98",ClothStuffing:"R103",CropGag:"R103",CupholderGag:"R98",DeepthroatGag:"R103",DentalGag:"R103",DildoGag:"R98",DildoPlugGag:"R103",DogMuzzleExposed:"R103",DuctTape:"R98",DusterGag:"R98",FoxyHarnessPanelGag:"R98",FunnelGag:"R103",FurScarf:"R98",FuturisticHarnessBallGag:"R101",FuturisticHarnessPanelGag:"R101",FuturisticMuzzle:"R98",FuturisticPanelGag:"R101",GasMaskGag:"R98",HarnessBallGag:"R98",HarnessBallGag1:"R98",HarnessPacifierGag:"R98",HarnessPanelGag:"R98",HarnessPonyBits:"R98",HookGagMask:"R103",HorrorMuzzle:"R114",Kissmark:"R98",KittyGag:"R98",KittyHarnessPanelGag:"R98",KittyMuzzleGag:"R98",LargeDildo:"R103",LatexBallMuzzleGag:"R98",LatexMuzzleMask:"R99",LatexPostureCollar:"R98",LatexRespirator:"R98",LatexSheathGag:"R103",LeatherCorsetCollar:"R98",LewdGag:"R98",LipGag:"R98",MedicalMask:"R98",MilkBottle:"R103",ModularGag:"R99",MouthFeatureGag:"R102",MuzzleGag:"R98",OTNPlugGag:"R103",OverfilledGag:"R110",PaciGag:"R98",PacifierGag:"R103",PaddedFaceMask:"R98",PantiesMask:"R98",PantyStuffing:"R103",PlasticWrap:"R98",PlugGag:"R103",PonyGag:"R98",PremiumMuzzle:"R110",PrisonLockdownGag:"R98",PumpGag:"R103",PumpkinGag:"R98",QualityHarnessGag:"R106",RegressedMilk:"R98",RegularSleepingPill:"R103",Ribbons:"R98",RingGag:"R98",RopeBallGag:"R98",RopeGag:"R98",RoseBallGag:"R123",ScarfGag:"R98",ShoeGag:"R98",Slime:"R98",SockStuffing:"R103",SpiderGag:"R98",SteelMuzzleGag:"R98",StitchedMuzzleGag:"R98",Stitches:"R98",TechnoGag:"R103",Tentacles:"R98",TonguePiercingGag:"R103",TongueStrapGag:"R103",WebGag:"R98",WiffleGag:"R98",XLBoneGag:"R98",XmasStickerGag:"R111"},Gw={AsylumCollar:"R115",AutoShockCollar:"R98",BatCollar:"R98",BonedNeckCorset:"R98",BordelleCollar:"R98",ChainCollar:"R115",ClubSlaveCollar:"R98",ComboHarness:"R98",DogCollar:"R98",ExtendablePostureCollar:"R99",FuturisticCollar:"R98",GothicCollar:"R98",HeartCollar:"R98",HeartLinkChoker:"R98",HighCollar:"R98",HighSecurityCollar:"R98",HighStyleSteelCollar:"R98",LatexCollar1:"R98",LatexCollar2:"R98",LatexPostureCollar:"R98",LatexRingCollar:"R99",LeatherChoker:"R98",LeatherCollar:"R98",LeatherCollarBell:"R98",LeatherCollarBow:"R98",LeatherCorsetCollar:"R98",LeatherDeluxeCollar:"R98",LoveLeatherCollar:"R98",MaidCollar:"R98",MoonCollar:"R110",NeckRope:"R98",NobleCorsetCollar:"R98",NylonCollar:"R98",OrnateCollar:"R98",PaddedBeltCollar:"R99",PetCollar:"R98",PetSuitShockCollar:"R98",PostureCollar:"R98",SSpikedCollar:"R121",ShinySteelCollar:"R98",ShockCollar:"R98",SlaveCollar:"R98",SlenderSteelCollar:"R98",SpikeCollar:"R98",SpikedChoker:"R99",SteampunkCollar:"R121",SteelPostureCollar:"R98",StrictPostureCollar:"R98",SunCollar:"R110",TechnoCollar:"R98"},Ww={CollarAutoShockUnit:"R98",CollarBell:"R98",CollarBow:"R98",CollarButterfly:"R98",CollarCowBell:"R98",CollarFlower:"R98",CollarLapis:"R98",CollarMoon:"R98",CollarNameTag:"R98",CollarNameTagLivestock:"R98",CollarNameTagLover:"R98",CollarNameTagOval:"R98",CollarNameTagPet:"R98",CollarPentagram:"R98",CollarPupBone:"R98",CollarRose:"R98",CollarRoseAmulet:"R118",CollarShockUnit:"R98",CollarSun:"R98",CustomCollarTag:"R98",ElectronicTag:"R98",Key:"R98"},qw={Bedchain:"R111",ChainLeash:"R98",ChokeChain:"R115",CollarChainLong:"R98",CollarChainMedium:"R98",CollarChainShort:"R98",CollarLeash:"R98",CollarRopeLong:"R98",CollarRopeMedium:"R98",CollarRopeShort:"R98",MCuffCollar:"R115",PetPost:"R98",Post:"R98"},zw={BellClamps:"R98",ChainClamp:"R98",ChainTassles:"R98",ChopStickNippleClamps:"R98",Clothespins:"R98",HeartPasties:"R98",KittyPasties:"R98",LactationPump:"R98",NippleClamp:"R98",NippleClamps2:"R98",NippleSuctionCups:"R98",NippleTape:"R98",NippleVibe:"R98",NippleWeightClamps:"R98",PlateClamps:"R98",ScrewClamps:"R98",ShockClamps:"R98",StretchClovers:"R98",TapedVibeEggs:"R98",VibeNippleClamp:"R98",VibratorRemote:"R98"},Kw={BarbellPiercing:"R98",BellPiercing:"R98",CrossedStraightPiercing:"R98",NecklacePiercingChain:"R98",NippleAccessory1:"R98",NippleAccessory2:"R98",NippleAccessory3:"R98",NippleChastityPiercing1:"R98",NippleChastityPiercing2:"R98",RoundPiercing:"R98",StraightPiercing:"R98",VibeHeartPiercings:"R98"},Uw={BarbelPiercing:"R98",ClownNose:"R99",DuctTape:"R98",GlueNose:"R105",NoseClip:"R114",NoseHook:"R98",NosePlugs:"R98",NoseRing:"R98",PigNose:"R98",PigNoseHook:"R98"},Vw={BulkyDiaper:"R98",DiaperHarness:"R98",FemPelvisHarness:"R114",ForbiddenChastityBelt:"R98",FuturisticChastityBelt:"R98",FuturisticTrainingBelt:"R98",HarnessPanties1:"R98",HarnessPanties2:"R98",HeavyDutyBelt:"R98",HempRope:"R98",HipHarness:"R107",HybridChastityBelt:"R98",LatexDiaper:"R116",LeatherChastityBelt:"R98",LeatherStrapPanties1:"R98",LoveChastityBelt:"R98",MetalChastityBelt:"R98",ModularChastityBelt:"R99",ObedienceBelt:"R98",OrnateChastityBelt:"R98",PelvisChainLeash:"R98",PolishedChastityBelt:"R98",PoofyDiaper:"R98",PortalPanties:"R98",Ribbons:"R98",SciFiPleasurePanties:"R98",SleekLeatherChastityBelt:"R98",SteelChastityPanties:"R98",StraponPanties:"R98",StuddedChastityBelt:"R98",UntrainersThin:"R116",WaistLegHarness:"R111",WombTattoos:"R122"},Jw={Script:"R98"},Yw={AdultBabyHarness:"R98",BarrelCorset:"R115",ClassicLatexCorset:"R98",Corset2:"R98",Corset3:"R98",Corset4:"R98",Corset5:"R98",CrotchChain:"R98",ExtremeCorset:"R115",FemPelvisHarness:"R114",FuturisticHarness:"R98",HarnessBra1:"R98",HarnessBra2:"R98",HeavyLatexCorset:"R98",HempRopeHarness:"R98",HighSecurityHarness:"R98",HipHarness:"R107",LatexCorset1:"R98",LeatherBreastBinder:"R98",LeatherChestHarness1:"R98",LeatherHarness:"R98",LeatherStrapBra1:"R98",LeatherStrapHarness:"R98",LockingSwimsuit:"R98",LockingSwimsuit2:"R98",NavelBar1:"R98",NylonRopeHarness:"R98",RibbonCorset:"R112",Ribbons:"R98",ShinyLeotardLock:"R114",SteelBelt:"R115",StuddedHarness:"R98",ThinLeatherStraps:"R98",TightCorset:"R107",Underbust:"R98"},Xw={AdultBabyHarness:"R98",BarrelCorset:"R115",ClassicLatexCorset:"R98",Corset2:"R98",Corset3:"R98",Corset4:"R98",Corset5:"R98",CrotchChain:"R98",ExtremeCorset:"R115",FemPelvisHarness:"R114",FuturisticHarness:"R98",HarnessBra1:"R98",HarnessBra2:"R98",HeavyLatexCorset:"R98",HempRopeHarness:"R98",HighSecurityHarness:"R98",HipHarness:"R107",LatexCorset1:"R98",LeatherBreastBinder:"R98",LeatherChestHarness1:"R98",LeatherHarness:"R98",LeatherStrapBra1:"R98",LeatherStrapHarness:"R98",LockingSwimsuit:"R98",LockingSwimsuit2:"R98",NavelBar1:"R98",NylonRopeHarness:"R98",RibbonCorset:"R112",Ribbons:"R98",ShinyLeotardLock:"R114",SteelBelt:"R115",StuddedHarness:"R98",ThinLeatherStraps:"R98",TightCorset:"R107",Underbust:"R98"},Zw={Ballspreader:"R118",BasicCockring:"R98",BenWaBalls:"R98",ChastityPouch:"R98",ClitAndDildoVibratorbelt:"R98",ClitSuctionCup:"R98",ClitoralStimulator:"R98",DoubleEndDildo:"R98",FlatChastityCage:"R98",FullCasingCage:"R103",FullLatexSuitWand:"R98",FuturisticVibrator:"R98",HeavyWeightClamp:"R98",HempRopeBelt:"R98",InflatableVibeDildo:"R98",InflatableVibratingPanties:"R98",LatexNulge:"R104",LockingCockring:"R104",LoversVibrator:"R98",LoversVibratorRemote:"R98",MysteryBox:"R124",PenisDildo:"R98",PlasticChastityCage1:"R98",PlasticChastityCage2:"R98",ShockDildo:"R98",Stitches:"R98",TapeStrips:"R98",TechnoChastityCage:"R98",VibeEggPenisBase:"R98",VibratingDildo:"R98",VibratingEgg:"R98",VibratingLatexPanties:"R98",VibratorRemote:"R98",WandBelt:"R98",WiredEgg:"R98"},Qw={AdornedClitPiercing:"R98",BarbellClitPiercing:"R98",ChastityClitPiercing:"R98",ChastityClitShield:"R98",ClitRing:"R98",CockRingLeash:"R103",HighSecurityVulvaShield:"R98",JewelClitPiercing:"R98",RoundClitPiercing:"R98",StraightClitPiercing:"R98",TapedClitEgg:"R98",UrethralSound:"R103",VibeEggGlans:"R98",VibeHeartClitPiercing:"R98"},eS={JewelrySet:"R98"},tS={AngelMask:"R109",AnimalNoses:"R109",AnimeLenses:"R99",BunnyMask1:"R98",BunnyMask2:"R98",BunnyMask3:"R98",ButterflyMask:"R98",DemonMask:"R109",DominoMask:"R98",DroneMask:"R98",EldritchMask:"R109",FacePaint:"R98",FaceScars:"R109",FaceVeil:"R98",FestivalFoxMask:"R98",FoxMask:"R98",FuturisticVisor:"R98",Glitter:"R98",HeadHarness:"R98",Kigu2Hood:"R112",Kissmark:"R98",KittyMask1:"R98",KittyMask2:"R98",KittyMask3:"R98",LaceMask1:"R98",LaceMask2:"R98",LatexMuzzleMask:"R99",MedicalMask:"R98",NecromancerHelmet:"R109",OpenFaceHood:"R98",PetNose:"R98",RubberMask:"R107",ShinobiMask:"R98",Splatters:"R114",SwimCap:"R98",VenetianMask:"R98"},nS={Discreet:"R98",Full:"R98",Regular:"R98"},rS={AnimeGirlNecklace:"R106",Bandana:"R98",BeadNecklace:"R121",BlackHeart:"R98",BodyChainNecklace:"R98",CatsuitCollar:"R98",ChokerTattoo:"R98",EldritchNecklace:"R121",ElegantHeartNecklace:"R98",FlowerGarland:"R98",FurScarf:"R98",IDCard:"R98",Necklace1:"R98",Necklace2:"R98",Necklace3:"R98",Necklace4:"R98",NecklaceBallGag:"R98",NecklaceButterfly:"R98",NecklaceKey:"R98",NecklaceLock:"R98",NecklaceRope:"R98",NecklaceRoseBallGag:"R123",PearlNecklace1:"R105",PlantNecklace:"R121",RosePendant:"R118",RuffledCollar:"R120",SatinScarf:"R112"},iS={Nipples1:"R98",Nipples2:"R98",Nipples3:"R98"},oS={Bikini1:"R98",BoxerShorts:"R98",Briefs:"R98",BulkyDiaper:"R98",CatsuitPanties:"R98",ChinesePanties1:"R98",CockSock:"R98",CowPrintedPanties:"R98",CrotchPanties1:"R98",Diapers1:"R98",Diapers2:"R98",Diapers3:"R98",Diapers4:"R98",FemPelvisHarness:"R114",FloralPanties2:"R98",FlowerPanties:"R98",HarnessPanties1:"R98",HarnessPanties2:"R98",HipHarness:"R107",Jockstrap:"R98",KittyPanties1:"R98",LatexCrotchlessPanties:"R98",LatexDiaper:"R116",LatexPanties1:"R98",LatexPanties2:"R98",LeatherStrapPanties1:"R98",MaidPanties1:"R98",MaidPanties2:"R98",MaleCatsuitPanties:"R98",MicroThong:"R98",Panties1:"R98",Panties11:"R98",Panties12:"R98",Panties13:"R98",Panties14:"R98",Panties15:"R98",Panties16:"R98",Panties7:"R98",Panties8:"R98",PearlPanties1:"R98",PilotPanties:"R98",PoofyDiaper:"R98",PullDownPanties:"R125",RedBowPanties:"R98",SexyBeachPanties1:"R98",SportPanties:"R120",StringPanties1:"R98",StringPasty1:"R98",StringThong:"R98",SunstripePanties1:"R98",Thong:"R98",UntrainersThin:"R116",WaistLegHarness:"R111",WrapPanties1:"R98",ZipPanties1:"R98"},aS={HeHim:"R98",SheHer:"R98",TheyThem:"R118"},sS={Penis:"R98",Pussy1:"R98",Pussy2:"R98",Pussy3:"R98"},lS={AnimeGirlBoots:"R106",AnkleBoots1:"R98",AnkleStrapShoes:"R98",BalletHeels1:"R98",BarefootSandals1:"R98",Boots1:"R98",Clogs:"R99",CombatBoots:"R118",CustomHeels:"R107",DeluxeBoots:"R98",DutyShoes:"R98",Flippers:"R98",FullLegBoots:"R110",FuturisticHeels2:"R98",FuzzyBoots:"R98",Geta:"R98",HeellessHoof:"R113",Heels1:"R98",Heels2:"R98",Heels3:"R98",HoofBoots:"R115",IndoorSlippers:"R111",LatexAnkleShoes:"R98",LatexHeels:"R98",MaryShoes:"R102",MistressBoots:"R98",PawBoots:"R98",PonyBoots:"R98",PumpHighHeels:"R121",Sandals:"R98",SandalsRS:"R98",Shoes1:"R98",Shoes2:"R98",Shoes4:"R98",Shoes5:"R98",Sneakers1:"R98",Sneakers2:"R98",SneakersSport:"R98",SocialHeels:"R98",StilettoHeels:"R98",StreetBoots:"R98",StrictPonyBoots:"R104",TallerBoots:"R100",ThighBoots:"R98",ThighHighLatexHeels:"R98",WesternBoots:"R98",WitchShoes:"R112",WoollyBootsTall:"R98",ZipperBBoots:"R120"},uS={CowPrintedSocks:"R98",FootlessSocks1:"R98",GradientPantyhose:"R98",HaremStockings:"R98",KneePads:"R98",LatexSocks1:"R98",LeatherSocks1:"R98",LongFishnets:"R110",Pantyhose1:"R98",Pantyhose2:"R98",ReverseBunnySuit:"R98",RippedPantyhose:"R111",Socks0:"R98",Socks1:"R98",Socks2:"R98",Socks3:"R98",Socks4:"R98",Socks5:"R98",Socks6:"R98",SocksFur:"R98",SocksStriped1:"R98",Stockings1:"R98",Stockings2:"R98",Stockings3:"R98",Stockings4:"R98",VSocks1:"R98",YuletideVelvetWarmth:"R104"},cS={CowPrintedSocks:"R98",FootlessSocks1:"R98",HaremStockings:"R98",HeelBinders:"R110",KneePads:"R98",LatexSocks1:"R98",LeatherSocks1:"R98",LooseSocks:"R98",Socks0:"R98",Socks1:"R98",Socks2:"R98",Socks3:"R98",Socks4:"R98",Socks5:"R98",Socks6:"R98",SocksFur:"R98",SocksStriped1:"R98",Stockings1:"R98",Stockings2:"R98",Stockings3:"R98",Stockings4:"R98",VSocks1:"R98"},dS={CowPrintedSocks:"R98",FootlessSocks1:"R98",HaremStockings:"R98",HeelBinders:"R110",KneePads:"R98",LatexSocks1:"R98",LeatherSocks1:"R98",LooseSocks:"R98",Socks0:"R98",Socks1:"R98",Socks2:"R98",Socks3:"R98",Socks4:"R98",Socks5:"R98",Socks6:"R98",SocksFur:"R98",SocksStriped1:"R98",Stockings1:"R98",Stockings2:"R98",Stockings3:"R98",Stockings4:"R98",VSocks1:"R98"},hS={BartenderVest:"R115",BartenderVestM:"R115",Blouse1:"R98",Catsuit:"R98",FishnetTop:"R98",LatexCatsuit:"R98",MaleSeamlessCatsuit:"R98",PilotSuit:"R98",ReverseBunnySuit:"R98",SeamlessCatsuit:"R98",SeethroughSuit:"R98",SeethroughSuitZip:"R98",ShinyLeotard:"R114",SleevelessCatsuit:"R98",SleevelessSlimLatexLeotard:"R98"},fS={Catsuit:"R98",CatsuitPanties:"R98",LatexCatsuit:"R98",LongFishnets:"R110",MaleCatsuitPanties:"R98",MaleSeamlessCatsuit:"R98",Pantyhose1:"R98",Pantyhose2:"R98",PilotPanties:"R98",PilotSuit:"R98",ReverseBunnySuit:"R98",RippedPantyhose:"R111",SeamlessCatsuit:"R98",SeethroughSuit:"R98",SeethroughSuitZip:"R98",Stockings1:"R98",Stockings2:"R98",Stockings3:"R98",Stockings4:"R98",YogaPants:"R121"},pS={BunnyTailStrap:"R98",CowtailStrap:"R98",DemonPlug:"R98",DragonTailStrap1:"R98",DragonTailStrap2Left:"R104",DragonTailStrap2Right:"R104",DragonsTail:"R119",FoxTailStrap:"R122",FoxTailsStrap:"R98",HorseTailStrap:"R98",HorseTailStrap1:"R98",KitsuneTailStraps:"R124",KittenTailStrap1:"R98",KittenTailStrap2:"R98",LargeBushyTail:"R115",LatexFoxTail:"R109",LionTailStrap:"R98",MouseTailStrap1:"R98",MouseTailStrap2:"R98",PuppyTailStrap:"R98",PuppyTailStrap1:"R98",RaccoonStrap:"R98",RaccoonTailStrap:"R98",SkunkTail:"R109",SuccubusHeartTailStrap:"R98",SuccubusTailStrap:"R98",TailStrap:"R98",Tentacles:"R98",WolfTailStrap1:"R98",WolfTailStrap2:"R98",WolfTailStrap3:"R98"},gS={AngelFeather:"R98",AngelWings:"R98",BatWings:"R98",BeeWings:"R98",CyberWings:"R98",DevilWings:"R98",DragonWings:"R107",FairyWings:"R98",FallenAngelWings:"R98",PixieWings:"R98",SteampunkWings:"R98",SuccubusFeather:"R98",SuccubusWings:"R98"},mS={AnkletLeft:DR,AnkletRight:HR,ArmsLeft:NR,ArmsRight:GR,Blush:WR,BodyLower:qR,BodyMarkings:zR,BodyStyle:KR,BodyUpper:UR,Bra:VR,Bracelet:JR,Cloth:YR,ClothAccessory:XR,ClothLower:ZR,ClothOuter:QR,Corset:ew,Decals:tw,Emoticon:nw,Eyebrows:rw,Eyes:iw,Eyes2:ow,EyeShadow:aw,FaceMarkings:sw,FacialHair:lw,Fluids:uw,Garters:cw,Glasses:dw,Gloves:hw,HairAccessory1:fw,HairAccessory2:pw,HairAccessory3:gw,HairBack:mw,HairFront:vw,HandAccessoryLeft:yw,HandAccessoryRight:bw,HandsLeft:Rw,HandsRight:ww,Hat:Sw,Head:Bw,Height:kw,ItemAddon:Cw,ItemArms:_w,ItemBoots:xw,ItemBreast:Pw,ItemButt:Ew,ItemDevices:Mw,ItemEars:Iw,ItemFeet:jw,ItemHandheld:Ow,ItemHands:Aw,ItemHead:$w,ItemHood:Fw,ItemLegs:Lw,ItemMisc:Tw,ItemMouth:Dw,ItemMouth2:Hw,ItemMouth3:Nw,ItemNeck:Gw,ItemNeckAccessories:Ww,ItemNeckRestraints:qw,ItemNipples:zw,ItemNipplesPiercings:Kw,ItemNose:Uw,ItemPelvis:Vw,ItemScript:Jw,ItemTorso:Yw,ItemTorso2:Xw,ItemVulva:Zw,ItemVulvaPiercings:Qw,Jewelry:eS,Mask:tS,Mouth:nS,Necklace:rS,Nipples:iS,Panties:oS,Pronouns:aS,Pussy:sS,Shoes:lS,Socks:uS,SocksLeft:cS,SocksRight:dS,Suit:hS,SuitLower:fS,TailStraps:pS,Wings:gS},vS=Object.freeze({__proto__:null,AnkletLeft:DR,AnkletRight:HR,ArmsLeft:NR,ArmsRight:GR,Blush:WR,BodyLower:qR,BodyMarkings:zR,BodyStyle:KR,BodyUpper:UR,Bra:VR,Bracelet:JR,Cloth:YR,ClothAccessory:XR,ClothLower:ZR,ClothOuter:QR,Corset:ew,Decals:tw,Emoticon:nw,EyeShadow:aw,Eyebrows:rw,Eyes:iw,Eyes2:ow,FaceMarkings:sw,FacialHair:lw,Fluids:uw,Garters:cw,Glasses:dw,Gloves:hw,HairAccessory1:fw,HairAccessory2:pw,HairAccessory3:gw,HairBack:mw,HairFront:vw,HandAccessoryLeft:yw,HandAccessoryRight:bw,HandsLeft:Rw,HandsRight:ww,Hat:Sw,Head:Bw,Height:kw,ItemAddon:Cw,ItemArms:_w,ItemBoots:xw,ItemBreast:Pw,ItemButt:Ew,ItemDevices:Mw,ItemEars:Iw,ItemFeet:jw,ItemHandheld:Ow,ItemHands:Aw,ItemHead:$w,ItemHood:Fw,ItemLegs:Lw,ItemMisc:Tw,ItemMouth:Dw,ItemMouth2:Hw,ItemMouth3:Nw,ItemNeck:Gw,ItemNeckAccessories:Ww,ItemNeckRestraints:qw,ItemNipples:zw,ItemNipplesPiercings:Kw,ItemNose:Uw,ItemPelvis:Vw,ItemScript:Jw,ItemTorso:Yw,ItemTorso2:Xw,ItemVulva:Zw,ItemVulvaPiercings:Qw,Jewelry:eS,Mask:tS,Mouth:nS,Necklace:rS,Nipples:iS,Panties:oS,Pronouns:aS,Pussy:sS,Shoes:lS,Socks:uS,SocksLeft:cS,SocksRight:dS,Suit:hS,SuitLower:fS,TailStraps:pS,Wings:gS,default:mS});const yS={},bS=Object.freeze({root:"mbs-shop-root",select:"mbs-shop-select",style:"mbs-shop-style"});function RS(){if(this.value){const e=yS[this.value];if(!e)return;Shop2Vars.Filters.MBS_VersionFilter=t=>e[`${t.Asset.Group.Name}${t.Asset.Name}`]?["Buy","Sell","Preview"]:[],Shop2.ApplyItemFilters()}else delete Shop2Vars.Filters.MBS_VersionFilter,Shop2.ApplyItemFilters()}function wS(e){document.getElementById(bS.style)||document.body.append(E.jsx("style",{id:bS.style,children:"#mbs-shop-root {\n  display: grid;\n  grid-template-rows: 2fr 3fr;\n}\n#mbs-shop-root > span {\n  color: white;\n  place-self: center center;\n  user-select: none;\n}\n\n#mbs-shop-select {\n  background-color: var(--mbs-button-color);\n  border: min(0.3dvh, 0.15dvw) solid var(--mbs-border-color);\n  box-sizing: border-box;\n  color: var(--mbs-text-color);\n  cursor: pointer;\n  font: inherit;\n}\n#mbs-shop-select:disabled {\n  background-color: color-mix(in srgb, var(--mbs-background-color) 60%, black 40%);\n  cursor: auto;\n}\n\n/* stylelint-disable selector-id-pattern */\n#Shop2GroupSelect, #Shop2PoseSelect {\n  z-index: 1;\n}".toString()})),(0===Shop2InitVars.Items.length||e)&&(Shop2InitVars.Items=function(){const e=Object.fromEntries(Object.entries(yS).filter(([e])=>"R98"!==e).flatMap(([e,t])=>Object.entries(t)));return Shop2.ParseAssets(Asset.filter(t=>t.Group.Name===t.DynamicGroupName&&(e[`${t.Group.Name}${t.Name}`]||(Shop2Consts.BuyGroups[t.BuyGroup]?.Value??t.Value)>0)&&!ShopHideGenderedAsset(t)).sort((e,t)=>e.Group.Category.localeCompare(t.Group.Category)||e.Group.Description.localeCompare(t.Group.Description)||e.Description.localeCompare(t.Description)))}())}Fh("new_items_screen",{async afterLoad(){Ph.log("Initializing new item screen hooks");if(null==GameVersionFormat.exec(GameVersion))return void Ph.error(`Invalid BC version: "${GameVersion}"`);for(const[e,t]of kh(vS))for(const[n,r]of kh(t)){const t=AssetGet("Female3DCG",e,n);null!=t&&(t.Group.Name===t.DynamicGroupName&&(yS[r]??={},yS[r][`${t.DynamicGroupName}${t.Name}`]=t))}Shop2.Elements.MBS={Coords:[135,445,420,180],Mode:new Set(["Preview","Buy","Sell"]),Draw:()=>null,Load:async()=>{let e=document.getElementById(bS.root);if(!e){const t=Object.keys(yS).filter(e=>"R98"!==e).sort((e,t)=>{const n=Number.parseInt(e.slice(1),10),r=Number.parseInt(t.slice(1),10);return n>r?-1:r>n?1:0});e=E.jsxs("label",{id:bS.root,children:[E.jsx("span",{children:"MBS: Filter by BC version"}),E.jsxs("select",{id:bS.select,onChange:RS,children:[E.jsx("option",{selected:!0,children:"All versions"}),E.jsx("hr",{}),t.map(e=>E.jsx("option",{children:e}))]})]}),e.querySelector("option[selected]")?.setAttribute("value",""),document.body.append(e)}e.toggleAttribute("hidden",!1)},Resize:()=>{ElementPositionFix(bS.root,36,...Shop2.Elements.MBS.Coords)},Unload:()=>{document.getElementById(bS.root)?.toggleAttribute("hidden",!0)},Exit:()=>{ElementRemove(bS.root)}},Kh.hookFunction("Shop2Load",0,(e,t)=>(wS(!1),t(e))),"Shop2"===CurrentScreen&&(wS(!0),Shop2.Elements.MBS.Mode.has(Shop2Vars.Mode)&&(Shop2.Elements.MBS.Load?.(),Shop2.Elements.MBS.Resize?.(!0)))}});const SS=Kh.getOriginalHash,BS=t;return Ph.log(`Initializing MBS version ${t}`),Fh("mbs",{async afterLoad(){!function(){const e={};for(const[t,n]of Object.entries(Xh)){const r=Kh.getOriginalHash(t);n.has(r)||(e[t]=r)}const t=Object.values(e).length;0!==t&&Ph.warn(`Found ${t} patched functions with an unknown hash`,e)}(),document.body.appendChild(E.jsx("style",{id:"mbs-style",children:":root {\n  --mbs-background-color: white;\n  --mbs-button-color: white;\n  --mbs-hover-color: cyan;\n  --mbs-tooltip-color: lightyellow;\n  --mbs-border-color: black;\n  --mbs-text-color: black;\n  --mbs-font-small: min(3.5dvh, 1.75dvw);\n  --mbs-font-large: min(5dvh, 2.5dvw);\n  --mbs-font-family: arial, sans-serif;\n}\n\n.mbs-timer {\n  height: min(6dvh, 3dvw);\n  text-align: center;\n  width: min(21dvh, 10.5dvw);\n}\n\n.mbs-screen {\n  display: grid;\n  position: fixed;\n  text-align: center;\n  user-select: none;\n  grid-gap: min(2dvh, 1dvw);\n  color: var(--mbs-text-color);\n  font-family: var(--mbs-font-family);\n  font-size: var(--mbs-font-small);\n}\n.mbs-screen .button,\n.mbs-screen .custom-select {\n  --button-color: var(--mbs-button-color);\n  --hover-color: var(--mbs-hover-color);\n}\n.mbs-screen .button-styling,\n.mbs-screen .button-tooltip {\n  border-color: var(--mbs-border-color);\n}\n.mbs-screen h1, .mbs-screen h2, .mbs-screen h3, .mbs-screen h4, .mbs-screen h5, .mbs-screen h6, .mbs-screen [role=heading], .mbs-screen p, .mbs-screen ul {\n  align-items: center;\n  align-self: center;\n}\n.mbs-screen h1 {\n  font-size: var(--mbs-font-large);\n}\n.mbs-screen h2 {\n  margin: min(1dvh, 0.5dvw);\n}\n.mbs-screen ul {\n  margin: 0;\n  text-align: left;\n}\n.mbs-screen input {\n  background-color: var(--mbs-background-color);\n  box-sizing: border-box;\n  color: var(--mbs-text-color);\n  font: inherit;\n  font-family: var(--mbs-font-family);\n  font-size: var(--mbs-font-small);\n  padding: unset;\n}\n.mbs-screen input:invalid {\n  background-color: #fbb;\n  box-shadow: 0 0 3px 2px #c22;\n}\n.mbs-screen input[type=checkbox] {\n  border: min(0.3dvh, 0.15dvw) solid var(--mbs-border-color);\n  cursor: pointer;\n  height: min(7dvh, 3.5dvw);\n  width: min(7dvh, 3.5dvw);\n}\n.mbs-screen input[type=checkbox]:hover {\n  background-color: var(--mbs-hover-color);\n}\n.mbs-screen input[type=checkbox]:disabled {\n  background-color: color-mix(in srgb, var(--mbs-background-color) 60%, black 40%);\n  cursor: auto;\n}\n.mbs-screen input[type=checkbox]::before {\n  height: min(4.6dvh, 2.3dvw);\n  width: min(4.6dvh, 2.3dvw);\n}\n.mbs-screen select {\n  background-color: var(--mbs-button-color);\n  border: min(0.3dvh, 0.15dvw) solid var(--mbs-border-color);\n  box-sizing: border-box;\n  color: var(--mbs-text-color);\n  cursor: pointer;\n  font: inherit;\n  font-family: var(--mbs-font-family);\n  font-size: var(--mbs-font-small);\n  text-overflow: ellipsis;\n}\n.mbs-screen select:disabled {\n  background-color: color-mix(in srgb, var(--mbs-background-color) 60%, black 40%);\n  cursor: auto;\n}\n.mbs-screen label:not(:has(:disabled)) > span {\n  cursor: pointer;\n}\n.mbs-screen .button,\n.mbs-screen .button-tooltip {\n  border-width: min(0.3dvh, 0.15dvw);\n}".toString()}))}}),e.API_VERSION=RR,e.MBS_VERSION=BS,e._getOriginalHash=SS,e._toItemBundles=ep,e._unpackSettings=Pb,e.css=vR,e.getDebug=SR,e.runTests=LR,e.wheelEvents=bR,e.wheelOutfits=pR,e}({});
//# sourceMappingURL=mbs.js.map
