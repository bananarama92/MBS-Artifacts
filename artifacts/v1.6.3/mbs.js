/*!
 * MBS: Maid's Bondage Scripts
 *
 * Copyright (C) 2023-2024 Bananarama92
 *
 * This program is free software: you can redistribute it and/or modify it under the terms of
 * the GNU General Public License as published by the Free Software Foundation,
 * either version 3 of the License, or (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY;
 * without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
 * See the GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License along with this program.
 * If not, see https://www.gnu.org/licenses/.
 */
var mbs=function(e){"use strict";const t="1.6.3";var n="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function r(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var i={},o={};Object.defineProperty(o,"__esModule",{value:!0});o.setAttributes=void 0;function a(e,t){for(const n of Object.keys(e))n in t&&(t[n]=e[n])}o.setAttributes=function(e,t){for(const n of Object.keys(t)){if("__source"===n||"__self"===n)continue;const r=t[n];if(n.startsWith("on")){const t=n.replace(/Capture$/,""),i=n!==t,o=t.toLowerCase().substring(2);e.addEventListener(o,r,i)}else"style"===n&&"string"!=typeof r?a(r,e.style):"dangerouslySetInnerHTML"===n?e.innerHTML=r:!0===r?e.setAttribute(n,n):(r||0===r)&&e.setAttribute(n,r.toString())}};var s={};Object.defineProperty(s,"__esModule",{value:!0});s.createDomElement=s.applyChildren=void 0;function l(e,t){t instanceof Element?e.appendChild(t):"string"==typeof t||"number"==typeof t?e.appendChild(document.createTextNode(t.toString())):console.warn("Unknown type to append: ",t)}s.applyChildren=function e(t,n){for(const r of n)(r||0===r)&&(Array.isArray(r)?e(t,r):l(t,r))};s.createDomElement=function(e,t){const n=(null==t?void 0:t.is)?{is:t.is}:void 0;return(null==t?void 0:t.xmlns)?document.createElementNS(t.xmlns,e,n):document.createElement(e,n)},Object.defineProperty(i,"__esModule",{value:!0});i.jsxDEV=p=i.jsxs=f=i.jsx=void 0;const u=o,c=s;function d(e,t){if("function"==typeof e)return e(t);const{children:n,...r}=t,i=(0,c.createDomElement)(e,r);return r&&(0,u.setAttributes)(i,r),(0,c.applyChildren)(i,[n]),i}var f=i.jsx=d,p=i.jsxs=d;i.jsxDEV=d;var h={},m={};Object.defineProperty(m,"__esModule",{value:!0});m.h=m.createElement=void 0;const g=o,v=s;function b(e,t,...n){if("function"==typeof e)return e({...t,children:n});const r=(0,v.createDomElement)(e,t);return t&&(0,g.setAttributes)(r,t),(0,v.applyChildren)(r,n),r}m.createElement=b;m.h=b;var y={};Object.defineProperty(y,"__esModule",{value:!0}),function(e){var t=n&&n.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),r=n&&n.__exportStar||function(e,n){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(n,r)||t(n,e,r)};Object.defineProperty(e,"__esModule",{value:!0}),r(m,e),r(i,e),r(y,e)}(h);Object.create;Object.create;function w(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)}function S(e,t,n,r,i){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?i.call(e,n):i?i.value=n:t.set(e,n),n}"function"==typeof SuppressedError&&SuppressedError;var C="object"==typeof global&&global&&global.Object===Object&&global,x="object"==typeof self&&self&&self.Object===Object&&self,_=C||x||Function("return this")(),$=_.Symbol,I=Object.prototype,O=I.hasOwnProperty,k=I.toString,E=$?$.toStringTag:void 0;var P=Object.prototype.toString;var M="[object Null]",B="[object Undefined]",j=$?$.toStringTag:void 0;function A(e){return null==e?void 0===e?B:M:j&&j in Object(e)?function(e){var t=O.call(e,E),n=e[E];try{e[E]=void 0;var r=!0}catch(e){}var i=k.call(e);return r&&(t?e[E]=n:delete e[E]),i}(e):function(e){return P.call(e)}(e)}function N(e){return null!=e&&"object"==typeof e}var T="[object Symbol]";function F(e){return"symbol"==typeof e||N(e)&&A(e)==T}var D=NaN;function L(e){return"number"==typeof e?e:F(e)?D:+e}function R(e,t){for(var n=-1,r=null==e?0:e.length,i=Array(r);++n<r;)i[n]=t(e[n],n,e);return i}var W=Array.isArray,G=1/0,z=$?$.prototype:void 0,H=z?z.toString:void 0;function q(e){if("string"==typeof e)return e;if(W(e))return R(e,q)+"";if(F(e))return H?H.call(e):"";var t=e+"";return"0"==t&&1/e==-G?"-0":t}function U(e,t){return function(n,r){var i;if(void 0===n&&void 0===r)return t;if(void 0!==n&&(i=n),void 0!==r){if(void 0===i)return r;"string"==typeof n||"string"==typeof r?(n=q(n),r=q(r)):(n=L(n),r=L(r)),i=e(n,r)}return i}}var V=U((function(e,t){return e+t}),0),K=/\s/;function J(e){for(var t=e.length;t--&&K.test(e.charAt(t)););return t}var Y=/^\s+/;function Z(e){return e?e.slice(0,J(e)+1).replace(Y,""):e}function Q(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}var X=NaN,ee=/^[-+]0x[0-9a-f]+$/i,te=/^0b[01]+$/i,ne=/^0o[0-7]+$/i,re=parseInt;function ie(e){if("number"==typeof e)return e;if(F(e))return X;if(Q(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=Q(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=Z(e);var n=te.test(e);return n||ne.test(e)?re(e.slice(2),n?2:8):ee.test(e)?X:+e}var oe=1/0,ae=17976931348623157e292;function se(e){return e?(e=ie(e))===oe||e===-oe?(e<0?-1:1)*ae:e==e?e:0:0===e?e:0}function le(e){var t=se(e),n=t%1;return t==t?n?t-n:t:0}function ue(e){return e}var ce="[object AsyncFunction]",de="[object Function]",fe="[object GeneratorFunction]",pe="[object Proxy]";function he(e){if(!Q(e))return!1;var t=A(e);return t==de||t==fe||t==ce||t==pe}var me,ge=_["__core-js_shared__"],ve=(me=/[^.]+$/.exec(ge&&ge.keys&&ge.keys.IE_PROTO||""))?"Symbol(src)_1."+me:"";var be=Function.prototype.toString;function ye(e){if(null!=e){try{return be.call(e)}catch(e){}try{return e+""}catch(e){}}return""}var we=/^\[object .+?Constructor\]$/,Se=Function.prototype,Ce=Object.prototype,xe=Se.toString,_e=Ce.hasOwnProperty,$e=RegExp("^"+xe.call(_e).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function Ie(e){return!(!Q(e)||function(e){return!!ve&&ve in e}(e))&&(he(e)?$e:we).test(ye(e))}function Oe(e,t){var n=function(e,t){return null==e?void 0:e[t]}(e,t);return Ie(n)?n:void 0}var ke=Oe(_,"WeakMap"),Ee=ke&&new ke,Pe=Ee?function(e,t){return Ee.set(e,t),e}:ue,Me=Object.create,Be=function(){function e(){}return function(t){if(!Q(t))return{};if(Me)return Me(t);e.prototype=t;var n=new e;return e.prototype=void 0,n}}();function je(e){return function(){var t=arguments;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var n=Be(e.prototype),r=e.apply(n,t);return Q(r)?r:n}}var Ae=1;function Ne(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}var Te=Math.max;function Fe(e,t,n,r){for(var i=-1,o=e.length,a=n.length,s=-1,l=t.length,u=Te(o-a,0),c=Array(l+u),d=!r;++s<l;)c[s]=t[s];for(;++i<a;)(d||i<o)&&(c[n[i]]=e[i]);for(;u--;)c[s++]=e[i++];return c}var De=Math.max;function Le(e,t,n,r){for(var i=-1,o=e.length,a=-1,s=n.length,l=-1,u=t.length,c=De(o-s,0),d=Array(c+u),f=!r;++i<c;)d[i]=e[i];for(var p=i;++l<u;)d[p+l]=t[l];for(;++a<s;)(f||i<o)&&(d[p+n[a]]=e[i++]);return d}function Re(){}var We=4294967295;function Ge(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=We,this.__views__=[]}function ze(){}Ge.prototype=Be(Re.prototype),Ge.prototype.constructor=Ge;var He=Ee?function(e){return Ee.get(e)}:ze,qe={},Ue=Object.prototype.hasOwnProperty;function Ve(e){for(var t=e.name+"",n=qe[t],r=Ue.call(qe,t)?n.length:0;r--;){var i=n[r],o=i.func;if(null==o||o==e)return i.name}return t}function Ke(e,t){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!t,this.__index__=0,this.__values__=void 0}function Je(e,t){var n=-1,r=e.length;for(t||(t=Array(r));++n<r;)t[n]=e[n];return t}function Ye(e){if(e instanceof Ge)return e.clone();var t=new Ke(e.__wrapped__,e.__chain__);return t.__actions__=Je(e.__actions__),t.__index__=e.__index__,t.__values__=e.__values__,t}Ke.prototype=Be(Re.prototype),Ke.prototype.constructor=Ke;var Ze=Object.prototype.hasOwnProperty;function Qe(e){if(N(e)&&!W(e)&&!(e instanceof Ge)){if(e instanceof Ke)return e;if(Ze.call(e,"__wrapped__"))return Ye(e)}return new Ke(e)}function Xe(e){var t=Ve(e),n=Qe[t];if("function"!=typeof n||!(t in Ge.prototype))return!1;if(e===n)return!0;var r=He(n);return!!r&&e===r[0]}Qe.prototype=Re.prototype,Qe.prototype.constructor=Qe;var et=Date.now;function tt(e){var t=0,n=0;return function(){var r=et(),i=16-(r-n);if(n=r,i>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}var nt=tt(Pe),rt=/\{\n\/\* \[wrapped with (.+)\] \*/,it=/,? & /;var ot=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/;function at(e){return function(){return e}}var st=function(){try{var e=Oe(Object,"defineProperty");return e({},"",{}),e}catch(e){}}(),lt=st?function(e,t){return st(e,"toString",{configurable:!0,enumerable:!1,value:at(t),writable:!0})}:ue,ut=tt(lt);function ct(e,t){for(var n=-1,r=null==e?0:e.length;++n<r&&!1!==t(e[n],n,e););return e}function dt(e,t,n,r){for(var i=e.length,o=n+(r?1:-1);r?o--:++o<i;)if(t(e[o],o,e))return o;return-1}function ft(e){return e!=e}function pt(e,t,n){return t==t?function(e,t,n){for(var r=n-1,i=e.length;++r<i;)if(e[r]===t)return r;return-1}(e,t,n):dt(e,ft,n)}function ht(e,t){return!!(null==e?0:e.length)&&pt(e,t,0)>-1}var mt=[["ary",128],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",32],["partialRight",64],["rearg",256]];function gt(e,t,n){var r=t+"";return ut(e,function(e,t){var n=t.length;if(!n)return e;var r=n-1;return t[r]=(n>1?"& ":"")+t[r],t=t.join(n>2?", ":" "),e.replace(ot,"{\n/* [wrapped with "+t+"] */\n")}(r,function(e,t){return ct(mt,(function(n){var r="_."+n[0];t&n[1]&&!ht(e,r)&&e.push(r)})),e.sort()}(function(e){var t=e.match(rt);return t?t[1].split(it):[]}(r),n)))}var vt=1,bt=2,yt=4,wt=8,St=32,Ct=64;function xt(e,t,n,r,i,o,a,s,l,u){var c=t&wt;t|=c?St:Ct,(t&=~(c?Ct:St))&yt||(t&=~(vt|bt));var d=[e,t,i,c?o:void 0,c?a:void 0,c?void 0:o,c?void 0:a,s,l,u],f=n.apply(void 0,d);return Xe(e)&&nt(f,d),f.placeholder=r,gt(f,e,t)}function _t(e){return e.placeholder}var $t=9007199254740991,It=/^(?:0|[1-9]\d*)$/;function Ot(e,t){var n=typeof e;return!!(t=null==t?$t:t)&&("number"==n||"symbol"!=n&&It.test(e))&&e>-1&&e%1==0&&e<t}var kt=Math.min;var Et="__lodash_placeholder__";function Pt(e,t){for(var n=-1,r=e.length,i=0,o=[];++n<r;){var a=e[n];a!==t&&a!==Et||(e[n]=Et,o[i++]=n)}return o}var Mt=1,Bt=2,jt=8,At=16,Nt=128,Tt=512;function Ft(e,t,n,r,i,o,a,s,l,u){var c=t&Nt,d=t&Mt,f=t&Bt,p=t&(jt|At),h=t&Tt,m=f?void 0:je(e);return function g(){for(var v=arguments.length,b=Array(v),y=v;y--;)b[y]=arguments[y];if(p)var w=_t(g),S=function(e,t){for(var n=e.length,r=0;n--;)e[n]===t&&++r;return r}(b,w);if(r&&(b=Fe(b,r,i,p)),o&&(b=Le(b,o,a,p)),v-=S,p&&v<u){var C=Pt(b,w);return xt(e,t,Ft,g.placeholder,n,b,C,s,l,u-v)}var x=d?n:this,$=f?x[e]:e;return v=b.length,s?b=function(e,t){for(var n=e.length,r=kt(t.length,n),i=Je(e);r--;){var o=t[r];e[r]=Ot(o,n)?i[o]:void 0}return e}(b,s):h&&v>1&&b.reverse(),c&&l<v&&(b.length=l),this&&this!==_&&this instanceof g&&($=m||je($)),$.apply(x,b)}}var Dt=1;var Lt="__lodash_placeholder__",Rt=1,Wt=2,Gt=4,zt=8,Ht=128,qt=256,Ut=Math.min;var Vt="Expected a function",Kt=1,Jt=2,Yt=8,Zt=16,Qt=32,Xt=64,en=Math.max;function tn(e,t,n,r,i,o,a,s){var l=t&Jt;if(!l&&"function"!=typeof e)throw new TypeError(Vt);var u=r?r.length:0;if(u||(t&=~(Qt|Xt),r=i=void 0),a=void 0===a?a:en(le(a),0),s=void 0===s?s:le(s),u-=i?i.length:0,t&Xt){var c=r,d=i;r=i=void 0}var f=l?void 0:He(e),p=[e,t,n,r,i,c,d,o,a,s];if(f&&function(e,t){var n=e[1],r=t[1],i=n|r,o=i<(Rt|Wt|Ht),a=r==Ht&&n==zt||r==Ht&&n==qt&&e[7].length<=t[8]||r==(Ht|qt)&&t[7].length<=t[8]&&n==zt;if(!o&&!a)return e;r&Rt&&(e[2]=t[2],i|=n&Rt?0:Gt);var s=t[3];if(s){var l=e[3];e[3]=l?Fe(l,s,t[4]):s,e[4]=l?Pt(e[3],Lt):t[4]}(s=t[5])&&(l=e[5],e[5]=l?Le(l,s,t[6]):s,e[6]=l?Pt(e[5],Lt):t[6]),(s=t[7])&&(e[7]=s),r&Ht&&(e[8]=null==e[8]?t[8]:Ut(e[8],t[8])),null==e[9]&&(e[9]=t[9]),e[0]=t[0],e[1]=i}(p,f),e=p[0],t=p[1],n=p[2],r=p[3],i=p[4],!(s=p[9]=void 0===p[9]?l?0:e.length:en(p[9]-u,0))&&t&(Yt|Zt)&&(t&=~(Yt|Zt)),t&&t!=Kt)h=t==Yt||t==Zt?function(e,t,n){var r=je(e);return function i(){for(var o=arguments.length,a=Array(o),s=o,l=_t(i);s--;)a[s]=arguments[s];var u=o<3&&a[0]!==l&&a[o-1]!==l?[]:Pt(a,l);return(o-=u.length)<n?xt(e,t,Ft,i.placeholder,void 0,a,u,void 0,void 0,n-o):Ne(this&&this!==_&&this instanceof i?r:e,this,a)}}(e,t,s):t!=Qt&&t!=(Kt|Qt)||i.length?Ft.apply(void 0,p):function(e,t,n,r){var i=t&Dt,o=je(e);return function t(){for(var a=-1,s=arguments.length,l=-1,u=r.length,c=Array(u+s),d=this&&this!==_&&this instanceof t?o:e;++l<u;)c[l]=r[l];for(;s--;)c[l++]=arguments[++a];return Ne(d,i?n:this,c)}}(e,t,n,r);else var h=function(e,t,n){var r=t&Ae,i=je(e);return function t(){return(this&&this!==_&&this instanceof t?i:e).apply(r?n:this,arguments)}}(e,t,n);return gt((f?Pe:nt)(h,p),e,t)}var nn=128;function rn(e,t,n){return t=n?void 0:t,t=e&&null==t?e.length:t,tn(e,nn,void 0,void 0,void 0,void 0,t)}function on(e,t,n){"__proto__"==t&&st?st(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}function an(e,t){return e===t||e!=e&&t!=t}var sn=Object.prototype.hasOwnProperty;function ln(e,t,n){var r=e[t];sn.call(e,t)&&an(r,n)&&(void 0!==n||t in e)||on(e,t,n)}function un(e,t,n,r){var i=!n;n||(n={});for(var o=-1,a=t.length;++o<a;){var s=t[o],l=r?r(n[s],e[s],s,n,e):void 0;void 0===l&&(l=e[s]),i?on(n,s,l):ln(n,s,l)}return n}var cn=Math.max;function dn(e,t,n){return t=cn(void 0===t?e.length-1:t,0),function(){for(var r=arguments,i=-1,o=cn(r.length-t,0),a=Array(o);++i<o;)a[i]=r[t+i];i=-1;for(var s=Array(t+1);++i<t;)s[i]=r[i];return s[t]=n(a),Ne(e,this,s)}}function fn(e,t){return ut(dn(e,t,ue),e+"")}var pn=9007199254740991;function hn(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=pn}function mn(e){return null!=e&&hn(e.length)&&!he(e)}function gn(e,t,n){if(!Q(n))return!1;var r=typeof t;return!!("number"==r?mn(n)&&Ot(t,n.length):"string"==r&&t in n)&&an(n[t],e)}function vn(e){return fn((function(t,n){var r=-1,i=n.length,o=i>1?n[i-1]:void 0,a=i>2?n[2]:void 0;for(o=e.length>3&&"function"==typeof o?(i--,o):void 0,a&&gn(n[0],n[1],a)&&(o=i<3?void 0:o,i=1),t=Object(t);++r<i;){var s=n[r];s&&e(t,s,r,o)}return t}))}var bn=Object.prototype;function yn(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||bn)}function wn(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}function Sn(e){return N(e)&&"[object Arguments]"==A(e)}var Cn=Object.prototype,xn=Cn.hasOwnProperty,_n=Cn.propertyIsEnumerable,$n=Sn(function(){return arguments}())?Sn:function(e){return N(e)&&xn.call(e,"callee")&&!_n.call(e,"callee")};function In(){return!1}var On="object"==typeof e&&e&&!e.nodeType&&e,kn=On&&"object"==typeof module&&module&&!module.nodeType&&module,En=kn&&kn.exports===On?_.Buffer:void 0,Pn=(En?En.isBuffer:void 0)||In,Mn={};function Bn(e){return function(t){return e(t)}}Mn["[object Float32Array]"]=Mn["[object Float64Array]"]=Mn["[object Int8Array]"]=Mn["[object Int16Array]"]=Mn["[object Int32Array]"]=Mn["[object Uint8Array]"]=Mn["[object Uint8ClampedArray]"]=Mn["[object Uint16Array]"]=Mn["[object Uint32Array]"]=!0,Mn["[object Arguments]"]=Mn["[object Array]"]=Mn["[object ArrayBuffer]"]=Mn["[object Boolean]"]=Mn["[object DataView]"]=Mn["[object Date]"]=Mn["[object Error]"]=Mn["[object Function]"]=Mn["[object Map]"]=Mn["[object Number]"]=Mn["[object Object]"]=Mn["[object RegExp]"]=Mn["[object Set]"]=Mn["[object String]"]=Mn["[object WeakMap]"]=!1;var jn="object"==typeof e&&e&&!e.nodeType&&e,An=jn&&"object"==typeof module&&module&&!module.nodeType&&module,Nn=An&&An.exports===jn&&C.process,Tn=function(){try{var e=An&&An.require&&An.require("util").types;return e||Nn&&Nn.binding&&Nn.binding("util")}catch(e){}}(),Fn=Tn&&Tn.isTypedArray,Dn=Fn?Bn(Fn):function(e){return N(e)&&hn(e.length)&&!!Mn[A(e)]},Ln=Object.prototype.hasOwnProperty;function Rn(e,t){var n=W(e),r=!n&&$n(e),i=!n&&!r&&Pn(e),o=!n&&!r&&!i&&Dn(e),a=n||r||i||o,s=a?wn(e.length,String):[],l=s.length;for(var u in e)!t&&!Ln.call(e,u)||a&&("length"==u||i&&("offset"==u||"parent"==u)||o&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||Ot(u,l))||s.push(u);return s}function Wn(e,t){return function(n){return e(t(n))}}var Gn=Wn(Object.keys,Object),zn=Object.prototype.hasOwnProperty;function Hn(e){if(!yn(e))return Gn(e);var t=[];for(var n in Object(e))zn.call(e,n)&&"constructor"!=n&&t.push(n);return t}function qn(e){return mn(e)?Rn(e):Hn(e)}var Un=Object.prototype.hasOwnProperty,Vn=vn((function(e,t){if(yn(t)||mn(t))un(t,qn(t),e);else for(var n in t)Un.call(t,n)&&ln(e,n,t[n])}));var Kn=Object.prototype.hasOwnProperty;function Jn(e){if(!Q(e))return function(e){var t=[];if(null!=e)for(var n in Object(e))t.push(n);return t}(e);var t=yn(e),n=[];for(var r in e)("constructor"!=r||!t&&Kn.call(e,r))&&n.push(r);return n}function Yn(e){return mn(e)?Rn(e,!0):Jn(e)}var Zn=vn((function(e,t){un(t,Yn(t),e)})),Qn=vn((function(e,t,n,r){un(t,Yn(t),e,r)})),Xn=vn((function(e,t,n,r){un(t,qn(t),e,r)})),er=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,tr=/^\w*$/;function nr(e,t){if(W(e))return!1;var n=typeof e;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!F(e))||(tr.test(e)||!er.test(e)||null!=t&&e in Object(t))}var rr=Oe(Object,"create");var ir=Object.prototype.hasOwnProperty;var or=Object.prototype.hasOwnProperty;function ar(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function sr(e,t){for(var n=e.length;n--;)if(an(e[n][0],t))return n;return-1}ar.prototype.clear=function(){this.__data__=rr?rr(null):{},this.size=0},ar.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},ar.prototype.get=function(e){var t=this.__data__;if(rr){var n=t[e];return"__lodash_hash_undefined__"===n?void 0:n}return ir.call(t,e)?t[e]:void 0},ar.prototype.has=function(e){var t=this.__data__;return rr?void 0!==t[e]:or.call(t,e)},ar.prototype.set=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=rr&&void 0===t?"__lodash_hash_undefined__":t,this};var lr=Array.prototype.splice;function ur(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}ur.prototype.clear=function(){this.__data__=[],this.size=0},ur.prototype.delete=function(e){var t=this.__data__,n=sr(t,e);return!(n<0)&&(n==t.length-1?t.pop():lr.call(t,n,1),--this.size,!0)},ur.prototype.get=function(e){var t=this.__data__,n=sr(t,e);return n<0?void 0:t[n][1]},ur.prototype.has=function(e){return sr(this.__data__,e)>-1},ur.prototype.set=function(e,t){var n=this.__data__,r=sr(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this};var cr=Oe(_,"Map");function dr(e,t){var n,r,i=e.__data__;return("string"==(r=typeof(n=t))||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==n:null===n)?i["string"==typeof t?"string":"hash"]:i.map}function fr(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}fr.prototype.clear=function(){this.size=0,this.__data__={hash:new ar,map:new(cr||ur),string:new ar}},fr.prototype.delete=function(e){var t=dr(this,e).delete(e);return this.size-=t?1:0,t},fr.prototype.get=function(e){return dr(this,e).get(e)},fr.prototype.has=function(e){return dr(this,e).has(e)},fr.prototype.set=function(e,t){var n=dr(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this};var pr="Expected a function";function hr(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError(pr);var n=function(){var r=arguments,i=t?t.apply(this,r):r[0],o=n.cache;if(o.has(i))return o.get(i);var a=e.apply(this,r);return n.cache=o.set(i,a)||o,a};return n.cache=new(hr.Cache||fr),n}hr.Cache=fr;var mr=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,gr=/\\(\\)?/g,vr=function(e){var t=hr(e,(function(e){return 500===n.size&&n.clear(),e})),n=t.cache;return t}((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(mr,(function(e,n,r,i){t.push(r?i.replace(gr,"$1"):n||e)})),t}));function br(e){return null==e?"":q(e)}function yr(e,t){return W(e)?e:nr(e,t)?[e]:vr(br(e))}var wr=1/0;function Sr(e){if("string"==typeof e||F(e))return e;var t=e+"";return"0"==t&&1/e==-wr?"-0":t}function Cr(e,t){for(var n=0,r=(t=yr(t,e)).length;null!=e&&n<r;)e=e[Sr(t[n++])];return n&&n==r?e:void 0}function xr(e,t,n){var r=null==e?void 0:Cr(e,t);return void 0===r?n:r}function _r(e,t){for(var n=-1,r=t.length,i=Array(r),o=null==e;++n<r;)i[n]=o?void 0:xr(e,t[n]);return i}function $r(e,t){for(var n=-1,r=t.length,i=e.length;++n<r;)e[i+n]=t[n];return e}var Ir=$?$.isConcatSpreadable:void 0;function Or(e){return W(e)||$n(e)||!!(Ir&&e&&e[Ir])}function kr(e,t,n,r,i){var o=-1,a=e.length;for(n||(n=Or),i||(i=[]);++o<a;){var s=e[o];t>0&&n(s)?t>1?kr(s,t-1,n,r,i):$r(i,s):r||(i[i.length]=s)}return i}function Er(e){return(null==e?0:e.length)?kr(e,1):[]}function Pr(e){return ut(dn(e,void 0,Er),e+"")}var Mr=Pr(_r),Br=Wn(Object.getPrototypeOf,Object),jr="[object Object]",Ar=Function.prototype,Nr=Object.prototype,Tr=Ar.toString,Fr=Nr.hasOwnProperty,Dr=Tr.call(Object);function Lr(e){if(!N(e)||A(e)!=jr)return!1;var t=Br(e);if(null===t)return!0;var n=Fr.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&Tr.call(n)==Dr}var Rr="[object DOMException]",Wr="[object Error]";function Gr(e){if(!N(e))return!1;var t=A(e);return t==Wr||t==Rr||"string"==typeof e.message&&"string"==typeof e.name&&!Lr(e)}var zr=fn((function(e,t){try{return Ne(e,void 0,t)}catch(e){return Gr(e)?e:new Error(e)}})),Hr="Expected a function";function qr(e,t){var n;if("function"!=typeof t)throw new TypeError(Hr);return e=le(e),function(){return--e>0&&(n=t.apply(this,arguments)),e<=1&&(t=void 0),n}}var Ur=fn((function(e,t,n){var r=1;if(n.length){var i=Pt(n,_t(Ur));r|=32}return tn(e,r,t,n,i)}));Ur.placeholder={};var Vr=Pr((function(e,t){return ct(t,(function(t){t=Sr(t),on(e,t,Ur(e[t],e))})),e})),Kr=fn((function(e,t,n){var r=3;if(n.length){var i=Pt(n,_t(Kr));r|=32}return tn(t,r,e,n,i)}));function Jr(e,t,n){var r=-1,i=e.length;t<0&&(t=-t>i?0:i+t),(n=n>i?i:n)<0&&(n+=i),i=t>n?0:n-t>>>0,t>>>=0;for(var o=Array(i);++r<i;)o[r]=e[r+t];return o}function Yr(e,t,n){var r=e.length;return n=void 0===n?r:n,!t&&n>=r?e:Jr(e,t,n)}Kr.placeholder={};var Zr=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");function Qr(e){return Zr.test(e)}var Xr="\\ud800-\\udfff",ei="["+Xr+"]",ti="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",ni="\\ud83c[\\udffb-\\udfff]",ri="[^"+Xr+"]",ii="(?:\\ud83c[\\udde6-\\uddff]){2}",oi="[\\ud800-\\udbff][\\udc00-\\udfff]",ai="(?:"+ti+"|"+ni+")"+"?",si="[\\ufe0e\\ufe0f]?",li=si+ai+("(?:\\u200d(?:"+[ri,ii,oi].join("|")+")"+si+ai+")*"),ui="(?:"+[ri+ti+"?",ti,ii,oi,ei].join("|")+")",ci=RegExp(ni+"(?="+ni+")|"+ui+li,"g");function di(e){return Qr(e)?function(e){return e.match(ci)||[]}(e):function(e){return e.split("")}(e)}function fi(e){return function(t){var n=Qr(t=br(t))?di(t):void 0,r=n?n[0]:t.charAt(0),i=n?Yr(n,1).join(""):t.slice(1);return r[e]()+i}}var pi=fi("toUpperCase");function hi(e){return pi(br(e).toLowerCase())}function mi(e,t,n,r){var i=-1,o=null==e?0:e.length;for(r&&o&&(n=e[++i]);++i<o;)n=t(n,e[i],i,e);return n}function gi(e){return function(t){return null==e?void 0:e[t]}}var vi=gi({"À":"A","Á":"A","Â":"A","Ã":"A","Ä":"A","Å":"A","à":"a","á":"a","â":"a","ã":"a","ä":"a","å":"a","Ç":"C","ç":"c","Ð":"D","ð":"d","È":"E","É":"E","Ê":"E","Ë":"E","è":"e","é":"e","ê":"e","ë":"e","Ì":"I","Í":"I","Î":"I","Ï":"I","ì":"i","í":"i","î":"i","ï":"i","Ñ":"N","ñ":"n","Ò":"O","Ó":"O","Ô":"O","Õ":"O","Ö":"O","Ø":"O","ò":"o","ó":"o","ô":"o","õ":"o","ö":"o","ø":"o","Ù":"U","Ú":"U","Û":"U","Ü":"U","ù":"u","ú":"u","û":"u","ü":"u","Ý":"Y","ý":"y","ÿ":"y","Æ":"Ae","æ":"ae","Þ":"Th","þ":"th","ß":"ss","Ā":"A","Ă":"A","Ą":"A","ā":"a","ă":"a","ą":"a","Ć":"C","Ĉ":"C","Ċ":"C","Č":"C","ć":"c","ĉ":"c","ċ":"c","č":"c","Ď":"D","Đ":"D","ď":"d","đ":"d","Ē":"E","Ĕ":"E","Ė":"E","Ę":"E","Ě":"E","ē":"e","ĕ":"e","ė":"e","ę":"e","ě":"e","Ĝ":"G","Ğ":"G","Ġ":"G","Ģ":"G","ĝ":"g","ğ":"g","ġ":"g","ģ":"g","Ĥ":"H","Ħ":"H","ĥ":"h","ħ":"h","Ĩ":"I","Ī":"I","Ĭ":"I","Į":"I","İ":"I","ĩ":"i","ī":"i","ĭ":"i","į":"i","ı":"i","Ĵ":"J","ĵ":"j","Ķ":"K","ķ":"k","ĸ":"k","Ĺ":"L","Ļ":"L","Ľ":"L","Ŀ":"L","Ł":"L","ĺ":"l","ļ":"l","ľ":"l","ŀ":"l","ł":"l","Ń":"N","Ņ":"N","Ň":"N","Ŋ":"N","ń":"n","ņ":"n","ň":"n","ŋ":"n","Ō":"O","Ŏ":"O","Ő":"O","ō":"o","ŏ":"o","ő":"o","Ŕ":"R","Ŗ":"R","Ř":"R","ŕ":"r","ŗ":"r","ř":"r","Ś":"S","Ŝ":"S","Ş":"S","Š":"S","ś":"s","ŝ":"s","ş":"s","š":"s","Ţ":"T","Ť":"T","Ŧ":"T","ţ":"t","ť":"t","ŧ":"t","Ũ":"U","Ū":"U","Ŭ":"U","Ů":"U","Ű":"U","Ų":"U","ũ":"u","ū":"u","ŭ":"u","ů":"u","ű":"u","ų":"u","Ŵ":"W","ŵ":"w","Ŷ":"Y","ŷ":"y","Ÿ":"Y","Ź":"Z","Ż":"Z","Ž":"Z","ź":"z","ż":"z","ž":"z","Ĳ":"IJ","ĳ":"ij","Œ":"Oe","œ":"oe","ŉ":"'n","ſ":"s"}),bi=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,yi=RegExp("[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]","g");function wi(e){return(e=br(e))&&e.replace(bi,vi).replace(yi,"")}var Si=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g;var Ci=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/;var xi="\\ud800-\\udfff",_i="\\u2700-\\u27bf",$i="a-z\\xdf-\\xf6\\xf8-\\xff",Ii="A-Z\\xc0-\\xd6\\xd8-\\xde",Oi="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",ki="["+Oi+"]",Ei="\\d+",Pi="["+_i+"]",Mi="["+$i+"]",Bi="[^"+xi+Oi+Ei+_i+$i+Ii+"]",ji="(?:\\ud83c[\\udde6-\\uddff]){2}",Ai="[\\ud800-\\udbff][\\udc00-\\udfff]",Ni="["+Ii+"]",Ti="(?:"+Mi+"|"+Bi+")",Fi="(?:"+Ni+"|"+Bi+")",Di="(?:['’](?:d|ll|m|re|s|t|ve))?",Li="(?:['’](?:D|LL|M|RE|S|T|VE))?",Ri="(?:[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]|\\ud83c[\\udffb-\\udfff])?",Wi="[\\ufe0e\\ufe0f]?",Gi=Wi+Ri+("(?:\\u200d(?:"+["[^"+xi+"]",ji,Ai].join("|")+")"+Wi+Ri+")*"),zi="(?:"+[Pi,ji,Ai].join("|")+")"+Gi,Hi=RegExp([Ni+"?"+Mi+"+"+Di+"(?="+[ki,Ni,"$"].join("|")+")",Fi+"+"+Li+"(?="+[ki,Ni+Ti,"$"].join("|")+")",Ni+"?"+Ti+"+"+Di,Ni+"+"+Li,"\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Ei,zi].join("|"),"g");function qi(e,t,n){return e=br(e),void 0===(t=n?void 0:t)?function(e){return Ci.test(e)}(e)?function(e){return e.match(Hi)||[]}(e):function(e){return e.match(Si)||[]}(e):e.match(t)||[]}var Ui=RegExp("['’]","g");function Vi(e){return function(t){return mi(qi(wi(t).replace(Ui,"")),e,"")}}var Ki=Vi((function(e,t,n){return t=t.toLowerCase(),e+(n?hi(t):t)}));var Ji=_.isFinite,Yi=Math.min;function Zi(e){var t=Math[e];return function(e,n){if(e=ie(e),(n=null==n?0:Yi(le(n),292))&&Ji(e)){var r=(br(e)+"e").split("e");return+((r=(br(t(r[0]+"e"+(+r[1]+n)))+"e").split("e"))[0]+"e"+(+r[1]-n))}return t(e)}}var Qi=Zi("ceil");function Xi(e){var t=Qe(e);return t.__chain__=!0,t}var eo=Math.ceil,to=Math.max;function no(e,t,n){return e==e&&(void 0!==n&&(e=e<=n?e:n),void 0!==t&&(e=e>=t?e:t)),e}function ro(e,t,n){return void 0===n&&(n=t,t=void 0),void 0!==n&&(n=(n=ie(n))==n?n:0),void 0!==t&&(t=(t=ie(t))==t?t:0),no(ie(e),t,n)}function io(e){var t=this.__data__=new ur(e);this.size=t.size}function oo(e,t){return e&&un(t,qn(t),e)}io.prototype.clear=function(){this.__data__=new ur,this.size=0},io.prototype.delete=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n},io.prototype.get=function(e){return this.__data__.get(e)},io.prototype.has=function(e){return this.__data__.has(e)},io.prototype.set=function(e,t){var n=this.__data__;if(n instanceof ur){var r=n.__data__;if(!cr||r.length<199)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new fr(r)}return n.set(e,t),this.size=n.size,this};var ao="object"==typeof e&&e&&!e.nodeType&&e,so=ao&&"object"==typeof module&&module&&!module.nodeType&&module,lo=so&&so.exports===ao?_.Buffer:void 0,uo=lo?lo.allocUnsafe:void 0;function co(e,t){if(t)return e.slice();var n=e.length,r=uo?uo(n):new e.constructor(n);return e.copy(r),r}function fo(e,t){for(var n=-1,r=null==e?0:e.length,i=0,o=[];++n<r;){var a=e[n];t(a,n,e)&&(o[i++]=a)}return o}function po(){return[]}var ho=Object.prototype.propertyIsEnumerable,mo=Object.getOwnPropertySymbols,go=mo?function(e){return null==e?[]:(e=Object(e),fo(mo(e),(function(t){return ho.call(e,t)})))}:po;var vo=Object.getOwnPropertySymbols?function(e){for(var t=[];e;)$r(t,go(e)),e=Br(e);return t}:po;function bo(e,t,n){var r=t(e);return W(e)?r:$r(r,n(e))}function yo(e){return bo(e,qn,go)}function wo(e){return bo(e,Yn,vo)}var So=Oe(_,"DataView"),Co=Oe(_,"Promise"),xo=Oe(_,"Set"),_o="[object Map]",$o="[object Promise]",Io="[object Set]",Oo="[object WeakMap]",ko="[object DataView]",Eo=ye(So),Po=ye(cr),Mo=ye(Co),Bo=ye(xo),jo=ye(ke),Ao=A;(So&&Ao(new So(new ArrayBuffer(1)))!=ko||cr&&Ao(new cr)!=_o||Co&&Ao(Co.resolve())!=$o||xo&&Ao(new xo)!=Io||ke&&Ao(new ke)!=Oo)&&(Ao=function(e){var t=A(e),n="[object Object]"==t?e.constructor:void 0,r=n?ye(n):"";if(r)switch(r){case Eo:return ko;case Po:return _o;case Mo:return $o;case Bo:return Io;case jo:return Oo}return t});var No=Ao,To=Object.prototype.hasOwnProperty;var Fo=_.Uint8Array;function Do(e){var t=new e.constructor(e.byteLength);return new Fo(t).set(new Fo(e)),t}var Lo=/\w*$/;var Ro=$?$.prototype:void 0,Wo=Ro?Ro.valueOf:void 0;function Go(e,t){var n=t?Do(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}var zo="[object Boolean]",Ho="[object Date]",qo="[object Map]",Uo="[object Number]",Vo="[object RegExp]",Ko="[object Set]",Jo="[object String]",Yo="[object Symbol]",Zo="[object ArrayBuffer]",Qo="[object DataView]",Xo="[object Float32Array]",ea="[object Float64Array]",ta="[object Int8Array]",na="[object Int16Array]",ra="[object Int32Array]",ia="[object Uint8Array]",oa="[object Uint8ClampedArray]",aa="[object Uint16Array]",sa="[object Uint32Array]";function la(e,t,n){var r,i=e.constructor;switch(t){case Zo:return Do(e);case zo:case Ho:return new i(+e);case Qo:return function(e,t){var n=t?Do(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)}(e,n);case Xo:case ea:case ta:case na:case ra:case ia:case oa:case aa:case sa:return Go(e,n);case qo:return new i;case Uo:case Jo:return new i(e);case Vo:return function(e){var t=new e.constructor(e.source,Lo.exec(e));return t.lastIndex=e.lastIndex,t}(e);case Ko:return new i;case Yo:return r=e,Wo?Object(Wo.call(r)):{}}}function ua(e){return"function"!=typeof e.constructor||yn(e)?{}:Be(Br(e))}var ca=Tn&&Tn.isMap,da=ca?Bn(ca):function(e){return N(e)&&"[object Map]"==No(e)};var fa=Tn&&Tn.isSet,pa=fa?Bn(fa):function(e){return N(e)&&"[object Set]"==No(e)},ha=1,ma=2,ga=4,va="[object Arguments]",ba="[object Function]",ya="[object GeneratorFunction]",wa="[object Object]",Sa={};function Ca(e,t,n,r,i,o){var a,s=t&ha,l=t&ma,u=t&ga;if(n&&(a=i?n(e,r,i,o):n(e)),void 0!==a)return a;if(!Q(e))return e;var c=W(e);if(c){if(a=function(e){var t=e.length,n=new e.constructor(t);return t&&"string"==typeof e[0]&&To.call(e,"index")&&(n.index=e.index,n.input=e.input),n}(e),!s)return Je(e,a)}else{var d=No(e),f=d==ba||d==ya;if(Pn(e))return co(e,s);if(d==wa||d==va||f&&!i){if(a=l||f?{}:ua(e),!s)return l?function(e,t){return un(e,vo(e),t)}(e,function(e,t){return e&&un(t,Yn(t),e)}(a,e)):function(e,t){return un(e,go(e),t)}(e,oo(a,e))}else{if(!Sa[d])return i?e:{};a=la(e,d,s)}}o||(o=new io);var p=o.get(e);if(p)return p;o.set(e,a),pa(e)?e.forEach((function(r){a.add(Ca(r,t,n,r,e,o))})):da(e)&&e.forEach((function(r,i){a.set(i,Ca(r,t,n,i,e,o))}));var h=c?void 0:(u?l?wo:yo:l?Yn:qn)(e);return ct(h||e,(function(r,i){h&&(r=e[i=r]),ln(a,i,Ca(r,t,n,i,e,o))})),a}Sa[va]=Sa["[object Array]"]=Sa["[object ArrayBuffer]"]=Sa["[object DataView]"]=Sa["[object Boolean]"]=Sa["[object Date]"]=Sa["[object Float32Array]"]=Sa["[object Float64Array]"]=Sa["[object Int8Array]"]=Sa["[object Int16Array]"]=Sa["[object Int32Array]"]=Sa["[object Map]"]=Sa["[object Number]"]=Sa[wa]=Sa["[object RegExp]"]=Sa["[object Set]"]=Sa["[object String]"]=Sa["[object Symbol]"]=Sa["[object Uint8Array]"]=Sa["[object Uint8ClampedArray]"]=Sa["[object Uint16Array]"]=Sa["[object Uint32Array]"]=!0,Sa["[object Error]"]=Sa[ba]=Sa["[object WeakMap]"]=!1;var xa=4;function _a(e){return Ca(e,xa)}var $a=1,Ia=4;function Oa(e){return Ca(e,$a|Ia)}function ka(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new fr;++t<n;)this.add(e[t])}function Ea(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1}function Pa(e,t){return e.has(t)}ka.prototype.add=ka.prototype.push=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this},ka.prototype.has=function(e){return this.__data__.has(e)};var Ma=1,Ba=2;function ja(e,t,n,r,i,o){var a=n&Ma,s=e.length,l=t.length;if(s!=l&&!(a&&l>s))return!1;var u=o.get(e),c=o.get(t);if(u&&c)return u==t&&c==e;var d=-1,f=!0,p=n&Ba?new ka:void 0;for(o.set(e,t),o.set(t,e);++d<s;){var h=e[d],m=t[d];if(r)var g=a?r(m,h,d,t,e,o):r(h,m,d,e,t,o);if(void 0!==g){if(g)continue;f=!1;break}if(p){if(!Ea(t,(function(e,t){if(!Pa(p,t)&&(h===e||i(h,e,n,r,o)))return p.push(t)}))){f=!1;break}}else if(h!==m&&!i(h,m,n,r,o)){f=!1;break}}return o.delete(e),o.delete(t),f}function Aa(e){var t=-1,n=Array(e.size);return e.forEach((function(e,r){n[++t]=[r,e]})),n}function Na(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=e})),n}var Ta=1,Fa=2,Da="[object Boolean]",La="[object Date]",Ra="[object Error]",Wa="[object Map]",Ga="[object Number]",za="[object RegExp]",Ha="[object Set]",qa="[object String]",Ua="[object Symbol]",Va="[object ArrayBuffer]",Ka="[object DataView]",Ja=$?$.prototype:void 0,Ya=Ja?Ja.valueOf:void 0;var Za=1,Qa=Object.prototype.hasOwnProperty;var Xa=1,es="[object Arguments]",ts="[object Array]",ns="[object Object]",rs=Object.prototype.hasOwnProperty;function is(e,t,n,r,i,o){var a=W(e),s=W(t),l=a?ts:No(e),u=s?ts:No(t),c=(l=l==es?ns:l)==ns,d=(u=u==es?ns:u)==ns,f=l==u;if(f&&Pn(e)){if(!Pn(t))return!1;a=!0,c=!1}if(f&&!c)return o||(o=new io),a||Dn(e)?ja(e,t,n,r,i,o):function(e,t,n,r,i,o,a){switch(n){case Ka:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case Va:return!(e.byteLength!=t.byteLength||!o(new Fo(e),new Fo(t)));case Da:case La:case Ga:return an(+e,+t);case Ra:return e.name==t.name&&e.message==t.message;case za:case qa:return e==t+"";case Wa:var s=Aa;case Ha:var l=r&Ta;if(s||(s=Na),e.size!=t.size&&!l)return!1;var u=a.get(e);if(u)return u==t;r|=Fa,a.set(e,t);var c=ja(s(e),s(t),r,i,o,a);return a.delete(e),c;case Ua:if(Ya)return Ya.call(e)==Ya.call(t)}return!1}(e,t,l,n,r,i,o);if(!(n&Xa)){var p=c&&rs.call(e,"__wrapped__"),h=d&&rs.call(t,"__wrapped__");if(p||h){var m=p?e.value():e,g=h?t.value():t;return o||(o=new io),i(m,g,n,r,o)}}return!!f&&(o||(o=new io),function(e,t,n,r,i,o){var a=n&Za,s=yo(e),l=s.length;if(l!=yo(t).length&&!a)return!1;for(var u=l;u--;){var c=s[u];if(!(a?c in t:Qa.call(t,c)))return!1}var d=o.get(e),f=o.get(t);if(d&&f)return d==t&&f==e;var p=!0;o.set(e,t),o.set(t,e);for(var h=a;++u<l;){var m=e[c=s[u]],g=t[c];if(r)var v=a?r(g,m,c,t,e,o):r(m,g,c,e,t,o);if(!(void 0===v?m===g||i(m,g,n,r,o):v)){p=!1;break}h||(h="constructor"==c)}if(p&&!h){var b=e.constructor,y=t.constructor;b==y||!("constructor"in e)||!("constructor"in t)||"function"==typeof b&&b instanceof b&&"function"==typeof y&&y instanceof y||(p=!1)}return o.delete(e),o.delete(t),p}(e,t,n,r,i,o))}function os(e,t,n,r,i){return e===t||(null==e||null==t||!N(e)&&!N(t)?e!=e&&t!=t:is(e,t,n,r,os,i))}var as=1,ss=2;function ls(e,t,n,r){var i=n.length,o=i,a=!r;if(null==e)return!o;for(e=Object(e);i--;){var s=n[i];if(a&&s[2]?s[1]!==e[s[0]]:!(s[0]in e))return!1}for(;++i<o;){var l=(s=n[i])[0],u=e[l],c=s[1];if(a&&s[2]){if(void 0===u&&!(l in e))return!1}else{var d=new io;if(r)var f=r(u,c,l,e,t,d);if(!(void 0===f?os(c,u,as|ss,r,d):f))return!1}}return!0}function us(e){return e==e&&!Q(e)}function cs(e){for(var t=qn(e),n=t.length;n--;){var r=t[n],i=e[r];t[n]=[r,i,us(i)]}return t}function ds(e,t){return function(n){return null!=n&&(n[e]===t&&(void 0!==t||e in Object(n)))}}function fs(e){var t=cs(e);return 1==t.length&&t[0][2]?ds(t[0][0],t[0][1]):function(n){return n===e||ls(n,e,t)}}function ps(e,t){return null!=e&&t in Object(e)}function hs(e,t,n){for(var r=-1,i=(t=yr(t,e)).length,o=!1;++r<i;){var a=Sr(t[r]);if(!(o=null!=e&&n(e,a)))break;e=e[a]}return o||++r!=i?o:!!(i=null==e?0:e.length)&&hn(i)&&Ot(a,i)&&(W(e)||$n(e))}function ms(e,t){return null!=e&&hs(e,t,ps)}var gs=1,vs=2;function bs(e,t){return nr(e)&&us(t)?ds(Sr(e),t):function(n){var r=xr(n,e);return void 0===r&&r===t?ms(n,e):os(t,r,gs|vs)}}function ys(e){return function(t){return null==t?void 0:t[e]}}function ws(e){return nr(e)?ys(Sr(e)):function(e){return function(t){return Cr(t,e)}}(e)}function Ss(e){return"function"==typeof e?e:null==e?ue:"object"==typeof e?W(e)?bs(e[0],e[1]):fs(e):ws(e)}function Cs(e,t,n){var r=n.length;if(null==e)return!r;for(e=Object(e);r--;){var i=n[r],o=t[i],a=e[i];if(void 0===a&&!(i in e)||!o(a))return!1}return!0}function xs(e,t,n,r){for(var i=-1,o=null==e?0:e.length;++i<o;){var a=e[i];t(r,a,n(a),e)}return r}function _s(e){return function(t,n,r){for(var i=-1,o=Object(t),a=r(t),s=a.length;s--;){var l=a[e?s:++i];if(!1===n(o[l],l,o))break}return t}}var $s=_s();function Is(e,t){return e&&$s(e,t,qn)}function Os(e,t){return function(n,r){if(null==n)return n;if(!mn(n))return e(n,r);for(var i=n.length,o=t?i:-1,a=Object(n);(t?o--:++o<i)&&!1!==r(a[o],o,a););return n}}var ks=Os(Is);function Es(e,t,n,r){return ks(e,(function(e,i,o){t(r,e,n(e),o)})),r}function Ps(e,t){return function(n,r){var i=W(n)?xs:Es,o=t?t():{};return i(n,e,Ss(r),o)}}var Ms=Object.prototype.hasOwnProperty,Bs=Ps((function(e,t,n){Ms.call(e,n)?++e[n]:on(e,n,1)}));function js(e,t,n){var r=tn(e,8,void 0,void 0,void 0,void 0,void 0,t=n?void 0:t);return r.placeholder=js.placeholder,r}js.placeholder={};function As(e,t,n){var r=tn(e,16,void 0,void 0,void 0,void 0,void 0,t=n?void 0:t);return r.placeholder=As.placeholder,r}As.placeholder={};var Ns=function(){return _.Date.now()},Ts="Expected a function",Fs=Math.max,Ds=Math.min;function Ls(e,t,n){var r,i,o,a,s,l,u=0,c=!1,d=!1,f=!0;if("function"!=typeof e)throw new TypeError(Ts);function p(t){var n=r,o=i;return r=i=void 0,u=t,a=e.apply(o,n)}function h(e){var n=e-l;return void 0===l||n>=t||n<0||d&&e-u>=o}function m(){var e=Ns();if(h(e))return g(e);s=setTimeout(m,function(e){var n=t-(e-l);return d?Ds(n,o-(e-u)):n}(e))}function g(e){return s=void 0,f&&r?p(e):(r=i=void 0,a)}function v(){var e=Ns(),n=h(e);if(r=arguments,i=this,l=e,n){if(void 0===s)return function(e){return u=e,s=setTimeout(m,t),c?p(e):a}(l);if(d)return clearTimeout(s),s=setTimeout(m,t),p(l)}return void 0===s&&(s=setTimeout(m,t)),a}return t=ie(t)||0,Q(n)&&(c=!!n.leading,o=(d="maxWait"in n)?Fs(ie(n.maxWait)||0,t):o,f="trailing"in n?!!n.trailing:f),v.cancel=function(){void 0!==s&&clearTimeout(s),u=0,r=l=i=s=void 0},v.flush=function(){return void 0===s?a:g(Ns())},v}var Rs=Object.prototype,Ws=Rs.hasOwnProperty,Gs=fn((function(e,t){e=Object(e);var n=-1,r=t.length,i=r>2?t[2]:void 0;for(i&&gn(t[0],t[1],i)&&(r=1);++n<r;)for(var o=t[n],a=Yn(o),s=-1,l=a.length;++s<l;){var u=a[s],c=e[u];(void 0===c||an(c,Rs[u])&&!Ws.call(e,u))&&(e[u]=o[u])}return e}));function zs(e,t,n){(void 0!==n&&!an(e[t],n)||void 0===n&&!(t in e))&&on(e,t,n)}function Hs(e){return N(e)&&mn(e)}function qs(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]}function Us(e){return un(e,Yn(e))}function Vs(e,t,n,r,i){e!==t&&$s(t,(function(o,a){if(i||(i=new io),Q(o))!function(e,t,n,r,i,o,a){var s=qs(e,n),l=qs(t,n),u=a.get(l);if(u)zs(e,n,u);else{var c=o?o(s,l,n+"",e,t,a):void 0,d=void 0===c;if(d){var f=W(l),p=!f&&Pn(l),h=!f&&!p&&Dn(l);c=l,f||p||h?W(s)?c=s:Hs(s)?c=Je(s):p?(d=!1,c=co(l,!0)):h?(d=!1,c=Go(l,!0)):c=[]:Lr(l)||$n(l)?(c=s,$n(s)?c=Us(s):Q(s)&&!he(s)||(c=ua(l))):d=!1}d&&(a.set(l,c),i(c,l,r,o,a),a.delete(l)),zs(e,n,c)}}(e,t,a,n,Vs,r,i);else{var s=r?r(qs(e,a),o,a+"",e,t,i):void 0;void 0===s&&(s=o),zs(e,a,s)}}),Yn)}function Ks(e,t,n,r,i,o){return Q(e)&&Q(t)&&(o.set(t,e),Vs(e,t,void 0,Ks,o),o.delete(t)),e}var Js=vn((function(e,t,n,r){Vs(e,t,n,r)})),Ys=fn((function(e){return e.push(void 0,Ks),Ne(Js,void 0,e)}));function Zs(e,t,n){if("function"!=typeof e)throw new TypeError("Expected a function");return setTimeout((function(){e.apply(void 0,n)}),t)}var Qs=fn((function(e,t){return Zs(e,1,t)})),Xs=fn((function(e,t,n){return Zs(e,ie(t)||0,n)}));function el(e,t,n){for(var r=-1,i=null==e?0:e.length;++r<i;)if(n(t,e[r]))return!0;return!1}var tl=200;function nl(e,t,n,r){var i=-1,o=ht,a=!0,s=e.length,l=[],u=t.length;if(!s)return l;n&&(t=R(t,Bn(n))),r?(o=el,a=!1):t.length>=tl&&(o=Pa,a=!1,t=new ka(t));e:for(;++i<s;){var c=e[i],d=null==n?c:n(c);if(c=r||0!==c?c:0,a&&d==d){for(var f=u;f--;)if(t[f]===d)continue e;l.push(c)}else o(t,d,r)||l.push(c)}return l}var rl=fn((function(e,t){return Hs(e)?nl(e,kr(t,1,Hs,!0)):[]}));function il(e){var t=null==e?0:e.length;return t?e[t-1]:void 0}var ol=fn((function(e,t){var n=il(t);return Hs(n)&&(n=void 0),Hs(e)?nl(e,kr(t,1,Hs,!0),Ss(n)):[]})),al=fn((function(e,t){var n=il(t);return Hs(n)&&(n=void 0),Hs(e)?nl(e,kr(t,1,Hs,!0),void 0,n):[]})),sl=U((function(e,t){return e/t}),1);function ll(e,t,n,r){for(var i=e.length,o=r?i:-1;(r?o--:++o<i)&&t(e[o],o,e););return n?Jr(e,r?0:o,r?o+1:i):Jr(e,r?o+1:0,r?i:o)}function ul(e){return"function"==typeof e?e:ue}function cl(e,t){return(W(e)?ct:ks)(e,ul(t))}function dl(e,t){for(var n=null==e?0:e.length;n--&&!1!==t(e[n],n,e););return e}var fl=_s(!0);function pl(e,t){return e&&fl(e,t,qn)}var hl=Os(pl,!0);function ml(e,t){return(W(e)?dl:hl)(e,ul(t))}function gl(e){return function(t){var n=No(t);return"[object Map]"==n?Aa(t):"[object Set]"==n?function(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=[e,e]})),n}(t):function(e,t){return R(t,(function(t){return[t,e[t]]}))}(t,e(t))}}var vl=gl(qn),bl=gl(Yn),yl=gi({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"}),wl=/[&<>"']/g,Sl=RegExp(wl.source);function Cl(e){return(e=br(e))&&Sl.test(e)?e.replace(wl,yl):e}var xl=/[\\^$.*+?()[\]{}|]/g,_l=RegExp(xl.source);function $l(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(!t(e[n],n,e))return!1;return!0}function Il(e,t){var n=!0;return ks(e,(function(e,r,i){return n=!!t(e,r,i)})),n}var Ol=4294967295;function kl(e){return e?no(le(e),0,Ol):0}function El(e,t){var n=[];return ks(e,(function(e,r,i){t(e,r,i)&&n.push(e)})),n}function Pl(e){return function(t,n,r){var i=Object(t);if(!mn(t)){var o=Ss(n);t=qn(t),n=function(e){return o(i[e],e,i)}}var a=e(t,n,r);return a>-1?i[o?t[a]:a]:void 0}}var Ml=Math.max;function Bl(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var i=null==n?0:le(n);return i<0&&(i=Ml(r+i,0)),dt(e,Ss(t),i)}var jl=Pl(Bl);function Al(e,t,n){var r;return n(e,(function(e,n,i){if(t(e,n,i))return r=n,!1})),r}var Nl=Math.max,Tl=Math.min;function Fl(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var i=r-1;return void 0!==n&&(i=le(n),i=n<0?Nl(r+i,0):Tl(i,r-1)),dt(e,Ss(t),i,!0)}var Dl=Pl(Fl);function Ll(e){return e&&e.length?e[0]:void 0}function Rl(e,t){var n=-1,r=mn(e)?Array(e.length):[];return ks(e,(function(e,i,o){r[++n]=t(e,i,o)})),r}function Wl(e,t){return(W(e)?R:Rl)(e,Ss(t))}var Gl=1/0;var zl=1/0;var Hl=Zi("floor");function ql(e){return Pr((function(t){var n=t.length,r=n,i=Ke.prototype.thru;for(e&&t.reverse();r--;){var o=t[r];if("function"!=typeof o)throw new TypeError("Expected a function");if(i&&!a&&"wrapper"==Ve(o))var a=new Ke([],!0)}for(r=a?r:n;++r<n;){var s=Ve(o=t[r]),l="wrapper"==s?He(o):void 0;a=l&&Xe(l[0])&&424==l[1]&&!l[4].length&&1==l[9]?a[Ve(l[0])].apply(a,l[3]):1==o.length&&Xe(o)?a[s]():a.thru(o)}return function(){var e=arguments,r=e[0];if(a&&1==e.length&&W(r))return a.plant(r).value();for(var i=0,o=n?t[i].apply(this,e):r;++i<n;)o=t[i].call(this,o);return o}}))}var Ul=ql(),Vl=ql(!0);function Kl(e,t){return fo(t,(function(t){return he(e[t])}))}var Jl=Object.prototype.hasOwnProperty,Yl=Ps((function(e,t,n){Jl.call(e,n)?e[n].push(t):on(e,n,[t])}));function Zl(e,t){return e>t}function Ql(e){return function(t,n){return"string"==typeof t&&"string"==typeof n||(t=ie(t),n=ie(n)),e(t,n)}}var Xl=Ql(Zl),eu=Ql((function(e,t){return e>=t})),tu=Object.prototype.hasOwnProperty;function nu(e,t){return null!=e&&tu.call(e,t)}var ru=Math.max,iu=Math.min;var ou="[object String]";function au(e){return"string"==typeof e||!W(e)&&N(e)&&A(e)==ou}function su(e,t){return R(t,(function(t){return e[t]}))}function lu(e){return null==e?[]:su(e,qn(e))}var uu=Math.max;var cu=Math.max;var du=Math.min;function fu(e,t,n){for(var r=n?el:ht,i=e[0].length,o=e.length,a=o,s=Array(o),l=1/0,u=[];a--;){var c=e[a];a&&t&&(c=R(c,Bn(t))),l=du(c.length,l),s[a]=!n&&(t||i>=120&&c.length>=120)?new ka(a&&c):void 0}c=e[0];var d=-1,f=s[0];e:for(;++d<i&&u.length<l;){var p=c[d],h=t?t(p):p;if(p=n||0!==p?p:0,!(f?Pa(f,h):r(u,h,n))){for(a=o;--a;){var m=s[a];if(!(m?Pa(m,h):r(e[a],h,n)))continue e}f&&f.push(h),u.push(p)}}return u}function pu(e){return Hs(e)?e:[]}var hu=fn((function(e){var t=R(e,pu);return t.length&&t[0]===e[0]?fu(t):[]})),mu=fn((function(e){var t=il(e),n=R(e,pu);return t===il(n)?t=void 0:n.pop(),n.length&&n[0]===e[0]?fu(n,Ss(t)):[]})),gu=fn((function(e){var t=il(e),n=R(e,pu);return(t="function"==typeof t?t:void 0)&&n.pop(),n.length&&n[0]===e[0]?fu(n,void 0,t):[]}));function vu(e,t){return function(n,r){return function(e,t,n,r){return Is(e,(function(e,i,o){t(r,n(e),i,o)})),r}(n,e,t(r),{})}}var bu=Object.prototype.toString,yu=vu((function(e,t,n){null!=t&&"function"!=typeof t.toString&&(t=bu.call(t)),e[t]=n}),at(ue)),wu=Object.prototype,Su=wu.hasOwnProperty,Cu=wu.toString,xu=vu((function(e,t,n){null!=t&&"function"!=typeof t.toString&&(t=Cu.call(t)),Su.call(e,t)?e[t].push(n):e[t]=[n]}),Ss);function _u(e,t){return t.length<2?e:Cr(e,Jr(t,0,-1))}function $u(e,t,n){var r=null==(e=_u(e,t=yr(t,e)))?e:e[Sr(il(t))];return null==r?void 0:Ne(r,e,n)}var Iu=fn($u),Ou=fn((function(e,t,n){var r=-1,i="function"==typeof t,o=mn(e)?Array(e.length):[];return ks(e,(function(e){o[++r]=i?Ne(t,e,n):$u(e,t,n)})),o}));var ku=Tn&&Tn.isArrayBuffer,Eu=ku?Bn(ku):function(e){return N(e)&&"[object ArrayBuffer]"==A(e)};var Pu=Tn&&Tn.isDate,Mu=Pu?Bn(Pu):function(e){return N(e)&&"[object Date]"==A(e)};var Bu=Object.prototype.hasOwnProperty;function ju(e,t){return os(e,t)}var Au=_.isFinite;function Nu(e){return"number"==typeof e&&e==le(e)}var Tu="[object Number]";function Fu(e){return"number"==typeof e||N(e)&&A(e)==Tu}var Du=ge?he:In;var Lu=Tn&&Tn.isRegExp,Ru=Lu?Bn(Lu):function(e){return N(e)&&"[object RegExp]"==A(e)},Wu=9007199254740991;var Gu=Array.prototype.join;var zu=Vi((function(e,t,n){return e+(n?"-":"")+t.toLowerCase()})),Hu=Ps((function(e,t,n){on(e,n,t)}));var qu=Math.max,Uu=Math.min;var Vu=Vi((function(e,t,n){return e+(n?" ":"")+t.toLowerCase()})),Ku=fi("toLowerCase");function Ju(e,t){return e<t}var Yu=Ql(Ju),Zu=Ql((function(e,t){return e<=t}));function Qu(e,t,n){for(var r=-1,i=e.length;++r<i;){var o=e[r],a=t(o);if(null!=a&&(void 0===s?a==a&&!F(a):n(a,s)))var s=a,l=o}return l}function Xu(e,t){for(var n,r=-1,i=e.length;++r<i;){var o=t(e[r]);void 0!==o&&(n=void 0===n?o:n+o)}return n}var ec=NaN;function tc(e,t){var n=null==e?0:e.length;return n?Xu(e,t)/n:ec}var nc=vn((function(e,t,n){Vs(e,t,n)})),rc=fn((function(e,t){return function(n){return $u(n,e,t)}})),ic=fn((function(e,t){return function(n){return $u(e,n,t)}}));function oc(e,t,n){var r=qn(t),i=Kl(t,r),o=!(Q(n)&&"chain"in n&&!n.chain),a=he(e);return ct(i,(function(n){var r=t[n];e[n]=r,a&&(e.prototype[n]=function(){var t=this.__chain__;if(o||t){var n=e(this.__wrapped__);return(n.__actions__=Je(this.__actions__)).push({func:r,args:arguments,thisArg:e}),n.__chain__=t,n}return r.apply(e,$r([this.value()],arguments))})})),e}var ac=U((function(e,t){return e*t}),1),sc="Expected a function";function lc(e){if("function"!=typeof e)throw new TypeError(sc);return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}}var uc="[object Map]",cc="[object Set]",dc=$?$.iterator:void 0;function fc(e){if(!e)return[];if(mn(e))return au(e)?di(e):Je(e);if(dc&&e[dc])return function(e){for(var t,n=[];!(t=e.next()).done;)n.push(t.value);return n}(e[dc]());var t=No(e);return(t==uc?Aa:t==cc?Na:lu)(e)}function pc(e,t){var n=e.length;if(n)return Ot(t+=t<0?n:0,n)?e[t]:void 0}function hc(e,t){return null==(e=_u(e,t=yr(t,e)))||delete e[Sr(il(t))]}function mc(e){return Lr(e)?void 0:e}var gc=Pr((function(e,t){var n={};if(null==e)return n;var r=!1;t=R(t,(function(t){return t=yr(t,e),r||(r=t.length>1),t})),un(e,wo(e),n),r&&(n=Ca(n,7,mc));for(var i=t.length;i--;)hc(n,t[i]);return n}));function vc(e,t,n,r){if(!Q(e))return e;for(var i=-1,o=(t=yr(t,e)).length,a=o-1,s=e;null!=s&&++i<o;){var l=Sr(t[i]),u=n;if("__proto__"===l||"constructor"===l||"prototype"===l)return e;if(i!=a){var c=s[l];void 0===(u=r?r(c,l,s):void 0)&&(u=Q(c)?c:Ot(t[i+1])?[]:{})}ln(s,l,u),s=s[l]}return e}function bc(e,t,n){for(var r=-1,i=t.length,o={};++r<i;){var a=t[r],s=Cr(e,a);n(s,a)&&vc(o,yr(a,e),s)}return o}function yc(e,t){if(null==e)return{};var n=R(wo(e),(function(e){return[e]}));return t=Ss(t),bc(e,n,(function(e,n){return t(e,n[0])}))}function wc(e,t){if(e!==t){var n=void 0!==e,r=null===e,i=e==e,o=F(e),a=void 0!==t,s=null===t,l=t==t,u=F(t);if(!s&&!u&&!o&&e>t||o&&a&&l&&!s&&!u||r&&a&&l||!n&&l||!i)return 1;if(!r&&!o&&!u&&e<t||u&&n&&i&&!r&&!o||s&&n&&i||!a&&i||!l)return-1}return 0}function Sc(e,t,n){t=t.length?R(t,(function(e){return W(e)?function(t){return Cr(t,1===e.length?e[0]:e)}:e})):[ue];var r=-1;t=R(t,Bn(Ss));var i=Rl(e,(function(e,n,i){var o=R(t,(function(t){return t(e)}));return{criteria:o,index:++r,value:e}}));return function(e,t){var n=e.length;for(e.sort(t);n--;)e[n]=e[n].value;return e}(i,(function(e,t){return function(e,t,n){for(var r=-1,i=e.criteria,o=t.criteria,a=i.length,s=n.length;++r<a;){var l=wc(i[r],o[r]);if(l)return r>=s?l:l*("desc"==n[r]?-1:1)}return e.index-t.index}(e,t,n)}))}function Cc(e){return Pr((function(t){return t=R(t,Bn(Ss)),fn((function(n){var r=this;return e(t,(function(e){return Ne(e,r,n)}))}))}))}var xc=Cc(R),_c=fn,$c=Math.min,Ic=_c((function(e,t){var n=(t=1==t.length&&W(t[0])?R(t[0],Bn(Ss)):R(kr(t,1),Bn(Ss))).length;return fn((function(r){for(var i=-1,o=$c(r.length,n);++i<o;)r[i]=t[i].call(this,r[i]);return Ne(e,this,r)}))})),Oc=Cc($l),kc=Cc(Ea),Ec=9007199254740991,Pc=Math.floor;function Mc(e,t){var n="";if(!e||t<1||t>Ec)return n;do{t%2&&(n+=e),(t=Pc(t/2))&&(e+=e)}while(t);return n}var Bc=ys("length"),jc="\\ud800-\\udfff",Ac="["+jc+"]",Nc="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",Tc="\\ud83c[\\udffb-\\udfff]",Fc="[^"+jc+"]",Dc="(?:\\ud83c[\\udde6-\\uddff]){2}",Lc="[\\ud800-\\udbff][\\udc00-\\udfff]",Rc="(?:"+Nc+"|"+Tc+")"+"?",Wc="[\\ufe0e\\ufe0f]?",Gc=Wc+Rc+("(?:\\u200d(?:"+[Fc,Dc,Lc].join("|")+")"+Wc+Rc+")*"),zc="(?:"+[Fc+Nc+"?",Nc,Dc,Lc,Ac].join("|")+")",Hc=RegExp(Tc+"(?="+Tc+")|"+zc+Gc,"g");function qc(e){return Qr(e)?function(e){for(var t=Hc.lastIndex=0;Hc.test(e);)++t;return t}(e):Bc(e)}var Uc=Math.ceil;function Vc(e,t){var n=(t=void 0===t?" ":q(t)).length;if(n<2)return n?Mc(t,e):t;var r=Mc(t,Uc(e/qc(t)));return Qr(t)?Yr(di(r),0,e).join(""):r.slice(0,e)}var Kc=Math.ceil,Jc=Math.floor;var Yc=/^\s+/,Zc=_.parseInt;var Qc=fn((function(e,t){return tn(e,32,void 0,t,Pt(t,_t(Qc)))}));Qc.placeholder={};var Xc=fn((function(e,t){return tn(e,64,void 0,t,Pt(t,_t(Xc)))}));Xc.placeholder={};var ed=Ps((function(e,t,n){e[n?0:1].push(t)}),(function(){return[[],[]]}));var td=Pr((function(e,t){return null==e?{}:function(e,t){return bc(e,t,(function(t,n){return ms(e,n)}))}(e,t)}));function nd(e,t,n,r){for(var i=n-1,o=e.length;++i<o;)if(r(e[i],t))return i;return-1}var rd=Array.prototype.splice;function id(e,t,n,r){var i=r?nd:pt,o=-1,a=t.length,s=e;for(e===t&&(t=Je(t)),n&&(s=R(e,Bn(n)));++o<a;)for(var l=0,u=t[o],c=n?n(u):u;(l=i(s,c,l,r))>-1;)s!==e&&rd.call(s,l,1),rd.call(e,l,1);return e}function od(e,t){return e&&e.length&&t&&t.length?id(e,t):e}var ad=fn(od);var sd=Array.prototype.splice;function ld(e,t){for(var n=e?t.length:0,r=n-1;n--;){var i=t[n];if(n==r||i!==o){var o=i;Ot(i)?sd.call(e,i,1):hc(e,i)}}return e}var ud=Pr((function(e,t){var n=null==e?0:e.length,r=_r(e,t);return ld(e,R(t,(function(e){return Ot(e,n)?+e:e})).sort(wc)),r})),cd=Math.floor,dd=Math.random;function fd(e,t){return e+cd(dd()*(t-e+1))}var pd=parseFloat,hd=Math.min,md=Math.random;var gd=Math.ceil,vd=Math.max;function bd(e){return function(t,n,r){return r&&"number"!=typeof r&&gn(t,n,r)&&(n=r=void 0),t=se(t),void 0===n?(n=t,t=0):n=se(n),function(e,t,n,r){for(var i=-1,o=vd(gd((t-e)/(n||1)),0),a=Array(o);o--;)a[r?o:++i]=e,e+=n;return a}(t,n,r=void 0===r?t<n?1:-1:se(r),e)}}var yd=bd(),wd=bd(!0),Sd=Pr((function(e,t){return tn(e,256,void 0,void 0,void 0,t)}));function Cd(e,t,n,r,i){return i(e,(function(e,i,o){n=r?(r=!1,e):t(n,e,i,o)})),n}function xd(e,t,n,r){var i=null==e?0:e.length;for(r&&i&&(n=e[--i]);i--;)n=t(n,e[i],i,e);return n}var _d=Array.prototype.reverse;function $d(e){return null==e?e:_d.call(e)}var Id=Zi("round");function Od(e){var t=e.length;return t?e[fd(0,t-1)]:void 0}function kd(e){return Od(lu(e))}function Ed(e){return(W(e)?Od:kd)(e)}function Pd(e,t){var n=-1,r=e.length,i=r-1;for(t=void 0===t?r:t;++n<t;){var o=fd(n,i),a=e[o];e[o]=e[n],e[n]=a}return e.length=t,e}function Md(e,t){return Pd(Je(e),no(t,0,e.length))}function Bd(e,t){var n=lu(e);return Pd(n,no(t,0,n.length))}function jd(e){return Pd(Je(e))}function Ad(e){return Pd(lu(e))}var Nd=Vi((function(e,t,n){return e+(n?"_":"")+t.toLowerCase()}));function Td(e,t){var n;return ks(e,(function(e,r,i){return!(n=t(e,r,i))})),!!n}var Fd=fn((function(e,t){if(null==e)return[];var n=t.length;return n>1&&gn(e,t[0],t[1])?t=[]:n>2&&gn(t[0],t[1],t[2])&&(t=[t[0]]),Sc(e,kr(t,1),[])})),Dd=4294967294,Ld=Math.floor,Rd=Math.min;function Wd(e,t,n,r){var i=0,o=null==e?0:e.length;if(0===o)return 0;for(var a=(t=n(t))!=t,s=null===t,l=F(t),u=void 0===t;i<o;){var c=Ld((i+o)/2),d=n(e[c]),f=void 0!==d,p=null===d,h=d==d,m=F(d);if(a)var g=r||h;else g=u?h&&(r||f):s?h&&f&&(r||!p):l?h&&f&&!p&&(r||!m):!p&&!m&&(r?d<=t:d<t);g?i=c+1:o=c}return Rd(o,Dd)}var Gd=2147483647;function zd(e,t,n){var r=0,i=null==e?r:e.length;if("number"==typeof t&&t==t&&i<=Gd){for(;r<i;){var o=r+i>>>1,a=e[o];null!==a&&!F(a)&&(n?a<=t:a<t)?r=o+1:i=o}return i}return Wd(e,t,ue,n)}function Hd(e,t){for(var n=-1,r=e.length,i=0,o=[];++n<r;){var a=e[n],s=t?t(a):a;if(!n||!an(s,l)){var l=s;o[i++]=0===a?0:a}}return o}var qd=Math.max;var Ud=Vi((function(e,t,n){return e+(n?" ":"")+pi(t)}));var Vd=U((function(e,t){return e-t}),0);function Kd(e,t){return e&&e.length?Xu(e,Ss(t)):0}var Jd=Object.prototype,Yd=Jd.hasOwnProperty;function Zd(e,t,n,r){return void 0===e||an(e,Jd[n])&&!Yd.call(r,n)?t:e}var Qd={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"};function Xd(e){return"\\"+Qd[e]}var ef=/<%=([\s\S]+?)%>/g,tf={escape:/<%-([\s\S]+?)%>/g,evaluate:/<%([\s\S]+?)%>/g,interpolate:ef,variable:"",imports:{_:{escape:Cl}}},nf=/\b__p \+= '';/g,rf=/\b(__p \+=) '' \+/g,of=/(__e\(.*?\)|\b__t\)) \+\n'';/g,af=/[()=,{}\[\]\/\s]/,sf=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,lf=/($^)/,uf=/['\n\r\u2028\u2029\\]/g,cf=Object.prototype.hasOwnProperty;function df(e,t){return t(e)}var ff=4294967295,pf=Math.min;function hf(e,t){var n=e;return n instanceof Ge&&(n=n.value()),mi(t,(function(e,t){return t.func.apply(t.thisArg,$r([e],t.args))}),n)}function mf(){return hf(this.__wrapped__,this.__actions__)}var gf=9007199254740991;function vf(e,t){for(var n=e.length;n--&&pt(t,e[n],0)>-1;);return n}function bf(e,t){for(var n=-1,r=e.length;++n<r&&pt(t,e[n],0)>-1;);return n}var yf=/^\s+/;var wf=/\w*$/;var Sf=gi({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"}),Cf=/&(?:amp|lt|gt|quot|#39);/g,xf=RegExp(Cf.source);var _f=xo&&1/Na(new xo([,-0]))[1]==1/0?function(e){return new xo(e)}:ze,$f=200;function If(e,t,n){var r=-1,i=ht,o=e.length,a=!0,s=[],l=s;if(n)a=!1,i=el;else if(o>=$f){var u=t?null:_f(e);if(u)return Na(u);a=!1,i=Pa,l=new ka}else l=t?[]:s;e:for(;++r<o;){var c=e[r],d=t?t(c):c;if(c=n||0!==c?c:0,a&&d==d){for(var f=l.length;f--;)if(l[f]===d)continue e;t&&l.push(d),s.push(c)}else i(l,d,n)||(l!==s&&l.push(d),s.push(c))}return s}var Of=fn((function(e){return If(kr(e,1,Hs,!0))})),kf=fn((function(e){var t=il(e);return Hs(t)&&(t=void 0),If(kr(e,1,Hs,!0),Ss(t))})),Ef=fn((function(e){var t=il(e);return t="function"==typeof t?t:void 0,If(kr(e,1,Hs,!0),void 0,t)}));var Pf=0;var Mf=Math.max;function Bf(e){if(!e||!e.length)return[];var t=0;return e=fo(e,(function(e){if(Hs(e))return t=Mf(e.length,t),!0})),wn(t,(function(t){return R(e,ys(t))}))}function jf(e,t){if(!e||!e.length)return[];var n=Bf(e);return null==t?n:R(n,(function(e){return Ne(t,void 0,e)}))}function Af(e,t,n,r){return vc(e,t,n(Cr(e,t)),r)}var Nf=Vi((function(e,t,n){return e+(n?" ":"")+t.toUpperCase()}));var Tf=fn((function(e,t){return Hs(e)?nl(e,t):[]}));var Ff=Pr((function(e){var t=e.length,n=t?e[0]:0,r=this.__wrapped__,i=function(t){return _r(t,e)};return!(t>1||this.__actions__.length)&&r instanceof Ge&&Ot(n)?((r=r.slice(n,+n+(t?1:0))).__actions__.push({func:df,args:[i],thisArg:void 0}),new Ke(r,this.__chain__).thru((function(e){return t&&!e.length&&e.push(void 0),e}))):this.thru(i)}));function Df(e,t,n){var r=e.length;if(r<2)return r?If(e[0]):[];for(var i=-1,o=Array(r);++i<r;)for(var a=e[i],s=-1;++s<r;)s!=i&&(o[i]=nl(o[i]||a,e[s],t,n));return If(kr(o,1),t,n)}var Lf=fn((function(e){return Df(fo(e,Hs))})),Rf=fn((function(e){var t=il(e);return Hs(t)&&(t=void 0),Df(fo(e,Hs),Ss(t))})),Wf=fn((function(e){var t=il(e);return t="function"==typeof t?t:void 0,Df(fo(e,Hs),void 0,t)})),Gf=fn(Bf);function zf(e,t,n){for(var r=-1,i=e.length,o=t.length,a={};++r<i;){var s=r<o?t[r]:void 0;n(a,e[r],s)}return a}var Hf=fn((function(e){var t=e.length,n=t>1?e[t-1]:void 0;return n="function"==typeof n?(e.pop(),n):void 0,jf(e,n)})),qf={chunk:function(e,t,n){t=(n?gn(e,t,n):void 0===t)?1:to(le(t),0);var r=null==e?0:e.length;if(!r||t<1)return[];for(var i=0,o=0,a=Array(eo(r/t));i<r;)a[o++]=Jr(e,i,i+=t);return a},compact:function(e){for(var t=-1,n=null==e?0:e.length,r=0,i=[];++t<n;){var o=e[t];o&&(i[r++]=o)}return i},concat:function(){var e=arguments.length;if(!e)return[];for(var t=Array(e-1),n=arguments[0],r=e;r--;)t[r-1]=arguments[r];return $r(W(n)?Je(n):[n],kr(t,1))},difference:rl,differenceBy:ol,differenceWith:al,drop:function(e,t,n){var r=null==e?0:e.length;return r?Jr(e,(t=n||void 0===t?1:le(t))<0?0:t,r):[]},dropRight:function(e,t,n){var r=null==e?0:e.length;return r?Jr(e,0,(t=r-(t=n||void 0===t?1:le(t)))<0?0:t):[]},dropRightWhile:function(e,t){return e&&e.length?ll(e,Ss(t),!0,!0):[]},dropWhile:function(e,t){return e&&e.length?ll(e,Ss(t),!0):[]},fill:function(e,t,n,r){var i=null==e?0:e.length;return i?(n&&"number"!=typeof n&&gn(e,t,n)&&(n=0,r=i),function(e,t,n,r){var i=e.length;for((n=le(n))<0&&(n=-n>i?0:i+n),(r=void 0===r||r>i?i:le(r))<0&&(r+=i),r=n>r?0:kl(r);n<r;)e[n++]=t;return e}(e,t,n,r)):[]},findIndex:Bl,findLastIndex:Fl,first:Ll,flatten:Er,flattenDeep:function(e){return(null==e?0:e.length)?kr(e,zl):[]},flattenDepth:function(e,t){return(null==e?0:e.length)?kr(e,t=void 0===t?1:le(t)):[]},fromPairs:function(e){for(var t=-1,n=null==e?0:e.length,r={};++t<n;){var i=e[t];r[i[0]]=i[1]}return r},head:Ll,indexOf:function(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var i=null==n?0:le(n);return i<0&&(i=cu(r+i,0)),pt(e,t,i)},initial:function(e){return(null==e?0:e.length)?Jr(e,0,-1):[]},intersection:hu,intersectionBy:mu,intersectionWith:gu,join:function(e,t){return null==e?"":Gu.call(e,t)},last:il,lastIndexOf:function(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var i=r;return void 0!==n&&(i=(i=le(n))<0?qu(r+i,0):Uu(i,r-1)),t==t?function(e,t,n){for(var r=n+1;r--;)if(e[r]===t)return r;return r}(e,t,i):dt(e,ft,i,!0)},nth:function(e,t){return e&&e.length?pc(e,le(t)):void 0},pull:ad,pullAll:od,pullAllBy:function(e,t,n){return e&&e.length&&t&&t.length?id(e,t,Ss(n)):e},pullAllWith:function(e,t,n){return e&&e.length&&t&&t.length?id(e,t,void 0,n):e},pullAt:ud,remove:function(e,t){var n=[];if(!e||!e.length)return n;var r=-1,i=[],o=e.length;for(t=Ss(t);++r<o;){var a=e[r];t(a,r,e)&&(n.push(a),i.push(r))}return ld(e,i),n},reverse:$d,slice:function(e,t,n){var r=null==e?0:e.length;return r?(n&&"number"!=typeof n&&gn(e,t,n)?(t=0,n=r):(t=null==t?0:le(t),n=void 0===n?r:le(n)),Jr(e,t,n)):[]},sortedIndex:function(e,t){return zd(e,t)},sortedIndexBy:function(e,t,n){return Wd(e,t,Ss(n))},sortedIndexOf:function(e,t){var n=null==e?0:e.length;if(n){var r=zd(e,t);if(r<n&&an(e[r],t))return r}return-1},sortedLastIndex:function(e,t){return zd(e,t,!0)},sortedLastIndexBy:function(e,t,n){return Wd(e,t,Ss(n),!0)},sortedLastIndexOf:function(e,t){if(null==e?0:e.length){var n=zd(e,t,!0)-1;if(an(e[n],t))return n}return-1},sortedUniq:function(e){return e&&e.length?Hd(e):[]},sortedUniqBy:function(e,t){return e&&e.length?Hd(e,Ss(t)):[]},tail:function(e){var t=null==e?0:e.length;return t?Jr(e,1,t):[]},take:function(e,t,n){return e&&e.length?Jr(e,0,(t=n||void 0===t?1:le(t))<0?0:t):[]},takeRight:function(e,t,n){var r=null==e?0:e.length;return r?Jr(e,(t=r-(t=n||void 0===t?1:le(t)))<0?0:t,r):[]},takeRightWhile:function(e,t){return e&&e.length?ll(e,Ss(t),!1,!0):[]},takeWhile:function(e,t){return e&&e.length?ll(e,Ss(t)):[]},union:Of,unionBy:kf,unionWith:Ef,uniq:function(e){return e&&e.length?If(e):[]},uniqBy:function(e,t){return e&&e.length?If(e,Ss(t)):[]},uniqWith:function(e,t){return t="function"==typeof t?t:void 0,e&&e.length?If(e,void 0,t):[]},unzip:Bf,unzipWith:jf,without:Tf,xor:Lf,xorBy:Rf,xorWith:Wf,zip:Gf,zipObject:function(e,t){return zf(e||[],t||[],ln)},zipObjectDeep:function(e,t){return zf(e||[],t||[],vc)},zipWith:Hf},Uf={countBy:Bs,each:cl,eachRight:ml,every:function(e,t,n){var r=W(e)?$l:Il;return n&&gn(e,t,n)&&(t=void 0),r(e,Ss(t))},filter:function(e,t){return(W(e)?fo:El)(e,Ss(t))},find:jl,findLast:Dl,flatMap:function(e,t){return kr(Wl(e,t),1)},flatMapDeep:function(e,t){return kr(Wl(e,t),Gl)},flatMapDepth:function(e,t,n){return n=void 0===n?1:le(n),kr(Wl(e,t),n)},forEach:cl,forEachRight:ml,groupBy:Yl,includes:function(e,t,n,r){e=mn(e)?e:lu(e),n=n&&!r?le(n):0;var i=e.length;return n<0&&(n=uu(i+n,0)),au(e)?n<=i&&e.indexOf(t,n)>-1:!!i&&pt(e,t,n)>-1},invokeMap:Ou,keyBy:Hu,map:Wl,orderBy:function(e,t,n,r){return null==e?[]:(W(t)||(t=null==t?[]:[t]),W(n=r?void 0:n)||(n=null==n?[]:[n]),Sc(e,t,n))},partition:ed,reduce:function(e,t,n){var r=W(e)?mi:Cd,i=arguments.length<3;return r(e,Ss(t),n,i,ks)},reduceRight:function(e,t,n){var r=W(e)?xd:Cd,i=arguments.length<3;return r(e,Ss(t),n,i,hl)},reject:function(e,t){return(W(e)?fo:El)(e,lc(Ss(t)))},sample:Ed,sampleSize:function(e,t,n){return t=(n?gn(e,t,n):void 0===t)?1:le(t),(W(e)?Md:Bd)(e,t)},shuffle:function(e){return(W(e)?jd:Ad)(e)},size:function(e){if(null==e)return 0;if(mn(e))return au(e)?qc(e):e.length;var t=No(e);return"[object Map]"==t||"[object Set]"==t?e.size:Hn(e).length},some:function(e,t,n){var r=W(e)?Ea:Td;return n&&gn(e,t,n)&&(t=void 0),r(e,Ss(t))},sortBy:Fd},Vf=Ns,Kf={after:function(e,t){if("function"!=typeof t)throw new TypeError("Expected a function");return e=le(e),function(){if(--e<1)return t.apply(this,arguments)}},ary:rn,before:qr,bind:Ur,bindKey:Kr,curry:js,curryRight:As,debounce:Ls,defer:Qs,delay:Xs,flip:function(e){return tn(e,512)},memoize:hr,negate:lc,once:function(e){return qr(2,e)},overArgs:Ic,partial:Qc,partialRight:Xc,rearg:Sd,rest:function(e,t){if("function"!=typeof e)throw new TypeError("Expected a function");return fn(e,t=void 0===t?t:le(t))},spread:function(e,t){if("function"!=typeof e)throw new TypeError("Expected a function");return t=null==t?0:qd(le(t),0),fn((function(n){var r=n[t],i=Yr(n,0,t);return r&&$r(i,r),Ne(e,this,i)}))},throttle:function(e,t,n){var r=!0,i=!0;if("function"!=typeof e)throw new TypeError("Expected a function");return Q(n)&&(r="leading"in n?!!n.leading:r,i="trailing"in n?!!n.trailing:i),Ls(e,t,{leading:r,maxWait:t,trailing:i})},unary:function(e){return rn(e,1)},wrap:function(e,t){return Qc(ul(t),e)}},Jf={castArray:function(){if(!arguments.length)return[];var e=arguments[0];return W(e)?e:[e]},clone:_a,cloneDeep:Oa,cloneDeepWith:function(e,t){return Ca(e,5,t="function"==typeof t?t:void 0)},cloneWith:function(e,t){return Ca(e,4,t="function"==typeof t?t:void 0)},conformsTo:function(e,t){return null==t||Cs(e,t,qn(t))},eq:an,gt:Xl,gte:eu,isArguments:$n,isArray:W,isArrayBuffer:Eu,isArrayLike:mn,isArrayLikeObject:Hs,isBoolean:function(e){return!0===e||!1===e||N(e)&&"[object Boolean]"==A(e)},isBuffer:Pn,isDate:Mu,isElement:function(e){return N(e)&&1===e.nodeType&&!Lr(e)},isEmpty:function(e){if(null==e)return!0;if(mn(e)&&(W(e)||"string"==typeof e||"function"==typeof e.splice||Pn(e)||Dn(e)||$n(e)))return!e.length;var t=No(e);if("[object Map]"==t||"[object Set]"==t)return!e.size;if(yn(e))return!Hn(e).length;for(var n in e)if(Bu.call(e,n))return!1;return!0},isEqual:ju,isEqualWith:function(e,t,n){var r=(n="function"==typeof n?n:void 0)?n(e,t):void 0;return void 0===r?os(e,t,void 0,n):!!r},isError:Gr,isFinite:function(e){return"number"==typeof e&&Au(e)},isFunction:he,isInteger:Nu,isLength:hn,isMap:da,isMatch:function(e,t){return e===t||ls(e,t,cs(t))},isMatchWith:function(e,t,n){return n="function"==typeof n?n:void 0,ls(e,t,cs(t),n)},isNaN:function(e){return Fu(e)&&e!=+e},isNative:function(e){if(Du(e))throw new Error("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return Ie(e)},isNil:function(e){return null==e},isNull:function(e){return null===e},isNumber:Fu,isObject:Q,isObjectLike:N,isPlainObject:Lr,isRegExp:Ru,isSafeInteger:function(e){return Nu(e)&&e>=-9007199254740991&&e<=Wu},isSet:pa,isString:au,isSymbol:F,isTypedArray:Dn,isUndefined:function(e){return void 0===e},isWeakMap:function(e){return N(e)&&"[object WeakMap]"==No(e)},isWeakSet:function(e){return N(e)&&"[object WeakSet]"==A(e)},lt:Yu,lte:Zu,toArray:fc,toFinite:se,toInteger:le,toLength:kl,toNumber:ie,toPlainObject:Us,toSafeInteger:function(e){return e?no(le(e),-9007199254740991,gf):0===e?e:0},toString:br},Yf={add:V,ceil:Qi,divide:sl,floor:Hl,max:function(e){return e&&e.length?Qu(e,ue,Zl):void 0},maxBy:function(e,t){return e&&e.length?Qu(e,Ss(t),Zl):void 0},mean:function(e){return tc(e,ue)},meanBy:function(e,t){return tc(e,Ss(t))},min:function(e){return e&&e.length?Qu(e,ue,Ju):void 0},minBy:function(e,t){return e&&e.length?Qu(e,Ss(t),Ju):void 0},multiply:ac,round:Id,subtract:Vd,sum:function(e){return e&&e.length?Xu(e,ue):0},sumBy:Kd},Zf=ro,Qf=function(e,t,n){return t=se(t),void 0===n?(n=t,t=0):n=se(n),function(e,t,n){return e>=iu(t,n)&&e<ru(t,n)}(e=ie(e),t,n)},Xf=function(e,t,n){if(n&&"boolean"!=typeof n&&gn(e,t,n)&&(t=n=void 0),void 0===n&&("boolean"==typeof t?(n=t,t=void 0):"boolean"==typeof e&&(n=e,e=void 0)),void 0===e&&void 0===t?(e=0,t=1):(e=se(e),void 0===t?(t=e,e=0):t=se(t)),e>t){var r=e;e=t,t=r}if(n||e%1||t%1){var i=md();return hd(e+i*(t-e+pd("1e-"+((i+"").length-1))),t)}return fd(e,t)},ep={assign:Vn,assignIn:Zn,assignInWith:Qn,assignWith:Xn,at:Mr,create:function(e,t){var n=Be(e);return null==t?n:oo(n,t)},defaults:Gs,defaultsDeep:Ys,entries:vl,entriesIn:bl,extend:Zn,extendWith:Qn,findKey:function(e,t){return Al(e,Ss(t),Is)},findLastKey:function(e,t){return Al(e,Ss(t),pl)},forIn:function(e,t){return null==e?e:$s(e,ul(t),Yn)},forInRight:function(e,t){return null==e?e:fl(e,ul(t),Yn)},forOwn:function(e,t){return e&&Is(e,ul(t))},forOwnRight:function(e,t){return e&&pl(e,ul(t))},functions:function(e){return null==e?[]:Kl(e,qn(e))},functionsIn:function(e){return null==e?[]:Kl(e,Yn(e))},get:xr,has:function(e,t){return null!=e&&hs(e,t,nu)},hasIn:ms,invert:yu,invertBy:xu,invoke:Iu,keys:qn,keysIn:Yn,mapKeys:function(e,t){var n={};return t=Ss(t),Is(e,(function(e,r,i){on(n,t(e,r,i),e)})),n},mapValues:function(e,t){var n={};return t=Ss(t),Is(e,(function(e,r,i){on(n,r,t(e,r,i))})),n},merge:nc,mergeWith:Js,omit:gc,omitBy:function(e,t){return yc(e,lc(Ss(t)))},pick:td,pickBy:yc,result:function(e,t,n){var r=-1,i=(t=yr(t,e)).length;for(i||(i=1,e=void 0);++r<i;){var o=null==e?void 0:e[Sr(t[r])];void 0===o&&(r=i,o=n),e=he(o)?o.call(e):o}return e},set:function(e,t,n){return null==e?e:vc(e,t,n)},setWith:function(e,t,n,r){return r="function"==typeof r?r:void 0,null==e?e:vc(e,t,n,r)},toPairs:vl,toPairsIn:bl,transform:function(e,t,n){var r=W(e),i=r||Pn(e)||Dn(e);if(t=Ss(t),null==n){var o=e&&e.constructor;n=i?r?new o:[]:Q(e)&&he(o)?Be(Br(e)):{}}return(i?ct:Is)(e,(function(e,r,i){return t(n,e,r,i)})),n},unset:function(e,t){return null==e||hc(e,t)},update:function(e,t,n){return null==e?e:Af(e,t,ul(n))},updateWith:function(e,t,n,r){return r="function"==typeof r?r:void 0,null==e?e:Af(e,t,ul(n),r)},values:lu,valuesIn:function(e){return null==e?[]:su(e,Yn(e))}},tp={at:Ff,chain:Xi,commit:function(){return new Ke(this.value(),this.__chain__)},lodash:Qe,next:function(){void 0===this.__values__&&(this.__values__=fc(this.value()));var e=this.__index__>=this.__values__.length;return{done:e,value:e?void 0:this.__values__[this.__index__++]}},plant:function(e){for(var t,n=this;n instanceof Re;){var r=Ye(n);r.__index__=0,r.__values__=void 0,t?i.__wrapped__=r:t=r;var i=r;n=n.__wrapped__}return i.__wrapped__=e,t},reverse:function(){var e=this.__wrapped__;if(e instanceof Ge){var t=e;return this.__actions__.length&&(t=new Ge(this)),(t=t.reverse()).__actions__.push({func:df,args:[$d],thisArg:void 0}),new Ke(t,this.__chain__)}return this.thru($d)},tap:function(e,t){return t(e),e},thru:df,toIterator:function(){return this},toJSON:mf,value:mf,valueOf:mf,wrapperChain:function(){return Xi(this)}},np={camelCase:Ki,capitalize:hi,deburr:wi,endsWith:function(e,t,n){e=br(e),t=q(t);var r=e.length,i=n=void 0===n?r:no(le(n),0,r);return(n-=t.length)>=0&&e.slice(n,i)==t},escape:Cl,escapeRegExp:function(e){return(e=br(e))&&_l.test(e)?e.replace(xl,"\\$&"):e},kebabCase:zu,lowerCase:Vu,lowerFirst:Ku,pad:function(e,t,n){e=br(e);var r=(t=le(t))?qc(e):0;if(!t||r>=t)return e;var i=(t-r)/2;return Vc(Jc(i),n)+e+Vc(Kc(i),n)},padEnd:function(e,t,n){e=br(e);var r=(t=le(t))?qc(e):0;return t&&r<t?e+Vc(t-r,n):e},padStart:function(e,t,n){e=br(e);var r=(t=le(t))?qc(e):0;return t&&r<t?Vc(t-r,n)+e:e},parseInt:function(e,t,n){return n||null==t?t=0:t&&(t=+t),Zc(br(e).replace(Yc,""),t||0)},repeat:function(e,t,n){return t=(n?gn(e,t,n):void 0===t)?1:le(t),Mc(br(e),t)},replace:function(){var e=arguments,t=br(e[0]);return e.length<3?t:t.replace(e[1],e[2])},snakeCase:Nd,split:function(e,t,n){return n&&"number"!=typeof n&&gn(e,t,n)&&(t=n=void 0),(n=void 0===n?4294967295:n>>>0)?(e=br(e))&&("string"==typeof t||null!=t&&!Ru(t))&&!(t=q(t))&&Qr(e)?Yr(di(e),0,n):e.split(t,n):[]},startCase:Ud,startsWith:function(e,t,n){return e=br(e),n=null==n?0:no(le(n),0,e.length),t=q(t),e.slice(n,n+t.length)==t},template:function(e,t,n){var r=tf.imports._.templateSettings||tf;n&&gn(e,t,n)&&(t=void 0),e=br(e),t=Qn({},t,r,Zd);var i,o,a=Qn({},t.imports,r.imports,Zd),s=qn(a),l=su(a,s),u=0,c=t.interpolate||lf,d="__p += '",f=RegExp((t.escape||lf).source+"|"+c.source+"|"+(c===ef?sf:lf).source+"|"+(t.evaluate||lf).source+"|$","g"),p=cf.call(t,"sourceURL")?"//# sourceURL="+(t.sourceURL+"").replace(/\s/g," ")+"\n":"";e.replace(f,(function(t,n,r,a,s,l){return r||(r=a),d+=e.slice(u,l).replace(uf,Xd),n&&(i=!0,d+="' +\n__e("+n+") +\n'"),s&&(o=!0,d+="';\n"+s+";\n__p += '"),r&&(d+="' +\n((__t = ("+r+")) == null ? '' : __t) +\n'"),u=l+t.length,t})),d+="';\n";var h=cf.call(t,"variable")&&t.variable;if(h){if(af.test(h))throw new Error("Invalid `variable` option passed into `_.template`")}else d="with (obj) {\n"+d+"\n}\n";d=(o?d.replace(nf,""):d).replace(rf,"$1").replace(of,"$1;"),d="function("+(h||"obj")+") {\n"+(h?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(i?", __e = _.escape":"")+(o?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+d+"return __p\n}";var m=zr((function(){return Function(s,p+"return "+d).apply(void 0,l)}));if(m.source=d,Gr(m))throw m;return m},templateSettings:tf,toLower:function(e){return br(e).toLowerCase()},toUpper:function(e){return br(e).toUpperCase()},trim:function(e,t,n){if((e=br(e))&&(n||void 0===t))return Z(e);if(!e||!(t=q(t)))return e;var r=di(e),i=di(t);return Yr(r,bf(r,i),vf(r,i)+1).join("")},trimEnd:function(e,t,n){if((e=br(e))&&(n||void 0===t))return e.slice(0,J(e)+1);if(!e||!(t=q(t)))return e;var r=di(e);return Yr(r,0,vf(r,di(t))+1).join("")},trimStart:function(e,t,n){if((e=br(e))&&(n||void 0===t))return e.replace(yf,"");if(!e||!(t=q(t)))return e;var r=di(e);return Yr(r,bf(r,di(t))).join("")},truncate:function(e,t){var n=30,r="...";if(Q(t)){var i="separator"in t?t.separator:i;n="length"in t?le(t.length):n,r="omission"in t?q(t.omission):r}var o=(e=br(e)).length;if(Qr(e)){var a=di(e);o=a.length}if(n>=o)return e;var s=n-qc(r);if(s<1)return r;var l=a?Yr(a,0,s).join(""):e.slice(0,s);if(void 0===i)return l+r;if(a&&(s+=l.length-s),Ru(i)){if(e.slice(s).search(i)){var u,c=l;for(i.global||(i=RegExp(i.source,br(wf.exec(i))+"g")),i.lastIndex=0;u=i.exec(c);)var d=u.index;l=l.slice(0,void 0===d?s:d)}}else if(e.indexOf(q(i),s)!=s){var f=l.lastIndexOf(i);f>-1&&(l=l.slice(0,f))}return l+r},unescape:function(e){return(e=br(e))&&xf.test(e)?e.replace(Cf,Sf):e},upperCase:Nf,upperFirst:pi,words:qi},rp={attempt:zr,bindAll:Vr,cond:function(e){var t=null==e?0:e.length,n=Ss;return e=t?R(e,(function(e){if("function"!=typeof e[1])throw new TypeError("Expected a function");return[n(e[0]),e[1]]})):[],fn((function(n){for(var r=-1;++r<t;){var i=e[r];if(Ne(i[0],this,n))return Ne(i[1],this,n)}}))},conforms:function(e){return function(e){var t=qn(e);return function(n){return Cs(n,e,t)}}(Ca(e,1))},constant:at,defaultTo:function(e,t){return null==e||e!=e?t:e},flow:Ul,flowRight:Vl,identity:ue,iteratee:function(e){return Ss("function"==typeof e?e:Ca(e,1))},matches:function(e){return fs(Ca(e,1))},matchesProperty:function(e,t){return bs(e,Ca(t,1))},method:rc,methodOf:ic,mixin:oc,noop:ze,nthArg:function(e){return e=le(e),fn((function(t){return pc(t,e)}))},over:xc,overEvery:Oc,overSome:kc,property:ws,propertyOf:function(e){return function(t){return null==e?void 0:Cr(e,t)}},range:yd,rangeRight:wd,stubArray:po,stubFalse:In,stubObject:function(){return{}},stubString:function(){return""},stubTrue:function(){return!0},times:function(e,t){if((e=le(e))<1||e>9007199254740991)return[];var n=ff,r=pf(e,ff);t=ul(t),e-=ff;for(var i=wn(r,t);++n<e;)t(n);return i},toPath:function(e){return W(e)?R(e,Sr):F(e)?[e]:Je(vr(br(e)))},uniqueId:function(e){var t=++Pf;return br(e)+t}};var ip=Math.max,op=Math.min;var ap=Math.min;
/**
	 * @license
	 * Lodash (Custom Build) <https://lodash.com/>
	 * Build: `lodash modularize exports="es" -o ./`
	 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
	 * Released under MIT license <https://lodash.com/license>
	 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
	 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
	 */
var sp,lp=4294967295,up=Array.prototype,cp=Object.prototype.hasOwnProperty,dp=$?$.iterator:void 0,fp=Math.max,pp=Math.min,hp=function(e){return function(t,n,r){if(null==r){var i=Q(n),o=i&&qn(n),a=o&&o.length&&Kl(n,o);(a?a.length:i)||(r=n,n=t,t=this)}return e(t,n,r)}}(oc);Qe.after=Kf.after,Qe.ary=Kf.ary,Qe.assign=ep.assign,Qe.assignIn=ep.assignIn,Qe.assignInWith=ep.assignInWith,Qe.assignWith=ep.assignWith,Qe.at=ep.at,Qe.before=Kf.before,Qe.bind=Kf.bind,Qe.bindAll=rp.bindAll,Qe.bindKey=Kf.bindKey,Qe.castArray=Jf.castArray,Qe.chain=tp.chain,Qe.chunk=qf.chunk,Qe.compact=qf.compact,Qe.concat=qf.concat,Qe.cond=rp.cond,Qe.conforms=rp.conforms,Qe.constant=rp.constant,Qe.countBy=Uf.countBy,Qe.create=ep.create,Qe.curry=Kf.curry,Qe.curryRight=Kf.curryRight,Qe.debounce=Kf.debounce,Qe.defaults=ep.defaults,Qe.defaultsDeep=ep.defaultsDeep,Qe.defer=Kf.defer,Qe.delay=Kf.delay,Qe.difference=qf.difference,Qe.differenceBy=qf.differenceBy,Qe.differenceWith=qf.differenceWith,Qe.drop=qf.drop,Qe.dropRight=qf.dropRight,Qe.dropRightWhile=qf.dropRightWhile,Qe.dropWhile=qf.dropWhile,Qe.fill=qf.fill,Qe.filter=Uf.filter,Qe.flatMap=Uf.flatMap,Qe.flatMapDeep=Uf.flatMapDeep,Qe.flatMapDepth=Uf.flatMapDepth,Qe.flatten=qf.flatten,Qe.flattenDeep=qf.flattenDeep,Qe.flattenDepth=qf.flattenDepth,Qe.flip=Kf.flip,Qe.flow=rp.flow,Qe.flowRight=rp.flowRight,Qe.fromPairs=qf.fromPairs,Qe.functions=ep.functions,Qe.functionsIn=ep.functionsIn,Qe.groupBy=Uf.groupBy,Qe.initial=qf.initial,Qe.intersection=qf.intersection,Qe.intersectionBy=qf.intersectionBy,Qe.intersectionWith=qf.intersectionWith,Qe.invert=ep.invert,Qe.invertBy=ep.invertBy,Qe.invokeMap=Uf.invokeMap,Qe.iteratee=rp.iteratee,Qe.keyBy=Uf.keyBy,Qe.keys=qn,Qe.keysIn=ep.keysIn,Qe.map=Uf.map,Qe.mapKeys=ep.mapKeys,Qe.mapValues=ep.mapValues,Qe.matches=rp.matches,Qe.matchesProperty=rp.matchesProperty,Qe.memoize=Kf.memoize,Qe.merge=ep.merge,Qe.mergeWith=ep.mergeWith,Qe.method=rp.method,Qe.methodOf=rp.methodOf,Qe.mixin=hp,Qe.negate=lc,Qe.nthArg=rp.nthArg,Qe.omit=ep.omit,Qe.omitBy=ep.omitBy,Qe.once=Kf.once,Qe.orderBy=Uf.orderBy,Qe.over=rp.over,Qe.overArgs=Kf.overArgs,Qe.overEvery=rp.overEvery,Qe.overSome=rp.overSome,Qe.partial=Kf.partial,Qe.partialRight=Kf.partialRight,Qe.partition=Uf.partition,Qe.pick=ep.pick,Qe.pickBy=ep.pickBy,Qe.property=rp.property,Qe.propertyOf=rp.propertyOf,Qe.pull=qf.pull,Qe.pullAll=qf.pullAll,Qe.pullAllBy=qf.pullAllBy,Qe.pullAllWith=qf.pullAllWith,Qe.pullAt=qf.pullAt,Qe.range=rp.range,Qe.rangeRight=rp.rangeRight,Qe.rearg=Kf.rearg,Qe.reject=Uf.reject,Qe.remove=qf.remove,Qe.rest=Kf.rest,Qe.reverse=qf.reverse,Qe.sampleSize=Uf.sampleSize,Qe.set=ep.set,Qe.setWith=ep.setWith,Qe.shuffle=Uf.shuffle,Qe.slice=qf.slice,Qe.sortBy=Uf.sortBy,Qe.sortedUniq=qf.sortedUniq,Qe.sortedUniqBy=qf.sortedUniqBy,Qe.split=np.split,Qe.spread=Kf.spread,Qe.tail=qf.tail,Qe.take=qf.take,Qe.takeRight=qf.takeRight,Qe.takeRightWhile=qf.takeRightWhile,Qe.takeWhile=qf.takeWhile,Qe.tap=tp.tap,Qe.throttle=Kf.throttle,Qe.thru=df,Qe.toArray=Jf.toArray,Qe.toPairs=ep.toPairs,Qe.toPairsIn=ep.toPairsIn,Qe.toPath=rp.toPath,Qe.toPlainObject=Jf.toPlainObject,Qe.transform=ep.transform,Qe.unary=Kf.unary,Qe.union=qf.union,Qe.unionBy=qf.unionBy,Qe.unionWith=qf.unionWith,Qe.uniq=qf.uniq,Qe.uniqBy=qf.uniqBy,Qe.uniqWith=qf.uniqWith,Qe.unset=ep.unset,Qe.unzip=qf.unzip,Qe.unzipWith=qf.unzipWith,Qe.update=ep.update,Qe.updateWith=ep.updateWith,Qe.values=ep.values,Qe.valuesIn=ep.valuesIn,Qe.without=qf.without,Qe.words=np.words,Qe.wrap=Kf.wrap,Qe.xor=qf.xor,Qe.xorBy=qf.xorBy,Qe.xorWith=qf.xorWith,Qe.zip=qf.zip,Qe.zipObject=qf.zipObject,Qe.zipObjectDeep=qf.zipObjectDeep,Qe.zipWith=qf.zipWith,Qe.entries=ep.toPairs,Qe.entriesIn=ep.toPairsIn,Qe.extend=ep.assignIn,Qe.extendWith=ep.assignInWith,hp(Qe,Qe),Qe.add=Yf.add,Qe.attempt=rp.attempt,Qe.camelCase=np.camelCase,Qe.capitalize=np.capitalize,Qe.ceil=Yf.ceil,Qe.clamp=Zf,Qe.clone=Jf.clone,Qe.cloneDeep=Jf.cloneDeep,Qe.cloneDeepWith=Jf.cloneDeepWith,Qe.cloneWith=Jf.cloneWith,Qe.conformsTo=Jf.conformsTo,Qe.deburr=np.deburr,Qe.defaultTo=rp.defaultTo,Qe.divide=Yf.divide,Qe.endsWith=np.endsWith,Qe.eq=Jf.eq,Qe.escape=np.escape,Qe.escapeRegExp=np.escapeRegExp,Qe.every=Uf.every,Qe.find=Uf.find,Qe.findIndex=qf.findIndex,Qe.findKey=ep.findKey,Qe.findLast=Uf.findLast,Qe.findLastIndex=qf.findLastIndex,Qe.findLastKey=ep.findLastKey,Qe.floor=Yf.floor,Qe.forEach=Uf.forEach,Qe.forEachRight=Uf.forEachRight,Qe.forIn=ep.forIn,Qe.forInRight=ep.forInRight,Qe.forOwn=ep.forOwn,Qe.forOwnRight=ep.forOwnRight,Qe.get=ep.get,Qe.gt=Jf.gt,Qe.gte=Jf.gte,Qe.has=ep.has,Qe.hasIn=ep.hasIn,Qe.head=qf.head,Qe.identity=ue,Qe.includes=Uf.includes,Qe.indexOf=qf.indexOf,Qe.inRange=Qf,Qe.invoke=ep.invoke,Qe.isArguments=Jf.isArguments,Qe.isArray=W,Qe.isArrayBuffer=Jf.isArrayBuffer,Qe.isArrayLike=Jf.isArrayLike,Qe.isArrayLikeObject=Jf.isArrayLikeObject,Qe.isBoolean=Jf.isBoolean,Qe.isBuffer=Jf.isBuffer,Qe.isDate=Jf.isDate,Qe.isElement=Jf.isElement,Qe.isEmpty=Jf.isEmpty,Qe.isEqual=Jf.isEqual,Qe.isEqualWith=Jf.isEqualWith,Qe.isError=Jf.isError,Qe.isFinite=Jf.isFinite,Qe.isFunction=Jf.isFunction,Qe.isInteger=Jf.isInteger,Qe.isLength=Jf.isLength,Qe.isMap=Jf.isMap,Qe.isMatch=Jf.isMatch,Qe.isMatchWith=Jf.isMatchWith,Qe.isNaN=Jf.isNaN,Qe.isNative=Jf.isNative,Qe.isNil=Jf.isNil,Qe.isNull=Jf.isNull,Qe.isNumber=Jf.isNumber,Qe.isObject=Q,Qe.isObjectLike=Jf.isObjectLike,Qe.isPlainObject=Jf.isPlainObject,Qe.isRegExp=Jf.isRegExp,Qe.isSafeInteger=Jf.isSafeInteger,Qe.isSet=Jf.isSet,Qe.isString=Jf.isString,Qe.isSymbol=Jf.isSymbol,Qe.isTypedArray=Jf.isTypedArray,Qe.isUndefined=Jf.isUndefined,Qe.isWeakMap=Jf.isWeakMap,Qe.isWeakSet=Jf.isWeakSet,Qe.join=qf.join,Qe.kebabCase=np.kebabCase,Qe.last=il,Qe.lastIndexOf=qf.lastIndexOf,Qe.lowerCase=np.lowerCase,Qe.lowerFirst=np.lowerFirst,Qe.lt=Jf.lt,Qe.lte=Jf.lte,Qe.max=Yf.max,Qe.maxBy=Yf.maxBy,Qe.mean=Yf.mean,Qe.meanBy=Yf.meanBy,Qe.min=Yf.min,Qe.minBy=Yf.minBy,Qe.stubArray=rp.stubArray,Qe.stubFalse=rp.stubFalse,Qe.stubObject=rp.stubObject,Qe.stubString=rp.stubString,Qe.stubTrue=rp.stubTrue,Qe.multiply=Yf.multiply,Qe.nth=qf.nth,Qe.noop=rp.noop,Qe.now=Vf,Qe.pad=np.pad,Qe.padEnd=np.padEnd,Qe.padStart=np.padStart,Qe.parseInt=np.parseInt,Qe.random=Xf,Qe.reduce=Uf.reduce,Qe.reduceRight=Uf.reduceRight,Qe.repeat=np.repeat,Qe.replace=np.replace,Qe.result=ep.result,Qe.round=Yf.round,Qe.sample=Uf.sample,Qe.size=Uf.size,Qe.snakeCase=np.snakeCase,Qe.some=Uf.some,Qe.sortedIndex=qf.sortedIndex,Qe.sortedIndexBy=qf.sortedIndexBy,Qe.sortedIndexOf=qf.sortedIndexOf,Qe.sortedLastIndex=qf.sortedLastIndex,Qe.sortedLastIndexBy=qf.sortedLastIndexBy,Qe.sortedLastIndexOf=qf.sortedLastIndexOf,Qe.startCase=np.startCase,Qe.startsWith=np.startsWith,Qe.subtract=Yf.subtract,Qe.sum=Yf.sum,Qe.sumBy=Yf.sumBy,Qe.template=np.template,Qe.times=rp.times,Qe.toFinite=Jf.toFinite,Qe.toInteger=le,Qe.toLength=Jf.toLength,Qe.toLower=np.toLower,Qe.toNumber=Jf.toNumber,Qe.toSafeInteger=Jf.toSafeInteger,Qe.toString=Jf.toString,Qe.toUpper=np.toUpper,Qe.trim=np.trim,Qe.trimEnd=np.trimEnd,Qe.trimStart=np.trimStart,Qe.truncate=np.truncate,Qe.unescape=np.unescape,Qe.uniqueId=rp.uniqueId,Qe.upperCase=np.upperCase,Qe.upperFirst=np.upperFirst,Qe.each=Uf.forEach,Qe.eachRight=Uf.forEachRight,Qe.first=qf.head,hp(Qe,(sp={},Is(Qe,(function(e,t){cp.call(Qe.prototype,t)||(sp[t]=e)})),sp),{chain:!1}),Qe.VERSION="4.17.21",(Qe.templateSettings=np.templateSettings).imports._=Qe,ct(["bind","bindKey","curry","curryRight","partial","partialRight"],(function(e){Qe[e].placeholder=Qe})),ct(["drop","take"],(function(e,t){Ge.prototype[e]=function(n){n=void 0===n?1:fp(le(n),0);var r=this.__filtered__&&!t?new Ge(this):this.clone();return r.__filtered__?r.__takeCount__=pp(n,r.__takeCount__):r.__views__.push({size:pp(n,lp),type:e+(r.__dir__<0?"Right":"")}),r},Ge.prototype[e+"Right"]=function(t){return this.reverse()[e](t).reverse()}})),ct(["filter","map","takeWhile"],(function(e,t){var n=t+1,r=1==n||3==n;Ge.prototype[e]=function(e){var t=this.clone();return t.__iteratees__.push({iteratee:Ss(e),type:n}),t.__filtered__=t.__filtered__||r,t}})),ct(["head","last"],(function(e,t){var n="take"+(t?"Right":"");Ge.prototype[e]=function(){return this[n](1).value()[0]}})),ct(["initial","tail"],(function(e,t){var n="drop"+(t?"":"Right");Ge.prototype[e]=function(){return this.__filtered__?new Ge(this):this[n](1)}})),Ge.prototype.compact=function(){return this.filter(ue)},Ge.prototype.find=function(e){return this.filter(e).head()},Ge.prototype.findLast=function(e){return this.reverse().find(e)},Ge.prototype.invokeMap=fn((function(e,t){return"function"==typeof e?new Ge(this):this.map((function(n){return $u(n,e,t)}))})),Ge.prototype.reject=function(e){return this.filter(lc(Ss(e)))},Ge.prototype.slice=function(e,t){e=le(e);var n=this;return n.__filtered__&&(e>0||t<0)?new Ge(n):(e<0?n=n.takeRight(-e):e&&(n=n.drop(e)),void 0!==t&&(n=(t=le(t))<0?n.dropRight(-t):n.take(t-e)),n)},Ge.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},Ge.prototype.toArray=function(){return this.take(lp)},Is(Ge.prototype,(function(e,t){var n=/^(?:filter|find|map|reject)|While$/.test(t),r=/^(?:head|last)$/.test(t),i=Qe[r?"take"+("last"==t?"Right":""):t],o=r||/^find/.test(t);i&&(Qe.prototype[t]=function(){var t=this.__wrapped__,a=r?[1]:arguments,s=t instanceof Ge,l=a[0],u=s||W(t),c=function(e){var t=i.apply(Qe,$r([e],a));return r&&d?t[0]:t};u&&n&&"function"==typeof l&&1!=l.length&&(s=u=!1);var d=this.__chain__,f=!!this.__actions__.length,p=o&&!d,h=s&&!f;if(!o&&u){t=h?t:new Ge(this);var m=e.apply(t,a);return m.__actions__.push({func:df,args:[c],thisArg:void 0}),new Ke(m,d)}return p&&h?e.apply(this,a):(m=this.thru(c),p?r?m.value()[0]:m.value():m)})})),ct(["pop","push","shift","sort","splice","unshift"],(function(e){var t=up[e],n=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",r=/^(?:pop|shift)$/.test(e);Qe.prototype[e]=function(){var e=arguments;if(r&&!this.__chain__){var i=this.value();return t.apply(W(i)?i:[],e)}return this[n]((function(n){return t.apply(W(n)?n:[],e)}))}})),Is(Ge.prototype,(function(e,t){var n=Qe[t];if(n){var r=n.name+"";cp.call(qe,r)||(qe[r]=[]),qe[r].push({name:t,func:n})}})),qe[Ft(void 0,2).name]=[{name:"wrapper",func:void 0}],Ge.prototype.clone=function(){var e=new Ge(this.__wrapped__);return e.__actions__=Je(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=Je(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=Je(this.__views__),e},Ge.prototype.reverse=function(){if(this.__filtered__){var e=new Ge(this);e.__dir__=-1,e.__filtered__=!0}else(e=this.clone()).__dir__*=-1;return e},Ge.prototype.value=function(){var e=this.__wrapped__.value(),t=this.__dir__,n=W(e),r=t<0,i=n?e.length:0,o=function(e,t,n){for(var r=-1,i=n.length;++r<i;){var o=n[r],a=o.size;switch(o.type){case"drop":e+=a;break;case"dropRight":t-=a;break;case"take":t=op(t,e+a);break;case"takeRight":e=ip(e,t-a)}}return{start:e,end:t}}(0,i,this.__views__),a=o.start,s=o.end,l=s-a,u=r?s:a-1,c=this.__iteratees__,d=c.length,f=0,p=ap(l,this.__takeCount__);if(!n||!r&&i==l&&p==l)return hf(e,this.__actions__);var h=[];e:for(;l--&&f<p;){for(var m=-1,g=e[u+=t];++m<d;){var v=c[m],b=v.iteratee,y=v.type,w=b(g);if(2==y)g=w;else if(!w){if(1==y)continue e;break e}}h[f++]=g}return h},Qe.prototype.at=tp.at,Qe.prototype.chain=tp.wrapperChain,Qe.prototype.commit=tp.commit,Qe.prototype.next=tp.next,Qe.prototype.plant=tp.plant,Qe.prototype.reverse=tp.reverse,Qe.prototype.toJSON=Qe.prototype.valueOf=Qe.prototype.value=tp.value,Qe.prototype.first=Qe.prototype.head,dp&&(Qe.prototype[dp]=tp.toIterator)
/**
	 * @license
	 * Lodash (Custom Build) <https://lodash.com/>
	 * Build: `lodash modularize exports="es" -o ./`
	 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
	 * Released under MIT license <https://lodash.com/license>
	 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
	 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
	 */;var mp={};!function(e){!function(){const t="1.2.0";function n(e){alert("Mod ERROR:\n"+e);const t=new Error(e);throw console.error(t),t}const r=new TextEncoder;function i(e){return!!e&&"object"==typeof e&&!Array.isArray(e)}function o(e){const t=new Set;return e.filter((e=>!t.has(e)&&t.add(e)))}const a=new Map,s=new Set;function l(e){s.has(e)||(s.add(e),console.warn(e))}function u(e){const t=[],n=new Map,r=new Set;for(const i of p.values()){const o=i.patching.get(e.name);if(o){t.push(...o.hooks);for(const[t,a]of o.patches.entries())n.has(t)&&n.get(t)!==a&&l(`ModSDK: Mod '${i.name}' is patching function ${e.name} with same pattern that is already applied by different mod, but with different pattern:\nPattern:\n${t}\nPatch1:\n${n.get(t)||""}\nPatch2:\n${a}`),n.set(t,a),r.add(i.name)}}t.sort(((e,t)=>t.priority-e.priority));const i=function(e,t){if(0===t.size)return e;let n=e.toString().replaceAll("\r\n","\n");for(const[r,i]of t.entries())n.includes(r)||l(`ModSDK: Patching ${e.name}: Patch ${r} not applied`),n=n.replaceAll(r,i);return(0,eval)(`(${n})`)}(e.original,n);let o=function(t){var n,o;const a=null===(o=(n=v.errorReporterHooks).hookChainExit)||void 0===o?void 0:o.call(n,e.name,r),s=i.apply(this,t);return null==a||a(),s};for(let n=t.length-1;n>=0;n--){const r=t[n],i=o;o=function(t){var n,o;const a=null===(o=(n=v.errorReporterHooks).hookEnter)||void 0===o?void 0:o.call(n,e.name,r.mod),s=r.hook.apply(this,[t,e=>{if(1!==arguments.length||!Array.isArray(t))throw new Error(`Mod ${r.mod} failed to call next hook: Expected args to be array, got ${typeof e}`);return i.call(this,e)}]);return null==a||a(),s}}return{hooks:t,patches:n,patchesSources:r,enter:o,final:i}}function c(e,t=!1){let n=a.get(e);if(n)t&&(n.precomputed=u(n));else{let t=window;const o=e.split(".");for(let n=0;n<o.length-1;n++)if(t=t[o[n]],!i(t))throw new Error(`ModSDK: Function ${e} to be patched not found; ${o.slice(0,n+1).join(".")} is not object`);const s=t[o[o.length-1]];if("function"!=typeof s)throw new Error(`ModSDK: Function ${e} to be patched not found`);const l=function(e){let t=-1;for(const n of r.encode(e)){let e=255&(t^n);for(let t=0;t<8;t++)e=1&e?-306674912^e>>>1:e>>>1;t=t>>>8^e}return(~t>>>0).toString(16).padStart(8,"0").toUpperCase()}(s.toString().replaceAll("\r\n","\n")),c={name:e,original:s,originalHash:l};n=Object.assign(Object.assign({},c),{precomputed:u(c),router:()=>{},context:t,contextProperty:o[o.length-1]}),n.router=function(e){return function(...t){return e.precomputed.enter.apply(this,[t])}}(n),a.set(e,n),t[n.contextProperty]=n.router}return n}function d(){for(const e of a.values())e.precomputed=u(e)}function f(){const e=new Map;for(const[t,n]of a)e.set(t,{name:t,original:n.original,originalHash:n.originalHash,sdkEntrypoint:n.router,currentEntrypoint:n.context[n.contextProperty],hookedByMods:o(n.precomputed.hooks.map((e=>e.mod))),patchedByMods:Array.from(n.precomputed.patchesSources)});return e}const p=new Map;function h(e){p.get(e.name)!==e&&n(`Failed to unload mod '${e.name}': Not registered`),p.delete(e.name),e.loaded=!1,d()}function m(e,t){e&&"object"==typeof e||n("Failed to register mod: Expected info object, got "+typeof e),"string"==typeof e.name&&e.name||n("Failed to register mod: Expected name to be non-empty string, got "+typeof e.name);let r=`'${e.name}'`;"string"==typeof e.fullName&&e.fullName||n(`Failed to register mod ${r}: Expected fullName to be non-empty string, got ${typeof e.fullName}`),r=`'${e.fullName} (${e.name})'`,"string"!=typeof e.version&&n(`Failed to register mod ${r}: Expected version to be string, got ${typeof e.version}`),e.repository||(e.repository=void 0),void 0!==e.repository&&"string"!=typeof e.repository&&n(`Failed to register mod ${r}: Expected repository to be undefined or string, got ${typeof e.version}`),null==t&&(t={}),t&&"object"==typeof t||n(`Failed to register mod ${r}: Expected options to be undefined or object, got ${typeof t}`);const o=!0===t.allowReplace,a=p.get(e.name);a&&(a.allowReplace&&o||n(`Refusing to load mod ${r}: it is already loaded and doesn't allow being replaced.\nWas the mod loaded multiple times?`),h(a));const s=e=>{let t=f.patching.get(e.name);return t||(t={hooks:[],patches:new Map},f.patching.set(e.name,t)),t},l=(e,t)=>(...i)=>{var o,a;const s=null===(a=(o=v.errorReporterHooks).apiEndpointEnter)||void 0===a?void 0:a.call(o,e,f.name);f.loaded||n(`Mod ${r} attempted to call SDK function after being unloaded`);const l=t(...i);return null==s||s(),l},u={unload:l("unload",(()=>h(f))),hookFunction:l("hookFunction",((e,t,i)=>{"string"==typeof e&&e||n(`Mod ${r} failed to patch a function: Expected function name string, got ${typeof e}`);const o=c(e),a=s(o);"number"!=typeof t&&n(`Mod ${r} failed to hook function '${e}': Expected priority number, got ${typeof t}`),"function"!=typeof i&&n(`Mod ${r} failed to hook function '${e}': Expected hook function, got ${typeof i}`);const l={mod:f.name,priority:t,hook:i};return a.hooks.push(l),d(),()=>{const e=a.hooks.indexOf(l);e>=0&&(a.hooks.splice(e,1),d())}})),patchFunction:l("patchFunction",((e,t)=>{"string"==typeof e&&e||n(`Mod ${r} failed to patch a function: Expected function name string, got ${typeof e}`);const o=c(e),a=s(o);i(t)||n(`Mod ${r} failed to patch function '${e}': Expected patches object, got ${typeof t}`);for(const[i,o]of Object.entries(t))"string"==typeof o?a.patches.set(i,o):null===o?a.patches.delete(i):n(`Mod ${r} failed to patch function '${e}': Invalid format of patch '${i}'`);d()})),removePatches:l("removePatches",(e=>{"string"==typeof e&&e||n(`Mod ${r} failed to patch a function: Expected function name string, got ${typeof e}`);const t=c(e);s(t).patches.clear(),d()})),callOriginal:l("callOriginal",((e,t,i)=>{"string"==typeof e&&e||n(`Mod ${r} failed to call a function: Expected function name string, got ${typeof e}`);const o=c(e);return Array.isArray(t)||n(`Mod ${r} failed to call a function: Expected args array, got ${typeof t}`),o.original.apply(null!=i?i:globalThis,t)})),getOriginalHash:l("getOriginalHash",(e=>("string"==typeof e&&e||n(`Mod ${r} failed to get hash: Expected function name string, got ${typeof e}`),c(e).originalHash)))},f={name:e.name,fullName:e.fullName,version:e.version,repository:e.repository,allowReplace:o,api:u,loaded:!0,patching:new Map};return p.set(e.name,f),Object.freeze(u)}function g(){const e=[];for(const t of p.values())e.push({name:t.name,fullName:t.fullName,version:t.version,repository:t.repository});return e}let v;const b=void 0===window.bcModSdk?window.bcModSdk=function(){const e={version:t,apiVersion:1,registerMod:m,getModsInfo:g,getPatchingInfo:f,errorReporterHooks:Object.seal({apiEndpointEnter:null,hookEnter:null,hookChainExit:null})};return v=e,Object.freeze(e)}():(i(window.bcModSdk)||n("Failed to init Mod SDK: Name already in use"),1!==window.bcModSdk.apiVersion&&n(`Failed to init Mod SDK: Different version already loaded ('1.2.0' vs '${window.bcModSdk.version}')`),window.bcModSdk.version!==t&&alert(`Mod SDK warning: Loading different but compatible versions ('1.2.0' vs '${window.bcModSdk.version}')\nOne of mods you are using is using an old version of SDK. It will work for now but please inform author to update`),window.bcModSdk);Object.defineProperty(e,"__esModule",{value:!0}),e.default=b}()}(mp);var gp,vp,bp,yp,wp,Sp,Cp=r(mp);const xp=Object.freeze(["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"]),_p=/^(v?)([0-9]+)\.([0-9]+)\.([0-9]+)(\.\S+)?$/;gp=new WeakSet,vp=function(e,t){const n=new Date(Date.now());console[e]("MBS:",...t),this.push({date:n,level:e,args:t})};const $p=new class extends Array{constructor(){super(...arguments),gp.add(this)}debug(...e){w(this,gp,"m",vp).call(this,"debug",e)}log(...e){w(this,gp,"m",vp).call(this,"log",e)}warn(...e){w(this,gp,"m",vp).call(this,"warn",e)}error(...e){w(this,gp,"m",vp).call(this,"error",e)}toJSON(){return this.map((e=>({date:e.date.toUTCString(),level:e.level,args:e.args.map((e=>e instanceof Map||e instanceof Set?Array.from(e):e))})))}};function Ip(e,t,n=-1/0,r=1/0){if(!(Number.isInteger(e)&&e>=n&&e<=r))throw"number"!=typeof e?new TypeError(`Invalid "${t}" type: ${typeof e}`):Number.isInteger(e)?new RangeError(`"${t}" must fall in the [${n}, ${r}] interval: ${e}`):new Error(`"${t}" must be an integer: ${e}`)}function Op(e,t,n){if(Ip(t,"n",0),!Array.isArray(e))throw new TypeError('Invalid "list" type: '+typeof e);const r=t-e.length;return r>0&&e.push(...Array(r).fill(n)),e}function kp(e,t){if(Ip(t,"n",0),!Array.isArray(e))throw new TypeError('Invalid "list" type: '+typeof e);const n=e.length-t;return n>0&&e.splice(t,n),e}function Ep(e){return Ip(e,"n",0,8),yd(0,e).map((e=>Ed(xp))).join("")}async function Pp(e,t=100){for(;!e();)await new Promise((e=>setTimeout(e,t)));return!0}const Mp=Cp.registerMod({name:"MBS",fullName:"Maid's Bondage Scripts",repository:"https://github.com/bananarama92/MBS",version:t});bp=new WeakMap;const Bp=new class{constructor(){bp.set(this,null)}get modName(){return"MBS"}getRuleState(e){return null===w(this,bp,"f")&&"undefined"!=typeof bcx&&S(this,bp,bcx.getModApi("MBS"),"f"),w(this,bp,"f")?.getRuleState(e)??null}};function jp(e,t){let n=`${e}(`;return n+=Object.values(t).map((e=>String(e))).join(", "),n+=")",n}class Ap{get index(){return w(this,wp,"f")}set index(e){this.setPosition(e)}get value(){return w(this,yp,"f")[w(this,wp,"f")]}get list(){return w(this,yp,"f")}constructor(e,t=0){if(yp.set(this,void 0),wp.set(this,void 0),!Tp(e))throw new TypeError('Invalid "iterable" type: '+typeof e);const n=Object.freeze([...e]);if(0===n.length)throw new Error('Passed "iterable" must contain at least one element');Ip(t,"index",0,n.length-1),S(this,yp,n,"f"),S(this,wp,t,"f")}*[(yp=new WeakMap,wp=new WeakMap,Symbol.iterator)](){for(;;)yield this.next()}next(e=!0){const t=(w(this,wp,"f")+1)%w(this,yp,"f").length;return e&&S(this,wp,t,"f"),w(this,yp,"f")[t]}previous(e=!0){const t=(w(this,wp,"f")+w(this,yp,"f").length-1)%w(this,yp,"f").length;return e&&S(this,wp,t,"f"),w(this,yp,"f")[t]}setPosition(e){Ip(e,"index",0,w(this,yp,"f").length-1),S(this,wp,e,"f")}toString(){return jp(typeof this,this.toJSON())}toJSON(){return{list:this.list,index:this.index}}}function Np(e,t){if(Ip(e,"start",0,65535),!Dp(t))throw new TypeError('Invalid "indices" type: '+typeof t);const n=e+Math.max(0,...t)+1;Ip(n,"stop",e+1,65535);const r=yd(e,n);return t.map((e=>String.fromCharCode(r[e])))}function Tp(e){return Symbol.iterator in Object(e)}class Fp{constructor(e=0,t=0,n=0,r=!1){if(Sp.set(this,void 0),Ip(e,"major",0,65535),Ip(t,"minor",0,65535),Ip(n,"micro",0,65535),"boolean"!=typeof r)throw new TypeError('Invalid "beta" type: '+typeof r);this.major=e,this.minor=t,this.micro=n,this.beta=r,S(this,Sp,[e,t,n].map((e=>String.fromCharCode(e)))+String.fromCharCode(r?0:1),"f"),Object.freeze(this)}equal(e){return e instanceof Fp&&this.valueOf()===e.valueOf()}greater(e){return e instanceof Fp&&this.valueOf()>e.valueOf()}lesser(e){return e instanceof Fp&&this.valueOf()<e.valueOf()}greaterOrEqual(e){return e instanceof Fp&&this.valueOf()>=e.valueOf()}lesserOrEqual(e){return e instanceof Fp&&this.valueOf()<=e.valueOf()}static fromVersion(e){const t=_p.exec(e);if(null===t)throw new Error(`Invalid "version": ${e}`);return new Fp(Number(t[2]),Number(t[3]),Number(t[4]),void 0!==t[5])}static fromBCVersion(e){const t=GameVersionFormat.exec(e);if(null===t)throw new Error(`Invalid BC version: "${e}"`);return new Fp(Number(t[1]),0,0,void 0!==t[2])}toString(){return jp(typeof this,this.toJSON())}valueOf(){return w(this,Sp,"f")}toJSON(){return{major:this.major,minor:this.minor,micro:this.micro,beta:this.beta}}}function Dp(e){return Array.isArray(e)}function Lp(e){return Object.keys(e)}function Rp(e){return Object.entries(e)}function Wp(e){return Object.fromEntries(e)}function Gp(e,t){return e.includes(t)}function zp(e){return Number.isInteger(e)}Sp=new WeakMap;const Hp=Object.freeze(Object.fromEntries([["CraftingSaveServer",["025B434F"]],["CraftingClick",["5A1B4ACC"]],["CraftingRun",["4018E748"]],["SpeechGarble",["9D669F73"]],["SpeechGarbleByGagLevel",["F7555009"]],["PreferenceLoad",["8BAC28C8"]],["WheelFortuneLoad",["204D57D4"]],["WheelFortuneClick",["21CCD6B4"]],["WheelFortuneRun",["150059B6"]],["WheelFortuneMouseUp",["1465BDFA"]],["WheelFortuneMouseDown",["306C80B6"]],["WheelFortuneCustomizeLoad",["97F0A81E"]],["WheelFortuneDrawWheel",["A8BF62A5"]]].map((e=>{const[t,n]=e,r=new Set(n.filter((e=>null!=e)));return[t,Object.freeze(r)]}))));function qp(e,t,n){if(lg(t),null===e||"object"!=typeof e)throw new TypeError('Invalid "item" type: '+typeof e);ExtendedItemSetOptionByRecord(t,e,n,{refresh:!1,push:!1})}function Up(e,t,n){const r={Asset:e};return ExtendedItemInit(t,r,!1,!1),n&&qp(r,t,n),r.Property??{}}const Vp=Object.freeze({NONE:0,CLOTHES:1,UNDERWEAR:2,COSPLAY:3,ALL:4});let Kp;function Jp(e,t){switch(e){case Vp.NONE:return()=>!1;case Vp.CLOTHES:return e=>e.Group.AllowNone&&!e.BodyCosplay&&!e.Group.Underwear;case Vp.UNDERWEAR:return e=>e.Group.AllowNone&&!e.BodyCosplay;case Vp.COSPLAY:return e=>!ug(t)?e.Group.AllowNone&&!e.BodyCosplay:e.Group.AllowNone;case Vp.ALL:return e=>!!ug(t)||e.Group.AllowNone&&!e.BodyCosplay;default:throw new Error(`Invalid "stripLevel" value: ${e}`)}}function Yp(e,t){if(void 0===t)return[-1,!1];if(void 0!==t.priority&&void 0!==t.blocksSubSet)return[t.priority,t.blocksSubSet];if(0===t.block.size)return t.priority=0,t.blocksSubSet=!1,[t.priority,t.blocksSubSet];{const n=[];for(const r of t.block)n.push(Yp(e,e.get(r)));return t.priority=1+Math.max(0,...n.map((e=>e[0]))),t.blocksSubSet=t.superSet&&n.some((e=>e[1])),[t.priority,t.blocksSubSet]}}function Zp(e,t,n=[]){if(!Dp(e))throw new TypeError('Invalid "itemList" type: '+typeof e);const r=new Map;[e,n].forEach(((e,n)=>{for(const{Group:i,Name:o,TypeRecord:a}of e){if(r.has(i))continue;const e=AssetGet(t.AssetFamily,i,o);if(null==e)throw new Error(`Unknown asset: ${i}${o}`);if("Item"!==e.Group.Category)continue;const s=Up(e,t,a),l={superSet:1===n,block:new Set(...e.Block??[],...s.Block??[])};(e.Effect?.includes("Enclose")||s.Effect?.includes("Enclose"))&&(l.priority=AssetGroup.length,l.blocksSubSet=l.superSet),r.set(i,l)}}));for(const[e,t]of r)Yp(r,t);return r}Pp(dg).then((()=>Kp=CharacterLoadSimple("MBSDummy")));const Qp=new Map;function Xp(e,t){const n=InventoryGetLock(e);if(!InventoryItemHasEffect(e,"Lock"))return!0;if("Decoy"===e.Craft?.Property){if(null==n)return!1;return!["OwnerOnly","LoverOnly","FamilyOnly"].some((t=>n.Asset[t]||e.Asset[t]))}const r=Bp.getRuleState("block_keyuse_self"),i=t.IsPlayer()&&r?.inEffect&&r?.isEnforced;switch(n?.Asset?.Name){case"SafewordPadlock":return!0;case"MetalPadlock":case"MistressPadlock":case"MistressTimerPadlock":case"PandoraPadlock":{if(i||LogQuery("KeyDeposit","Cell"))return!1;let e=Qp.get(`${t.ID}:${n.Asset.Name}`);return void 0===e&&(e=t.Inventory.some((e=>e.Asset.Name===`${n.Asset.Name}Key`)),Qp.set(`${t.ID}:${n.Asset.Name}`,e)),e}case"TimerPasswordPadlock":case"PasswordPadlock":case"CombinationPadlock":return Number(e.Property?.LockMemberNumber)===t.MemberNumber;case"HighSecurityPadlock":{const n=(e?.Property?.MemberNumberListKeys??"").split(",").map(Number);return!i&&Gp(n,t.MemberNumber)}default:return!1}}function eh(e,t,n,r=null,i=null,o=Player){if(!Dp(t))throw new TypeError('Invalid "itemList" type: '+typeof t);if(function(e){const t=e.Appearance.find((e=>InventoryItemHasEffect(e,"Enclose")));return null!=t&&!Xp(t,e)}(o))return void $p.log(`Failed to equip all "${e}" wheel of fortune items: cannot unlock enclosing item`);!function(e,t){lg(t);const n=Jp(e,t),r=t.Appearance;for(let e=r.length-1;e>=0;e--){const t=r[e].Asset;t.Group.AllowNone&&"Appearance"===t.Group.Category&&n(t)&&r.splice(e,1)}}(n,o),"function"==typeof i&&(t=i(t,o));const a=function(e,t,n){const r=Zp(e,n,t);return t.filter((e=>r.get(e.Group)?.blocksSubSet))}(t,o.Appearance.map((e=>({Group:e.Asset.Group.Name,Name:e.Asset.Name,TypeRecord:e.Property?.TypeRecord,NoEquip:!0}))),o);Qp.clear();const s={},l=new Set,u=o.IsPlayer()&&LogQuery("ClubSlave","Management");for(const{Name:e,Group:n,Equip:r,NoEquip:i}of[...a,...t]){const t=AssetGet(o.AssetFamily,n,e),a=InventoryGet(o,n),c="function"!=typeof r||r(o);if(null!=t)if(c){const e={InventoryGroupIsBlockedForCharacter:InventoryGroupIsBlockedForCharacter(o,n,!1),InventoryGroupIsBlockedByOwnerRule:InventoryGroupIsBlockedByOwnerRule(o,n),"Locked item equipped":null!=a&&!Xp(a,o)};i||(e.InventoryBlockedOrLimited=InventoryBlockedOrLimited(o,{Asset:t}),e.InventoryChatRoomAllow=!InventoryChatRoomAllow(t.Category??[]),e["Blocked via Club Slave Collar"]=u&&"Appearance"===t.Group.Category);const r=Rp(e).filter((e=>e[1]));0!==r.length?s[t.Description]=r.map((e=>e[0])):null!=a&&InventoryRemove(o,n,!1)}else l.add(n);else s[e]=["Unknown asset"]}for(const{Name:e,Group:n,Craft:i,ItemCallback:a,Color:u,TypeRecord:c,Property:d}of t){const t=AssetGet(o.AssetFamily,n,e),f=s[t?.Description??e];if(null==t||void 0!==f||l.has(n))continue;if(!InventoryAllow(o,t,t.Prerequisite,!1)){s[t.Description]=["InventoryAllow"];continue}const p=[...u??t.DefaultColor],h=CharacterAppearanceSetItem(o,n,t,p,SkillGetWithRatio(o,"Bondage"),o.MemberNumber,!1);null!=h&&(c&&qp(h,o,c),void 0!==i&&(h.Craft=Oa(i),InventoryCraft(o,o,n,h.Craft,!1,!1)),h.Property=Object.assign(h.Property??{},Oa(d)),"function"==typeof a&&a(h,o),"function"==typeof r&&r(h,o))}if(CharacterRefresh(o,!1,!1),o.IsPlayer()){ChatRoomCharacterUpdate(o);const t=Object.values(s).length;0!==t&&$p.log(`Failed to equip ${t} "${e}" wheel of fortune items`,s)}}function th(e,t,n){if("string"!=typeof t||!DynamicDrawTextRegex.test(t))return!1;const r=`${n.Group.Name}${n.Name}`,[i,o]=Rp(TextItemDataLookup).find((([e])=>e.includes(r)))??["",null];return null!==o&&t.length<=(o.maxLength[e]??-1)}const nh=Object.freeze({OverridePriority:(e,t)=>{if(zp(e))return!0;if(CommonIsObject(e)){const n=t.Layer.map((e=>e.Name));return Rp(e).every((([e,t])=>n.includes(e)&&zp(t)))}return!1},Opacity:(e,t)=>"number"==typeof e&&e<=t.MaxOpacity&&e>=t.MinOpacity,Text:(e,t)=>th("Text",e,t),Text2:(e,t)=>th("Text2",e,t),Text3:(e,t)=>th("Text3",e,t),ShowText:(e,t)=>"boolean"==typeof e,TriggerValues:(e,t)=>"string"==typeof e&&e.split(",").length===ItemVulvaFuturisticVibratorTriggers.length,AccessMode:(e,t)=>"string"==typeof e&&ItemVulvaFuturisticVibratorAccessModes.includes(e),PunishOrgasm:(e,t)=>"boolean"==typeof e,PunishStandup:(e,t)=>"boolean"==typeof e,Texts:(e,t)=>!!Array.isArray(e)&&(!(e.length<ItemDevicesLuckyWheelMinTexts||e.length>ItemDevicesLuckyWheelMaxTexts)&&e.every((e=>"string"==typeof e&&e.length<=ItemDevicesLuckyWheelMaxTextLength))),TargetAngle:(e,t)=>"number"==typeof e&&e>=0&&e<=360,OverrideHeight:function(e,t){const n=VariableHeightDataLookup[`${t.Group.Name}${t.Name}`];if(void 0===n)return!1;const r=e;return null!==r&&"object"==typeof r&&Number.isInteger(r.Priority)&&"number"==typeof r.Height&&r.Height<=n.maxHeight&&r.Height>=n.minHeight&&(null==r.HeightRatioProportion||"number"==typeof r.HeightRatioProportion&&r.HeightRatioProportion>=0&&r.HeightRatioProportion<=1)},PunishStruggle:(e,t)=>"boolean"==typeof e,PunishStruggleOther:(e,t)=>"boolean"==typeof e,PunishRequiredSpeechWord:(e,t)=>"string"==typeof e&&e.length<=70,PunishProhibitedSpeechWords:(e,t)=>"string"==typeof e&&e.length<=70,PunishSpeech:(e,t)=>zp(e)&&e>=0&&e<FuturisticTrainingBeltSpeechPunishments.length,PunishRequiredSpeech:(e,t)=>zp(e)&&e>=0&&e<FuturisticTrainingBeltSpeechPunishments.length,PunishProhibitedSpeech:(e,t)=>zp(e)&&e>=0&&e<FuturisticTrainingBeltSpeechPunishments.length,PublicModeCurrent:(e,t)=>zp(e)&&e>=0&&e<FuturisticTrainingBeltModes.length,PublicModePermission:(e,t)=>zp(e)&&e>=0&&e<FuturisticTrainingBeltPermissions.length,ShockLevel:(e,t)=>zp(e)&&e>=0&&e<=2,PortalLinkCode:(e,t)=>"string"==typeof e&&PortalLinkCodeRegex.test(e)});function rh(e,t){if(null===t||"object"!=typeof t)return{};const n=new Set(["OverridePriority"]);if(e.Archetype){const r=ExtendedItemGatherOptions({Asset:e,Property:t});for(const e of r){"VariableHeightOption"===e.OptionType&&n.add("OverrideHeight");for(const t of Lp(e.ParentData.baselineProperty??{}))CraftingPropertyExclude.has(t)||n.add(t)}}const r={};for(const[i,o]of Rp(t)){const t=nh[i];null!=o&&n.has(i)&&void 0!==t&&(t(o,e)&&(r[i]=o))}return r}const ih=Object.freeze(new Map([["Unknown asset",e=>null==e],["Unsupported owner-only asset",e=>e?.OwnerOnly],["Unsupported lovers-only asset",e=>e?.LoverOnly],["Unsupported D/S family-only asset",e=>e?.FamilyOnly],["Unsupported disabled asset",e=>!e?.Enable],["Unsupported script-asset",e=>"Script"===e?.Group?.Category]]));function oh(e,t,n=!0){for(const[n,r]of ih)if(r(e))throw new Error(`${n}: ${t.Group}${t.Name}`);let r,i;"string"==typeof t.Color?r=[t.Color]:Array.isArray(t.Color)&&t.Color.every((e=>"string"==typeof e))&&(r=[...t.Color]),null!==t.Craft&&"object"==typeof t.Craft&&(i=Object.assign(Oa(t.Craft),{TypeRecord:void 0,OverridePriority:null,Lock:""}),CraftingValidate(i,e,!1));const o=t.Property??{};let a;return CommonIsObject(o.TypeRecord)?a=Object.freeze({...o.TypeRecord}):"string"==typeof o.Type||null===o.Type?a=ExtendedItemTypeToRecord(e,o.Type):"string"==typeof o.Mode&&(a=ExtendedItemTypeToRecord(e,o.Mode)),Object.freeze({Name:t.Name,Group:t.Group,Custom:n,Property:Object.freeze(rh(e,t.Property)),TypeRecord:a,Color:r,Craft:Object.freeze(i),ItemCallback:void 0,Equip:void 0})}function ah(e,t){if(!Dp(e))throw new TypeError('Invalid "items" type: '+typeof e);return e.map((e=>function(e,t){const{Group:n,Name:r,Color:i,Craft:o,TypeRecord:a,Property:s}=e,l=AssetGet(t.AssetFamily,n,r);if(null==l)throw new Error(`Unknown asset: ${n}${r}`);return{Group:n,Name:r,Color:_a(i),Craft:_a(o),Property:Object.assign(Up(l,t,a),Oa(s))}}(e,t)))}var sh;class lh{get screen(){return this.constructor.screen}get ids(){return this.constructor.ids}get rootParams(){return this.screenParams[this.constructor.ids.root]}constructor(e,t,n){this.parent=e,this.screenParams=nc(Oa(t),n??{}),this.child=null}resize(e){const t=MainCanvas.canvas.clientHeight/1e3,n=MainCanvas.canvas.clientWidth/2e3;for(const[r,{shape:i,visibility:o}]of Rp(this.screenParams)){const a={left:`${MainCanvas.canvas.offsetLeft+i[0]*n}px`,top:`${MainCanvas.canvas.offsetTop+i[1]*t}px`,width:`${i[2]*n}px`,height:`${i[3]*t}px`};e&&(a.fontFamily=CommonGetFontName(),a.visibility=o);const s=document.getElementById(r);Object.assign(s.style,a)}}unload(){for(const e of Lp(this.screenParams)){const t=document.getElementById(e);null!==t&&(t.style.visibility="hidden")}}exit(){for(const e of Lp(this.screenParams))ElementRemove(e)}load(){const e=CurrentScreen;CurrentScreenFunctions?.Unload?.(),ControllerIsActive()&&ControllerClearAreas(),CurrentScreen=this.screen,CurrentScreenFunctions=this.getFunctions(),CurrentDarkFactor=1,CommonGetFont.clearCache(),CommonGetFontName.clearCache(),CurrentScreenFunctions?.Resize?.(!0),"ChatSearch"!=e&&"ChatCreate"!=e||ChatRoomStimulationMessage("Walk")}loadChild(e,...t){return this.child&&this.child.exit(),this.child=new e(this,...t),this.child.load(),this.child}exitScreens(e){let t=this.parent,n=this.child;for(;null!=n?.child;)n=n.child;for(;n&&n!==this;)n.child=null,n.exit(),n=n.parent;if(e)for(;null!==t&&!(t instanceof uh);)t.child=null,t.exit(),t=t.parent;null!==t&&(t.load(),t.child=null)}getFunctions(){return{Run:this.run?.bind(this)??CommonNoop,Draw:this.draw?.bind(this),Click:this.click?.bind(this)??CommonNoop,Load:this.load.bind(this),Unload:this.unload?.bind(this),Resize:this.resize?.bind(this),Exit:this.exit.bind(this)}}}lh.background="Sheet",lh.screen="",lh.screenParamsDefault={};class uh extends lh{constructor(e,t,n,r){super(e,uh.screenParamsDefault,null),this.module=t,this.background=n,this.screenFunctions=Object.freeze({...r})}run(e){return this.screenFunctions.Run(e)}draw(){return this.screenFunctions.Draw?.()}click(e){return this.screenFunctions.Click(e)}load(){return this.screenFunctions.Load?.()}unload(){return this.screenFunctions.Unload?.()}resize(e){return this.screenFunctions.Resize?.(e)}keyDown(e){return this.screenFunctions.KeyDown?.(e)??!1}exit(){return this.screenFunctions.Exit?.()}}uh.screenParamsDefault={};const ch=Object.freeze({NONE:0,SAVE:1,DELETE:2});class dh extends lh{get index(){return w(this,sh,"f")}set index(e){Ip(e,"index",0,this.mbsList.length-1),S(this,sh,e,"f")}get mbsObject(){return this.mbsList[w(this,sh,"f")]}hasStorageSpace(){return null!==this.mbsList[this.index]||this.dataSize.value<=this.dataSize.max*this.dataSize.marigin}constructor(e,t,n,r,i,o){super(e,i,o),sh.set(this,0),this.character=r,this.mbsList=t,this.index=n,this.dataSize=Object.seal({value:0,valueRecord:{},max:Em,marigin:.9})}load(){const e=Pm(this.character.OnlineSharedSettings);this.dataSize.value=Kd(Object.values(e),(e=>Number.isNaN(e)?0:e)),this.dataSize.valueRecord=e,super.load()}exit(e=!0,t=ch.NONE){if(super.exit(),!this.character.IsPlayer())return this.exitScreens(e);switch(t){case ch.NONE:break;case ch.SAVE:this.settings.isValid(this.index)&&this.hasStorageSpace()&&(this.mbsList[this.index]=this.settings.writeSettings(),this.mbsList[this.index]?.register());break;case ch.DELETE:{const e=this.mbsList[this.index];this.mbsList[this.index]=null,e?.unregister();break}default:throw new Error(`Unsupported action: ${t}`)}this.exitScreens(e)}}sh=new WeakMap;var fh,ph,hh,mh,gh;const vh=Object.freeze({[Vp.NONE]:"None",[Vp.CLOTHES]:"Clothes",[Vp.UNDERWEAR]:"Clothes and underwear",[Vp.COSPLAY]:"Clothes, underwear and cosplay items",[Vp.ALL]:"Clothes, underwear, cosplay items and body"});function bh(e){e=ro(e,60,14400);const t={h:0,m:0,s:0};return t.h=Math.floor(e/3600),e-=3600*t.h,t.m=Math.floor(e/60),e-=60*t.m,t.s=e,`${t.h.toString().padStart(2,"0")}:${t.m.toString().padStart(2,"0")}:${t.s.toString().padStart(2,"0")}`}function yh(e,t,n){return p("div",{id:e.inputID,class:"mbs-dropdown",onWheel:n=>{const r=document.getElementById(e.buttonID);if(r.disabled)return;let i;if(n.deltaY<0)i=ro(t[e.level]-1,Vp.NONE,Vp.COSPLAY);else{if(!(n.deltaY>0))return;i=ro(t[e.level]+1,Vp.NONE,Vp.COSPLAY)}t[e.level]=i,r.innerText=vh[t[e.level]]},children:[f("button",{class:"mbs-button",disabled:n,id:e.buttonID,children:vh[Vp.UNDERWEAR]}),p("div",{class:"mbs-dropdown-content",id:e.dropdownID,children:[" ",Object.values(vh).slice(0,4).map(((r,i)=>f("button",{class:"mbs-button mbs-dropdown-button",disabled:n,"data-level":i,id:e.optionID+i.toString(),onClick:n=>{const r=n.target;t[e.level]=ro(Number.parseInt(r.dataset.level),Vp.NONE,Vp.COSPLAY);document.getElementById(e.buttonID).innerText=vh[t[e.level]]},children:r})))," "]})]})}const wh="mbs-fwitemset",Sh=Object.freeze({root:wh,styles:`${wh}-style`,delete:`${wh}-delete`,deleteButton:`${wh}-delete-button`,deleteTooltip:`${wh}-delete-tooltip`,accept:`${wh}-accept`,acceptButton:`${wh}-accept-button`,acceptTooltip:`${wh}-accept-tooltip`,cancel:`${wh}-cancel`,cancelButton:`${wh}-cancel-button`,cancelTooltip:`${wh}-cancel-tooltip`,exit:`${wh}-exit`,exitButton:`${wh}-exit-button`,exitTooltip:`${wh}-exit-tooltip`,header:`${wh}-header`,midDiv:`${wh}-mid-grid`,botDiv:`${wh}-bot-grid`,outfitName:`${wh}-outfit-name`,outfitInput:`${wh}-outfit-input`,outfitDiv:`${wh}-outfit-div`,outfitButton:`${wh}-outfit-button`,outfitTooltip:`${wh}-outfit-tooltip`,stripHeader:`${wh}-strip-header`,stripInput:`${wh}-strip-dropdown`,stripButton:`${wh}-strip-dropdown-button`,stripDropdown:`${wh}-strip-dropdown-content`,stripOption:`${wh}-strip-dropdown-option`,equipHeader:`${wh}-equip-header`,equipInput:`${wh}-equip-dropdown`,equipButton:`${wh}-equip-dropdown-button`,equipDropdown:`${wh}-equip-dropdown-content`,equipOption:`${wh}-equip-dropdown-option`,weightHeader:`${wh}-weight-header`,weightInput:`${wh}-weight-input`,lockHeader:`${wh}-lock-header`,lockGrid:`${wh}-lock-grid`,lockContainer:`${wh}-lock-container`,lockCheckbox:`${wh}-lock-checkbox`,lockTimer:`${wh}-lock-timer`});class Ch extends dh{constructor(e,t,n,r,i=null){const o=!r.IsPlayer();super(e,t,n,r,Ch.screenParamsDefault,i),fh.add(this),this.settings=new gg(t),this.preview=CharacterLoadSimple("MBSFortuneWheelPreview"),document.body.appendChild(p("div",{id:Sh.root,class:"mbs-screen",children:[f("style",{id:Sh.styles,children:'#mbs-fwitemset {\n  grid-template: "delete header accept cancel exit" min(9vh, 4.5vw) "midDiv midDiv midDiv midDiv midDiv" max-content "botDiv botDiv botDiv botDiv botDiv" auto/min(9vh, 4.5vw) auto min(9vh, 4.5vw) min(9vh, 4.5vw) min(9vh, 4.5vw);\n}\n\n#mbs-fwitemset-delete {\n  grid-area: delete;\n}\n\n#mbs-fwitemset-header {\n  grid-area: header;\n  margin-left: min(20vh, 10vw);\n}\n\n#mbs-fwitemset-accept {\n  grid-area: accept;\n}\n\n#mbs-fwitemset-cancel {\n  grid-area: cancel;\n}\n\n#mbs-fwitemset-exit {\n  grid-area: exit;\n}\n\n#mbs-fwitemset-mid-grid {\n  display: grid;\n  grid-area: midDiv;\n  grid-template: "name ." min(10vh, 5vw) "outfitCode outfitCodeButton" min(7vh, 3.5vw)/min(78vh, 39vw) auto;\n  margin-left: 35%;\n  grid-gap: min(2vh, 1vw) min(6vh, 3vw);\n}\n\n#mbs-fwitemset-outfit-name {\n  align-self: end;\n  grid-area: name;\n  height: min(7vh, 3.5vw);\n}\n\n#mbs-fwitemset-outfit-input {\n  grid-area: outfitCode;\n  height: min(7vh, 3.5vw);\n}\n\n#mbs-fwitemset-outfit-div {\n  grid-area: outfitCodeButton;\n  grid-template-columns: min(27vh, 13.5vw);\n  grid-template-rows: min(7vh, 3.5vw) auto;\n}\n\n#mbs-fwitemset-bot-grid {\n  display: grid;\n  grid-area: botDiv;\n  margin-left: 35%;\n  grid-gap: min(2vh, 1vw) min(8vh, 4vw);\n  align-items: end;\n  grid-template: "headerStrip headerLock" min(7vh, 3.5vw) "configStrip gridLock" min(7vh, 3.5vw) "headerEquip gridLock" min(7vh, 3.5vw) "configEquip gridLock" min(7vh, 3.5vw) "headerWeight gridLock" min(7vh, 3.5vw) "configWeight gridLock" min(7vh, 3.5vw)/min(40vh, 20vw) auto;\n  overflow: hidden;\n  text-align: left;\n}\n\n#mbs-fwitemset-strip-header {\n  grid-area: headerStrip;\n}\n\n#mbs-fwitemset-strip-input {\n  align-self: start;\n  grid-area: configStrip;\n}\n\n#mbs-fwitemset-equip-header {\n  grid-area: headerEquip;\n}\n\n#mbs-fwitemset-equip-input {\n  align-self: start;\n  grid-area: configEquip;\n}\n\n#mbs-fwitemset-weight-header {\n  grid-area: headerWeight;\n}\n\n#mbs-fwitemset-weight-input {\n  align-self: start;\n  grid-area: configWeight;\n  width: min(7vh, 3.5vw);\n}\n\n#mbs-fwitemset-lock-header {\n  grid-area: headerLock;\n}\n\n#mbs-fwitemset-lock-grid {\n  align-self: start;\n  display: grid;\n  grid-area: gridLock;\n  grid-template-columns: 5fr 5fr;\n  overflow-y: scroll;\n  grid-gap: min(2vh, 1vw);\n}\n\n.mbs-fwitemset-lock-container {\n  align-items: center;\n  display: grid;\n  word-wrap: break-word;\n  grid-template-columns: 1.5fr 8.5fr;\n  grid-gap: min(2vh, 1vw);\n}\n\n.mbs-timer {\n  height: min(5vh, 2.5vw);\n  text-align: center;\n  width: min(21vh, 10.5vw);\n}\n\n#mbs-fwitemset-strip-dropdown-button, #mbs-fwitemset-equip-dropdown-button {\n  height: min(7vh, 3.5vw);\n}\n\n#mbs-fwitemset-strip-dropdown-content, #mbs-fwitemset-equip-dropdown-content {\n  width: min(80vh, 40vw);\n}'.toString()}),f("h1",{id:Sh.header,children:`Customize wheel of fortune item set ${this.index}`}),p("div",{id:Sh.delete,class:"mbs-button-div",children:[f("button",{class:"mbs-button",id:Sh.deleteButton,style:{backgroundImage:"url('./Icons/Trash.png')"},onClick:()=>this.exit(!1,ch.DELETE),disabled:o}),f("div",{class:"mbs-button-tooltip",id:Sh.deleteTooltip,style:{justifySelf:"left"},children:"Delete item set"})]}),p("div",{id:Sh.accept,class:"mbs-button-div",children:[f("button",{class:"mbs-button",id:Sh.acceptButton,style:{backgroundImage:"url('./Icons/Accept.png')"},onClick:()=>this.exit(!1,ch.SAVE),disabled:!0}),f("div",{class:"mbs-button-tooltip",id:Sh.acceptTooltip,style:{justifySelf:"right"},children:"Save item set:\\nMissing outfit"})]}),p("div",{id:Sh.cancel,class:"mbs-button-div",children:[f("button",{class:"mbs-button",id:Sh.cancelButton,style:{backgroundImage:"url('./Icons/Cancel.png')"},onClick:()=>this.exit(!1,ch.NONE)}),f("div",{class:"mbs-button-tooltip",id:Sh.cancelTooltip,style:{justifySelf:"right"},children:"Cancel"})]}),p("div",{id:Sh.exit,class:"mbs-button-div",children:[f("button",{class:"mbs-button",id:Sh.exitButton,style:{backgroundImage:"url('./Icons/Exit.png')"},onClick:()=>this.exit(!0,ch.NONE)}),f("div",{class:"mbs-button-tooltip",id:Sh.exitTooltip,style:{justifySelf:"right"},children:"Exit"})]}),p("div",{id:Sh.midDiv,children:[f("input",{type:"text",id:Sh.outfitName,placeholder:"Name",disabled:o,maxLength:70,onInput:e=>{this.settings.name=e.target.value,w(this,fh,"m",hh).call(this,Sh.acceptButton)},onFocus:e=>e.target.select()}),f("input",{type:"text",id:Sh.outfitInput,placeholder:"Outfit code",disabled:o,onInput:e=>{this.settings.outfitCache=e.target.value,w(this,fh,"m",hh).call(this,Sh.outfitButton)},onFocus:e=>e.target.select()}),p("div",{id:Sh.outfitDiv,class:"mbs-button-div",children:[f("button",{class:"mbs-button",disabled:!0,id:Sh.outfitButton,onClick:()=>w(this,fh,"m",hh).call(this,Sh.acceptButton,!0),children:"Parse"}),f("div",{class:"mbs-button-tooltip",id:Sh.outfitTooltip,children:"Parse the outfit code"})]})]}),p("div",{id:Sh.botDiv,children:[f("div",{id:Sh.stripHeader,children:"Clothing strip level:"}),f("div",{id:Sh.equipHeader,children:"Clothing equip level:"}),f("div",{id:Sh.weightHeader,children:"Wheel option weight:"}),f("div",{id:Sh.lockHeader,children:"Enabled lock types:"}),f("input",{type:"number",id:Sh.weightInput,min:1,max:9,value:1,disabled:o,onInput:e=>{const t=e.target;this.settings.weight=ro(Number.parseInt(t.value,10),1,9)},onWheel:e=>{const t=e.target;if(!t.disabled){if(e.deltaY<0)t.stepUp(1);else{if(!(e.deltaY>0))return;t.stepDown(1)}this.settings.weight=ro(Number.parseInt(t.value,10),1,9)}},onFocus:e=>e.target.select()}),yh({inputID:Sh.stripInput,buttonID:Sh.stripButton,optionID:Sh.stripOption,dropdownID:Sh.stripDropdown,level:"stripLevel"},this.settings,o),yh({inputID:Sh.equipInput,buttonID:Sh.equipButton,optionID:Sh.equipOption,dropdownID:Sh.equipDropdown,level:"equipLevel"},this.settings,o),p("div",{id:Sh.lockGrid,children:[" ",this.settings.flags.map(((e,t)=>{let n;if("TimerPasswordPadlock"===e.type)n=function(e,t,n){return f("input",{type:"time",class:"mbs-timer",id:Sh.lockTimer+t.toString(),disabled:n,min:"00:01:00",max:"04:00:00",step:1,value:bh(e.time),onInput:t=>{const n=t.target,[r,i,o]=n.value.split(":").map((e=>Number.parseInt(e,10)));e.time=ro(3600*r+60*i+o,60,14400)},onWheel:t=>{const n=t.target;if(n.disabled)return;if(t.deltaY<0)n.stepUp(120);else{if(!(t.deltaY>0))return;n.stepDown(120)}const[r,i,o]=n.value.split(":").map((e=>Number.parseInt(e,10)));e.time=ro(3600*r+60*i+o,60,14400)}})}(e,t,o);else n=e.description;return p("div",{class:Sh.lockContainer,id:Sh.lockContainer+t.toString(),children:[f("input",{type:"checkbox",class:Sh.lockCheckbox,id:Sh.lockCheckbox+t.toString(),disabled:o,checked:e.enabled,onClick:()=>{e.enabled=!e.enabled,w(this,fh,"m",hh).call(this,Sh.acceptButton)}}),n]})}))," "]})]})]}))}load(){super.load();const e=this.mbsObject;if(null!==e){this.settings.readSettings(e),this.settings.outfitCache=LZString.compressToBase64(JSON.stringify(ah(e.itemList,this.preview))),ElementValue(Sh.outfitName,e.name),ElementValue(Sh.weightInput,e.weight.toString()),ElementValue(Sh.outfitInput,this.settings.outfitCache);for(const[e,t]of this.settings.flags.entries()){if(document.getElementById(`${Sh.lockCheckbox}${e}`).checked=t.enabled,"TimerPasswordPadlock"===t.type)ElementValue(`${Sh.lockTimer}${e}`,bh(t.time))}const t=document.getElementById(Sh.equipButton),n=document.getElementById(Sh.stripButton);t.innerText=vh[this.settings.equipLevel],n.innerText=vh[this.settings.stripLevel],w(this,fh,"m",hh).call(this,Sh.acceptButton,!0),w(this,fh,"m",hh).call(this,Sh.outfitButton)}else this.settings.reset(),w(this,fh,"m",hh).call(this,Sh.acceptButton),w(this,fh,"m",hh).call(this,Sh.outfitButton);w(this,fh,"m",gh).call(this)}draw(){DrawCharacter(this.preview,300,175,.78,!1)}exit(e,t){CharacterDelete(this.preview),super.exit(e,t)}}fh=new WeakSet,ph=function(){return this.settings.isValid(this.index)&&this.hasStorageSpace()},hh=function(e,t=!1){const n=document.getElementById(e),r=!this.character.IsPlayer();switch(e){case Sh.acceptButton:if(t){const e=this.settings.loadFromBase64();n.disabled=r||!(e&&w(this,fh,"m",ph).call(this)),!r&&e&&w(this,fh,"m",gh).call(this)}else n.disabled=r||!(null!==this.settings.itemList&&w(this,fh,"m",ph).call(this));w(this,fh,"m",mh).call(this,Sh.acceptTooltip);break;case Sh.outfitButton:n.disabled=r||!this.settings.outfitCache,w(this,fh,"m",mh).call(this,Sh.outfitTooltip);break;default:throw new Error(`Unsupported tooltip type: ${e}`)}},mh=function(e){const t=document.getElementById(e);switch(e){case Sh.acceptTooltip:{const e="Save item set";this.settings.loadFromBase64()?w(this,fh,"m",ph).call(this)?t.innerText=e:this.settings.name?this.settings.flags.every((e=>!e.enabled))?t.innerText=`${e}:\nMust enable at least one lock type`:this.hasStorageSpace()?t.innerText=`${e}:\nMax allowed OnlineSharedSettings storage size exceeded (${Mm(this.dataSize.value)} / ${Mm(this.dataSize.max)}`:t.innerText=`${e}:\nDuplicate name`:t.innerText=`${e}:\nMissing name`:t.innerText=`${e}:\nMissing outfit`;break}case Sh.outfitTooltip:{const e="Parse outfit code";this.settings.outfitCache?t.innerText=e:t.innerText=`${e}:\nMissing code`;break}default:throw new Error(`Unsupported tooltip type: ${e}`)}},gh=function(){if(this.preview.Appearance=[...this.character.Appearance],this.preview.OnlineSharedSettings=this.character.OnlineSharedSettings,CharacterReleaseTotal(this.preview),null===this.settings.itemList)return;const e=Jp(this.settings.equipLevel,this.preview),t=this.preview.AssetFamily;eh("MBSPreview",this.settings.itemList.filter((({Name:n,Group:r})=>{const i=AssetGet(t,r,n);return null!=i&&("Appearance"!==i.Group.Category||e(i))})),this.settings.stripLevel,null,null,this.preview)},Ch.ids=Sh,Ch.screen="MBS_FWItemSetScreen",Ch.background="Sheet",Ch.screenParamsDefault={[wh]:Object.freeze({shape:[80,60,1840,880],visibility:"visible"})};const xh="mbs-fwcommand",_h=Object.freeze({root:xh,styles:`${xh}-style`,delete:`${xh}-delete`,deleteButton:`${xh}-delete-button`,deleteTooltip:`${xh}-delete-tooltip`,accept:`${xh}-accept`,acceptButton:`${xh}-accept-button`,acceptTooltip:`${xh}-accept-tooltip`,cancel:`${xh}-cancel`,cancelButton:`${xh}-cancel-button`,cancelTooltip:`${xh}-cancel-tooltip`,exit:`${xh}-exit`,exitButton:`${xh}-exit-button`,exitTooltip:`${xh}-exit-tooltip`,header:`${xh}-header`,commandInput:`${xh}-command-input`,weightHeader:`${xh}-weight-header`,weightInput:`${xh}-weight-input`});class $h extends dh{constructor(e,t,n,r,i=null){super(e,t,n,r,$h.screenParamsDefault,i),this.settings=new vg(t);const o=!r.IsPlayer();document.body.appendChild(p("div",{id:_h.root,class:"mbs-screen",children:[f("style",{id:_h.styles,children:'#mbs-fwcommand {\n  grid-template: "delete header accept cancel exit" min(9vh, 4.5vw) "commandInput commandInput commandInput commandInput commandInput" min(9vh, 4.5vw) "weightHeader weightHeader weightHeader weightHeader weightHeader" min(7vh, 3.5vw) "weightInput weightInput weightInput weightInput weightInput" min(7vh, 3.5vw)/min(9vh, 4.5vw) auto min(9vh, 4.5vw) min(9vh, 4.5vw) min(9vh, 4.5vw);\n}\n\n#mbs-fwcommand-delete {\n  grid-area: delete;\n}\n\n#mbs-fwcommand-header {\n  grid-area: header;\n  margin-left: min(20vh, 10vw);\n}\n\n#mbs-fwcommand-accept {\n  grid-area: accept;\n}\n\n#mbs-fwcommand-cancel {\n  grid-area: cancel;\n}\n\n#mbs-fwcommand-exit {\n  grid-area: exit;\n}\n\n#mbs-fwcommand-command-input {\n  grid-area: commandInput;\n  height: min(7vh, 3.5vw);\n  place-self: self-end center;\n  width: 50%;\n}\n\n#mbs-fwcommand-weight-header {\n  align-self: self-end;\n  grid-area: weightHeader;\n}\n\n#mbs-fwcommand-weight-input {\n  grid-area: weightInput;\n  place-self: start center;\n  width: min(7vh, 3.5vw);\n}'.toString()}),f("h1",{id:_h.header,children:`Customize wheel of fortune command ${this.index}`}),p("div",{id:_h.delete,class:"mbs-button-div",children:[f("button",{class:"mbs-button",id:_h.deleteButton,style:{backgroundImage:"url('./Icons/Trash.png')"},onClick:()=>this.exit(!1,ch.DELETE),disabled:o}),f("div",{class:"mbs-button-tooltip",id:_h.deleteTooltip,style:{justifySelf:"left"},children:"Delete command"})]}),p("div",{id:_h.accept,class:"mbs-button-div",children:[f("button",{class:"mbs-button",id:_h.acceptButton,style:{backgroundImage:"url('./Icons/Accept.png')"},onClick:()=>this.exit(!1,ch.SAVE),disabled:!0}),f("div",{class:"mbs-button-tooltip",id:_h.acceptTooltip,style:{justifySelf:"right"},children:"Save command"})]}),p("div",{id:_h.cancel,class:"mbs-button-div",children:[f("button",{class:"mbs-button",id:_h.cancelButton,style:{backgroundImage:"url('./Icons/Cancel.png')"},onClick:()=>this.exit(!1,ch.NONE)}),f("div",{class:"mbs-button-tooltip",id:_h.cancelTooltip,style:{justifySelf:"right"},children:"Cancel"})]}),p("div",{id:_h.exit,class:"mbs-button-div",children:[f("button",{class:"mbs-button",id:_h.exitButton,style:{backgroundImage:"url('./Icons/Exit.png')"},onClick:()=>this.exit(!0,ch.NONE)}),f("div",{class:"mbs-button-tooltip",id:_h.exitTooltip,style:{justifySelf:"right"},children:"Exit"})]}),f("input",{type:"text",id:_h.commandInput,placeholder:"Role play command",disabled:o,maxLength:70,onInput:e=>{this.settings.name=e.target.value;document.getElementById(_h.acceptButton).disabled=0===this.settings.name.length},onFocus:e=>e.target.select()}),f("div",{id:_h.weightHeader,children:"Wheel option weight:"}),f("input",{type:"number",id:_h.weightInput,min:1,max:9,value:1,disabled:o,onInput:e=>{const t=e.target;this.settings.weight=ro(Number.parseInt(t.value,10),1,9)},onWheel:e=>{const t=e.target;if(!t.disabled){if(e.deltaY<0)t.stepUp(1);else{if(!(e.deltaY>0))return;t.stepDown(1)}this.settings.weight=ro(Number.parseInt(t.value,10),1,9)}},onFocus:e=>e.target.select()})]}))}load(){if(super.load(),null!==this.mbsObject){this.settings.readSettings(this.mbsObject),ElementValue(_h.commandInput,this.mbsObject.name),ElementValue(_h.weightInput,this.mbsObject.weight.toString());document.getElementById(_h.acceptButton).disabled=this.character.IsPlayer()}else this.settings.reset()}}$h.screen="MBS_FWCommandScreen",$h.background="Sheet",$h.screenParamsDefault={[xh]:Object.freeze({shape:[80,60,1840,880],visibility:"visible"})};var Ih,Oh;function kh(e,t,n){const r=Tm(e.OnlineSharedSettings?.MBS,"OnlineSharedSettings",!1);let i,o=void 0===r?void 0:r[t];if(Array.isArray(o)||(void 0!==o&&$p.warn(`Failed to load "${e.AccountName}" wheel of fortune ${n}`),o=Array(og).fill(null)),e.IsPlayer())i=Player.MBSSettings[t];else{const e=[];i=Am("FortuneWheelItemSets"===t?wg.fromObject:Sg.fromObject,o,e),e.forEach((e=>console.warn(e)))}return i.forEach((e=>e?.register(!1))),i}function Eh(e,t){return f("button",{class:"mbs-button",id:Mh.button+t.toString(),style:{height:"min(7vh, 3.5vw)"},onClick:()=>{if(t<og){const n={[Ch.ids.root]:{shape:e.rootParams.shape}};return e.loadChild(Ch,e.wheelStruct.FortuneWheelItemSets,t,e.character,n)}return e.loadChild($h,e.wheelStruct.FortuneWheelCommands,t-og,e.character)}})}const Ph="mbs-fwselect",Mh=Object.freeze({root:Ph,styles:`${Ph}-style`,exit:`${Ph}-exit`,exitButton:`${Ph}-exit-button`,exitTooltip:`${Ph}-exit-tooltip`,storage:`${Ph}-storage`,storageInner:`${Ph}-storage-cover`,storageTooltip:`${Ph}-storage-tooltip`,storageFooter:`${Ph}-storage-footer`,buttonOuterGrid:`${Ph}-button-grid-outer`,buttonInnerGrid0:`${Ph}-button-grid-inner0`,buttonInnerGrid1:`${Ph}-button-grid-inner1`,button:`${Ph}-button`,itemSets:`${Ph}-header0`,commandSets:`${Ph}-header1`});class Bh extends lh{get wheelList(){return[...this.wheelStruct.FortuneWheelItemSets,...this.wheelStruct.FortuneWheelCommands]}constructor(e,t,n,r=null){super(e,Bh.screenParamsDefault,r),Ih.add(this),this.wheelStruct=t,this.character=n,this.dataSize=Object.seal({value:0,valueRecord:{},max:Em,marigin:.9});const i=this.character.IsPlayer();document.body.appendChild(p("div",{id:Mh.root,class:"mbs-screen",children:[f("style",{id:Mh.styles,children:'#mbs-fwselect {\n  grid-template: ". buttonOuterGrid exit" min(9vh, 4.5vw) "storage buttonOuterGrid ." auto "storageFooter buttonOuterGrid ." min(14vh, 7vw)/min(30vh, 15vw) auto min(20vh, 10vw);\n}\n\n#mbs-fwselect-exit {\n  grid-area: exit;\n  height: min(9vh, 4.5vw);\n  justify-self: end;\n  width: min(9vh, 4.5vw);\n}\n\n#mbs-fwselect-storage {\n  background-image: linear-gradient(180deg, #d80000, #d80000 10%, #00d800 60%, #00d800) !important;\n  border: min(0.3vh, 0.15vw) solid var(--mbs-border-color);\n  display: grid;\n  grid-area: storage;\n  height: 100%;\n  justify-self: center;\n  width: 35%;\n}\n#mbs-fwselect-storage #mbs-fwselect-storage-tooltip {\n  bottom: unset;\n  left: 15%;\n  position: absolute;\n  visibility: hidden;\n}\n#mbs-fwselect-storage:hover #mbs-fwselect-storage-tooltip {\n  visibility: visible;\n}\n\n#mbs-fwselect-storage-cover {\n  width: 100%;\n}\n\n#mbs-fwselect-storage-footer {\n  grid-area: storageFooter;\n  height: min(7vh, 3.5vw);\n  padding-top: min(1vh, 0.5vw);\n}\n\n#mbs-fwselect-button-grid-outer {\n  display: grid;\n  grid-area: buttonOuterGrid;\n  grid-template-rows: min(9vh, 4.5vw) auto min(9vh, 4.5vw) auto;\n  height: 94%;\n  overflow-y: scroll;\n  padding-left: min(2vh, 1vw);\n  padding-right: min(2vh, 1vw);\n}\n\n#mbs-fwselect-button-grid-inner0, #mbs-fwselect-button-grid-inner1 {\n  display: grid;\n  grid-template-columns: minmax(0, 4fr) minmax(0, 4fr);\n  grid-gap: min(2vh, 1vw);\n  padding-bottom: min(2vh, 1vw);\n  padding-top: min(2vh, 1vw);\n}\n\n#mbs-fwselect-header0, #mbs-fwselect-header1 {\n  background-color: var(--mbs-background-color);\n  display: flex;\n  height: 100%;\n  justify-content: center;\n  position: sticky;\n  top: 0%;\n}'.toString()}),p("div",{id:Mh.buttonOuterGrid,children:[f("h1",{id:Mh.itemSets,"z-index":1,children:i?"Fortune wheel item sets":`${this.character.Nickname??this.character.Name}'s fortune wheel item sets`}),f("div",{id:Mh.buttonInnerGrid0,children:yd(0,og).map((e=>Eh(this,e)))}),f("h1",{id:Mh.commandSets,"z-index":1,children:i?"Fortune wheel commands":`${this.character.Nickname??this.character.Name}'s fortune wheel commands`}),f("div",{id:Mh.buttonInnerGrid1,children:yd(og,2*og).map((e=>Eh(this,e)))})]}),p("div",{id:Mh.exit,class:"mbs-button-div",children:[f("button",{class:"mbs-button",id:Mh.exitButton,onClick:this.exit.bind(this),style:{backgroundImage:"url('./Icons/Exit.png')"}}),f("span",{class:"mbs-button-tooltip",id:Mh.exitTooltip,style:{justifySelf:"right"},children:"Exit"})]}),p("div",{id:Mh.storage,children:[f("div",{id:Mh.storageInner}),p("div",{id:Mh.storageTooltip,class:"mbs-button-tooltip",children:[f("h2",{id:Mh.storageTooltip+"-header",children:"OnlineSharedSettings Data Usage"}),f("ul",{id:Mh.storageTooltip+"-list"})]})]}),f("div",{id:Mh.storageFooter})]}))}load(){const e=Pm(this.character.OnlineSharedSettings);this.dataSize.value=Kd(Object.values(e),(e=>Number.isNaN(e)?0:e)),this.dataSize.valueRecord=e,w(this,Ih,"m",Oh).call(this),super.load()}exit(){super.exit(),this.exitScreens(!1)}}Ih=new WeakSet,Oh=function(){const e=this.character.IsPlayer();for(const[t,n]of this.wheelList.entries()){const r=document.getElementById(`${Mh.button}${t}`);r.innerText=`${(t%og).toString().padStart(2)}: ${n?.name??"<Empty>"}`,r.disabled=null===n&&!e}const t=document.getElementById(Mh.storage),n=document.getElementById(Mh.storageInner),r=document.getElementById(Mh.storageFooter);if(e){const e=ro(Mm(this.dataSize.value),0,9999),i=100*e/(Em/1e3);r.innerText=`${e} / ${Em/1e3} KB`,n.style.height=100-i+"%",n.style.backgroundColor="var(--mbs-background-color)",n.style.borderBottom="min(0.3vh, 0.15vw) solid var(--mbs-border-color)",i>=90&&(t.style.boxShadow="0 0 min(2vh, 1vw) red");const o=/\W/g;let a=Object.entries(this.dataSize.valueRecord).map((([e,t])=>[e.replaceAll(o,""),Number.isNaN(t)?"Unknown":`${Mm(t)} KB`]));a.length>=11&&(a=a.slice(0,10),a.push(["...",""]));const s=document.getElementById(Mh.storageTooltip+"-list");s.innerHTML="";for(const[e,t]of a)s.appendChild(p("li",{children:[f("span",{style:{float:"left"},children:e}),f("span",{style:{float:"right",paddingLeft:"min(7vh, 3.5vw)"},children:t})]}))}else{const e=document.getElementById(Mh.storageTooltip);r.innerText=`- / ${Em/1e3} KB`,n.style.height="100%",n.style.backgroundColor="gray",e.style.display="none"}},Bh.ids=Mh,Bh.screen="MBS_FWSelectScreen",Bh.background="Sheet",Bh.screenParamsDefault={[Ph]:Object.freeze({shape:[80,60,1840,880],visibility:"visible"})};const jh=Object.freeze(["Exclusive","5 Minutes","15 Minutes","1 Hour","4 Hours","High Security"]),Ah=Object.freeze([Object.freeze({type:"ExclusivePadlock",description:"Exclusive",enabled:!0}),Object.freeze({type:"TimerPasswordPadlock",description:"Timer",time:300,enabled:!0}),Object.freeze({type:"TimerPasswordPadlock",description:"Timer",time:900,enabled:!0}),Object.freeze({type:"TimerPasswordPadlock",description:"Timer",time:3600,enabled:!0}),Object.freeze({type:"TimerPasswordPadlock",description:"Timer",time:14400,enabled:!1}),Object.freeze({type:"HighSecurityPadlock",description:"High security",enabled:!1}),Object.freeze({type:null,description:"No lock",enabled:!1})]);function Nh(e,t,n){Ip(t,"seconds",60,14400),Fh(e,"TimerPasswordPadlock",n)&&(null==e.Property&&(e.Property={}),e.Property.RemoveTimer=CurrentTime+1e3*t,e.Property.RemoveItem=!0,e.Property.LockSet=!0,e.Property.Password=Ep(8))}function Th(e,t){Fh(e,"HighSecurityPadlock",t),null==e.Property&&(e.Property={}),e.Property.MemberNumberListKeys=""}function Fh(e,t,n){if(null===e||"object"!=typeof e)throw new TypeError('Invalid "item" type: '+typeof e);if("string"!=typeof t)throw new TypeError('Invalid "lockName" type: '+typeof t);lg(n);const r=AssetGet(n.AssetFamily,"ItemMisc",t);if(null==r)throw new Error(`Invalid "lockName" value: ${t}`);return!(null!=InventoryGetLock(e)||!InventoryDoesItemAllowLock(e)||InventoryBlockedOrLimited(n,{Asset:r}))&&(InventoryLock(n,e,{Asset:r},null,!1),!0)}function Dh(e,t){return e.forEach(((e,n)=>{e.enabled=t.includes(n)})),e}function Lh(e){switch(e.type){case"ExclusivePadlock":return"Exclusive";case"HighSecurityPadlock":return"High Security";case"TimerPasswordPadlock":return`${Math.floor(e.time/60)} Minutes`;case null:return"No Lock";default:throw new Error(`Invalid flag type: ${e.type}`)}}var Rh,Wh,Gh,zh,Hh,qh,Uh,Vh;let Kh;const Jh=Object.freeze({builtinBC:0,builtinMBS:1,customMBS:2});let Yh,Zh,Qh,Xh;Pp(dg).then((()=>{Kh=new TextCache("Screens/MiniGame/WheelFortune/Text_WheelFortune.csv","MISSING VALUE FOR TAG: ")}));const em="mbs-fwpreset",tm=Object.freeze({root:em,styles:`${em}-style`,delete:`${em}-delete`,deleteButton:`${em}-delete-button`,deleteTooltip:`${em}-delete-tooltip`,accept:`${em}-accept`,acceptButton:`${em}-accept-button`,acceptTooltip:`${em}-accept-tooltip`,save:`${em}-save`,saveButton:`${em}-save-button`,saveTooltip:`${em}-save-tooltip`,exit:`${em}-exit`,exitButton:`${em}-exit-button`,exitTooltip:`${em}-exit-tooltip`,header:`${em}-header`,midDiv:`${em}-mid-div`,nameDiv:`${em}-name-div`,nameHeader:`${em}-name-header`,nameInput:`${em}-name-input`,nameDropdown:`${em}-name-dropdown`,nameDropdownDiv:`${em}-name-dropdown-div`,nameDropdownContent:`${em}-name-dropdown-content`,builtinBC:`${em}-builtin-bc`,builtinBCColor:`${em}-builtin-bc-color`,builtinBCTooltip:`${em}-builtin-bc-tooltip`,builtinBCTooltipHeader:`${em}-builtin-bc-tooltip-header`,builtinBCTooltipList:`${em}-builtin-bc-tooltip-list`,builtinBCDiv:`${em}-builtin-bc-div`,builtinBCHeader:`${em}-builtin-bc-header`,builtinMBS:`${em}-builtin-mbs`,builtinMBSColor:`${em}-builtin-mbs-color`,builtinMBSTooltip:`${em}-builtin-mbs-button-tooltip`,builtinMBSTooltipHeader:`${em}-builtin-mbs-button-tooltip-header`,builtinMBSTooltipList:`${em}-builtin-mbs-button-tooltip-list`,builtinMBSDiv:`${em}-builtin-mbs-div`,builtinMBSHeader:`${em}-builtin-mbs-header`,customMBS:`${em}-custom-mbs`,customMBSColor:`${em}-custom-mbs-color`,customMBSTooltip:`${em}-custom-mbs-button-tooltip`,customMBSTooltipHeader:`${em}-custom-mbs-button-tooltip-header`,customMBSTooltipList:`${em}-custom-mbs-button-tooltip-list`,customMBSDiv:`${em}-custom-mbs-div`,customMBSHeader:`${em}-custom-mbs-header`});class nm extends lh{get index(){return w(this,Wh,"f")}set index(e){Ip(e,"index",0,this.presets.length-1),w(this,Wh,"f")!==e&&(S(this,Wh,e,"f"),w(this,Rh,"m",Vh).call(this))}constructor(e,t,n=null){!function(){if(void 0!==Yh)return;const e=/^([a-zA-Z0-9_\s]+) for ([0-9]+) (minutes|hours)$/,t=WheelFortuneOption.filter((e=>void 0===e.Custom)),n=new Set,r={};for(const i of t){const t=Kh.get(`Option${i.ID}`),o=e.exec(t);if(!o){r[i.ID]={header:t,type:Jh.builtinBC},n.add(t);continue}const[a,s]=[o[1],o[3]];let l=Number.parseInt(o[2]);"hours"===s&&(l*=60),n.add(a),r[i.ID]={header:a,description:`${l} Minutes`,type:Jh.builtinBC}}Yh=Array.from(n),Zh=Object.fromEntries(Object.entries(r).map((([e,t])=>[e,{...t,index:Yh.indexOf(t.header)}])));const i=256;Qh=Object.fromEntries(am.flatMap(((e,t)=>e.flags.map(((n,r)=>[String.fromCharCode(i+16*t+r),{header:e.name,description:Lh(n),index:t,type:Jh.builtinMBS}]))))),Xh=Object.fromEntries(yd(512,1536).map(((e,t)=>{const n=String.fromCharCode(e),r=Math.floor(t/i);let o;switch(r){case 0:case 2:o=(0===r?0:16)+Math.floor(t%i/16);break;case 1:case 3:o=(1===r?0:16)+Math.floor(t%i/16)+32;break;default:throw new RangeError(`Index ${t} lies out of the [0, 2**10) range`)}return[n,{header:"<Empty>",type:Jh.customMBS,index:o}]})))}(),super(e,nm.screenParamsDefault,n),Rh.add(this),this.activePreset={name:"<PLACEHOLDER>",ids:new Set},Wh.set(this,0),this.presets=t,this.queueServer=new Set,this.idMapping={...Oa(Zh),...Oa(Qh),...Oa(Xh)},document.body.appendChild(p("div",{id:tm.root,class:"mbs-screen",children:[f("style",{id:tm.styles,children:'#mbs-fwpreset {\n  grid-template: "delete header accept save exit" min(9vh, 4.5vw) "mid mid mid mid mid" auto/min(9vh, 4.5vw) auto min(9vh, 4.5vw) min(9vh, 4.5vw) min(9vh, 4.5vw);\n}\n\n#mbs-fwpreset-delete {\n  grid-area: delete;\n}\n\n#mbs-fwpreset-header {\n  grid-area: header;\n  margin-left: min(20vh, 10vw);\n}\n\n#mbs-fwpreset-accept {\n  grid-area: accept;\n}\n\n#mbs-fwpreset-save {\n  grid-area: save;\n}\n\n#mbs-fwpreset-exit {\n  grid-area: exit;\n}\n\n#mbs-fwpreset-mid-div {\n  display: grid;\n  grid-area: mid;\n  text-align: center;\n  grid-gap: min(2vh, 1vw);\n  grid-template: "name-header builtin-bc-header builtin-mbs-header custom-mbs-header" min(9vh, 4.5vw) "name builtin-bc builtin-mbs custom-mbs" auto/auto min-content min-content min-content;\n  justify-items: center;\n  justify-self: center;\n  width: 100%;\n}\n#mbs-fwpreset-mid-div > p {\n  text-wrap: nowrap;\n}\n\n#mbs-fwpreset-name-header {\n  grid-area: name-header;\n}\n\n#mbs-fwpreset-builtin-bc-header {\n  grid-area: builtin-bc-header;\n}\n\n#mbs-fwpreset-builtin-mbs-header {\n  grid-area: builtin-mbs-header;\n}\n\n#mbs-fwpreset-custom-mbs-header {\n  grid-area: custom-mbs-header;\n}\n\n.mbs-fwpreset-grid {\n  display: grid;\n  grid-gap: min(1.2vh, 0.6vw);\n  grid-auto-flow: column;\n  grid-template-rows: repeat(8, min(7vh, 3.5vw));\n  width: fit-content;\n}\n\n#mbs-fwpreset-name-div {\n  grid-area: name;\n}\n\n#mbs-fwpreset-name-input {\n  height: min(7vh, 3.5vw);\n  width: min(35vh, 17.5vw);\n}\n\n#mbs-fwpreset-name-dropdown-div {\n  height: min(7vh, 3.5vw);\n  position: relative;\n  text-wrap: auto;\n  top: 5%;\n  width: min(36vh, 18vw);\n}\n\n#mbs-fwpreset-builtin-bc-div {\n  grid-area: builtin-bc;\n  grid-template-columns: repeat(4, min(7vh, 3.5vw));\n}\n\n#mbs-fwpreset-builtin-mbs-div {\n  grid-area: builtin-mbs;\n  grid-template-columns: min(7vh, 3.5vw);\n}\n\n#mbs-fwpreset-custom-mbs-div {\n  grid-area: custom-mbs;\n  grid-template-columns: repeat(8, min(7vh, 3.5vw));\n}\n\n.mbs-fwpreset-color {\n  border: unset !important;\n  height: 84%;\n  left: 4%;\n  position: relative;\n  top: 4%;\n  width: 84%;\n}\n.mbs-fwpreset-color[data-color=red] {\n  background-color: red;\n}\n.mbs-fwpreset-color[data-color=green] {\n  background-color: green;\n}\n.mbs-fwpreset-color:focus {\n  filter: brightness(60%);\n}\n.mbs-fwpreset-color + .mbs-button-tooltip {\n  z-index: 2;\n}\n.mbs-fwpreset-color:focus + .mbs-button-tooltip {\n  visibility: visible;\n  z-index: 1;\n}\n\n.mbs-fwpreset {\n  border: min(0.3vh, 0.15vw) solid var(--mbs-border-color);\n  display: grid;\n  grid-template-columns: min(7vh, 3.5vw);\n  grid-template-rows: min(7vh, 3.5vw) auto;\n}\n.mbs-fwpreset:hover .mbs-fwpreset-color {\n  filter: brightness(60%);\n}\n.mbs-fwpreset:hover .mbs-button-tooltip {\n  visibility: visible;\n}'.toString()}),p("h1",{id:tm.header,children:["Wheel of Fortune preset ",this.index]}),p("div",{id:tm.delete,class:"mbs-button-div",children:[f("button",{class:"mbs-button",id:tm.deleteButton,style:{backgroundImage:"url('./Icons/Trash.png')"},onClick:this.deletePreset.bind(this),disabled:!0}),f("div",{class:"mbs-button-tooltip",id:tm.deleteTooltip,style:{justifySelf:"left"},children:"Delete the current preset"})]}),p("div",{id:tm.accept,class:"mbs-button-div",children:[f("button",{class:"mbs-button",id:tm.acceptButton,style:{backgroundImage:"url('./Icons/Accept.png')"},onClick:this.equipPreset.bind(this),disabled:!0}),f("div",{class:"mbs-button-tooltip",id:tm.acceptTooltip,style:{justifySelf:"right"},children:"Equip the current preset"})]}),p("div",{id:tm.save,class:"mbs-button-div",children:[f("button",{class:"mbs-button",id:tm.saveButton,style:{backgroundImage:"url('./Icons/Save.png')"},onClick:this.savePreset.bind(this)}),f("div",{class:"mbs-button-tooltip",id:tm.saveTooltip,style:{justifySelf:"right"},children:"Save the current preset"})]}),p("div",{id:tm.exit,class:"mbs-button-div",children:[f("button",{class:"mbs-button",id:tm.exitButton,style:{backgroundImage:"url('./Icons/Exit.png')"},onClick:()=>this.exit(!1)}),f("div",{class:"mbs-button-tooltip",id:tm.exitTooltip,style:{justifySelf:"right"},children:"Exit"})]}),p("div",{id:tm.midDiv,children:[f("p",{id:tm.nameHeader,children:"Preset Name"}),f("p",{id:tm.builtinBCHeader,children:"Builtin BC Options"}),f("p",{id:tm.builtinMBSHeader,children:"Builtin MBS Options"}),f("p",{id:tm.customMBSHeader,children:"Custom MBS Options"}),p("div",{id:tm.nameDiv,children:[f("input",{type:"text",id:tm.nameInput,maxLength:20,onFocus:e=>e.target.select(),onInput:e=>this.activePreset.name=e.target.value}),p("div",{id:tm.nameDropdownDiv,class:"mbs-dropdown",onWheel:e=>this.index=ro(this.index+Math.sign(e.deltaY),0,this.presets.length-1),children:[f("button",{class:"mbs-button",id:tm.nameDropdown}),p("div",{class:"mbs-dropdown-content",id:tm.nameDropdownContent,children:[" ",Object.values(this.presets).map(((e,t)=>f("button",{class:"mbs-button mbs-dropdown-button",id:tm.nameDropdown+t.toString(),onClick:()=>this.index=t,children:`${t}: ${e?.name??"<Empty>"}`})))," "]})]})]}),f("div",{id:tm.builtinBCDiv,class:"mbs-fwpreset-grid",children:w(this,Rh,"m",Hh).call(this,Jh.builtinBC)}),f("div",{id:tm.builtinMBSDiv,class:"mbs-fwpreset-grid",children:w(this,Rh,"m",Hh).call(this,Jh.builtinMBS)}),f("div",{id:tm.customMBSDiv,class:"mbs-fwpreset-grid",children:w(this,Rh,"m",Hh).call(this,Jh.customMBS)})]})]}))}savePreset(){const e=this.presets[this.index],t={name:this.activePreset.name,ids:cg(Array.from(this.activePreset.ids).sort().join(""))};t.name===e?.name&&t.ids===e?.ids||(this.presets[this.index]=t,this.queueServer.add(Bm.SETTINGS),w(this,Rh,"m",Uh).call(this))}equipPreset(){const e=cg(Array.from(this.activePreset.ids).sort().join(""));Player.OnlineSharedSettings&&Player.OnlineSharedSettings.WheelFortune!==e&&(Player.OnlineSharedSettings.WheelFortune=e,this.queueServer.add(Bm.SHARED))}deletePreset(){null!==this.presets[this.index]&&(this.queueServer.add(Bm.SETTINGS),this.presets[this.index]=null,w(this,Rh,"m",Vh).call(this))}load(){super.load(),w(this,Rh,"m",Gh).call(this),w(this,Rh,"m",Vh).call(this)}exit(e=!0){super.exit(),this.queueServer.size&&Dm(Array.from(this.queueServer),!0),this.exitScreens(e)}}function rm(e,t,n){if(null===e||"object"!=typeof e)throw new TypeError('Invalid "item" type: '+typeof e);if(!Dp(n))throw new TypeError('Invalid "indices" type: '+typeof n);if(null===t||"object"!=typeof t)throw new TypeError('Invalid "character" type: '+typeof t);if(!t.IsSimple()&&!t.IsPlayer())throw new Error("Expected a simple or player character");const r=t.Appearance.find((e=>"HairFront"===e.Asset.Group.Name));if(void 0===r)return;const i=Math.max(0,...n);let o;"string"==typeof e.Color?e.Color=o=Op([e.Color],i,"Default"):Array.isArray(e.Color)&&0!==e.Color.length?o=e.Color:e.Color=o=Array(i).fill("Default"),"string"==typeof r.Color?n.forEach((e=>o[e]=r.Color)):Array.isArray(r.Color)&&r.Color.length>=1&&n.forEach((e=>o[e]=r.Color[0]))}function im(e,t){if(null===t||"object"!=typeof t)throw new TypeError('Invalid "character" type: '+typeof t);if(!t.IsSimple()&&!t.IsPlayer())throw new Error("Expected a simple or player character");if(ug(t)){!function(e,t,n){if(!Dp(e))throw new TypeError('Invalid "groupNames" type: '+typeof e);if("string"!=typeof n)throw new TypeError('Invalid "color" type: '+typeof e);for(const r of e){const e=InventoryGet(t,r);null!=e&&(e.Color=Array(e.Asset.ColorableLayerCount).fill(n))}}(["HairAccessory1","HairAccessory2","HairAccessory3","HairBack","HairFront","BodyUpper","BodyLower","Wings","TailStraps","Nipples","Blush","Mouth"],t,"#484747")}return e}let om,am,sm,lm,um;Wh=new WeakMap,Rh=new WeakSet,Gh=function(){const e=[...Player.MBSSettings.FortuneWheelItemSets,...Player.MBSSettings.FortuneWheelCommands];for(const[t,n]of e.entries()){let e=512;if(e+=t<32?t>=16?16*(16+t):16*t:t>=48?16*t:16*(16+t),n instanceof wg)for(const[t,r]of n.flags.entries()){const i=String.fromCharCode(e+t);this.idMapping[i].description=Lh(r),this.idMapping[i].header=n.name}else if(n instanceof Sg){const t=String.fromCharCode(e);this.idMapping[t].header=n.name,delete this.idMapping[t].description}else for(const t of yd(16)){const n=String.fromCharCode(e+t);this.idMapping[n].header="<Empty>",delete this.idMapping[n].description}}},zh=function(e,t,n,r){const i=e.toString();return p("div",{id:r.root+i,class:"mbs-fwpreset",children:[f("button",{id:r.color+i,class:"mbs-fwpreset-color","data-color":"red",onClick:e=>e.target.focus()}),p("div",{id:r.tooltip+i,class:"mbs-button-tooltip",style:{justifySelf:n},children:[f("h2",{id:r.tooltipHeader+i,"data-prefix":t??""}),f("ul",{id:r.tooltipList+i})]})]})},Hh=function(e){let t,n,r;const i=w(this,Rh,"m",qh).call(this,e);switch(e){case Jh.builtinBC:t=Yh,n="left";break;case Jh.builtinMBS:t=am,n="center";break;case Jh.customMBS:t=[...Player.MBSSettings.FortuneWheelItemSets,...Player.MBSSettings.FortuneWheelCommands],n="right",r=(e,t)=>t>=og?`Command Set ${t-32}: `:`Item Set ${t}: `;break;default:throw new Error(`Unknown type: ${e}`)}return t.map(((e,t)=>w(this,Rh,"m",zh).call(this,t,r?.(e,t),n,i)))},qh=function(e){switch(e){case Jh.builtinBC:return{root:tm.builtinBC,color:tm.builtinBCColor,tooltip:tm.builtinBCTooltip,tooltipHeader:tm.builtinBCTooltipHeader,tooltipList:tm.builtinBCTooltipList};case Jh.builtinMBS:return{root:tm.builtinMBS,color:tm.builtinMBSColor,tooltip:tm.builtinMBSTooltip,tooltipHeader:tm.builtinMBSTooltipHeader,tooltipList:tm.builtinMBSTooltipList};case Jh.customMBS:return{root:tm.customMBS,color:tm.customMBSColor,tooltip:tm.customMBSTooltip,tooltipHeader:tm.customMBSTooltipHeader,tooltipList:tm.customMBSTooltipList};default:throw new Error(`Unknown type: ${e}`)}},Uh=function(){const e=this.presets[w(this,Wh,"f")],t=document.getElementById(tm.nameInput),n=document.getElementById(tm.nameDropdown),r=document.getElementById(`${tm.nameDropdown}${this.index}`);t.placeholder=`Preset ${this.index}`,r.innerText=n.innerText=`${w(this,Wh,"f")}: ${this.activePreset.name}`;const i=document.getElementById(tm.deleteButton),o=document.getElementById(tm.deleteTooltip),a=document.getElementById(tm.acceptButton),s=document.getElementById(tm.acceptTooltip),l=document.getElementById(tm.header);null===e?(t.value="",i.disabled=!0,a.disabled=!0,o.innerText="Delete the current preset:\nunsaved preset",s.innerText="Equip the current preset:\nunsaved preset",l.innerText=`Wheel of Fortune preset ${this.index} (unsaved)`):(t.value=e.name,i.disabled=!1,a.disabled=!1,o.innerText="Delete the current preset",s.innerText="Equip the current preset",l.innerText=`Wheel of Fortune preset ${this.index}`)},Vh=function(){const e=this.presets[w(this,Wh,"f")];this.activePreset=null!==e?{name:e.name,ids:new Set(e.ids)}:{name:"<Empty>",ids:new Set(Player.OnlineSharedSettings?.WheelFortune??WheelFortuneDefault)},w(this,Rh,"m",Uh).call(this);const t={[Jh.builtinBC]:{},[Jh.builtinMBS]:{},[Jh.customMBS]:{}};for(const[e,{type:n,index:r,description:i,header:o}]of Object.entries(this.idMapping)){const a=this.activePreset.ids.has(e),s=t[n][r]??={header:o,enabled:a,description:[]};s.enabled||=a,i&&a&&s.description.push(i)}for(const e of Object.values(Jh)){const n=w(this,Rh,"m",qh).call(this,e);for(const[r,i]of Object.entries(t[e])){document.getElementById(`${n.color}${r}`).dataset.color=i.enabled?"green":"red";const e=document.getElementById(`${n.tooltipHeader}${r}`);e.innerText=(e.dataset.prefix??"")+i.header;const t=document.getElementById(`${n.tooltipList}${r}`);t.innerHTML="";for(const e of i.description)t.appendChild(f("li",{children:e}))}}},nm.background="Sheet",nm.screen=`MBS_${nm.name}`,nm.ids=tm,nm.screenParamsDefault={[em]:Object.freeze({shape:[80,60,1840,880],visibility:"visible"})};class cm extends uh{constructor(){super(null,"WheelFortune","MiniGame",{Run:WheelFortuneRun,Click:WheelFortuneClick,Exit:WheelFortuneExit,Load:()=>{CommonSetScreen("MiniGame","WheelFortune"),WheelFortuneLoad()}}),this.character=Player,this.FortuneWheelItemSets=Array(og).fill(null),this.FortuneWheelCommands=Array(og).fill(null),this.weightedIDs=this.character.OnlineSharedSettings?.WheelFortune??WheelFortuneDefault}initialize(){if(null==WheelFortuneCharacter)throw new Error("Cannot load the fortune wheel UI while `WheelFortuneCharacter == null`");WheelFortuneOption=[...sm],WheelFortuneDefault=lm,this.character=WheelFortuneCharacter,this.FortuneWheelItemSets=kh(WheelFortuneCharacter,"FortuneWheelItemSets","item sets"),this.FortuneWheelCommands=kh(WheelFortuneCharacter,"FortuneWheelCommands","commands"),this.weightedIDs=function(e){const t=Array.from(e).flatMap((e=>{const t=WheelFortuneOption.find((t=>t.ID===e));return void 0===t?[]:Array(t.Weight??1).fill(e)}));if(0===t.length)return Array.from(e.length>0?e:WheelFortuneDefault).sort(Math.random).join();const n=[];for(;n.length<50;)n.push(...Fd(t,Math.random));return n.join("")}(this.character.OnlineSharedSettings?.WheelFortune??WheelFortuneDefault)}}function dm(){if(um.initialize(),null!=TextScreenCache)for(const{Description:e,Custom:t,ID:n}of WheelFortuneOption)void 0!==e&&(TextScreenCache.cache[`Option${n}`]=t?`*${e}`:e)}function fm(){if(null!=TextScreenCache)for(const{Description:e,Custom:t,ID:n}of WheelFortuneOption)void 0!==e&&(TextScreenCache.cache[`Option${n}`]=t?`*${e}`:e)}cm.screen="WheelFortune",Pp(dg).then((()=>{const e={exit:[1830,60,90,90],roll:[1720,60,90,90],select:[1610,60,90,90],preset:[1500,60,90,90]};if($p.log("Initializing wheel of fortune hooks"),function(){const e=String.fromCharCode(256),t=WheelFortuneOption.find((t=>void 0===t.Custom&&t.ID>=e));return void 0===t||($p.warn("Aborting wheel of fortune hook initialization: Found one or more builtin wheel of fortune option-IDs outside of the extended ASCII range",t),!1)}())switch(Mp.patchFunction("WheelFortuneRun",{'DrawTextWrap(TextGet((WheelFortuneVelocity == 0) ? (WheelFortuneForced ? "Forced" : "Title") : "Wait"), 1375, 200, 550, 200, "White");':";",'DrawButton(1720, 60, 90, 90, "", BackColor, "Icons/Random.png", TextGet("Random"));':";"}),Mp.hookFunction("WheelFortuneLoad",11,((e,t)=>(dm(),t(e)))),Mp.hookFunction("WheelFortuneCustomizeLoad",0,((e,t)=>(fm(),t(e)))),Mp.hookFunction("WheelFortuneRun",0,((t,n)=>{const r=Player.MBSSettings.RollWhenRestrained||!Player.IsRestrained();r||(WheelFortuneForced=!1),n(t);const i=0===WheelFortuneVelocity,o=i?"White":"Silver",a=WheelFortuneCharacter?.Nickname??WheelFortuneCharacter?.Name,s=WheelFortuneCharacter?.IsPlayer()?"MBS: Configure custom options":`MBS: View ${a}'s option config`;DrawButton(...e.select,"",o,"Icons/Crafting.png",s,!i);const l=!(0!==WheelFortuneVelocity||!WheelFortuneCharacter?.IsPlayer()),u=l?"White":"Silver",c=WheelFortuneCharacter?.Nickname??WheelFortuneCharacter?.Name,d=WheelFortuneCharacter?.IsPlayer()?"MBS: Configure option presets":`MBS: View ${c}'s option presets`;DrawButton(...e.preset,"",u,"Icons/Crafting.png",d,!l);const f=0==WheelFortuneVelocity&&r?"White":"Silver";DrawButton(...e.roll,"",f,"Icons/Random.png",r?TextGet("Random"):"MBS: Cannot spin while restrained",!r);let p="";p=0!==WheelFortuneVelocity?TextGet("Wait"):r?WheelFortuneForced?TextGet("Forced"):TextGet("Title"):"MBS: Cannot spin the wheel of fortune while restrained",DrawTextWrap(p,1375,200,550,200,"White")})),Mp.hookFunction("WheelFortuneClick",0,((t,n)=>{if(Player.MBSSettings.RollWhenRestrained||!Player.IsRestrained()||(WheelFortuneForced=!1,!MouseIn(...e.roll))){if(0===WheelFortuneVelocity&&MouseIn(...e.select)){const e={FortuneWheelItemSets:um.FortuneWheelItemSets,FortuneWheelCommands:um.FortuneWheelCommands};um.loadChild(Bh,e,um.character)}else 0===WheelFortuneVelocity&&MouseIn(...e.preset)&&WheelFortuneCharacter?.IsPlayer()&&um.loadChild(nm,WheelFortuneCharacter.MBSSettings.FortuneWheelPresets);return n(t)}})),Mp.hookFunction("WheelFortuneMouseUp",11,((e,t)=>{!Player.MBSSettings.RollWhenRestrained&&Player.IsRestrained()||t(e)})),Mp.hookFunction("WheelFortuneMouseDown",11,((e,t)=>{!Player.MBSSettings.RollWhenRestrained&&Player.IsRestrained()||t(e)})),Mp.hookFunction("WheelFortuneDrawWheel",11,(([e,...t],n)=>n([um.weightedIDs,...t]))),um=new cm,Pp(pg).then((()=>{$p.log("Initializing wheel of fortune module"),om=function(){const e=Wp(Rp({leash_candy:[{Name:"ReverseBunnySuit",Group:"Suit",ItemCallback:(e,t)=>rm(e,t,[0,1])},{Name:"Catsuit",Group:"SuitLower",ItemCallback:(e,t)=>rm(e,t,[0,1])},{Name:"FaceVeil",Group:"Mask",Color:["#000","Default"],ItemCallback:(e,t)=>rm(e,t,[1])},{Name:"FuturisticMittens",Group:"ItemHands",TypeRecord:{typed:0},Craft:{Property:"Secure",Name:"Permanent PSO Mittens"},ItemCallback:(e,t)=>rm(e,t,[0,1])},{Name:"InteractiveVRHeadset",Group:"ItemHead",TypeRecord:{b:3,f:3,g:1},Craft:{Property:"Secure",Name:"Permanent PSO Headset"},ItemCallback:(e,t)=>rm(e,t,[0])},{Name:"LargeDildo",Group:"ItemMouth",Craft:{Property:"Secure",Name:"Permanent PSO Dildo",Description:"Specially made to fill a PSOs mouth and throat"}},{Name:"LatexBallMuzzleGag",Group:"ItemMouth2",Craft:{Property:"Secure",Name:"Permanent PSO Muzzle",Description:"Forcing the dildo in and keeping it secure"}},{Name:"FuturisticMuzzle",Group:"ItemMouth3",TypeRecord:{n:1,h:0,s:3},Craft:{Property:"Secure",Name:"Permanent PSO Muzzle",Description:"Keeping your cries muffled"},ItemCallback:(e,t)=>rm(e,t,[3])},{Name:"FuturisticVibrator",Group:"ItemVulva",TypeRecord:{vibrating:9},Craft:{Property:"Secure",Name:"Permanent PSO Vibe",Description:"Specially made to fill a PSO"}},{Name:"SciFiPleasurePanties",Group:"ItemPelvis",TypeRecord:{c:3,i:4,o:1,s:2},Craft:{Property:"Secure",Name:"Permanent PSO Panties",Description:"No escape and no Orgasms"},ItemCallback:(e,t)=>rm(e,t,[0,2,4,5])},{Name:"BonedNeckCorset",Group:"ItemNeck",Color:["#222222","#888888","#AA2121","#AA2121","#888888"],TypeRecord:{typed:1},Craft:{Property:"Secure",Name:"Permanent PSO Collar"},ItemCallback:(e,t)=>rm(e,t,[2,3])},{Name:"CollarChainShort",Group:"ItemNeckRestraints",Craft:{Property:"Secure",Name:"Permanent PSO Chain",Description:"To keep a PSO on their knees"},Property:{OverridePriority:7},ItemCallback:(e,t)=>rm(e,t,[0])},{Name:"StrictLeatherPetCrawler",Group:"ItemArms",Craft:{Property:"Secure",Name:"Permanent PSO Suit",Description:"Extra tight and unremovable"}},{Name:"HeavyLatexCorset",Group:"ItemTorso",TypeRecord:{typed:0},Craft:{Property:"Secure",Name:"Permanent PSO Corset",Description:"Extra tight and specially molded"}},{Name:"FuturisticHarness",Group:"ItemTorso2",TypeRecord:{typed:0},Craft:{Property:"Secure",Name:"Permanent PSO Harness",Description:"Special harness that constantly shrinks...."},Property:{OverridePriority:23},ItemCallback:(e,t)=>rm(e,t,[0,1,2])},{Name:"FuturisticEarphones",Group:"ItemEars",TypeRecord:{typed:0},Craft:{Property:"Secure",Name:"Permanent PSO Earphones"},Color:["#0F0F0F","Default","Default"],ItemCallback:(e,t)=>rm(e,t,[1])},{Name:"CeilingChain",Group:"ItemAddon",TypeRecord:{typed:0},Craft:{Property:"Secure",Name:"Permanent PSO Chain",Description:"Never to escape"},ItemCallback:(e,t)=>rm(e,t,[0])},{Name:"RoundPiercing",Group:"ItemNipplesPiercings",TypeRecord:{typed:1},Craft:{Property:"Secure",Name:"Permanent PSO Piercings"},Color:["#000000","Default","Default"],ItemCallback:(e,t)=>rm(e,t,[1,2])},{Name:"CollarAutoShockUnit",Group:"ItemNeckAccessories",TypeRecord:{s:2,y:0},Craft:{Property:"Secure",Name:"Permanent PSO Shock Unit"}},{Name:"FrogtieStraps",Group:"ItemLegs",Craft:{Property:"Secure",Name:"Permanent PSO Straps",Description:"To keep a PSO on their knees"},ItemCallback:(e,t)=>rm(e,t,[2])},{Name:"DroneMask",Group:"ItemHood",TypeRecord:{m:0,e:0,p:1,g:0,s:1,h:2,j:0},Craft:{Property:"Thin",Name:"Permanent PSO Mask"},ItemCallback:(e,t)=>rm(e,t,[2])}],mummy:[{Name:"DuctTape",Group:"ItemFeet",TypeRecord:{typed:0},Craft:{Property:"Secure",Name:"Mummy Wrappings",Description:"A bundle of resilient cloth wrappings"},ItemCallback:(e,t)=>{rm(e,t,[0]);const n=TypedItemDataLookup[`${e.Asset.Group.Name}${e.Asset.Name}`],r=(n?.options??[]).map((e=>e.Property.TypeRecord));0!==r.length&&qp(e,t,Ed(r)??{})}},{Name:"DuctTape",Group:"ItemLegs",TypeRecord:{typed:0},Craft:{Property:"Secure",Name:"Mummy Wrappings",Description:"A bundle of resilient cloth wrappings"},ItemCallback:(e,t)=>{rm(e,t,[0]);const n=TypedItemDataLookup[`${e.Asset.Group.Name}${e.Asset.Name}`],r=(n?.options??[]).map((e=>e.Property.TypeRecord));0!==r.length&&qp(e,t,Ed(r)??{})}},{Name:"DuctTape",Group:"ItemHands",TypeRecord:{typed:0},Craft:{Property:"Secure",Name:"Mummy Wrappings",Description:"A bundle of resilient cloth wrappings"},ItemCallback:(e,t)=>rm(e,t,[0])},{Name:"DuctTape",Group:"ItemArms",TypeRecord:{typed:0},Craft:{Property:"Secure",Name:"Mummy Wrappings",Description:"A bundle of resilient cloth wrappings"},ItemCallback:(e,t)=>{rm(e,t,[0]);const n=TypedItemDataLookup[`${e.Asset.Group.Name}${e.Asset.Name}`],r=(n?.options??[]).map((e=>e.Property.TypeRecord));0!==r.length&&qp(e,t,Ed(r)??{})}},{Name:"LargeDildo",Group:"ItemMouth",Craft:{Property:"Large",Name:"Rubber Mouth Sealant",Description:"A rubber mass molded to shape of your mouth"}},{Name:"DuctTape",Group:"ItemMouth2",TypeRecord:{typed:0},Craft:{Property:"Large",Name:"Mummy Wrappings",Description:"A bundle of resilient cloth wrappings"},ItemCallback:(e,t)=>{rm(e,t,[0]);const n=TypedItemDataLookup[`${e.Asset.Group.Name}${e.Asset.Name}`],r=(n?.options??[]).map((e=>e.Property.TypeRecord));r.length<2||qp(e,t,Ed(r.slice(1))??{})}},{Name:"DuctTape",Group:"ItemMouth3",TypeRecord:{typed:0},Craft:{Property:"Large",Name:"Mummy Wrappings",Description:"A bundle of resilient cloth wrappings"},Equip:()=>Math.random()>.5,ItemCallback:(e,t)=>{rm(e,t,[0]);const n=TypedItemDataLookup[`${e.Asset.Group.Name}${e.Asset.Name}`],r=(n?.options??[]).map((e=>e.Property.TypeRecord));0!==r.length&&qp(e,t,Ed(r)??{})}}],maid:[{Name:"LaceBands",Group:"Bracelet",Color:["#aaaaaa","#151515"]},{Name:"MaidOutfit2",Group:"Cloth",Color:["#0C0C0C","#919194","#9C9C9F"]},{Name:"CatsuitCollar",Group:"ClothAccessory",Color:["#0E0E0E"]},{Name:"MaidHairband1",Group:"Hat",Color:["#979797"]},{Name:"Socks6",Group:"Socks",Color:["#0D0D0D","#919194"]},{Name:"HeartTop",Group:"Bra",Color:["#0E0E0E"]},{Name:"FuturisticHeels2",Group:"Shoes",Color:["#101010","Default","#F1FAFF","#898989","#898989"],TypeRecord:{typed:1}},{Name:"MaidCollar",Group:"ItemNeck",Color:["#DCDCDC","#1B1B1B","Default"],Craft:{Property:"Secure",Name:"Maid Collar",Description:"A tight fitting yet comfortable collar"}},{Name:"FuturisticMittens",Group:"ItemHands",Color:["#FFFFFF","#FFFFFF","#2E2E2E","#050505"],TypeRecord:{typed:0},Craft:{Property:"Secure",Name:"Maid Mittens",Description:"For keeping a maid out of trouble"}},{Name:"FuturisticHeels2",Group:"ItemBoots",Color:["#101010","#101010","Default","#F1FAFF","#898989","#898989","#898989"],TypeRecord:{typed:1},Craft:{Property:"Secure",Name:"Maid Heels",Description:"For keeping a maid on their toes"}},{Name:"WiredEgg",Group:"ItemVulva",Color:["Default","#141414"],TypeRecord:{vibrating:1},Craft:{Property:"Arousing",Name:"Maid Teaser",Description:"A little reminder to keep a maid on edge"},Property:{OverridePriority:21}},{Name:"StraitLeotard",Group:"ItemArms",Color:["#FFFFFF","#1A1A1A","#FFFFFF"],TypeRecord:{cl:1,co:1,np:0,vp:0},Craft:{Property:"Secure",Name:"Maid Jacket",Description:"For keeping a maid out of trouble"}},{Name:"LeatherAnkleCuffs",Group:"ItemFeet",Color:["#969696","#191919","#969696"],TypeRecord:{typed:0},Craft:{Property:"Secure",Name:"Maid Cuffs",Description:"For keeping a maid out of trouble"}},{Name:"BallGag",Group:"ItemMouth",TypeRecord:{typed:2},Craft:{Property:"Large",Name:"Maid Silencer",Description:"Silence is golden"}}],statue:[{Name:"ReverseBunnySuit",Group:"SuitLower",Color:["#1B1B1B"],Equip:e=>ug(e)},{Name:"SeamlessCatsuit",Group:"SuitLower",Color:["#484747"],Equip:e=>!ug(e)},{Name:"SeamlessCatsuit",Group:"Suit",Color:["#484747"],Equip:e=>!ug(e)},{Name:"ReverseBunnySuit",Group:"Cloth",Color:["#1B1B1B","#1B1B1B"]},{Name:"BondageSkirt",Group:"ClothLower",Color:["#484747","#333333","#333333"]},{Name:"CatsuitCollar",Group:"ClothAccessory",Color:["#484747"]},{Name:"HighCollar",Group:"ItemNeck",Color:["#363636","#717171"],Craft:{Property:"Secure",Name:"Statue Neck"}},{Name:"LargeDildo",Group:"ItemMouth",Color:["#333333"],Craft:{Property:"Large",Name:"Mouth Sealant"},Property:{OverridePriority:27}},{Name:"LatexPostureCollar",Group:"ItemMouth2",Color:["Default"],Craft:{Property:"Large",Name:"Mouth Sealant"},Property:{OverridePriority:28}},{Name:"LatexBallMuzzleGag",Group:"ItemMouth3",Color:["#A1A1A1"],Craft:{Property:"Large",Name:"Mouth Sealant"}},{Name:"KirugumiMask",Group:"ItemHood",Color:["#484747","#484747","#484747","#484747"],TypeRecord:{e:0,m:3,b:0,br:0,op:0,ms:0},Craft:{Property:"Secure",Name:"Statue's Visage"}},{Name:"MonoHeel",Group:"ItemBoots",Color:["#737070","#737070","#101010"],TypeRecord:{typed:0},Craft:{Property:"Secure",Name:"Statue Base"}},{Name:"FuturisticMittens",Group:"ItemHands",Color:["#767676","#5F5F5F","#3C3C3C","#4F4F4F"],TypeRecord:{typed:0},Craft:{Property:"Secure",Name:"Statue Hands"}},{Name:"SmoothLeatherArmbinder1",Group:"ItemArms",Color:["#191919","#3D3D3D","#191919","#191919","#191919"],Craft:{Property:"Secure",Name:"Statue Arms"}}]}).map((([e,t])=>{const n=Object.freeze(t.map((t=>{let n;if(null!==t.Craft&&"object"==typeof t.Craft){const r=AssetGet(Player.AssetFamily,t.Group,t.Name);if(null==r)throw new Error(`Invalid ${e} item: ${t.Group}${t.Name}`);n={...t.Craft,Item:t.Name,Private:!0,Lock:"",TypeRecord:void 0,Name:t.Craft.Name||r.Description,MemberNumber:void 0,MemberName:""},CraftingValidate(n,r,!1)}return Object.freeze({...t,Custom:!1,Property:Object.freeze(t.Property??{}),TypeRecord:t.TypeRecord,Craft:Object.freeze(n),Color:t.Color,ItemCallback:t.ItemCallback,Equip:t.Equip})})));return[e,n]})));return Object.freeze(e)}(),am=Object.freeze([new wg("PSO Bondage",om.leash_candy,Player.MBSSettings.FortuneWheelItemSets,Vp.UNDERWEAR,Vp.UNDERWEAR,Dh(Ah.map(_a),[0,1,2,3,4,5]),!1),new wg("Mummification",om.mummy,Player.MBSSettings.FortuneWheelItemSets,Vp.CLOTHES,Vp.UNDERWEAR,Dh(Ah.map(_a),[3]),!1),new wg("Bondage Maid",om.maid,Player.MBSSettings.FortuneWheelItemSets,Vp.UNDERWEAR,Vp.UNDERWEAR,Dh(Ah.map(_a),[0,1,2,3]),!1),new wg("Petrification",om.statue,Player.MBSSettings.FortuneWheelItemSets,Vp.UNDERWEAR,Vp.UNDERWEAR,Dh(Ah.map(_a),[0,1,2,3]),!1,im)]),am.forEach((e=>e.register(!1))),sm=Object.freeze(WheelFortuneOption.filter((e=>!e.Custom))),lm=WheelFortuneDefault,Dm([Bm.SHARED])})),CurrentScreen){case"WheelFortune":return dm();case"WheelFortuneCustomize":return fm()}}));const pm=80,hm=160;var mm,gm,vm,bm,ym,wm;Pp(dg).then((()=>{$p.log("Initializing crafting hooks"),Mp.patchFunction("CraftingClick",{"if (CraftingOffset < 0) CraftingOffset = 80 - 20;":"if (CraftingOffset < 0) CraftingOffset = 160 - 20;","if (CraftingOffset >= 80) CraftingOffset = 0;":"if (CraftingOffset >= 160) CraftingOffset = 0;"}),Mp.patchFunction("CraftingRun",{"/ ${80 / 20}.":"/ 8."}),Pp(pg).then((()=>{$p.log("Initializing crafting cache"),Mp.hookFunction("CraftingSaveServer",0,((e,t)=>{const n=Player.Crafting;Player.Crafting=n?.slice(0,pm),t(e),Player.Crafting=n;const r=null==(i=Player.Crafting?Player.Crafting.slice(pm):null)?"":i.map((e=>e?.Item?CraftingSerialize(e):"")).join(CraftingSerializeItemSep);var i;r!=Player.MBSSettings.CraftingCache&&(Player.MBSSettings.CraftingCache=r,Dm([Bm.SETTINGS]))})),function(e,t){if(e.Crafting??=[],Op(e.Crafting,pm,null),!t)return;const n=LZString.compressToUTF16(t),r=CraftingDecompressServerData(n),i=new Set(e.Crafting.map((e=>JSON.stringify(e))));let o=!1;for(const[e,t]of r.entries())if(null!=t)e:switch(CraftingValidate(t)){case CraftingStatusType.OK:{const n=JSON.stringify(t);i.has(n)&&($p.warn(`Filtering duplicate crafting item ${pm+e}: "${t.Name} (${t.Item})"`),r[e]=null);break e}case CraftingStatusType.ERROR:{const n=JSON.stringify(t);i.has(n)?($p.warn(`Filtering duplicate crafting item ${pm+e}:"${t.Name} (${t.Item})"`),r[e]=null):o=!0;break e}case CraftingStatusType.CRITICAL_ERROR:$p.error(`Removing corrupt crafting item ${pm+e}: "${t?.Name} (${t?.Item})"`),r[e]=null}for(const t of r)if(e.Crafting.length>=hm){if(null==t)continue;if(e.Crafting.includes(null,pm))$p.warn("Found more than 160 crafting items, trimming down [80, 160)-interval null entries"),e.Crafting=e.Crafting.filter(((e,t)=>t<pm||null!=e));else{if(!e.Crafting.includes(null)){const t=e.Crafting.length-hm;$p.error(`Found more than 160 crafting items, the last ${t} will be deleted`);break}$p.warn("Found more than 160 crafting items, trimming down [0, 80)-interval null entries"),e.Crafting=e.Crafting.filter((e=>null!=e))}}else e.Crafting.push(t);o&&e.IsPlayer()&&CraftingSaveServer()}(Player,Player.MBSSettings.CraftingCache)}))}));gm=new WeakMap,vm=new WeakMap,bm=new WeakMap,ym=new WeakMap,mm=new WeakSet,wm=async function(e,t){const n=await fetch(t).then((t=>t.ok?($p.debug(`Successfully fetched "${e}" json`,t),t.json()):($p.debug(`Failed to fetch "${e}" json`,t),Promise.resolve(null)))).catch((e=>($p.error(e),null)));if(null!==n)switch(e){case"phoneticDict":S(this,gm,Object.freeze(n),"f"),S(this,bm,!0,"f");break;case"gagData":S(this,vm,Object.freeze(n),"f"),S(this,ym,!0,"f");break;default:throw new Error(`Invalid type: ${e}`)}};const Sm=new class{constructor(){mm.add(this),gm.set(this,Object.freeze({})),vm.set(this,Object.freeze({})),bm.set(this,!1),ym.set(this,!1)}get gagData(){return w(this,ym,"f")||w(this,mm,"m",wm).call(this,"gagData","https://bananarama92.github.io/MBS/devel/vendor/gag_data.json"),w(this,vm,"f")}get phoneticDict(){return w(this,bm,"f")||w(this,mm,"m",wm).call(this,"phoneticDict","https://bananarama92.github.io/MBS/devel/vendor/en_US.json"),w(this,gm,"f")}init(){this.gagData,this.phoneticDict}},Cm=Object.freeze({LIGHT:3,MEDIUM:6,HEAVY:9,KILO_HEAVY:12,MEGA_HEAVY:15,GIGA_HEAVY:18,MAX:21}),xm=Object.freeze(new Set(["aɪ","aʊ","b","d","dʒ","eɪ","f","h","i","j","k","m","n","oʊ","p","s","t","tʃ","u","v","w","z","æ","ð","ŋ","ɑ","ɔ","ɔɪ","ə","ɛ","ɝ","ɡ","ɪ","ɪə","ɫ","ɹ","ʃ","ʊ","ʒ","θ"])),_m=/\p{L}/u;function $m(e){const t=e.toLowerCase(),n=Sm.phoneticDict[t];if(void 0===n)return;const r=yd(0,n.length).map((e=>[]));for(const e of Gf(n,r)){const[t,n]=e;let r=0;for(;r<t.length;){const e=t[r],i=t.slice(r,r+2);xm.has(i)?(n.push(i),r+=2):(n.push(e),r+=1)}}return r}function Im(e,t){let n=e=>e;if(null!=e?.dropChars){const r={level:t,levelMin:e.dropChars.levelMin??Cm.HEAVY,levelMax:e.dropChars.levelMax??Cm.MAX,maxFrac:e.dropChars.maxFrac??.5};n=e=>function(e,t){const{level:n,levelMax:r,levelMin:i,maxFrac:o}=t;if(n<i)return e;const a=Array.from(e),s=Math.max(o,o*(n-i)/(r-i)),l=Math.floor(a.length*s);return e.slice(0,a.length-l).padEnd(a.length-Math.floor(l/2))}(e,r)}return{dropChars:n,character:e?.character??null,fallback:e?.fallback??(e=>Mp.callOriginal("SpeechGarbleByGagLevel",e)),ignoreOOC:e?.ignoreOOC??!1,perSyllable:e?.perSyllable??!1}}function Om(e,t,n=null){if(e&&e.HasEffect("OpenMouth")&&!e.HasEffect("BlockMouth"))return Sm.gagData["Ring Gag"]??{};e:if(null!==n){const e=Math.floor(t/3);if(0===e)break e;t/3-e>n.syllable/n.syllableMax&&(t=3*(1+e))}return t<=Cm.LIGHT?Sm.gagData["Cleave Gag"]??{}:t<=Cm.MEDIUM?Sm.gagData["Ball Gag"]??{}:Sm.gagData["Dildo Gag"]??{}}function km(e,t,n=null){const{dropChars:r,fallback:i,character:o,ignoreOOC:a,perSyllable:s}=Im(n,t);let l="";const u=function(e,t=!1){const n=SpeechGetOOCRanges(e).values();let r=n.next();if(r.done||t)return[{words:e,ooc:!1}];const i=[];let o=0;for(;!r.done;){const t=r.value.start,a=t+r.value.length;i.push({words:e.slice(o,t),ooc:!1}),i.push({words:e.slice(t,a),ooc:!0}),r=n.next(),o=a}return i.push({words:e.slice(o),ooc:!1}),i}(e,a);for(const e of u){if(e.ooc){l+=e.words;continue}let n="",a=[];const u=e.words.length-1;for(const[c,d]of Array.from(e.words).entries()){const e=_m.test(d);if(e&&(n+=d,a.push(d.toUpperCase()===d),c<u))continue;const f=$m(n);if(f){const e=r(f.flatMap(((e,n)=>{const r=s?{syllable:n+1,syllableMax:f.length}:null,i=Om(o,t,r);return e.map((e=>i[e]?.SOUND??""))})).join(""));a.every(Boolean)?l+=e.toUpperCase():a[0]&&e.length>0?l+=`${e[0].toUpperCase()}${e.slice(1)}`:l+=e}else l+=i([t,n]);n="",a=[],e||(l+=i([t,d]))}}return l}Pp(dg).then((()=>{$p.log("Initializing garbling module"),Mp.hookFunction("SpeechGarble",0,(([e,t,n,...r],i)=>{const o=SpeechGetTotalGagLevel(e,n);if(o&&e&&t&&Player.MBSSettings.AlternativeGarbling&&e.HasEffect("OpenMouth")&&!e.HasEffect("BlockMouth")){let n=km(t,o,{dropChars:Player.MBSSettings.DropTrailing?{}:void 0,perSyllable:Player.MBSSettings.GarblePerSyllable,character:e});return n=SpeechStutter(e,n),n=SpeechBabyTalk(e,n),n}return i([e,t,n,...r])})),Mp.hookFunction("SpeechGarbleByGagLevel",0,(([e,t,n,...r],i)=>{if(e&&t&&Player.MBSSettings.AlternativeGarbling){return km(t,e,{dropChars:Player.MBSSettings.DropTrailing?{}:void 0,perSyllable:Player.MBSSettings.GarblePerSyllable,fallback:i,ignoreOOC:n})}return i([e,t,...r])}))}));const Em=18e4;function Pm(e){const t=[],n=CommonIsObject(e)?e:{};for(const[e,r]of Object.entries(n))try{const n=JSON.stringify(r??"");t.push([e,(new TextEncoder).encode(n).byteLength])}catch{t.push([e,NaN])}return Object.fromEntries(t.sort((([e,t],[n,r])=>{t=Math.round(t/100),r=Math.round(r/100);const i=Number.isNaN(t),o=Number.isNaN(r);return t===r||i&&o?e.localeCompare(n):i||o?o?-1:1:r-t})))}function Mm(e){return Math.round(e/100)/10}const Bm=Object.freeze({SETTINGS:0,SHARED:1});function jm(){const e=function(){const e=Fp.fromVersion(t),n=`#v${e.major}${e.minor}${e.micro}`;return e.beta?["blob/devel",""]:["blob/main",n]}();return`https://github.com/bananarama92/MBS/${e[0]}/CHANGELOG.md${e[1]}`}function Am(e,t,n){Array.isArray(t)?t.length>og&&(kp(t,og),n.push([`Trimming too long wheel of fortune item list: ${t.length}/${og}`])):(t=[],n.push(["Re-initializing invalid wheel of fortune item list: "+typeof t]));const r=Object.seal(Array(og).fill(null));return t.forEach(((t,i)=>{if(null!==t)try{(r[i]=e(r,t)).register(!1)}catch(e){n.push([`Failed to load corrupted custom wheel of fortune item ${i}`,e])}})),r}function Nm(e,t){Array.isArray(e)?e.length>ag&&(kp(e,ag),t.push([`Trimming too long wheel of fortune preset list: ${e.length}/${ag}`])):(e=[],t.push(["Re-initializing invalid wheel of fortune preset list: "+typeof e]));const n=Object.seal(Array(ag).fill(null));return e.forEach(((e,r)=>{if(null===e)return;if(Array.isArray(e)||"object"!=typeof e||"string"!=typeof e.ids)return void t.push([`Failed to load corrupted custom wheel of fortune preset ${r}`]);const{name:i,ids:o}=e;n[r]={name:"string"==typeof i&&i.length>0&&i.length<=20?i:`Preset ${r}`,ids:o}})),n}function Tm(e,t,n=!0){let r=null;try{if(e&&"string"==typeof e){let t=LZString.decompressFromUTF16(e);t||(t=LZString.decompressFromBase64(e)),r=JSON.parse(t||"null")}}catch(e){n&&$p.warn(`failed to load corrupted MBS ${t}`,e)}return null!==r&&"object"==typeof r?r:{}}function Fm(e=null,n=!0){if(void 0===Player.OnlineSharedSettings)throw new Error('"Player.OnlineSharedSettings" still uninitialized');e??={...Tm(Player.OnlineSettings?.MBS,"OnlineSettings"),...Tm(Player.ExtensionSettings.MBS,"ExtensionSettings"),...Tm(Player.OnlineSharedSettings.MBS,"OnlineSharedSettings")},void 0!==e.Version&&function(e){if(void 0===e)return $p.log("Detecting first-time MBS initialization"),!1;const n=Fp.fromVersion(t);let r;try{r=Fp.fromVersion(e)}catch(t){return $p.warn(`Failed to parse previous MBS version: ${e}`),!1}return n.greater(r)?($p.log(`Upgrading MBS from ${e} to ${t}`),!0):!!n.lesser(r)&&($p.warn(`Downgrading MBS from ${e} to ${t}`),!1)}(Player.OnlineSharedSettings.MBSVersion??Player.OnlineSettings?.MBSVersion)&&function(){const e=`New MBS version detected: ${t}\n\nSee below for the updated changelog:\n${jm()}`;"number"==typeof Player.MemberNumber&&ServerAccountBeep({MemberNumber:Player.MemberNumber,MemberName:"MBS",ChatRoomName:"MBS Changelog",Private:!0,Message:e,ChatRoomSpace:"",BeepType:""})}();let r=!1;void 0!==Player.OnlineSettings?.MBSVersion&&(delete Player.OnlineSettings.MBSVersion,r=!0),Player.OnlineSettings?.MBS&&(delete Player.OnlineSettings.MBS,r=!0),r&&ServerAccountUpdate.QueueData({OnlineSettings:Player.OnlineSettings});const i=function(e){const n={Version:[],CraftingCache:[],FortuneWheelItemSets:[],FortuneWheelCommands:[],FortuneWheelPresets:[],LockedWhenRestrained:[],RollWhenRestrained:[],AlternativeGarbling:[],DropTrailing:[],GarblePerSyllable:[]},r={CraftingCache:"",LockedWhenRestrained:!1,RollWhenRestrained:!0,AlternativeGarbling:!1,DropTrailing:!1,GarblePerSyllable:!1};for(const[t,i]of Rp(r))void 0!==e[t]&&(typeof e[t]!=typeof i?n[t]=[[`Invalid type, expected a ${typeof i}: ${typeof n[t]}`]]:r[t]=e[t]);const i={Version:t,CraftingCache:r.CraftingCache,FortuneWheelItemSets:Am(wg.fromObject,e.FortuneWheelSets??e.FortuneWheelItemSets??[],n.FortuneWheelItemSets),FortuneWheelCommands:Am(Sg.fromObject,e.FortuneWheelCommands??[],n.FortuneWheelCommands),FortuneWheelPresets:Nm(e.FortuneWheelPresets??[],n.FortuneWheelPresets),LockedWhenRestrained:r.LockedWhenRestrained,RollWhenRestrained:r.RollWhenRestrained,AlternativeGarbling:r.AlternativeGarbling,DropTrailing:r.DropTrailing,GarblePerSyllable:r.GarblePerSyllable};return i.AlternativeGarbling&&Sm.init(),{settings:i,ok:0===Kd(Object.values(n).map((e=>e.length))),err:Wp(Rp(n).filter((([e,t])=>t.length>0)))}}(e);return(i.ok||n)&&(Player.MBSSettings=i.settings),i.ok||($p.warn("Encountered and fixed one or more errors while parsing MBS settings",i.err),n&&function(e){const t=Wp(Rp(e).map((([e,t])=>[e,t.map((e=>e.join(", ")))]))),n=`Encountered one or more errors while parsing MBS settings:\n\n${JSON.stringify(t,void 0,4)}`;"number"==typeof Player.MemberNumber&&ServerAccountBeep({MemberNumber:Player.MemberNumber,MemberName:"MBS",ChatRoomName:"MBS Settings Error",Private:!0,Message:n,ChatRoomSpace:"",BeepType:""})}(i.err)),Player.OnlineSharedSettings.WheelFortune??=WheelFortuneDefault,i}function Dm(e,n=!0){if(void 0===Player.OnlineSharedSettings)throw new Error("Player.OnlineSharedSettings is still uninitialized");const r={};if(e.includes(Bm.SETTINGS)){const e=gc(Player.MBSSettings,"FortuneWheelItemSets","FortuneWheelCommands");Player.ExtensionSettings.MBS=LZString.compressToUTF16(JSON.stringify(e)),n&&(r["ExtensionSettings.MBS"]=Player.ExtensionSettings.MBS)}if(e.includes(Bm.SHARED)){const e=Object.freeze({FortuneWheelItemSets:Player.MBSSettings.FortuneWheelItemSets,FortuneWheelCommands:Player.MBSSettings.FortuneWheelCommands});Player.OnlineSharedSettings.MBS=LZString.compressToUTF16(JSON.stringify(e)),Player.OnlineSharedSettings.MBSVersion=t,n&&(Player.OnlineSharedSettings.WheelFortune=cg(Player.OnlineSharedSettings.WheelFortune),r.OnlineSharedSettings=Player.OnlineSharedSettings)}n&&ServerAccountUpdate.QueueData(r)}function Lm(){const e=["ExtensionSettings","OnlineSharedSettings"];for(const t of e){const e=Pm(Player[t]),n=Object.fromEntries(Object.entries(e).map((([e,t])=>[e,Mm(t)]))),r=Mm(Kd(Object.values(e),(e=>Number.isNaN(e)?0:e)));r>=.9*Em/1e3?$p.warn(`Total ${t} data usage at ${r} / ${Em/1e3} KB`,n):$p.log(`Total ${t} data usage at ${r} / ${Em/1e3} KB`,n)}}const Rm=Object.freeze({OK:0,ERROR:1,EMPTY_SETTINGS:2,WARN:3});Pp(fg).then((()=>{Fm(),Dm([Bm.SETTINGS,Bm.SHARED],!1),$p.log("Initializing settings module"),Lm()}));var Wm,Gm,zm,Hm,qm,Um,Vm,Km,Jm;function Ym(){null!=TextScreenCache&&(TextScreenCache.cache[`Homepage${eg.screen}`]="MBS Settings");const e=new Image;e.addEventListener("error",(()=>DrawGetImageOnError(e,!1))),e.src="Icons/Maid.png",DrawCacheImage.set(`Icons/${eg.screen}.png`,e)}class Zm extends uh{constructor(){super(null,"Character","Preference",{Run:PreferenceRun,Click:PreferenceClick,Exit:PreferenceExit,Load:()=>CommonSetScreen("Character","Preference")})}}Zm.screen="Preference";const Qm="mbs-preference",Xm=Object.freeze({root:Qm,styles:`${Qm}-style`,header:`${Qm}-header`,exit:`${Qm}-exit`,exitButton:`${Qm}-exit-button`,exitTooltip:`${Qm}-exit-tooltip`,settingsGrid:`${Qm}-settings`,settingsPair:`${Qm}-settings-pair`,itemsButton:`${Qm}-items-button`,itemsHeader:`${Qm}-items-header`,wheelButton:`${Qm}-wheel-button`,wheelHeader:`${Qm}-wheel-header`,rollCheckbox:`${Qm}-roll-checkbox`,rollHeader:`${Qm}-roll-header`,lockCheckbox:`${Qm}-lock-checkbox`,lockHeader:`${Qm}-lock-header`,gagCheckbox:`${Qm}-gag-checkbox`,gagHeader:`${Qm}-gag-header`,miscGrid:`${Qm}-misc`,reset:`${Qm}-reset`,resetButton:`${Qm}-reset-button`,resetTooltip:`${Qm}-reset-tooltip`,resetScreen:`${Qm}-reset-screen`,resetBackground:`${Qm}-reset-background`,resetGrid:`${Qm}-reset-grid`,resetAccept:`${Qm}-reset-accept`,resetCancel:`${Qm}-reset-cancel`,import:`${Qm}-import`,importButton:`${Qm}-import-button`,importTooltip:`${Qm}-import-tooltip`,export:`${Qm}-export`,exportButton:`${Qm}-export-button`,exportTooltip:`${Qm}-export-tooltip`,changelog:`${Qm}-changelog`,changelogButton:`${Qm}-changelog-button`,changelogTooltip:`${Qm}-changelog-tooltip`});class eg extends lh{constructor(e,n=null){super(e,eg.screenParamsDefault,n),Wm.add(this),document.body.appendChild(p("div",{id:Xm.root,class:"mbs-screen",children:[f("style",{id:Xm.styles,children:'#mbs-preference {\n  grid-template: "header header exit" min(9vh, 4.5vw) "settings misc misc" auto/auto min(29vh, 14.5vw) min(9vh, 4.5vw);\n}\n\n#mbs-preference-header {\n  grid-area: header;\n}\n\n#mbs-preference-exit {\n  grid-area: exit;\n}\n\n.mbs-preference-settings-pair {\n  grid-column-gap: min(3vh, 1.5vw);\n  align-items: center;\n  display: grid;\n  grid-template-columns: min(9vh, 4.5vw) auto;\n  padding-right: min(6vh, 3vw);\n  text-align: justify;\n}\n.mbs-preference-settings-pair button {\n  height: min(9vh, 4.5vw);\n  width: min(9vh, 4.5vw);\n}\n.mbs-preference-settings-pair > p {\n  margin: 0;\n}\n\n#mbs-preference-settings {\n  display: grid;\n  grid-area: settings;\n  height: 100%;\n  overflow: hidden scroll;\n  grid-gap: min(2vh, 1vw);\n}\n\n#mbs-preference-misc {\n  align-self: self-end;\n  display: grid;\n  grid-gap: min(2vh, 1vw);\n  grid-area: misc;\n  grid-template: "reset reset" min(9vh, 4.5vw) "import export" min(9vh, 4.5vw) "changelog changelog" min(9vh, 4.5vw)/auto auto;\n}\n#mbs-preference-misc button {\n  background-origin: padding-box;\n  background-position: left;\n  background-size: min(7vh, 3.5vw) min(7vh, 3.5vw);\n}\n\n#mbs-preference-reset {\n  grid-area: reset;\n  grid-template-columns: min(40vh, 20vw);\n}\n#mbs-preference-reset button:not(:hover) {\n  background-color: pink;\n}\n\n#mbs-preference-import {\n  grid-area: import;\n  grid-template-columns: min(19vh, 9.5vw);\n}\n\n#mbs-preference-export {\n  grid-area: export;\n  grid-template-columns: min(19vh, 9.5vw);\n}\n\n#mbs-preference-changelog {\n  grid-area: changelog;\n  grid-template-columns: min(40vh, 20vw);\n}\n\n#mbs-preference-reset-screen {\n  align-items: center;\n  background-color: rgba(0, 0, 0, 0.7);\n  z-index: 2;\n}\n\n#mbs-preference-reset-background {\n  background: url("https://bananarama92.github.io/MBS/main/images/SheetMBS.png") var(--mbs-background-color);\n  background-blend-mode: multiply;\n  background-position: center;\n  background-repeat: no-repeat;\n  background-size: contain;\n  box-sizing: border-box;\n  height: 80%;\n  justify-self: center;\n  mask-image: url("https://bananarama92.github.io/MBS/main/images/SheetMBS.png");\n  mask-position: center;\n  mask-repeat: no-repeat;\n  mask-size: contain;\n  padding: min(6vh, 3vw);\n  padding-top: min(3vh, 1.5vw);\n  position: relative;\n  width: 80%;\n  word-break: break-word;\n}\n\n#mbs-preference-reset-grid {\n  display: grid;\n  grid-template-columns: auto auto;\n  justify-items: center;\n  padding-top: min(10vh, 5vw);\n}\n#mbs-preference-reset-grid .mbs-button {\n  height: min(9vh, 4.5vw);\n  width: min(27vh, 13.5vw);\n}'.toString()}),f("h1",{id:Xm.header,children:`Maid's Bondage Scripts ${t}`}),p("div",{id:Xm.exit,class:"mbs-button-div",children:[f("button",{class:"mbs-button",id:Xm.exitButton,onClick:this.exit.bind(this),style:{backgroundImage:"url('./Icons/Exit.png')"}}),f("span",{class:"mbs-button-tooltip",style:{justifySelf:"right"},children:"Exit"})]}),p("div",{id:Xm.settingsGrid,children:[f("h2",{children:"Wheel of fortune settings"}),p("div",{class:"mbs-preference-settings-pair",children:[f("button",{class:"mbs-button",style:{backgroundImage:"url('./Icons/Crafting.png')"},onClick:w(this,Wm,"m",Km).bind(this)}),"Configure the wheel of fortune"]}),p("div",{class:"mbs-preference-settings-pair",children:[f("input",{type:"checkbox","data-field":"RollWhenRestrained",onClick:w(this,Wm,"m",Gm).bind(this)}),"Allow wheel rolling while restrained"]}),p("div",{class:"mbs-preference-settings-pair",children:[f("input",{type:"checkbox","data-field":"LockedWhenRestrained",onClick:w(this,Wm,"m",Gm).bind(this)}),"Lock MBS settings while restrained"]}),f("h2",{children:"Garbling settings"}),p("div",{class:"mbs-preference-settings-pair",children:[f("input",{type:"checkbox","data-field":"AlternativeGarbling",onClick:w(this,Wm,"m",Gm).bind(this)}),p("span",{children:[p("p",{children:[f("strong",{children:"Experimental"}),": whether gags will use an alternative form of, more phonetically acurate, speech garbling based on ",f("a",{href:"https://github.com/CordeliaMist/Dalamud-GagSpeak",target:"_blank",children:"Dalamud-GagSpeak"})]}),p("p",{children:["Incompatible-ish with ",f("a",{href:"https://sidiousious.gitlab.io/bce/",target:"_blank",children:"FBC"}),"'s garbling anti-cheat as of the moment"]})]})]}),p("div",{class:"mbs-preference-settings-pair",children:[f("input",{type:"checkbox","data-field":"DropTrailing",onClick:w(this,Wm,"m",Gm).bind(this)}),"Whether to heaviest gags will drop up to half of all trailing characters when alternate garbling is enabled"]}),p("div",{class:"mbs-preference-settings-pair",children:[f("input",{type:"checkbox","data-field":"GarblePerSyllable",onClick:w(this,Wm,"m",Gm).bind(this)}),"Interpolate between the three alternative garbling levels, allowing for a more gradual increase in garbling strength (on a syllable by syllable basis) as the gag level increases"]})]}),p("div",{id:Xm.miscGrid,children:[p("div",{id:Xm.reset,class:"mbs-button-div",children:[f("button",{class:"mbs-button",id:Xm.resetButton,style:{backgroundImage:"url('./Icons/ServiceBell.png')"},onClick:w(this,Wm,"m",qm).bind(this),children:"Reset MBS"}),f("span",{class:"mbs-button-tooltip",children:"Clear all MBS data"})]}),p("div",{id:Xm.import,class:"mbs-button-div",children:[f("button",{class:"mbs-button",id:Xm.importButton,onClick:w(this,Wm,"m",zm).bind(this),children:"Import"}),f("span",{class:"mbs-button-tooltip",children:"Import MBS settings"})]}),p("div",{id:Xm.export,class:"mbs-button-div",children:[f("button",{class:"mbs-button",id:Xm.exportButton,onClick:w(this,Wm,"m",Hm).bind(this),children:"Export"}),f("span",{class:"mbs-button-tooltip",children:" Export MBS settings"})]}),p("div",{id:Xm.changelog,class:"mbs-button-div",children:[f("button",{class:"mbs-button",id:Xm.changelogButton,style:{backgroundImage:"url('./Icons/Changelog.png')"},onClick:()=>open(jm(),"_blank"),children:"Latest Changes"}),f("span",{class:"mbs-button-tooltip",children:"Open the MBS changelog"})]})]})]})),document.body.appendChild(f("div",{id:Xm.resetScreen,class:"mbs-screen","screen-generated":eg.screen,children:p("div",{id:Xm.resetBackground,children:[f("h1",{children:"MBS data reset"}),f("p",{children:f("strong",{children:"- Warning -"})}),p("p",{children:["If you confirm, ",f("i",{children:"all"})," MBS data (including settings, overrides, and current states) will be permanently reset!"]}),f("p",{children:"You will be able to continue using MBS, but all of your configuration will be reset to default!"}),f("p",{children:f("strong",{children:"This action cannot be undone!"})}),p("div",{id:Xm.resetGrid,children:[f("button",{class:"mbs-button",onClick:w(this,Wm,"m",Vm).bind(this),disabled:!0,id:Xm.resetAccept,children:"Confirm (10)"}),f("button",{class:"mbs-button",onClick:this.exit.bind(this),id:Xm.resetCancel,children:"Cancel"})]})]})}))}load(){w(this,Wm,"m",Jm).call(this),super.load()}draw(){DrawCharacter(Player,50,50,.9)}exit(){const e=document.getElementById(Xm.resetScreen);"visible"===e.style.visibility?e.style.visibility="hidden":(super.exit(),this.exitScreens(!1))}}let tg;var ng,rg,ig;Wm=new WeakSet,Gm=function(e){const t=e.target.dataset.field;if(t in Player.MBSSettings)switch(Player.MBSSettings[t]=!Player.MBSSettings[t],Dm([Bm.SETTINGS]),t){case"AlternativeGarbling":Player.MBSSettings[t]&&Sm.init();break;case"LockedWhenRestrained":w(this,Wm,"m",Jm).call(this)}},zm=function(){const e=prompt("Please paste MBS settings.\nImporting settings will overwrite existing settings. Are you sure?");if(!e)return;const t=function(e){$p.log("Importing new MBS settings");let t=null,n=null;try{t=JSON.parse(LZString.decompressFromBase64(e.trim())||"{}")}catch(e){n=e}if(n||null===t||"object"!=typeof t||Dp(t))return $p.error("Aborting, failed to parse corrupted MBS settings",n),{status:Rm.ERROR,ok:!1};if(0===Object.keys(t).length)return $p.error("Aborting, detected empty or corrupted MBS settings"),{status:Rm.EMPTY_SETTINGS,ok:!1};const r=Fm(t,!1);return r.ok?(Dm([Bm.SETTINGS,Bm.SHARED],!0),Lm(),{status:Rm.OK,...r}):{status:Rm.WARN,...r}}(e);switch(t.status){case Rm.OK:return $p.log("Settings successfully updated"),alert("Settings successfully updated!");case Rm.ERROR:return alert("ERROR: Detected corrupted MBS settings.\nNo changes were made.");case Rm.EMPTY_SETTINGS:return alert("ERROR: Detected empty or corrupted MBS settings.\nNo changes were made.");case Rm.WARN:return void(confirm("WARNING: MBS successfully parsed the settings but found one or more invalid fields; please check the browser console for more details.\nAre you sure you want to continue?")&&(Player.MBSSettings=t.settings,Dm([Bm.SETTINGS,Bm.SHARED],!0),Lm(),$p.log("Settings successfully updated"),alert("Settings successfully updated!")));default:throw new Error(`Unknown status type: ${t.status}`)}},Hm=function(){const e=LZString.compressToBase64(JSON.stringify(Player.MBSSettings));navigator.clipboard.writeText(e),alert("MBS settings copied to clipboard.")},qm=function(){const e=document.getElementById(Xm.resetScreen),t=document.getElementById(Xm.resetAccept);e.style.visibility="visible",t.disabled=!0,w(this,Wm,"m",Um).call(this,t)},Um=async function(e){let t=9;for(;t>=0;)await new Promise((e=>setTimeout(e,1e3))),e.innerText=`Confirm (${t})`,t--;e.innerText="Confirm",e.disabled=!1},Vm=function(){delete Player.ExtensionSettings.MBS,void 0!==Player.OnlineSharedSettings&&(delete Player.OnlineSharedSettings.MBSVersion,delete Player.OnlineSharedSettings.MBS,Player.OnlineSharedSettings.WheelFortune=lm),WheelFortuneOption=WheelFortuneOption.filter((e=>!0!==e.Custom)),WheelFortuneDefault=lm,Player.Crafting=Player.Crafting?.slice(0,pm),Player.MBSSettings=Object.seal({Version:t,CraftingCache:"",FortuneWheelItemSets:Object.seal(Array(og).fill(null)),FortuneWheelCommands:Object.seal(Array(og).fill(null)),LockedWhenRestrained:!1,RollWhenRestrained:!0,FortuneWheelPresets:Object.seal(Array(ag).fill(null)),AlternativeGarbling:!1,DropTrailing:!1,GarblePerSyllable:!1}),ServerAccountUpdate.QueueData({ExtensionSettings:Player.ExtensionSettings,OnlineSharedSettings:Player.OnlineSharedSettings},!0),$p.log("Settings successfully reset"),Lm(),this.exit()},Km=function(){const e={FortuneWheelItemSets:kh(Player,"FortuneWheelItemSets","item sets"),FortuneWheelCommands:kh(Player,"FortuneWheelCommands","commands")},[t,n,r,i]=this.screenParams[this.ids.root].shape,o={[Bh.ids.root]:{shape:[95,n,r+(t-95),i]}};this.loadChild(Bh,e,Player,o)},Jm=function(){const e=Player.IsRestrained()&&Player.MBSSettings.LockedWhenRestrained,t=document.getElementById(Xm.settingsGrid);for(const n of t.children)for(const t of n.children){const n=t.dataset?.field;n&&n in Player.MBSSettings&&(t.checked=Player.MBSSettings[n],t.disabled=e)}},eg.screen="MBS_PreferenceScreen",eg.ids=Xm,eg.screenParamsDefault={[Qm]:Object.freeze({shape:[525,75,1380,850],visibility:"visible"}),[Xm.resetScreen]:Object.freeze({shape:[0,0,2e3,1e3],visibility:"hidden"})},Pp(dg).then((()=>{if(Mp.hookFunction("PreferenceLoad",0,((e,t)=>{t(e),Ym()})),ServerPlayerChatRoom.register({screen:eg.screen,callback:()=>"ChatRoom"===InformationSheetPreviousScreen}),Mp.hookFunction("PreferenceClick",0,((e,t)=>{const n=PreferenceSubscreen;t(e),n||PreferenceSubscreen!==eg.screen||(PreferenceExit(),tg.loadChild(eg))})),PreferenceSubscreenList.push(eg.screen),tg=new Zm,"Preference"===CurrentScreen)return Ym()}));const og=32,ag=8,sg=Object.freeze(["Blue","Gold","Gray","Green","Orange","Purple","Red","Yellow"]);function lg(e){if(null===e||"object"!=typeof e)throw new TypeError('Invalid "character" type: '+typeof e);if(!e.IsSimple()&&!e.IsPlayer())throw new Error("Expected a simple or player character")}function ug(e){if(!(e.OnlineSharedSettings?.BlockBodyCosplay??!0))return!0;const t=Bp.getRuleState("alt_allow_changing_appearance");return!(null===t||!e.IsPlayer())&&(t.inEffect&&t.isEnforced&&t.customData.minimumRole>3)}function cg(e){if("string"!=typeof e)throw new TypeError('Invalid "IDs" type: '+typeof e);let t="";for(const n of WheelFortuneOption)e.includes(n.ID)&&(t+=n.ID);return t}function dg(e=!0){return"object"==typeof MainCanvas&&(!e||GameVersionFormat.test(GameVersion))}function fg(){return dg()&&void 0!==Player.OnlineSharedSettings}function pg(){return fg()&&void 0!==Player.MBSSettings}const hg=Object.freeze({"PSO Bondage":0,Mummification:1,"Bondage Maid":2,Petrification:3});class mg{constructor(e,t){this.name=null,this.mbsList=e,this.weight=Number.isInteger(t)?ro(t,1,9):1}reset(){this.name=null,this.weight=1}isValid(e=null){return!!this.name&&this.mbsList.every(((t,n)=>n===e||t?.name!==this.name))}toString(){return jp(typeof this,this.toJSON())}}class gg extends mg{get stripLevel(){return this.stripIter.value}set stripLevel(e){const t=this.stripIter.list.indexOf(e);this.stripIter.setPosition(t)}get equipLevel(){return this.equipIter.value}set equipLevel(e){const t=this.equipIter.list.indexOf(e);this.equipIter.setPosition(t)}constructor(e,t){super(e,t),this.itemList=null,this.flags=Object.freeze(Ah.map((e=>Object.seal({...e})))),this.outfitCache=null,this.stripIter=new Ap([Vp.NONE,Vp.CLOTHES,Vp.UNDERWEAR,Vp.COSPLAY],Vp.UNDERWEAR),this.equipIter=new Ap([Vp.NONE,Vp.CLOTHES,Vp.UNDERWEAR,Vp.COSPLAY],Vp.UNDERWEAR)}reset(){super.reset(),this.itemList=null,this.outfitCache=null,this.stripLevel=Vp.UNDERWEAR,this.equipLevel=Vp.UNDERWEAR,Ah.forEach(((e,t)=>Object.assign(this.flags[t],e)))}readSettings(e){if(!(e instanceof wg))throw new TypeError('Invalid "ItemSet" type: '+typeof e);this.name=e.name,this.itemList=e.itemList,this.stripLevel=e.stripLevel,this.equipLevel=e.equipLevel,this.outfitCache=null,this.weight=e.weight,e.flags.forEach(((e,t)=>Object.assign(this.flags[t],e)))}writeSettings(e=null){if(null===this.name||null===this.itemList)throw new Error('Cannot create an ItemSet while "name" or "itemList" is null');return new wg(this.name,this.itemList,this.mbsList,this.stripLevel,this.equipLevel,this.flags,!0,e,this.weight)}loadFromBase64(){if(null===this.outfitCache)return!1;let e,t;try{e=JSON.parse(LZString.decompressFromBase64(this.outfitCache.trim())),t=function(e){if(!Dp(e)){if(null===e||"object"!=typeof e)throw new TypeError('Invalid "items" type: '+typeof e);e=[e]}const t=[],n=new Map,r=new Set;return e.forEach(((e,i)=>{let o=null;try{o=AssetGet("Female3DCG",e.Group,e.Name);const n=oh(o,e);!r.has(e.Group)&&null!=o&&(o.Group.IsItem()||o.Group.IsAppearance()&&o.Group.AllowNone)&&(r.add(e.Group),t.push(n))}catch(e){let t=`${o?.Group?.Name}${o?.Name}`;t.includes("undefined")&&(t=`Item ${i}`),n.set(t,e)}})),0!==n.size&&$p.log(`Failed to parse ${n.size} of the provided items`,n),t}(e)}catch(e){return $p.warn("Failed to parse outfit code:",e),!1}return 0!==t.length&&(this.itemList=Object.freeze(function(e,t=Kp){const n=Zp(e,t);return Fd(e,(e=>n.get(e.Group)?.priority??1/0))}(t)),!0)}isValid(e=null){return super.isValid(e)&&null!==this.itemList&&this.flags.some((e=>e.enabled))}toJSON(){return{name:this.name,itemList:this.itemList,stripLevel:this.stripLevel,equipLevel:this.equipLevel,flags:this.flags,outfitCache:this.outfitCache}}}class vg extends mg{readSettings(e){if(!(e instanceof Sg))throw new TypeError('Invalid "command" type: '+typeof e);this.name=e.name,this.weight=e.weight}writeSettings(){if(null===this.name)throw new Error('Cannot create a Command while "name" is null');return new Sg(this.name,this.mbsList,this.weight)}toJSON(){return{name:this.name}}}class bg{get children(){return w(this,ng,"f")}get index(){return this.mbsList.findIndex((e=>e===this))}constructor(e,t,n,r){ng.set(this,null),this.name=e,this.custom=t,this.mbsList=n,this.weight=r}static validate(e){throw new Error("Trying to call an abstract method")}static fromObject(...e){throw new Error("Trying to call an abstract method")}register(){S(this,ng,this.toOptions(),"f")}unregister(){S(this,ng,null,"f")}toString(){return jp(typeof this,this.toJSON())}}ng=new WeakMap;class yg extends bg{constructor(){super(...arguments),rg.add(this)}register(e=!0){super.register();let t=w(this,rg,"m",ig).call(this);for(const e of this.children){const n=WheelFortuneOption.findIndex((t=>t.ID===e.ID));-1!==n?(WheelFortuneOption[n]=e,e.Default&&!WheelFortuneDefault.includes(e.ID)&&(WheelFortuneDefault+=e.ID)):(WheelFortuneOption.splice(t,0,e),e.Default&&(WheelFortuneDefault+=e.ID)),t+=1}e&&Dm([Bm.SHARED])}unregister(e=!0){const t=this.children?.map((e=>e.ID))??[];super.unregister(),WheelFortuneOption=WheelFortuneOption.filter((e=>!t.includes(e.ID))),WheelFortuneDefault=Array.from(WheelFortuneDefault).filter((e=>!t.includes(e))).join(""),e&&Dm([Bm.SHARED])}}rg=new WeakSet,ig=function(){if(this.children?.length){const e=this.children[0].ID,t=WheelFortuneOption.findIndex((t=>t.ID>=e));return-1===t?WheelFortuneOption.length:t}return WheelFortuneOption.length};class wg extends yg{constructor(e,t,n,r,i,o,a,s,l){const u=wg.validate({name:e,itemList:t,mbsList:n,stripLevel:r,equipLevel:i,flags:o,custom:a,preRunCallback:s,weight:l});super(u.name,u.custom,u.mbsList,u.weight),this.itemList=u.itemList,this.stripLevel=u.stripLevel,this.equipLevel=u.equipLevel,this.flags=u.flags,this.preRunCallback=u.preRunCallback}static validate(e){if("string"!=typeof e.name)throw new TypeError('Invalid "name" type: '+typeof e.name);if(!Dp(e.itemList))throw new TypeError('Invalid "itemList" type: '+typeof e.itemList);{const t=[],n=[];for(let r of e.itemList){const e=AssetGet("Female3DCG",r.Group,r.Name);null!=e?(e.Group.IsItem()||e.Group.IsAppearance()&&e.Group.AllowNone)&&(r.TypeRecord||void 0===r.Type||(r=Object.freeze({...gc(r,"Type"),TypeRecord:ExtendedItemTypeToRecord(e,r.Type)})),t.push(r)):n.push(`${r.Group}:${r.Name}`)}e.itemList=Object.freeze(t),0!==n.length&&$p.warn(`Found ${n.length} items in wheel of fortune item set "${this.name}": ${n}`)}if(!Dp(e.mbsList))throw new TypeError('Invalid "mbsList" type: '+typeof e.mbsList);if(Gp(Object.values(Vp),e.stripLevel)||(e.stripLevel=Vp.UNDERWEAR),Gp(Object.values(Vp),e.equipLevel)||(e.stripLevel=Vp.UNDERWEAR),Dp(e.flags)){let t;if(e.flags.every((e=>"string"==typeof e))){t=function(e){return Ah.map(((t,n)=>{const r={...t};return r.enabled=e.includes(jh[n]),r}))}(e.flags)}else t=function(e){return Ah.map(((t,n)=>{const r=e[n];if(null===r||"object"!=typeof r||r.type!==t.type)return{...t};const i="boolean"==typeof r.enabled?r.enabled:t.enabled;switch(r.type){case"TimerPasswordPadlock":return Number.isInteger(r.time)&&r.time>=1&&r.time<=86400?{type:r.type,description:t.description,time:r.time,enabled:i}:{...t};case"ExclusivePadlock":case"HighSecurityPadlock":case null:return{type:r.type,description:t.description,enabled:i};default:return{...t}}}))}(e.flags);t.every((e=>!e.enabled))&&(t[0].enabled=!0),e.flags=Object.freeze(t.map((e=>Object.freeze(e))))}else e.flags=Ah;return"boolean"!=typeof e.custom&&(e.custom=!0),null!==e.preRunCallback&&"function"!=typeof e.preRunCallback&&(e.preRunCallback=null),Number.isInteger(e.weight)?e.weight=ro(e.weight,1,9):e.weight=1,e}static fromObject(e,t){const n=[t.name,t.itemList,e,t.stripLevel,t.equipLevel,t.flags,t.custom,t.preRunCallback,t.weight];return new wg(...n)}scriptFactory(e=null){const t=this.itemList.map((({Name:e,Group:t})=>AssetGet(Player.AssetFamily,t,e)));return n=>{n=n??Player;const r=Jp(this.equipLevel,n),i=this.itemList.filter(((e,n)=>{const i=t[n];return null!=i&&("Appearance"!==i.Group.Category||r(i))}));eh(this.name,i,this.stripLevel,e,this.preRunCallback,n??Player)}}getIDs(){const e=[];for(const[t,n]of this.flags.entries())n.enabled&&e.push(t);let t;if(this.custom){if(t=256*(2+Math.floor(this.index/16))+16*this.index,t<0)throw new Error(`Item set "${this.name}" absent from currently selected fortune wheel sets`)}else if(t=256+16*hg[this.name],Number.isNaN(t))throw new Error(`Unknown default item set "${this.name}"`);return Np(t,e)}toOptions(){const e=this.flags.filter((e=>e.enabled)),t=this.getIDs();return e.map(((e,n)=>{const r=null===e.type?this.name:`${this.name}: ${Lh(e)}`;let i=!0;switch(e.type){case"HighSecurityPadlock":case null:i=!1;break;case"TimerPasswordPadlock":i=4!==n}return{ID:t[n],Color:Ed(sg),Script:this.scriptFactory(((...t)=>function(e,t,n){const r=e.type;switch(r){case"TimerPasswordPadlock":Nh(t,e.time,n);break;case"ExclusivePadlock":Fh(t,"ExclusivePadlock",n);break;case"HighSecurityPadlock":InventoryDoesItemAllowLock(t)&&t.Craft&&(t.Craft.Property="Puzzling"),Th(t,n);break;case null:break;default:throw new Error(`Unknown flag type: ${r}`,e)}}(e,...t))),Description:r,Default:i,Custom:this.custom,Parent:this,Flag:e,Weight:this.weight}}))}toJSON(){return{name:this.name,itemList:this.itemList,stripLevel:this.stripLevel,equipLevel:this.equipLevel,flags:this.flags,custom:this.custom,preRunCallback:this.preRunCallback,weight:this.weight}}}class Sg extends yg{constructor(e,t,n){const r=Sg.validate({name:e,mbsList:t,weight:n});super(r.name,!0,r.mbsList,r.weight)}static validate(e){if("string"!=typeof e.name)throw new TypeError('Invalid "name" type: '+typeof e.name);if(!Array.isArray(e.mbsList))throw new TypeError('Invalid "mbsList" type: '+typeof e.mbsList);return Number.isInteger(e.weight)?e.weight=ro(e.weight,1,9):e.weight=1,e}static fromObject(e,t){const n=[t.name,e,t.weight];return new Sg(...n)}toOptions(){const[e]=this.getIDs();return[{ID:e,Color:Ed(sg),Description:this.name,Default:!0,Custom:this.custom,Parent:this,Script:void 0,Flag:void 0,Weight:this.weight}]}getIDs(){const e=256*(3+Math.floor(this.index/16))+this.index;return[String.fromCharCode(e)]}toJSON(){return{name:this.name,weight:this.weight}}}let Cg=null;function xg(){return null===Cg&&(Cg=CharacterLoadSimple("MBSAPI")),Cg}var _g=Object.freeze({__proto__:null,getAll:function(){if(!pg())return $p.error("MBS not fully loaded yet"),{};const e=Player.MBSSettings.FortuneWheelItemSets,t={};for(const[n,r]of e.entries())null!==r&&(t[r.name]={name:r.name,index:n,items:ah(r.itemList,xg())});return t},getByIndex:function(e){if("number"!=typeof e)throw new TypeError('Invalid "index" type: '+typeof e);if(!pg())return void $p.error("MBS not fully loaded yet");const t=Player.MBSSettings.FortuneWheelItemSets[e];return null==t?void 0:{name:t.name,index:e,items:ah(t.itemList,xg())}},getByName:function(e){if("string"!=typeof e)throw new TypeError('Invalid "name" type: '+typeof e);if(!pg())return void $p.error("MBS not fully loaded yet");let t=-1;const n=Player.MBSSettings.FortuneWheelItemSets.find(((n,r)=>{const i=n?.name===e;return i&&(t=r),i}));return null==n?void 0:{name:e,index:t,items:ah(n.itemList,xg())}},getIndices:function(){return pg()?Player.MBSSettings.FortuneWheelItemSets.filter((e=>null!==e)).map(((e,t)=>t)):($p.error("MBS not fully loaded yet"),[])},getNames:function(){return pg()?Player.MBSSettings.FortuneWheelItemSets.filter((e=>null!==e)).map((e=>e.name)):($p.error("MBS not fully loaded yet"),[])}});const $g=Object.freeze({backgroundColor:"--mbs-background-color",buttonColor:"--mbs-button-color",buttonHoverColor:"--mbs-hover-color",tooltipColor:"--mbs-tooltip-color",borderColor:"--mbs-border-color",textColor:"--mbs-text-color"}),Ig=Object.freeze({backgroundColor:"white",buttonColor:"white",buttonHoverColor:"cyan",tooltipColor:"lightyellow",borderColor:"black",textColor:"black"});var Og=Object.freeze({__proto__:null,DEFAULT_STYLE:Ig,getStyle:function(){const e=document.querySelector(":root");return e?Wp(Rp($g).map((([t,n])=>[t,e.style.getPropertyValue(n)||Ig[t]]))):($p.error(":root selector missing in document"),{...Ig})},setStyle:function(e){if("object"!=typeof e)throw new TypeError(`Invalid style type: "${typeof e}"`);if(null===e)throw new Error("Invalid style value: null");const t=document.querySelector(":root");if(t)for(const[n,r]of Rp($g)){const i=e[n];void 0!==i&&t.style.setProperty(r,i)}else $p.error(":root selector missing in document")}});const kg=Object.freeze({major:1,minor:3}),Eg=function(){return pg()?JSON.stringify({log:$p,settings:Player.MBSSettings},void 0,4):JSON.stringify({log:$p,settings:"ERROR: MBS not fully loaded yet"},void 0,4)};Pp(dg).then((()=>{"undefined"!=typeof FUSAM&&"function"==typeof FUSAM.registerDebugMethod&&FUSAM.registerDebugMethod("mbs",Eg)}));const Pg="raises",Mg="passes";function Bg(e,t,n){if(!t)throw void 0===n?new Error(`${e}`):new Error(`${e}: ${n}`)}function jg(e,t,n){try{t()}catch(t){const r=t;if(r?.message!==n)throw new Error(`${e}: Invalid error message\nExpected error: "${n}"\nObserved error: "${r?.message}"`);return}throw new Error(`${e}: Failed to raise an error`)}function Ag(e,t){try{return t()}catch(t){throw new Error(`${e}: Unexpected error message: ${t}`,{cause:t})}}function Ng(e,t,n,r){if(r=r??Lg,!ju(t,n))throw new Error(`${e}: Passed objects not equal:\nObserved: ${r(t)}\nExpected: ${r(n)}`)}function Tg(e,t,n){if(typeof t!==n)throw new Error(`${e}: Invalid object type "${typeof t}", expected "${n}"`)}function Fg(e,t,n){if(t.length!==n)throw new Error(`${e}: Invalid object length ${t.length}, expected ${n}`)}function Dg(e,t){switch(typeof t){case"undefined":return"__UNDEFINED__";case"function":return"__FUNCTION__";case"symbol":return"__SYMBOL__";default:return t}}function Lg(e){return JSON.stringify(e,Dg,1)}var Rg=Object.freeze({__proto__:null,test_LoopIterator:function(){const e="test_LoopIterator";[{args:[void 0],excMessage:'Invalid "iterable" type: undefined'},{args:[[]],excMessage:'Passed "iterable" must contain at least one element'},{args:[[1],.5],excMessage:'"index" must be an integer: 0.5'},{args:[[0,1],3],excMessage:'"index" must fall in the [0, 1] interval: 3'}].forEach((({args:t,excMessage:n},r)=>{jg(`${e}:constructor:${Pg}:${r}`,(()=>new Ap(...t)),n)}));const t=new Ap([0,1,2,3],0);let n;Ng(`${e}:list:${Mg}:0`,t.list,[0,1,2,3]),Ng(`${e}:index:${Mg}:0`,t.index,0),Ng(`${e}:value:${Mg}:0`,t.index,0),Tg(`${e}:[Symbol.iterator]:${Mg}:0`,t[Symbol.iterator],"function"),n=Ag(`${e}:next:${Mg}:0`,(()=>t.next(!1))),Ng(`${e}:next:${Mg}:0`,n,1),Ng(`${e}:next:${Mg}:0`,t.index,0),n=Ag(`${e}:next:${Mg}:0`,(()=>t.next())),Ng(`${e}:next:${Mg}:0`,n,1),Ng(`${e}:next:${Mg}:0`,t.index,1),jg(`${e}:setPosition:${Pg}:0`,(()=>t.setPosition(10)),'"index" must fall in the [0, 3] interval: 10'),Ag(`${e}:setPosition:${Mg}:0`,(()=>t.setPosition(0))),Ng(`${e}:setPosition:${Mg}:0`,t.index,0),n=Ag(`${e}:previous:${Mg}:0`,(()=>t.previous(!1))),Ng(`${e}:previous:${Mg}:0`,n,3),Ng(`${e}:previous:${Mg}:0`,t.index,0),n=Ag(`${e}:previous:${Mg}:0`,(()=>t.previous())),Ng(`${e}:previous:${Mg}:0`,n,3),Ng(`${e}:previous:${Mg}:0`,t.index,3),n=Ag(`${e}:toString:${Mg}:0`,(()=>t.toString())),Tg(`${e}:toString:${Mg}:0`,n,"string"),n=Ag(`${e}:toJSON:${Mg}:0`,(()=>t.toJSON())),Ng(`${e}:toJSON:${Mg}:0`,t.toJSON(),{list:[0,1,2,3],index:3})},test_MBS_VERSION:function(){Tg(`test_MBS_VERSION:${Mg}:0`,t,"string")},test_Version:function(){const e="test_Version";[{args:["bob",0,0,!1],excMessage:'Invalid "major" type: string'},{args:[0,"bob",0,!1],excMessage:'Invalid "minor" type: string'},{args:[0,0,"bob",!1],excMessage:'Invalid "micro" type: string'},{args:[0,0,0,"bob"],excMessage:'Invalid "beta" type: string'}].forEach((({args:t,excMessage:n},r)=>{jg(`${e}:constructor:${Pg}:${r}`,(()=>new Fp(...t)),n)}));const t=new Fp(1,0,5),n=new Fp(2,3,1),r=new Fp(0,99,5,!0);Ng(`${e}:major:${Mg}:0`,t.major,1),Ng(`${e}:minor:${Mg}:0`,t.minor,0),Ng(`${e}:micro:${Mg}:0`,t.micro,5),Ng(`${e}:beta:${Mg}:0`,t.beta,!1),Bg(`${e}:equal:${Mg}:0`,!t.equal(null)),Bg(`${e}:equal:${Mg}:1`,t.equal(t)),Bg(`${e}:equal:${Mg}:2`,!t.equal(n)),Bg(`${e}:equal:${Mg}:3`,!t.equal(r)),Bg(`${e}:greater:${Mg}:0`,!t.greater(null)),Bg(`${e}:greater:${Mg}:1`,!t.greater(t)),Bg(`${e}:greater:${Mg}:2`,!t.greater(n)),Bg(`${e}:greater:${Mg}:3`,t.greater(r)),Bg(`${e}:lesser:${Mg}:0`,!t.lesser(null)),Bg(`${e}:lesser:${Mg}:1`,!t.lesser(t)),Bg(`${e}:lesser:${Mg}:2`,t.lesser(n)),Bg(`${e}:lesser:${Mg}:3`,!t.lesser(r)),Bg(`${e}:greaterOrEqual:${Mg}:0`,!t.greaterOrEqual(null)),Bg(`${e}:greaterOrEqual:${Mg}:1`,t.greaterOrEqual(t)),Bg(`${e}:greaterOrEqual:${Mg}:2`,!t.greaterOrEqual(n)),Bg(`${e}:greaterOrEqual:${Mg}:3`,t.greaterOrEqual(r)),Bg(`${e}:lesserOrEqual:${Mg}:0`,!t.lesserOrEqual(null)),Bg(`${e}:lesserOrEqual:${Mg}:1`,t.lesserOrEqual(t)),Bg(`${e}:lesserOrEqual:${Mg}:2`,t.lesserOrEqual(n)),Bg(`${e}:lesserOrEqual:${Mg}:3`,!t.lesserOrEqual(r));let i=Ag(`${e}:fromVersion:${Mg}:0`,(()=>Fp.fromVersion("1.0.5")));Ng(`${e}:fromVersion:${Mg}:0`,i,t),jg(`${e}:fromVersion:${Pg}:0`,(()=>Fp.fromVersion(void 0)),'Invalid "version": undefined'),i=Ag(`${e}:fromVersion:${Mg}:0`,(()=>Fp.fromBCVersion("R109Beta3"))),Ng(`${e}:fromVersion:${Mg}:0`,i,new Fp(109,0,0,!0)),jg(`${e}:fromVersion:${Pg}:0`,(()=>Fp.fromVersion(void 0)),'Invalid "version": undefined'),i=Ag(`${e}:toString:${Mg}:0`,(()=>t.toString())),Tg(`${e}:toString:${Mg}:0`,i,"string"),i=Ag(`${e}:toJSON:${Mg}:0`,(()=>t.toJSON())),Ng(`${e}:toJSON:${Mg}:0`,i,{major:1,minor:0,micro:5,beta:!1})},test_generateIDs:function(){const e="test_generateIDs";[{args:[0,void 0],excMessage:'Invalid "indices" type: undefined'},{args:[65535,[5]],excMessage:'"stop" must fall in the [65536, 65535] interval: 65541'}].forEach((({args:t,excMessage:n},r)=>{jg(`${e}:${Pg}:${r}`,(()=>Np(...t)),n)})),[{args:[80,[0,4,6]],output:["P","T","V"]},{args:[1024,[0,4,1]],output:["Ѐ","Є","Ё"]},{args:[0,[]],output:[]}].forEach((({args:t,output:n},r)=>{const i=Ag(`${e}:${Mg}:${r}`,(()=>Np(...t)));Ng(`${e}:${Mg}:${r}`,i,n)}))},test_getRandomPassword:function(){const e="test_getRandomPassword";[{args:[void 0],excMessage:'Invalid "n" type: undefined'}].forEach((({args:t,excMessage:n},r)=>{jg(`${e}:${Pg}:${r}`,(()=>Ep(...t)),n)})),yd(0,9).forEach((t=>{const n=Ag(`${e}:${Mg}:${t}`,(()=>Ep(t)));Tg(`${e}:${Mg}:${t}`,n,"string"),Fg(`${e}:${Mg}:${t}`,n,t)}))},test_isIterable:function(){const e="test_isIterable";[{args:[null],output:!1},{args:[1],output:!1},{args:[[1]],output:!0},{args:[new Set],output:!0}].forEach((({args:t,output:n},r)=>{const i=Ag(`${e}:${Mg}:${r}`,(()=>Tp(...t)));Ng(`${e}:${Mg}:${r}`,i,n)}))},test_padArray:function(){const e="test_padArray";[{args:[[],.5,null],excMessage:'"n" must be an integer: 0.5'},{args:[void 0,5,null],excMessage:'Invalid "list" type: undefined'}].forEach((({args:t,excMessage:n},r)=>{jg(`${e}:${Pg}:${r}`,(()=>Op(...t)),n)})),[{args:[["a","b","c"],5,"test"],output:["a","b","c","test","test"]},{args:[["a","b","c"],2,"test"],output:["a","b","c"]}].forEach((({args:t,output:n},r)=>{const i=Ag(`${e}:${Mg}:${r}`,(()=>Op(...t)));Ng(`${e}:${Mg}:${r}`,i,n)}))},test_trimArray:function(){const e="test_trimArray";[{args:[[],.5],excMessage:'"n" must be an integer: 0.5'},{args:[void 0,5],excMessage:'Invalid "list" type: undefined'}].forEach((({args:t,excMessage:n},r)=>{jg(`${e}:${Pg}:${r}`,(()=>kp(...t)),n)})),[{args:[["a","b","c"],1],output:["a"]},{args:[["a","b","c"],4],output:["a","b","c"]}].forEach((({args:t,output:n},r)=>{const i=Ag(`${e}:${Mg}:${r}`,(()=>kp(...t)));Ng(`${e}:${Mg}:${r}`,i,n)}))},test_validateInt:function(){const e="test_validateInt";[{args:[.5,"test"],excMessage:'"test" must be an integer: 0.5'},{args:["test","test"],excMessage:'Invalid "test" type: string'},{args:[5,"test",10],excMessage:'"test" must fall in the [10, Infinity] interval: 5'},{args:[5,"test",0,3],excMessage:'"test" must fall in the [0, 3] interval: 5'}].forEach((({args:t,excMessage:n},r)=>{jg(`${e}:${Pg}:${r}`,(()=>Ip(...t)),n)})),Ag(`${e}:${Mg}:0`,(()=>Ip(0,"test")))}});var Wg=Object.freeze({__proto__:null,test_FORTUNE_WHEEL_COLORS:function(){const e="test_FORTUNE_WHEEL_COLORS";Bg(`${e}:${Mg}:0`,Array.isArray(sg)),Bg(`${e}:${Mg}:0`,sg.every((e=>"string"==typeof e)))},test_FORTUNE_WHEEL_MAX_SETS:function(){const e="test_FORTUNE_WHEEL_MAX_SETS";Tg(`${e}:${Mg}:0`,og,"number"),Bg(`${e}:${Mg}:0`,Number.isInteger(og)),Bg(`${e}:${Mg}:0`,og>=0)},test_canChangeCosplay:function(){const e="test_canChangeCosplay",t=yd(0,3).map((t=>`${e}${t}`)).map((e=>{const t=CharacterLoadSimple(e);return t.OnlineSharedSettings=t.OnlineSharedSettings??{},t}));try{t[1].OnlineSharedSettings={...t[1].OnlineSharedSettings??{},BlockBodyCosplay:!1},t[2].OnlineSharedSettings={...t[1].OnlineSharedSettings??{},BlockBodyCosplay:!0};[{args:[t[0]],output:!1},{args:[t[1]],output:!0},{args:[t[2]],output:!1}].forEach((({args:t,output:n},r)=>{const i=Ag(`${e}:${Mg}:${r}`,(()=>ug(...t)));Ng(`${e}:${Mg}:${r}`,i,n)}))}finally{t.forEach((e=>CharacterDelete(e)))}},test_equipHighSecLock:function(){const e="test_equipHighSecLock",t=CharacterLoadSimple(e);try{const n=AssetGet(t.AssetFamily,"ItemArms","LatexArmbinder");if(null==n)throw new Error;const r={Asset:n};Ag(`${e}:${Mg}:0`,(()=>Th(r,t))),Ng(`${e}:${Mg}:0`,r.Property?.MemberNumberListKeys,"")}finally{CharacterDelete(t)}},test_equipLock:function(){const e="test_equipLock",t=yd(0,5).map((t=>`${e}-${t}`)).map(CharacterLoadSimple);try{t[4].BlockItems.push({Name:"ExclusivePadlock",Group:"ItemMisc"}),InventoryWear(t[2],"LatexArmbinder","ItemArms"),InventoryLock(t[2],t[2].Appearance.at(-1),"ExclusivePadlock");const n=AssetGet(t[0].AssetFamily,"ItemArms","LatexArmbinder"),r=AssetGet(t[0].AssetFamily,"ItemArms","NylonRope");if(null==n||null==r)throw new Error;const i={Asset:n};[{args:["bob","ExclusivePadlock",t[0]],excMessage:'Invalid "item" type: string'},{args:[i,0,t[0]],excMessage:'Invalid "lockName" type: number'},{args:[i,"bob",t[0]],excMessage:'Invalid "lockName" value: bob'},{args:[i,"ExclusivePadlock",1],excMessage:'Invalid "character" type: number'}].forEach((({args:t,excMessage:n},r)=>{jg(`${e}:${Pg}:${r}`,(()=>Fh(...t)),n)}));[{args:[i,"ExclusivePadlock",t[1]],output:!0},{args:[i,"ExclusivePadlock",t[2]],output:!1},{args:[{Asset:r},"ExclusivePadlock",t[3]],output:!1},{args:[i,"ExclusivePadlock",t[4]],output:!1}].forEach((({args:t,output:n},r)=>{const i=Ag(`${e}:${Mg}:${r}`,(()=>Fh(...t)));Ng(`${e}:${Mg}:0`,i,n)}))}finally{t.forEach((e=>CharacterDelete(e)))}},test_equipTimerLock:function(){const e="test_equipTimerLock",t=CharacterLoadSimple(e);try{const n=AssetGet(t.AssetFamily,"ItemArms","LatexArmbinder");if(null==n)throw new Error;const r={Asset:n};jg(`${e}:${Pg}:0`,(()=>Nh(r,void 0,t)),'Invalid "seconds" type: undefined'),Ag(`${e}:${Mg}:0`,(()=>Nh(r,99,t))),Bg(`${e}:${Mg}:0`,(r.Property?.RemoveTimer??1/0)<=CurrentTime+198e4),Ng(`${e}:${Mg}:0`,r.Property?.RemoveItem,!0),Ng(`${e}:${Mg}:0`,r.Property?.LockSet,!0),Tg(`${e}:${Mg}:0`,r.Property?.Password,"string")}finally{CharacterDelete(t)}},test_sanitizeWheelFortuneIDs:function(){const e="test_sanitizeWheelFortuneIDs";jg(`${e}:${Pg}:0`,(()=>cg(void 0)),'Invalid "IDs" type: undefined'),[{args:["ABC"],output:"ABC"},{args:["A䀁"],output:"A"}].forEach((({args:t,output:n},r)=>{const i=Ag(`${e}:${Mg}:${r}`,(()=>cg(...t)));Ng(`${e}:${Mg}:${r}`,i,n)}))},test_settingsLoaded:function(){const e="test_settingsLoaded",t=Ag(`${e}:${Mg}:0`,fg);Ng(`${e}:${Mg}:0`,t,!0)},test_settingsMBSLoaded:function(){const e="test_settingsMBSLoaded",t=Ag(`${e}:${Mg}:0`,pg);Ng(`${e}:${Mg}:0`,t,!0)}});const Gg=Object.freeze({Mummification:e=>({...e,TypeRecord:void 0})});var zg=Object.freeze({__proto__:null,test_builtinMBSWheel:function(){const e="test_builtinMBSWheel",t=Er(Object.values(am).map((e=>e.children??[]))),n=t.map((e=>e.Description)).map((e=>CharacterLoadSimple(e)));try{t.forEach((t=>{if(!(t.Parent instanceof wg))return;const n=CharacterLoadSimple(t.Description);t.Script(n);for(let r of t.Parent.itemList){const i=InventoryGet(n,r.Group);if(void 0!==r.Equip)continue;Bg(`${e}:${t.Description}:${r.Group}:${r.Name}:${Mg}`,null!=i);const o=(Gg[t.Parent.name]??(e=>e))(oh(i.Asset,{...i,Group:i.Asset.Group.Name,Name:i.Asset.Name,Color:void 0===r.Color?void 0:i.Color},!1),n);null!==o&&(r={...r,ItemCallback:void 0,Property:{...o.Property,...r.Property},Equip:void 0,Craft:void 0!==r.Craft&&"HighSecurityPadlock"===t.Flag.type&&InventoryDoesItemAllowLock(i)?{...r.Craft,Property:"Puzzling"}:r.Craft},Ng(`${e}:${t.Description}:${r.Group}:${r.Name}:${Mg}`,o,r))}}))}finally{n.forEach((e=>CharacterDelete(e)))}}});const Hg=function(){if(!pg())return $p.warn("MBS not fully loaded yet"),!1;const e={...Rg,...Wg,...zg},t={};for(const[n,r]of Rp(e))try{r()}catch(e){t[n]=e}return 0===Object.values(t).length||($p.warn(t),!1)};Pp(dg).then((()=>{const e={[`${Ch.screen}Background`]:Ch.background,[`${$h.screen}Background`]:$h.background,[`${Bh.screen}Background`]:Bh.background,[`${eg.screen}Background`]:eg.background,[`${nm.screen}Background`]:nm.background},t=globalThis;Object.assign(t,e)}));const qg=new Set;Pp(dg).then((()=>{qg.size?$p.log("Initializing R104 bug fix backports",Fd(Array.from(qg))):$p.log("No R104 bug fix backports")}));const Ug=Mp.getOriginalHash,Vg=t;return $p.log(`Initializing MBS version ${t}`),Pp((()=>dg(!1))).then((()=>{!function(e){const t=Fp.fromBCVersion(e),n=Fp.fromBCVersion("R103");if(t.lesser(n))throw new Error(`BC ${GameVersion} detected; MBS requires version R103 or later`);$p.log(`Detected BC ${GameVersion}`)}(GameVersion),function(){const e={};for(const[t,n]of Object.entries(Hp)){const r=Mp.getOriginalHash(t);n.has(r)||(e[t]=r)}const t=Object.values(e).length;0!==t&&$p.warn(`Found ${t} patched functions with an unknown hash`,e)}(),document.body.appendChild(f("style",{id:"mbs-style",children:":root {\n  --mbs-background-color: white;\n  --mbs-button-color: white;\n  --mbs-hover-color: cyan;\n  --mbs-tooltip-color: lightyellow;\n  --mbs-border-color: black;\n  --mbs-text-color: black;\n  --mbs-font-small: min(3.5vh, 1.75vw);\n  --mbs-font-large: min(5vh, 2.5vw);\n  --mbs-font-family: arial, sans-serif;\n}\n\n.mbs-button {\n  background-origin: content-box;\n  background-position: center;\n  background-repeat: no-repeat;\n  background-size: cover;\n  height: 100%;\n  overflow: clip;\n  padding-left: min(2vh, 1vw);\n  padding-right: min(2vh, 1vw);\n  text-align: center;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n  width: 100%;\n}\n.mbs-button:hover {\n  background-color: var(--mbs-hover-color);\n}\n.mbs-button:disabled {\n  background-color: var(--mbs-button-color);\n  filter: brightness(60%);\n}\n\n.mbs-button-tooltip {\n  background-color: var(--mbs-tooltip-color) !important;\n  border: min(0.3vh, 0.15vw) solid var(--mbs-border-color);\n  bottom: -10%;\n  box-shadow: min(0.4vh, 0.2vw) min(0.4vh, 0.2vw) min(2vh, 1vw) 0 rgba(0, 0, 0, 0.5);\n  line-height: 1.4;\n  padding: min(1vh, 0.5vw) min(2vh, 1vw) min(1vh, 0.5vw) min(2vh, 1vw);\n  position: relative;\n  text-align: center;\n  visibility: hidden;\n  white-space: nowrap;\n  width: fit-content;\n  z-index: 1;\n}\n\n.mbs-button-div {\n  display: grid;\n  grid-template-columns: min(9vh, 4.5vw);\n  grid-template-rows: min(9vh, 4.5vw) auto;\n}\n.mbs-button-div .mbs-button-tooltip {\n  justify-self: center;\n}\n.mbs-button-div .mbs-button {\n  height: inherit;\n  width: inherit;\n}\n.mbs-button-div .mbs-button:hover + .mbs-button-tooltip {\n  visibility: visible;\n}\n\n.mbs-timer {\n  height: min(6vh, 3vw);\n  text-align: center;\n  width: min(21vh, 10.5vw);\n}\n\n.mbs-dropdown-button {\n  border: unset !important;\n  padding-bottom: min(1vh, 0.5vw);\n  padding-top: min(1vh, 0.5vw);\n}\n.mbs-dropdown-button:nth-child(even) {\n  filter: brightness(85%);\n}\n\n.mbs-dropdown-content {\n  border: min(0.3vh, 0.15vw) solid var(--mbs-border-color);\n  overflow-y: scroll;\n  position: absolute;\n  visibility: hidden;\n  z-index: 1;\n}\n\n.mbs-dropdown:hover .mbs-dropdown-content {\n  visibility: visible;\n}\n\n.mbs-screen {\n  display: grid;\n  position: fixed;\n  text-align: center;\n  user-select: none;\n  visibility: hidden;\n  grid-gap: min(2vh, 1vw);\n}\n.mbs-screen h1, .mbs-screen h2, .mbs-screen p, .mbs-screen ul {\n  align-items: center;\n  align-self: center;\n  color: var(--mbs-text-color);\n  font-family: var(--mbs-font-family);\n}\n.mbs-screen h1 {\n  font-size: var(--mbs-font-large);\n}\n.mbs-screen h2 {\n  margin: min(1vh, 0.5vw);\n}\n.mbs-screen ul {\n  margin: 0;\n  text-align: left;\n}\n.mbs-screen p, .mbs-screen h2, .mbs-screen ul {\n  font-size: var(--mbs-font-small);\n}\n.mbs-screen div, .mbs-screen input {\n  background-color: var(--mbs-background-color);\n  color: var(--mbs-text-color);\n  font-family: var(--mbs-font-family);\n  font-size: var(--mbs-font-small);\n}\n.mbs-screen button {\n  background-color: var(--mbs-button-color);\n  border: min(0.3vh, 0.15vw) solid var(--mbs-border-color);\n  color: var(--mbs-text-color);\n  font-family: var(--mbs-font-family);\n  font-size: var(--mbs-font-small);\n}\n.mbs-screen input:invalid {\n  background-color: #fbb;\n  box-shadow: 0 0 3px 2px #c22;\n}\n.mbs-screen input[type=checkbox] {\n  border: min(0.3vh, 0.15vw) solid var(--mbs-border-color);\n  height: min(7vh, 3.5vw);\n  width: min(7vh, 3.5vw);\n}\n.mbs-screen input[type=checkbox]:hover {\n  background-color: var(--mbs-hover-color);\n}\n.mbs-screen input[type=checkbox]:disabled {\n  background-color: var(--mbs-background-color);\n  filter: brightness(60%);\n}\n.mbs-screen input[type=checkbox]::before {\n  height: min(4.6vh, 2.3vw);\n  width: min(4.6vh, 2.3vw);\n}".toString()}))})),e.API_VERSION=kg,e.MBS_VERSION=Vg,e._getFunctionHash=Ug,e._toItemBundles=ah,e._unpackSettings=Tm,e.css=Og,e.getDebug=Eg,e.runTests=Hg,e.wheelOutfits=_g,e}({});
//# sourceMappingURL=mbs.js.map
